<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babylonjs/3.3.0/babylon.js"></script>
  <title>Babylon.js SVG Texture Example</title>
</head>

<body>
  <canvas id="renderCanvas"></canvas>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var canvas = document.getElementById("renderCanvas");
      var engine = new BABYLON.Engine(canvas, true);
      canvas.width = 800;
      canvas.height = 800;

      var createScene = function () {
        var scene = new BABYLON.Scene(engine);

        // 创建相机
        var camera = new BABYLON.ArcRotateCamera("camera", -Math.PI / 2, Math.PI / 4, 20, new BABYLON.Vector3(0, 0, 0));
        camera.attachControl(canvas, true);

        // 创建灯光
        var light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0));

        // 随机确定两个点
        var point1 = new BABYLON.Vector3(Math.random() * 20, Math.random() * 20, Math.random() * 20);
        var point2 = new BABYLON.Vector3(Math.random() * 20, Math.random() * 20, Math.random() * 20);
        console.log(123);
        let path = [point1, point2];
        // 创建一个管道
        let tube = BABYLON.Mesh.CreateTube("tube", path, this.radius, 64, null, BABYLON.Mesh.CAP_ALL, scene, true);


        // SVG 图片的 base64 编码
        var svgBase64 = "data:image/svg+xml;base64,CiAgICAgICAgPHN2ZyB3aWR0aCA9ICc2MHB4JyBoZWlnaHQ9JzYwcHgnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgdmVyc2lvbj0nMS4xJz4gCiAgICAgICAgICA8ZGVmcz4KICAgICAgICAgICAgPGxpbmVhckdyYWRpZW50IGlkID0gImRlZiIgeDE9IjAlIiB5MT0iMzkuNiUiIHgyPSIwJSIgeTI9Ijg3LjIlIj4KICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQgPSAiNTcuMTI2Nzk5OTk5OTk5OTk2JSIgc3R5bGUgPSAic3RvcC1jb2xvcjogcmdiKDQ1LDI0Myw0NCk7IHN0b3Atb3BhY2l0eTogMSIgPjwvc3RvcD4KICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQgPSAiNzcuMjg5MiUiIHN0eWxlID0gInN0b3AtY29sb3I6IHJnYigyNDcsMjQ3LDI0Nyk7IHN0b3Atb3BhY2l0eTogMSI+PC9zdG9wPgogICAgICAgICAgICA8L2xpbmVhckdyYWRpZW50PgogICAgICAgICAgPC9kZWZzPiAgCiAgICAgICAgICA8cmVjdCB3aWR0aD0nNjBweCcgaGVpZ2h0PSc2MHB4JyBzdHlsZT0gImZpbGw6IHVybCgjZGVmKSI+PC9yZWN0PiAgICAKICAgICAgICA8L3N2Zz4KICAgIA=="

        // 创建一个标准材质
        var material = new BABYLON.StandardMaterial("keyMaterial", scene);
        material.diffuseTexture = new BABYLON.Texture(svgBase64, scene);
        material.specularPower = 200;
        material.roughness = 1;
        material.specularColor.set(0.2, 0.2, 0.2);

        // 将材质应用到管道
        tube.material = material;

        // 使管道旋转
        scene.registerBeforeRender(function () {
          // tube.rotation.y += 0.01;s
        });

        return scene;
      };

      var scene = createScene();

      engine.runRenderLoop(function () {
        scene.render();
      });

      window.addEventListener("resize", function () {
        engine.resize();
      });
    });
  </script>
</body>

</html>