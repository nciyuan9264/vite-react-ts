{"version":3,"file":"babylon.gui.min.js","mappings":"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","sources":["webpack://BABYLON.GUI/webpack/universalModuleDefinition","webpack://BABYLON.GUI/external umd {\"root\":\"BABYLON\",\"commonjs\":\"babylonjs\",\"commonjs2\":\"babylonjs\",\"amd\":\"babylonjs\"}","webpack://BABYLON.GUI/webpack/bootstrap","webpack://BABYLON.GUI/webpack/runtime/define property getters","webpack://BABYLON.GUI/webpack/runtime/global","webpack://BABYLON.GUI/webpack/runtime/hasOwnProperty shorthand","webpack://BABYLON.GUI/webpack/runtime/make namespace object","webpack://BABYLON.GUI/../../../../node_modules/tslib/tslib.es6.mjs","webpack://BABYLON.GUI/../../../dev/gui/src/2D/valueAndUnit.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/measure.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/math2D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/control.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/container.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/rectangle.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/textBlock.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/image.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/button.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/stackPanel.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/checkbox.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/textWrapper.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/inputText.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/grid.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/colorpicker.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/ellipse.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/focusableButton.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/inputTextArea.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/inputPassword.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/line.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/multiLinePoint.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/multiLine.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/radioButton.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/sliders/baseSlider.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/sliders/slider.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/selector.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/scrollViewers/scrollViewerWindow.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/sliders/scrollBar.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/sliders/imageScrollBar.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/scrollViewers/scrollViewer.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/toggleButton.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/virtualKeyboard.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/displayGrid.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/sliders/imageBasedSlider.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/statics.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/gradient/BaseGradient.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/gradient/LinearGradient.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/controls/gradient/RadialGradient.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/style.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/advancedDynamicTexture.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/adtInstrumentation.ts","webpack://BABYLON.GUI/../../../dev/gui/src/2D/xmlLoader.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/vector3WithInfo.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/control3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/contentDisplay3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/abstractButton3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/button3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/container3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/volumeBasedPanel.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/cylinderPanel.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluent/shaders/fluent.vertex.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluent/fluentMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/touchHolographicMenu.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/handMenu.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentBackplate/shaders/fluentBackplate.fragment.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentBackplate/shaders/fluentBackplate.vertex.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentBackplate/fluentBackplateMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/holographicBackplate.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/holographicButton.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentButton/shaders/fluentButton.fragment.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentButton/shaders/fluentButton.vertex.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentButton/fluentButtonMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/touchButton3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/touchHolographicButton.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/behaviors/defaultBehavior.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/handle/shaders/handle.vertex.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/handle/shaders/handle.fragment.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/handle/handleMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/gizmos/gizmoHandle.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/gizmos/slateGizmo.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/holographicSlate.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/meshButton3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/nearMenu.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/planePanel.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/scatterPanel.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/shaders/mrdlSliderBar.fragment.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/shaders/mrdlSliderBar.vertex.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/mrdlSliderBarMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/shaders/mrdlSliderThumb.fragment.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/shaders/mrdlSliderThumb.vertex.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/mrdlSliderThumbMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/mrdlBackplateMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/slider3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/spherePanel.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/stackPanel3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/touchMeshButton3D.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/shaders/mrdlBackglow.fragment.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/shaders/mrdlBackglow.vertex.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/mrdlBackglowMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/mrdlFrontplateMaterial.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/MRTK3/touchHolographicButton.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/controls/index.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluent/index.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentButton/index.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/fluentBackplate/index.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/handle/index.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/mrdl/index.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/gui3DManager.ts","webpack://BABYLON.GUI/../../../dev/gui/src/3D/materials/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"babylonjs\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"babylonjs-gui\", [\"babylonjs\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"babylonjs-gui\"] = factory(require(\"babylonjs\"));\n\telse\n\t\troot[\"BABYLON\"] = root[\"BABYLON\"] || {}, root[\"BABYLON\"][\"GUI\"] = factory(root[\"BABYLON\"]);\n})((typeof self !== \"undefined\" ? self : typeof global !== \"undefined\" ? global : this), (__WEBPACK_EXTERNAL_MODULE__520__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__520__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n};\n","import { Observable } from \"core/Misc/observable\";\r\nimport type { AdvancedDynamicTexture } from \"./advancedDynamicTexture\";\r\n\r\n/**\r\n * Class used to specific a value and its associated unit\r\n */\r\nexport class ValueAndUnit {\r\n    private _value = 1;\r\n    private _unit = ValueAndUnit.UNITMODE_PIXEL;\r\n    private _originalUnit: number;\r\n\r\n    /**\r\n     * Gets or sets a value indicating that this value will not scale accordingly with adaptive scaling property\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#adaptive-scaling\r\n     */\r\n    public ignoreAdaptiveScaling = false;\r\n\r\n    /**\r\n     * Observable event triggered each time the value or unit changes\r\n     */\r\n    public onChangedObservable = new Observable<void>();\r\n\r\n    /**\r\n     * Creates a new ValueAndUnit\r\n     * @param value defines the value to store\r\n     * @param unit defines the unit to store - defaults to ValueAndUnit.UNITMODE_PIXEL\r\n     * @param negativeValueAllowed defines a boolean indicating if the value can be negative\r\n     */\r\n    public constructor(\r\n        value: number,\r\n        /** defines the unit to store */\r\n        unit = ValueAndUnit.UNITMODE_PIXEL,\r\n        /** defines a boolean indicating if the value can be negative */\r\n        public negativeValueAllowed = true\r\n    ) {\r\n        this._value = value;\r\n        this._unit = unit;\r\n        this._originalUnit = unit;\r\n    }\r\n\r\n    /** Gets a boolean indicating if the value is a percentage */\r\n    public get isPercentage(): boolean {\r\n        return this._unit === ValueAndUnit.UNITMODE_PERCENTAGE;\r\n    }\r\n\r\n    /** Gets a boolean indicating if the value is store as pixel */\r\n    public get isPixel(): boolean {\r\n        return this._unit === ValueAndUnit.UNITMODE_PIXEL;\r\n    }\r\n\r\n    /**\r\n     * Gets value (without units)\r\n     * @deprecated use value property instead\r\n     */\r\n    public get internalValue(): number {\r\n        return this._value;\r\n    }\r\n\r\n    /** Gets value (without units) */\r\n    public get value(): number {\r\n        return this._value;\r\n    }\r\n\r\n    /** Sets value (without units) */\r\n    public set value(value: number) {\r\n        if (value !== this._value) {\r\n            this._value = value;\r\n            this.onChangedObservable.notifyObservers();\r\n        }\r\n    }\r\n\r\n    /** Gets units (without value) */\r\n    public get unit(): number {\r\n        return this._unit;\r\n    }\r\n\r\n    /** Sets units (without value) */\r\n    public set unit(value: number) {\r\n        if (value !== this._unit) {\r\n            this._unit = value;\r\n            this.onChangedObservable.notifyObservers();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets value as pixel\r\n     * @param host defines the root host\r\n     * @param refValue defines the reference value for percentages\r\n     * @returns the value as pixel\r\n     */\r\n    public getValueInPixel(host: AdvancedDynamicTexture, refValue: number): number {\r\n        if (this.isPixel) {\r\n            return this.getValue(host);\r\n        }\r\n\r\n        return this.getValue(host) * refValue;\r\n    }\r\n\r\n    /**\r\n     * Update the current value and unit.\r\n     * @param value defines the value to store\r\n     * @param unit defines the unit to store\r\n     * @returns the current ValueAndUnit\r\n     */\r\n    public updateInPlace(value: number, unit = ValueAndUnit.UNITMODE_PIXEL): ValueAndUnit {\r\n        if (this.value !== value || this.unit !== unit) {\r\n            // set member variables to notify only once\r\n            this._value = value;\r\n            this._unit = unit;\r\n            this.onChangedObservable.notifyObservers();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets the value accordingly to its unit\r\n     * @param host  defines the root host\r\n     * @returns the value\r\n     */\r\n    public getValue(host: AdvancedDynamicTexture): number {\r\n        if (host && !this.ignoreAdaptiveScaling && this.unit !== ValueAndUnit.UNITMODE_PERCENTAGE) {\r\n            let width: number = 0;\r\n            let height: number = 0;\r\n\r\n            if (host.idealWidth) {\r\n                width = Math.ceil((this._value * host.getSize().width) / host.idealWidth);\r\n            }\r\n\r\n            if (host.idealHeight) {\r\n                height = Math.ceil((this._value * host.getSize().height) / host.idealHeight);\r\n            }\r\n\r\n            if (host.useSmallestIdeal && host.idealWidth && host.idealHeight) {\r\n                return window.innerWidth < window.innerHeight ? width : height;\r\n            }\r\n\r\n            if (host.idealWidth) {\r\n                // horizontal\r\n                return width;\r\n            }\r\n\r\n            if (host.idealHeight) {\r\n                // vertical\r\n                return height;\r\n            }\r\n        }\r\n        return this._value;\r\n    }\r\n\r\n    /**\r\n     * Gets a string representation of the value\r\n     * @param host defines the root host\r\n     * @param decimals defines an optional number of decimals to display\r\n     * @returns a string\r\n     */\r\n    public toString(host: AdvancedDynamicTexture, decimals?: number): string {\r\n        switch (this._unit) {\r\n            case ValueAndUnit.UNITMODE_PERCENTAGE: {\r\n                const percentage = this.getValue(host) * 100;\r\n                return (decimals ? percentage.toFixed(decimals) : percentage) + \"%\";\r\n            }\r\n            case ValueAndUnit.UNITMODE_PIXEL: {\r\n                const pixels = this.getValue(host);\r\n                return (decimals ? pixels.toFixed(decimals) : pixels) + \"px\";\r\n            }\r\n        }\r\n\r\n        return this._unit.toString();\r\n    }\r\n\r\n    /**\r\n     * Store a value parsed from a string\r\n     * @param source defines the source string\r\n     * @returns true if the value was successfully parsed and updated\r\n     */\r\n    public fromString(source: string | number): boolean {\r\n        const match = ValueAndUnit._Regex.exec(source.toString());\r\n\r\n        if (!match || match.length === 0) {\r\n            return false;\r\n        }\r\n\r\n        let sourceValue = parseFloat(match[1]);\r\n        let sourceUnit = this._originalUnit;\r\n\r\n        if (!this.negativeValueAllowed) {\r\n            if (sourceValue < 0) {\r\n                sourceValue = 0;\r\n            }\r\n        }\r\n\r\n        if (match.length === 4) {\r\n            switch (match[3]) {\r\n                case \"px\":\r\n                    sourceUnit = ValueAndUnit.UNITMODE_PIXEL;\r\n                    break;\r\n                case \"%\":\r\n                    sourceUnit = ValueAndUnit.UNITMODE_PERCENTAGE;\r\n                    sourceValue /= 100.0;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        if (sourceValue === this._value && sourceUnit === this._unit) {\r\n            return false;\r\n        }\r\n\r\n        this._value = sourceValue;\r\n        this._unit = sourceUnit;\r\n        this.onChangedObservable.notifyObservers();\r\n\r\n        return true;\r\n    }\r\n\r\n    // Static\r\n    private static _Regex = /(^-?\\d*(\\.\\d+)?)(%|px)?/;\r\n    private static _UNITMODE_PERCENTAGE = 0;\r\n    private static _UNITMODE_PIXEL = 1;\r\n\r\n    /** UNITMODE_PERCENTAGE */\r\n    public static get UNITMODE_PERCENTAGE(): number {\r\n        return ValueAndUnit._UNITMODE_PERCENTAGE;\r\n    }\r\n\r\n    /** UNITMODE_PIXEL */\r\n    public static get UNITMODE_PIXEL(): number {\r\n        return ValueAndUnit._UNITMODE_PIXEL;\r\n    }\r\n}\r\n","import type { Matrix2D } from \"./math2D\";\r\nimport { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nconst tmpRect = [new Vector2(0, 0), new Vector2(0, 0), new Vector2(0, 0), new Vector2(0, 0)];\r\n\r\nconst tmpRect2 = [new Vector2(0, 0), new Vector2(0, 0), new Vector2(0, 0), new Vector2(0, 0)];\r\n\r\nconst tmpV1 = new Vector2(0, 0);\r\nconst tmpV2 = new Vector2(0, 0);\r\n\r\n/**\r\n * Class used to store 2D control sizes\r\n */\r\nexport class Measure {\r\n    /**\r\n     * Creates a new measure\r\n     * @param left defines left coordinate\r\n     * @param top defines top coordinate\r\n     * @param width defines width dimension\r\n     * @param height defines height dimension\r\n     */\r\n    public constructor(\r\n        /** defines left coordinate */\r\n        public left: number,\r\n        /** defines top coordinate  */\r\n        public top: number,\r\n        /** defines width dimension  */\r\n        public width: number,\r\n        /** defines height dimension */\r\n        public height: number\r\n    ) {}\r\n\r\n    /**\r\n     * Copy from another measure\r\n     * @param other defines the other measure to copy from\r\n     */\r\n    public copyFrom(other: Measure): void {\r\n        this.left = other.left;\r\n        this.top = other.top;\r\n        this.width = other.width;\r\n        this.height = other.height;\r\n    }\r\n\r\n    /**\r\n     * Copy from a group of 4 floats\r\n     * @param left defines left coordinate\r\n     * @param top defines top coordinate\r\n     * @param width defines width dimension\r\n     * @param height defines height dimension\r\n     */\r\n    public copyFromFloats(left: number, top: number, width: number, height: number): void {\r\n        this.left = left;\r\n        this.top = top;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n    /**\r\n     * Computes the axis aligned bounding box measure for two given measures\r\n     * @param a Input measure\r\n     * @param b Input measure\r\n     * @param result the resulting bounding measure\r\n     */\r\n    public static CombineToRef(a: Measure, b: Measure, result: Measure) {\r\n        const left = Math.min(a.left, b.left);\r\n        const top = Math.min(a.top, b.top);\r\n        const right = Math.max(a.left + a.width, b.left + b.width);\r\n        const bottom = Math.max(a.top + a.height, b.top + b.height);\r\n        result.left = left;\r\n        result.top = top;\r\n        result.width = right - left;\r\n        result.height = bottom - top;\r\n    }\r\n\r\n    /**\r\n     * Computes the axis aligned bounding box of the measure after it is modified by a given transform\r\n     * @param transform the matrix to transform the measure before computing the AABB\r\n     * @param addX number to add to left\r\n     * @param addY number to add to top\r\n     * @param addWidth number to add to width\r\n     * @param addHeight number to add to height\r\n     * @param result the resulting AABB\r\n     */\r\n    public addAndTransformToRef(transform: Matrix2D, addX: number, addY: number, addWidth: number, addHeight: number, result: Measure) {\r\n        const left = this.left + addX;\r\n        const top = this.top + addY;\r\n        const width = this.width + addWidth;\r\n        const height = this.height + addHeight;\r\n\r\n        tmpRect[0].copyFromFloats(left, top);\r\n        tmpRect[1].copyFromFloats(left + width, top);\r\n        tmpRect[2].copyFromFloats(left + width, top + height);\r\n        tmpRect[3].copyFromFloats(left, top + height);\r\n\r\n        tmpV1.copyFromFloats(Number.MAX_VALUE, Number.MAX_VALUE);\r\n        tmpV2.copyFromFloats(0, 0);\r\n        for (let i = 0; i < 4; i++) {\r\n            transform.transformCoordinates(tmpRect[i].x, tmpRect[i].y, tmpRect2[i]);\r\n            tmpV1.x = Math.floor(Math.min(tmpV1.x, tmpRect2[i].x));\r\n            tmpV1.y = Math.floor(Math.min(tmpV1.y, tmpRect2[i].y));\r\n            tmpV2.x = Math.ceil(Math.max(tmpV2.x, tmpRect2[i].x));\r\n            tmpV2.y = Math.ceil(Math.max(tmpV2.y, tmpRect2[i].y));\r\n        }\r\n        result.left = tmpV1.x;\r\n        result.top = tmpV1.y;\r\n        result.width = tmpV2.x - tmpV1.x;\r\n        result.height = tmpV2.y - tmpV1.y;\r\n    }\r\n\r\n    /**\r\n     * Computes the axis aligned bounding box of the measure after it is modified by a given transform\r\n     * @param transform the matrix to transform the measure before computing the AABB\r\n     * @param result the resulting AABB\r\n     */\r\n    public transformToRef(transform: Matrix2D, result: Measure) {\r\n        this.addAndTransformToRef(transform, 0, 0, 0, 0, result);\r\n    }\r\n    /**\r\n     * Check equality between this measure and another one\r\n     * @param other defines the other measures\r\n     * @returns true if both measures are equals\r\n     */\r\n    public isEqualsTo(other: Measure): boolean {\r\n        if (this.left !== other.left) {\r\n            return false;\r\n        }\r\n\r\n        if (this.top !== other.top) {\r\n            return false;\r\n        }\r\n\r\n        if (this.width !== other.width) {\r\n            return false;\r\n        }\r\n\r\n        if (this.height !== other.height) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Creates an empty measure\r\n     * @returns a new measure\r\n     */\r\n    public static Empty(): Measure {\r\n        return new Measure(0, 0, 0, 0);\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport { Vector2 } from \"core/Maths/math.vector\";\r\nimport { Epsilon } from \"core/Maths/math.constants\";\r\n\r\n/**\r\n * Class used to transport Vector2 information for pointer events\r\n */\r\nexport class Vector2WithInfo extends Vector2 {\r\n    /**\r\n     * Creates a new Vector2WithInfo\r\n     * @param source defines the vector2 data to transport\r\n     * @param buttonIndex defines the current mouse button index\r\n     */\r\n    public constructor(\r\n        source: Vector2,\r\n        /** defines the current mouse button index */\r\n        public buttonIndex: number = 0\r\n    ) {\r\n        super(source.x, source.y);\r\n    }\r\n}\r\n\r\n/** Class used to provide 2D matrix features */\r\nexport class Matrix2D {\r\n    /** Gets the internal array of 6 floats used to store matrix data */\r\n    public m = new Float32Array(6);\r\n\r\n    /**\r\n     * Creates a new matrix\r\n     * @param m00 defines value for (0, 0)\r\n     * @param m01 defines value for (0, 1)\r\n     * @param m10 defines value for (1, 0)\r\n     * @param m11 defines value for (1, 1)\r\n     * @param m20 defines value for (2, 0)\r\n     * @param m21 defines value for (2, 1)\r\n     */\r\n    constructor(m00: number, m01: number, m10: number, m11: number, m20: number, m21: number) {\r\n        this.fromValues(m00, m01, m10, m11, m20, m21);\r\n    }\r\n\r\n    /**\r\n     * Fills the matrix from direct values\r\n     * @param m00 defines value for (0, 0)\r\n     * @param m01 defines value for (0, 1)\r\n     * @param m10 defines value for (1, 0)\r\n     * @param m11 defines value for (1, 1)\r\n     * @param m20 defines value for (2, 0)\r\n     * @param m21 defines value for (2, 1)\r\n     * @returns the current modified matrix\r\n     */\r\n    public fromValues(m00: number, m01: number, m10: number, m11: number, m20: number, m21: number): Matrix2D {\r\n        this.m[0] = m00;\r\n        this.m[1] = m01;\r\n        this.m[2] = m10;\r\n        this.m[3] = m11;\r\n        this.m[4] = m20;\r\n        this.m[5] = m21;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets matrix determinant\r\n     * @returns the determinant\r\n     */\r\n    public determinant(): number {\r\n        return this.m[0] * this.m[3] - this.m[1] * this.m[2];\r\n    }\r\n\r\n    /**\r\n     * Inverses the matrix and stores it in a target matrix\r\n     * @param result defines the target matrix\r\n     * @returns the current matrix\r\n     */\r\n    public invertToRef(result: Matrix2D): Matrix2D {\r\n        const l0 = this.m[0];\r\n        const l1 = this.m[1];\r\n        const l2 = this.m[2];\r\n        const l3 = this.m[3];\r\n        const l4 = this.m[4];\r\n        const l5 = this.m[5];\r\n\r\n        const det = this.determinant();\r\n        if (det < Epsilon * Epsilon) {\r\n            result.m[0] = 0;\r\n            result.m[1] = 0;\r\n            result.m[2] = 0;\r\n            result.m[3] = 0;\r\n            result.m[4] = 0;\r\n            result.m[5] = 0;\r\n            return this;\r\n        }\r\n\r\n        const detDiv = 1 / det;\r\n\r\n        const det4 = l2 * l5 - l3 * l4;\r\n        const det5 = l1 * l4 - l0 * l5;\r\n\r\n        result.m[0] = l3 * detDiv;\r\n        result.m[1] = -l1 * detDiv;\r\n        result.m[2] = -l2 * detDiv;\r\n        result.m[3] = l0 * detDiv;\r\n        result.m[4] = det4 * detDiv;\r\n        result.m[5] = det5 * detDiv;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Multiplies the current matrix with another one\r\n     * @param other defines the second operand\r\n     * @param result defines the target matrix\r\n     * @returns the current matrix\r\n     */\r\n    public multiplyToRef(other: Matrix2D, result: Matrix2D): Matrix2D {\r\n        const l0 = this.m[0];\r\n        const l1 = this.m[1];\r\n        const l2 = this.m[2];\r\n        const l3 = this.m[3];\r\n        const l4 = this.m[4];\r\n        const l5 = this.m[5];\r\n\r\n        const r0 = other.m[0];\r\n        const r1 = other.m[1];\r\n        const r2 = other.m[2];\r\n        const r3 = other.m[3];\r\n        const r4 = other.m[4];\r\n        const r5 = other.m[5];\r\n\r\n        result.m[0] = l0 * r0 + l1 * r2;\r\n        result.m[1] = l0 * r1 + l1 * r3;\r\n        result.m[2] = l2 * r0 + l3 * r2;\r\n        result.m[3] = l2 * r1 + l3 * r3;\r\n        result.m[4] = l4 * r0 + l5 * r2 + r4;\r\n        result.m[5] = l4 * r1 + l5 * r3 + r5;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Applies the current matrix to a set of 2 floats and stores the result in a vector2\r\n     * @param x defines the x coordinate to transform\r\n     * @param y defines the x coordinate to transform\r\n     * @param result defines the target vector2\r\n     * @returns the current matrix\r\n     */\r\n    public transformCoordinates(x: number, y: number, result: Vector2): Matrix2D {\r\n        result.x = x * this.m[0] + y * this.m[2] + this.m[4];\r\n        result.y = x * this.m[1] + y * this.m[3] + this.m[5];\r\n\r\n        return this;\r\n    }\r\n\r\n    // Statics\r\n    /**\r\n     * Creates an identity matrix\r\n     * @returns a new matrix\r\n     */\r\n    public static Identity(): Matrix2D {\r\n        return new Matrix2D(1, 0, 0, 1, 0, 0);\r\n    }\r\n\r\n    /**\r\n     * Creates an identity matrix and stores it in a target matrix\r\n     * @param result defines the target matrix\r\n     */\r\n    public static IdentityToRef(result: Matrix2D): void {\r\n        result.m[0] = 1;\r\n        result.m[1] = 0;\r\n        result.m[2] = 0;\r\n        result.m[3] = 1;\r\n        result.m[4] = 0;\r\n        result.m[5] = 0;\r\n    }\r\n\r\n    /**\r\n     * Creates a translation matrix and stores it in a target matrix\r\n     * @param x defines the x coordinate of the translation\r\n     * @param y defines the y coordinate of the translation\r\n     * @param result defines the target matrix\r\n     */\r\n    public static TranslationToRef(x: number, y: number, result: Matrix2D): void {\r\n        result.fromValues(1, 0, 0, 1, x, y);\r\n    }\r\n\r\n    /**\r\n     * Creates a scaling matrix and stores it in a target matrix\r\n     * @param x defines the x coordinate of the scaling\r\n     * @param y defines the y coordinate of the scaling\r\n     * @param result defines the target matrix\r\n     */\r\n    public static ScalingToRef(x: number, y: number, result: Matrix2D): void {\r\n        result.fromValues(x, 0, 0, y, 0, 0);\r\n    }\r\n\r\n    /**\r\n     * Creates a rotation matrix and stores it in a target matrix\r\n     * @param angle defines the rotation angle\r\n     * @param result defines the target matrix\r\n     */\r\n    public static RotationToRef(angle: number, result: Matrix2D): void {\r\n        const s = Math.sin(angle);\r\n        const c = Math.cos(angle);\r\n\r\n        result.fromValues(c, s, -s, c, 0, 0);\r\n    }\r\n\r\n    private static _TempPreTranslationMatrix = Matrix2D.Identity();\r\n    private static _TempPostTranslationMatrix = Matrix2D.Identity();\r\n    private static _TempRotationMatrix = Matrix2D.Identity();\r\n    private static _TempScalingMatrix = Matrix2D.Identity();\r\n    private static _TempCompose0 = Matrix2D.Identity();\r\n    private static _TempCompose1 = Matrix2D.Identity();\r\n    private static _TempCompose2 = Matrix2D.Identity();\r\n\r\n    /**\r\n     * Composes a matrix from translation, rotation, scaling and parent matrix and stores it in a target matrix\r\n     * @param tx defines the x coordinate of the translation\r\n     * @param ty defines the y coordinate of the translation\r\n     * @param angle defines the rotation angle\r\n     * @param scaleX defines the x coordinate of the scaling\r\n     * @param scaleY defines the y coordinate of the scaling\r\n     * @param parentMatrix defines the parent matrix to multiply by (can be null)\r\n     * @param result defines the target matrix\r\n     */\r\n    public static ComposeToRef(tx: number, ty: number, angle: number, scaleX: number, scaleY: number, parentMatrix: Nullable<Matrix2D>, result: Matrix2D): void {\r\n        Matrix2D.TranslationToRef(tx, ty, Matrix2D._TempPreTranslationMatrix);\r\n\r\n        Matrix2D.ScalingToRef(scaleX, scaleY, Matrix2D._TempScalingMatrix);\r\n\r\n        Matrix2D.RotationToRef(angle, Matrix2D._TempRotationMatrix);\r\n\r\n        Matrix2D.TranslationToRef(-tx, -ty, Matrix2D._TempPostTranslationMatrix);\r\n\r\n        Matrix2D._TempPreTranslationMatrix.multiplyToRef(Matrix2D._TempScalingMatrix, Matrix2D._TempCompose0);\r\n        Matrix2D._TempCompose0.multiplyToRef(Matrix2D._TempRotationMatrix, Matrix2D._TempCompose1);\r\n        if (parentMatrix) {\r\n            Matrix2D._TempCompose1.multiplyToRef(Matrix2D._TempPostTranslationMatrix, Matrix2D._TempCompose2);\r\n            Matrix2D._TempCompose2.multiplyToRef(parentMatrix, result);\r\n        } else {\r\n            Matrix2D._TempCompose1.multiplyToRef(Matrix2D._TempPostTranslationMatrix, result);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Useful math functions\r\n */\r\nexport class MathTools {\r\n    /**\r\n     * Default rounding precision for GUI elements. It should be\r\n     * set to a power of ten, where the exponent means the number\r\n     * of decimal digits to round to, i.e, 100 means 2 decimal digits,\r\n     * 1000 means 3 decimal digits, etc. Default is 100 (2 decimal digits).\r\n     */\r\n    public static DefaultRoundingPrecision = 100;\r\n\r\n    /**\r\n     * Rounds a number to the nearest multiple of a given precision\r\n     * @param value the value to be rounded\r\n     * @param precision the multiple to which the value will be rounded. Default is 100 (2 decimal digits)\r\n     * @returns\r\n     */\r\n    public static Round(value: number, precision: number = MathTools.DefaultRoundingPrecision): number {\r\n        return Math.round(value * precision) / precision;\r\n    }\r\n}\r\n","/* eslint-disable @typescript-eslint/naming-convention */\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport { Vector2, Vector3, Matrix } from \"core/Maths/math.vector\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\nimport { Logger } from \"core/Misc/logger\";\r\nimport { Tools } from \"core/Misc/tools\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport type { Container } from \"./container\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport { ValueAndUnit } from \"../valueAndUnit\";\r\nimport { Measure } from \"../measure\";\r\nimport type { Style } from \"../style\";\r\nimport { Matrix2D, Vector2WithInfo } from \"../math2D\";\r\nimport { GetClass, RegisterClass } from \"core/Misc/typeStore\";\r\nimport { SerializationHelper, serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasGradient, ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport { EngineStore } from \"core/Engines/engineStore\";\r\nimport type { IAccessibilityTag } from \"core/IAccessibilityTag\";\r\nimport type { IPointerEvent } from \"core/Events/deviceInputEvents\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { Animation } from \"core/Animations/animation\";\r\nimport type { BaseGradient } from \"./gradient/BaseGradient\";\r\n\r\n/**\r\n * Root class used for all 2D controls\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#controls\r\n */\r\nexport class Control implements IAnimatable {\r\n    /**\r\n     * Gets or sets a boolean indicating if alpha must be an inherited value (false by default)\r\n     */\r\n    public static AllowAlphaInheritance = false;\r\n\r\n    private _alpha = 1;\r\n    private _alphaSet = false;\r\n    private _zIndex = 0;\r\n    /** @internal */\r\n    public _host: AdvancedDynamicTexture;\r\n    /** Gets or sets the control parent */\r\n    public parent: Nullable<Container>;\r\n    /** @internal */\r\n    public _currentMeasure = Measure.Empty();\r\n    /** @internal */\r\n    public _tempPaddingMeasure = Measure.Empty();\r\n    private _fontFamily = \"Arial\";\r\n    private _fontStyle = \"\";\r\n    private _fontWeight = \"\";\r\n    private _fontSize = new ValueAndUnit(18, ValueAndUnit.UNITMODE_PIXEL, false);\r\n    private _font: string;\r\n    /** @internal */\r\n    public _width = new ValueAndUnit(1, ValueAndUnit.UNITMODE_PERCENTAGE, false);\r\n    /** @internal */\r\n    public _height = new ValueAndUnit(1, ValueAndUnit.UNITMODE_PERCENTAGE, false);\r\n    /** @internal */\r\n    protected _fontOffset: { ascent: number; height: number; descent: number };\r\n    private _color = \"\";\r\n    private _style: Nullable<Style> = null;\r\n    private _styleObserver: Nullable<Observer<Style>>;\r\n    /** @internal */\r\n    protected _horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n    /** @internal */\r\n    protected _verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n    /** @internal */\r\n    protected _isDirty = true;\r\n    /** @internal */\r\n    protected _wasDirty = false;\r\n    /** @internal */\r\n    public _tempParentMeasure = Measure.Empty();\r\n    /** @internal */\r\n    public _prevCurrentMeasureTransformedIntoGlobalSpace = Measure.Empty();\r\n    /** @internal */\r\n    public _cachedParentMeasure = Measure.Empty();\r\n    private _descendantsOnlyPadding = false;\r\n    private _paddingLeft = new ValueAndUnit(0);\r\n    private _paddingRight = new ValueAndUnit(0);\r\n    private _paddingTop = new ValueAndUnit(0);\r\n    private _paddingBottom = new ValueAndUnit(0);\r\n    /** @internal */\r\n    public _left = new ValueAndUnit(0);\r\n    /** @internal */\r\n    public _top = new ValueAndUnit(0);\r\n    private _scaleX = 1.0;\r\n    private _scaleY = 1.0;\r\n    private _rotation = 0;\r\n    private _transformCenterX = 0.5;\r\n    private _transformCenterY = 0.5;\r\n    /** @internal */\r\n    public _transformMatrix = Matrix2D.Identity();\r\n    /** @internal */\r\n    protected _invertTransformMatrix = Matrix2D.Identity();\r\n    /** @internal */\r\n    protected _transformedPosition = Vector2.Zero();\r\n    private _isMatrixDirty = true;\r\n    private _cachedOffsetX: number;\r\n    private _cachedOffsetY: number;\r\n    private _isVisible = true;\r\n    private _isHighlighted = false;\r\n    private _highlightColor = \"#4affff\";\r\n    protected _highlightLineWidth = 2;\r\n    /** @internal */\r\n    public _linkedMesh: Nullable<TransformNode>;\r\n    private _fontSet = false;\r\n    private _dummyVector2 = Vector2.Zero();\r\n    private _downCount = 0;\r\n    private _enterCount = -1;\r\n    private _doNotRender = false;\r\n    private _downPointerIds: { [id: number]: boolean } = {};\r\n    private _evaluatedMeasure = new Measure(0, 0, 0, 0);\r\n    private _evaluatedParentMeasure = new Measure(0, 0, 0, 0);\r\n    protected _isEnabled = true;\r\n    protected _disabledColor = \"#9a9a9a\";\r\n    protected _disabledColorItem = \"#6a6a6a\";\r\n    protected _isReadOnly = false;\r\n    private _gradient: Nullable<BaseGradient> = null;\r\n    /** @internal */\r\n    protected _rebuildLayout = false;\r\n\r\n    /** @internal */\r\n    public _customData: any = {};\r\n\r\n    /** @internal */\r\n    public _isClipped = false;\r\n\r\n    /** @internal */\r\n    public _automaticSize = false;\r\n\r\n    /** @internal */\r\n    public _tag: any;\r\n\r\n    /**\r\n     * Gets or sets the unique id of the node. Please note that this number will be updated when the control is added to a container\r\n     */\r\n    public uniqueId: number;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if the control is readonly (default: false).\r\n     * A readonly control will still raise pointer events but will not react to them\r\n     */\r\n    public get isReadOnly() {\r\n        return this._isReadOnly;\r\n    }\r\n\r\n    public set isReadOnly(value: boolean) {\r\n        this._isReadOnly = value;\r\n    }\r\n\r\n    /**\r\n     * Gets the transformed measure, that is the bounding box of the control after applying all transformations\r\n     */\r\n    public get transformedMeasure(): Measure {\r\n        return this._evaluatedMeasure;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets an object used to store user defined information for the node\r\n     */\r\n    @serialize()\r\n    public metadata: any = null;\r\n\r\n    /** Gets or sets a boolean indicating if the control can be hit with pointer events */\r\n    @serialize()\r\n    public isHitTestVisible = true;\r\n    /** Gets or sets a boolean indicating if the control can block pointer events. False by default except on the following controls:\r\n     * * Button controls (Button, RadioButton, ToggleButton)\r\n     * * Checkbox\r\n     * * ColorPicker\r\n     * * InputText\r\n     * * Slider\r\n     */\r\n    @serialize()\r\n    public isPointerBlocker = false;\r\n    /** Gets or sets a boolean indicating if the control can be focusable */\r\n    @serialize()\r\n    public isFocusInvisible = false;\r\n\r\n    protected _clipChildren = true;\r\n    /**\r\n     * Sets/Gets a boolean indicating if the children are clipped to the current control bounds.\r\n     * Please note that not clipping children may generate issues with adt.useInvalidateRectOptimization so it is recommended to turn this optimization off if you want to use unclipped children\r\n     */\r\n    public set clipChildren(value: boolean) {\r\n        this._clipChildren = value;\r\n    }\r\n\r\n    @serialize()\r\n    public get clipChildren() {\r\n        return this._clipChildren;\r\n    }\r\n\r\n    protected _clipContent = true;\r\n    /**\r\n     * Sets/Gets a boolean indicating that control content must be clipped\r\n     * Please note that not clipping content may generate issues with adt.useInvalidateRectOptimization so it is recommended to turn this optimization off if you want to use unclipped children\r\n     */\r\n    public set clipContent(value: boolean) {\r\n        this._clipContent = value;\r\n    }\r\n\r\n    @serialize()\r\n    public get clipContent() {\r\n        return this._clipContent;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that the current control should cache its rendering (useful when the control does not change often)\r\n     */\r\n    @serialize()\r\n    public useBitmapCache = false;\r\n\r\n    private _cacheData: Nullable<ImageData>;\r\n\r\n    private _shadowOffsetX = 0;\r\n    /** Gets or sets a value indicating the offset to apply on X axis to render the shadow */\r\n    @serialize()\r\n    public get shadowOffsetX() {\r\n        return this._shadowOffsetX;\r\n    }\r\n\r\n    public set shadowOffsetX(value: number) {\r\n        if (this._shadowOffsetX === value) {\r\n            return;\r\n        }\r\n\r\n        this._shadowOffsetX = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    private _shadowOffsetY = 0;\r\n    /** Gets or sets a value indicating the offset to apply on Y axis to render the shadow */\r\n    @serialize()\r\n    public get shadowOffsetY() {\r\n        return this._shadowOffsetY;\r\n    }\r\n\r\n    public set shadowOffsetY(value: number) {\r\n        if (this._shadowOffsetY === value) {\r\n            return;\r\n        }\r\n\r\n        this._shadowOffsetY = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    private _shadowBlur = 0;\r\n    private _previousShadowBlur = 0;\r\n    /** Gets or sets a value indicating the amount of blur to use to render the shadow */\r\n    @serialize()\r\n    public get shadowBlur() {\r\n        return this._shadowBlur;\r\n    }\r\n\r\n    public set shadowBlur(value: number) {\r\n        if (this._shadowBlur === value) {\r\n            return;\r\n        }\r\n\r\n        this._previousShadowBlur = this._shadowBlur;\r\n\r\n        this._shadowBlur = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    private _shadowColor = \"black\";\r\n    /** Gets or sets a value indicating the color of the shadow (black by default ie. \"#000\") */\r\n    @serialize()\r\n    public get shadowColor() {\r\n        return this._shadowColor;\r\n    }\r\n\r\n    public set shadowColor(value: string) {\r\n        if (this._shadowColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._shadowColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the cursor to use when the control is hovered */\r\n    @serialize()\r\n    public hoverCursor = \"\";\r\n\r\n    /** @internal */\r\n    protected _linkOffsetX = new ValueAndUnit(0);\r\n    /** @internal */\r\n    protected _linkOffsetY = new ValueAndUnit(0);\r\n\r\n    // Properties\r\n\r\n    /** Gets the control type name */\r\n    public get typeName(): string {\r\n        return this._getTypeName();\r\n    }\r\n\r\n    /**\r\n     * Get the current class name of the control.\r\n     * @returns current class name\r\n     */\r\n    public getClassName(): string {\r\n        return this._getTypeName();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the accessibility tag to describe the control for accessibility purpose.\r\n     * By default, GUI controls already indicate accessibility info, but one can override the info using this tag.\r\n     */\r\n    public set accessibilityTag(value: Nullable<IAccessibilityTag>) {\r\n        this._accessibilityTag = value;\r\n        this.onAccessibilityTagChangedObservable.notifyObservers(value);\r\n    }\r\n\r\n    public get accessibilityTag() {\r\n        return this._accessibilityTag;\r\n    }\r\n\r\n    protected _accessibilityTag: Nullable<IAccessibilityTag> = null;\r\n\r\n    public onAccessibilityTagChangedObservable = new Observable<Nullable<IAccessibilityTag>>();\r\n\r\n    /**\r\n     * An event triggered when pointer wheel is scrolled\r\n     */\r\n    public onWheelObservable = new Observable<Vector2>();\r\n    /**\r\n     * An event triggered when the pointer moves over the control.\r\n     */\r\n    public onPointerMoveObservable = new Observable<Vector2>();\r\n\r\n    /**\r\n     * An event triggered when the pointer moves out of the control.\r\n     */\r\n    public onPointerOutObservable = new Observable<Control>();\r\n\r\n    /**\r\n     * An event triggered when the pointer taps the control\r\n     */\r\n    public onPointerDownObservable = new Observable<Vector2WithInfo>();\r\n\r\n    /**\r\n     * An event triggered when pointer up\r\n     */\r\n    public onPointerUpObservable = new Observable<Vector2WithInfo>();\r\n\r\n    /**\r\n     * An event triggered when a control is clicked on\r\n     */\r\n    public onPointerClickObservable = new Observable<Vector2WithInfo>();\r\n\r\n    /**\r\n     * An event triggered when pointer enters the control\r\n     */\r\n    public onPointerEnterObservable = new Observable<Control>();\r\n\r\n    /**\r\n     * An event triggered when the control is marked as dirty\r\n     */\r\n    public onDirtyObservable = new Observable<Control>();\r\n\r\n    /**\r\n     * An event triggered before drawing the control\r\n     */\r\n    public onBeforeDrawObservable = new Observable<Control>();\r\n\r\n    /**\r\n     * An event triggered after the control was drawn\r\n     */\r\n    public onAfterDrawObservable = new Observable<Control>();\r\n\r\n    /**\r\n     * An event triggered when the control has been disposed\r\n     */\r\n    public onDisposeObservable = new Observable<Control>();\r\n\r\n    /**\r\n     * An event triggered when the control isVisible is changed\r\n     */\r\n    public onIsVisibleChangedObservable = new Observable<boolean>();\r\n\r\n    /**\r\n     * Get the hosting AdvancedDynamicTexture\r\n     */\r\n    public get host(): AdvancedDynamicTexture {\r\n        return this._host;\r\n    }\r\n\r\n    /** Gets or set information about font offsets (used to render and align text) */\r\n    @serialize()\r\n    public get fontOffset(): { ascent: number; height: number; descent: number } {\r\n        return this._fontOffset;\r\n    }\r\n\r\n    public set fontOffset(offset: { ascent: number; height: number; descent: number }) {\r\n        this._fontOffset = offset;\r\n    }\r\n\r\n    /** Gets or sets alpha value for the control (1 means opaque and 0 means entirely transparent) */\r\n    @serialize()\r\n    public get alpha(): number {\r\n        return this._alpha;\r\n    }\r\n\r\n    public set alpha(value: number) {\r\n        if (this._alpha === value) {\r\n            return;\r\n        }\r\n        this._alphaSet = true;\r\n        this._alpha = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a number indicating size of stroke we want to highlight the control with (mostly for debugging purpose)\r\n     */\r\n    public get highlightLineWidth(): number {\r\n        return this._highlightLineWidth;\r\n    }\r\n\r\n    public set highlightLineWidth(value: number) {\r\n        if (this._highlightLineWidth === value) {\r\n            return;\r\n        }\r\n\r\n        this._highlightLineWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that we want to highlight the control (mostly for debugging purpose)\r\n     */\r\n    public get isHighlighted(): boolean {\r\n        return this._isHighlighted;\r\n    }\r\n\r\n    public set isHighlighted(value: boolean) {\r\n        if (this._isHighlighted === value) {\r\n            return;\r\n        }\r\n\r\n        this._isHighlighted = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a string defining the color to use for highlighting this control\r\n     */\r\n    public get highlightColor(): string {\r\n        return this._highlightColor;\r\n    }\r\n\r\n    public set highlightColor(value: string) {\r\n        if (this._highlightColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._highlightColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a value indicating the scale factor on X axis (1 by default)\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#rotation-and-scaling\r\n     */\r\n    @serialize()\r\n    public get scaleX(): number {\r\n        return this._scaleX;\r\n    }\r\n\r\n    public set scaleX(value: number) {\r\n        if (this._scaleX === value) {\r\n            return;\r\n        }\r\n\r\n        this._scaleX = value;\r\n        this._markAsDirty();\r\n        this._markMatrixAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a value indicating the scale factor on Y axis (1 by default)\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#rotation-and-scaling\r\n     */\r\n    @serialize()\r\n    public get scaleY(): number {\r\n        return this._scaleY;\r\n    }\r\n\r\n    public set scaleY(value: number) {\r\n        if (this._scaleY === value) {\r\n            return;\r\n        }\r\n\r\n        this._scaleY = value;\r\n        this._markAsDirty();\r\n        this._markMatrixAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the rotation angle (0 by default)\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#rotation-and-scaling\r\n     */\r\n    @serialize()\r\n    public get rotation(): number {\r\n        return this._rotation;\r\n    }\r\n\r\n    public set rotation(value: number) {\r\n        if (this._rotation === value) {\r\n            return;\r\n        }\r\n\r\n        this._rotation = value;\r\n        this._markAsDirty();\r\n        this._markMatrixAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the transformation center on Y axis (0 by default)\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#rotation-and-scaling\r\n     */\r\n    @serialize()\r\n    public get transformCenterY(): number {\r\n        return this._transformCenterY;\r\n    }\r\n\r\n    public set transformCenterY(value: number) {\r\n        if (this._transformCenterY === value) {\r\n            return;\r\n        }\r\n\r\n        this._transformCenterY = value;\r\n        this._markAsDirty();\r\n        this._markMatrixAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the transformation center on X axis (0 by default)\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#rotation-and-scaling\r\n     */\r\n    @serialize()\r\n    public get transformCenterX(): number {\r\n        return this._transformCenterX;\r\n    }\r\n\r\n    public set transformCenterX(value: number) {\r\n        if (this._transformCenterX === value) {\r\n            return;\r\n        }\r\n\r\n        this._transformCenterX = value;\r\n        this._markAsDirty();\r\n        this._markMatrixAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the horizontal alignment\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#alignments\r\n     */\r\n    @serialize()\r\n    public get horizontalAlignment(): number {\r\n        return this._horizontalAlignment;\r\n    }\r\n\r\n    public set horizontalAlignment(value: number) {\r\n        if (this._horizontalAlignment === value) {\r\n            return;\r\n        }\r\n\r\n        this._horizontalAlignment = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the vertical alignment\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#alignments\r\n     */\r\n    @serialize()\r\n    public get verticalAlignment(): number {\r\n        return this._verticalAlignment;\r\n    }\r\n\r\n    public set verticalAlignment(value: number) {\r\n        if (this._verticalAlignment === value) {\r\n            return;\r\n        }\r\n\r\n        this._verticalAlignment = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    private _fixedRatio = 0;\r\n    public set fixedRatio(value: number) {\r\n        if (this._fixedRatio === value) {\r\n            return;\r\n        }\r\n\r\n        this._fixedRatio = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a fixed ratio for this control.\r\n     * When different from 0, the ratio is used to compute the \"second\" dimension.\r\n     * The first dimension used in the computation is the last one set (by setting width / widthInPixels or height / heightInPixels), and the\r\n     * second dimension is computed as first dimension * fixedRatio\r\n     */\r\n    @serialize()\r\n    public get fixedRatio(): number {\r\n        return this._fixedRatio;\r\n    }\r\n\r\n    private _fixedRatioMasterIsWidth = true;\r\n    set fixedRatioMasterIsWidth(value: boolean) {\r\n        if (this._fixedRatioMasterIsWidth === value) {\r\n            return;\r\n        }\r\n        this._fixedRatioMasterIsWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that the fixed ratio is set on the width instead of the height. True by default.\r\n     * When the height of a control is set, this property is changed to false.\r\n     */\r\n    @serialize()\r\n    get fixedRatioMasterIsWidth(): boolean {\r\n        return this._fixedRatioMasterIsWidth;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets control width\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get width(): string | number {\r\n        return this._width.toString(this._host);\r\n    }\r\n\r\n    public set width(value: string | number) {\r\n        this._fixedRatioMasterIsWidth = true;\r\n\r\n        if (this._width.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._width.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the control width in pixel\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get widthInPixels(): number {\r\n        return this._width.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set widthInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this._fixedRatioMasterIsWidth = true;\r\n        this.width = value + \"px\";\r\n    }\r\n\r\n    /**\r\n     * Gets or sets control height\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get height(): string | number {\r\n        return this._height.toString(this._host);\r\n    }\r\n\r\n    public set height(value: string | number) {\r\n        this._fixedRatioMasterIsWidth = false;\r\n\r\n        if (this._height.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._height.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets control height in pixel\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get heightInPixels(): number {\r\n        return this._height.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n    }\r\n\r\n    public set heightInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this._fixedRatioMasterIsWidth = false;\r\n        this.height = value + \"px\";\r\n    }\r\n\r\n    /** Gets or set font family */\r\n    public get fontFamily(): string {\r\n        return this._fontFamily;\r\n    }\r\n\r\n    public set fontFamily(value: string) {\r\n        if (this._fontFamily === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontFamily = value;\r\n        this._resetFontCache();\r\n    }\r\n\r\n    /** Gets or sets font style */\r\n    public get fontStyle(): string {\r\n        return this._fontStyle;\r\n    }\r\n\r\n    public set fontStyle(value: string) {\r\n        if (this._fontStyle === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontStyle = value;\r\n        this._resetFontCache();\r\n    }\r\n\r\n    /** Gets or sets font weight */\r\n    public get fontWeight(): string {\r\n        return this._fontWeight;\r\n    }\r\n\r\n    public set fontWeight(value: string) {\r\n        if (this._fontWeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontWeight = value;\r\n        this._resetFontCache();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets style\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#styles\r\n     */\r\n    @serialize()\r\n    public get style(): Nullable<Style> {\r\n        return this._style;\r\n    }\r\n\r\n    public set style(value: Nullable<Style>) {\r\n        if (this._style) {\r\n            this._style.onChangedObservable.remove(this._styleObserver);\r\n            this._styleObserver = null;\r\n        }\r\n\r\n        this._style = value;\r\n\r\n        if (this._style) {\r\n            this._styleObserver = this._style.onChangedObservable.add(() => {\r\n                this._markAsDirty();\r\n                this._resetFontCache();\r\n            });\r\n        }\r\n\r\n        this._markAsDirty();\r\n        this._resetFontCache();\r\n    }\r\n\r\n    /** @internal */\r\n    public get _isFontSizeInPercentage(): boolean {\r\n        return this._fontSize.isPercentage;\r\n    }\r\n\r\n    /** Gets or sets font size in pixels */\r\n    public get fontSizeInPixels(): number {\r\n        const fontSizeToUse = this._style ? this._style._fontSize : this._fontSize;\r\n\r\n        if (fontSizeToUse.isPixel) {\r\n            return fontSizeToUse.getValue(this._host);\r\n        }\r\n\r\n        return fontSizeToUse.getValueInPixel(this._host, this._tempParentMeasure.height || this._cachedParentMeasure.height);\r\n    }\r\n\r\n    public set fontSizeInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.fontSize = value + \"px\";\r\n    }\r\n\r\n    /** Gets or sets font size */\r\n    public get fontSize(): string | number {\r\n        return this._fontSize.toString(this._host);\r\n    }\r\n\r\n    public set fontSize(value: string | number) {\r\n        if (this._fontSize.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._fontSize.fromString(value)) {\r\n            this._markAsDirty();\r\n            this._resetFontCache();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets foreground color */\r\n    @serialize()\r\n    public get color(): string {\r\n        return this._color;\r\n    }\r\n\r\n    public set color(value: string) {\r\n        if (this._color === value) {\r\n            return;\r\n        }\r\n\r\n        this._color = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets gradient. Setting a gradient will override the color */\r\n    @serialize()\r\n    public get gradient(): Nullable<BaseGradient> {\r\n        return this._gradient;\r\n    }\r\n\r\n    public set gradient(value: Nullable<BaseGradient>) {\r\n        if (this._gradient === value) {\r\n            return;\r\n        }\r\n\r\n        this._gradient = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets z index which is used to reorder controls on the z axis */\r\n    @serialize()\r\n    public get zIndex(): number {\r\n        return this._zIndex;\r\n    }\r\n\r\n    public set zIndex(value: number) {\r\n        if (this.zIndex === value) {\r\n            return;\r\n        }\r\n\r\n        this._zIndex = value;\r\n\r\n        if (this.parent) {\r\n            this.parent._reOrderControl(this);\r\n        }\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the control can be rendered */\r\n    @serialize()\r\n    public get notRenderable(): boolean {\r\n        return this._doNotRender;\r\n    }\r\n\r\n    public set notRenderable(value: boolean) {\r\n        if (this._doNotRender === value) {\r\n            return;\r\n        }\r\n\r\n        this._doNotRender = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the control is visible */\r\n    @serialize()\r\n    public get isVisible(): boolean {\r\n        return this._isVisible;\r\n    }\r\n\r\n    public set isVisible(value: boolean) {\r\n        if (this._isVisible === value) {\r\n            return;\r\n        }\r\n\r\n        this._isVisible = value;\r\n        this._markAsDirty(true);\r\n\r\n        this.onIsVisibleChangedObservable.notifyObservers(value);\r\n    }\r\n\r\n    /** Gets a boolean indicating that the control needs to update its rendering */\r\n    public get isDirty(): boolean {\r\n        return this._isDirty;\r\n    }\r\n\r\n    /**\r\n     * Gets the current linked mesh (or null if none)\r\n     */\r\n    public get linkedMesh(): Nullable<TransformNode> {\r\n        return this._linkedMesh;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding should work like in CSS.\r\n     * Basically, it will add the padding amount on each side of the parent control for its children.\r\n     */\r\n    @serialize()\r\n    public get descendantsOnlyPadding(): boolean {\r\n        return this._descendantsOnlyPadding;\r\n    }\r\n\r\n    public set descendantsOnlyPadding(value: boolean) {\r\n        if (this._descendantsOnlyPadding === value) {\r\n            return;\r\n        }\r\n\r\n        this._descendantsOnlyPadding = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding to use on the left of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get paddingLeft(): string | number {\r\n        return this._paddingLeft.toString(this._host);\r\n    }\r\n\r\n    public set paddingLeft(value: string | number) {\r\n        if (this._paddingLeft.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding in pixels to use on the left of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get paddingLeftInPixels(): number {\r\n        return this._paddingLeft.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set paddingLeftInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.paddingLeft = value + \"px\";\r\n    }\r\n\r\n    /** @internal */\r\n    public get _paddingLeftInPixels(): number {\r\n        if (this._descendantsOnlyPadding) {\r\n            return 0;\r\n        }\r\n\r\n        return this.paddingLeftInPixels;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding to use on the right of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get paddingRight(): string | number {\r\n        return this._paddingRight.toString(this._host);\r\n    }\r\n\r\n    public set paddingRight(value: string | number) {\r\n        if (this._paddingRight.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding in pixels to use on the right of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get paddingRightInPixels(): number {\r\n        return this._paddingRight.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set paddingRightInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.paddingRight = value + \"px\";\r\n    }\r\n\r\n    /** @internal */\r\n    public get _paddingRightInPixels(): number {\r\n        if (this._descendantsOnlyPadding) {\r\n            return 0;\r\n        }\r\n\r\n        return this.paddingRightInPixels;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding to use on the top of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get paddingTop(): string | number {\r\n        return this._paddingTop.toString(this._host);\r\n    }\r\n\r\n    public set paddingTop(value: string | number) {\r\n        if (this._paddingTop.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding in pixels to use on the top of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get paddingTopInPixels(): number {\r\n        return this._paddingTop.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n    }\r\n\r\n    public set paddingTopInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.paddingTop = value + \"px\";\r\n    }\r\n\r\n    /** @internal */\r\n    public get _paddingTopInPixels(): number {\r\n        if (this._descendantsOnlyPadding) {\r\n            return 0;\r\n        }\r\n\r\n        return this.paddingTopInPixels;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding to use on the bottom of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get paddingBottom(): string | number {\r\n        return this._paddingBottom.toString(this._host);\r\n    }\r\n\r\n    public set paddingBottom(value: string | number) {\r\n        if (this._paddingBottom.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the padding in pixels to use on the bottom of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get paddingBottomInPixels(): number {\r\n        return this._paddingBottom.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n    }\r\n\r\n    public set paddingBottomInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.paddingBottom = value + \"px\";\r\n    }\r\n\r\n    /** @internal */\r\n    public get _paddingBottomInPixels(): number {\r\n        if (this._descendantsOnlyPadding) {\r\n            return 0;\r\n        }\r\n\r\n        return this.paddingBottomInPixels;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the left coordinate of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get left(): string | number {\r\n        return this._left.toString(this._host);\r\n    }\r\n\r\n    public set left(value: string | number) {\r\n        if (this._left.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the left coordinate in pixels of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get leftInPixels(): number {\r\n        return this._left.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set leftInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.left = value + \"px\";\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the top coordinate of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get top(): string | number {\r\n        return this._top.toString(this._host);\r\n    }\r\n\r\n    public set top(value: string | number) {\r\n        if (this._top.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the top coordinate in pixels of the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public get topInPixels(): number {\r\n        return this._top.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n    }\r\n\r\n    public set topInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.top = value + \"px\";\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the offset on X axis to the linked mesh\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#tracking-positions\r\n     */\r\n    @serialize()\r\n    public get linkOffsetX(): string | number {\r\n        return this._linkOffsetX.toString(this._host);\r\n    }\r\n\r\n    public set linkOffsetX(value: string | number) {\r\n        if (this._linkOffsetX.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the offset in pixels on X axis to the linked mesh\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#tracking-positions\r\n     */\r\n    public get linkOffsetXInPixels(): number {\r\n        return this._linkOffsetX.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set linkOffsetXInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.linkOffsetX = value + \"px\";\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the offset on Y axis to the linked mesh\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#tracking-positions\r\n     */\r\n    @serialize()\r\n    public get linkOffsetY(): string | number {\r\n        return this._linkOffsetY.toString(this._host);\r\n    }\r\n\r\n    public set linkOffsetY(value: string | number) {\r\n        if (this._linkOffsetY.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a value indicating the offset in pixels on Y axis to the linked mesh\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#tracking-positions\r\n     */\r\n    public get linkOffsetYInPixels(): number {\r\n        return this._linkOffsetY.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n    }\r\n\r\n    public set linkOffsetYInPixels(value: number) {\r\n        if (isNaN(value)) {\r\n            return;\r\n        }\r\n        this.linkOffsetY = value + \"px\";\r\n    }\r\n\r\n    /** Gets the center coordinate on X axis */\r\n    public get centerX(): number {\r\n        return this._currentMeasure.left + this._currentMeasure.width / 2;\r\n    }\r\n\r\n    /** Gets the center coordinate on Y axis */\r\n    public get centerY(): number {\r\n        return this._currentMeasure.top + this._currentMeasure.height / 2;\r\n    }\r\n\r\n    /** Gets or sets if control is Enabled */\r\n    @serialize()\r\n    public get isEnabled(): boolean {\r\n        return this._isEnabled;\r\n    }\r\n\r\n    public set isEnabled(value: boolean) {\r\n        if (this._isEnabled === value) {\r\n            return;\r\n        }\r\n\r\n        this._isEnabled = value;\r\n        this._markAsDirty();\r\n        // if this control or any of it's descendants are under a pointer, we need to fire a pointerOut event\r\n        const recursivelyFirePointerOut = (control: Control) => {\r\n            if (!control.host) {\r\n                return;\r\n            }\r\n            for (const pointer in control.host._lastControlOver) {\r\n                if (control === this.host._lastControlOver[pointer]) {\r\n                    control._onPointerOut(control, null, true);\r\n                    delete control.host._lastControlOver[pointer];\r\n                }\r\n            }\r\n            if ((control as Container).children !== undefined) {\r\n                (control as Container).children.forEach(recursivelyFirePointerOut);\r\n            }\r\n        };\r\n        recursivelyFirePointerOut(this);\r\n    }\r\n    /** Gets or sets background color of control if it's disabled. Only applies to Button class. */\r\n    @serialize()\r\n    public get disabledColor(): string {\r\n        return this._disabledColor;\r\n    }\r\n\r\n    public set disabledColor(value: string) {\r\n        if (this._disabledColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._disabledColor = value;\r\n        this._markAsDirty();\r\n    }\r\n    /** Gets or sets front color of control if it's disabled. Only applies to Checkbox class. */\r\n    @serialize()\r\n    public get disabledColorItem(): string {\r\n        return this._disabledColorItem;\r\n    }\r\n\r\n    public set disabledColorItem(value: string) {\r\n        if (this._disabledColorItem === value) {\r\n            return;\r\n        }\r\n\r\n        this._disabledColorItem = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets/sets the overlap group of the control.\r\n     * Controls with overlapGroup set to a number can be deoverlapped.\r\n     * Controls with overlapGroup set to undefined are not deoverlapped.\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#deoverlapping\r\n     */\r\n    @serialize()\r\n    public overlapGroup?: number;\r\n    /**\r\n     * Gets/sets the deoverlap movement multiplier\r\n     */\r\n    @serialize()\r\n    public overlapDeltaMultiplier?: number;\r\n\r\n    /**\r\n     * Array of animations\r\n     */\r\n    animations: Nullable<Animation[]> = null;\r\n\r\n    // Functions\r\n\r\n    /**\r\n     * Creates a new control\r\n     * @param name defines the name of the control\r\n     */\r\n    constructor(\r\n        /** defines the name of the control */\r\n        public name?: string\r\n    ) {}\r\n\r\n    /** @internal */\r\n    protected _getTypeName(): string {\r\n        return \"Control\";\r\n    }\r\n\r\n    /**\r\n     * Gets the first ascendant in the hierarchy of the given type\r\n     * @param className defines the required type\r\n     * @returns the ascendant or null if not found\r\n     */\r\n    public getAscendantOfClass(className: string): Nullable<Control> {\r\n        if (!this.parent) {\r\n            return null;\r\n        }\r\n\r\n        if (this.parent.getClassName() === className) {\r\n            return this.parent;\r\n        }\r\n\r\n        return this.parent.getAscendantOfClass(className);\r\n    }\r\n\r\n    /**\r\n     * Mark control element as dirty\r\n     * @param force force non visible elements to be marked too\r\n     */\r\n    public markAsDirty(force = false): void {\r\n        this._markAsDirty(force);\r\n    }\r\n\r\n    /**\r\n     * Mark the element and its children as dirty\r\n     */\r\n    public markAllAsDirty(): void {\r\n        this._markAllAsDirty();\r\n    }\r\n\r\n    /** @internal */\r\n    public _resetFontCache(): void {\r\n        this._fontSet = true;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Determines if a container is an ascendant of the current control\r\n     * @param container defines the container to look for\r\n     * @returns true if the container is one of the ascendant of the control\r\n     */\r\n    public isAscendant(container: Control): boolean {\r\n        if (!this.parent) {\r\n            return false;\r\n        }\r\n\r\n        if (this.parent === container) {\r\n            return true;\r\n        }\r\n\r\n        return this.parent.isAscendant(container);\r\n    }\r\n\r\n    /**\r\n     * Gets coordinates in local control space\r\n     * @param globalCoordinates defines the coordinates to transform\r\n     * @returns the new coordinates in local space\r\n     */\r\n    public getLocalCoordinates(globalCoordinates: Vector2): Vector2 {\r\n        const result = Vector2.Zero();\r\n\r\n        this.getLocalCoordinatesToRef(globalCoordinates, result);\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Gets coordinates in local control space\r\n     * @param globalCoordinates defines the coordinates to transform\r\n     * @param result defines the target vector2 where to store the result\r\n     * @returns the current control\r\n     */\r\n    public getLocalCoordinatesToRef(globalCoordinates: Vector2, result: Vector2): Control {\r\n        result.x = globalCoordinates.x - this._currentMeasure.left;\r\n        result.y = globalCoordinates.y - this._currentMeasure.top;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets coordinates in parent local control space\r\n     * @param globalCoordinates defines the coordinates to transform\r\n     * @returns the new coordinates in parent local space\r\n     */\r\n    public getParentLocalCoordinates(globalCoordinates: Vector2): Vector2 {\r\n        const result = Vector2.Zero();\r\n\r\n        result.x = globalCoordinates.x - this._cachedParentMeasure.left;\r\n        result.y = globalCoordinates.y - this._cachedParentMeasure.top;\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Move the current control to a vector3 position projected onto the screen.\r\n     * @param position defines the target position\r\n     * @param scene defines the hosting scene\r\n     */\r\n    public moveToVector3(position: Vector3, scene: Scene): void {\r\n        if (!this._host || this.parent !== this._host._rootContainer) {\r\n            Tools.Error(\"Cannot move a control to a vector3 if the control is not at root level\");\r\n            return;\r\n        }\r\n\r\n        this.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n\r\n        const globalViewport = this._host._getGlobalViewport();\r\n        const projectedPosition = Vector3.Project(position, Matrix.IdentityReadOnly, scene.getTransformMatrix(), globalViewport);\r\n\r\n        this._moveToProjectedPosition(projectedPosition);\r\n\r\n        if (projectedPosition.z < 0 || projectedPosition.z > 1) {\r\n            this.notRenderable = true;\r\n            return;\r\n        }\r\n        this.notRenderable = false;\r\n    }\r\n\r\n    /**\r\n     * Will store all controls that have this control as ascendant in a given array\r\n     * @param results defines the array where to store the descendants\r\n     * @param directDescendantsOnly defines if true only direct descendants of 'this' will be considered, if false direct and also indirect (children of children, an so on in a recursive manner) descendants of 'this' will be considered\r\n     * @param predicate defines an optional predicate that will be called on every evaluated child, the predicate must return true for a given child to be part of the result, otherwise it will be ignored\r\n     */\r\n    public getDescendantsToRef(results: Control[], directDescendantsOnly: boolean = false, predicate?: (control: Control) => boolean): void {\r\n        // Do nothing by default\r\n    }\r\n\r\n    /**\r\n     * Will return all controls that have this control as ascendant\r\n     * @param directDescendantsOnly defines if true only direct descendants of 'this' will be considered, if false direct and also indirect (children of children, an so on in a recursive manner) descendants of 'this' will be considered\r\n     * @param predicate defines an optional predicate that will be called on every evaluated child, the predicate must return true for a given child to be part of the result, otherwise it will be ignored\r\n     * @returns all child controls\r\n     */\r\n    public getDescendants(directDescendantsOnly?: boolean, predicate?: (control: Control) => boolean): Control[] {\r\n        const results = new Array<Control>();\r\n\r\n        this.getDescendantsToRef(results, directDescendantsOnly, predicate);\r\n\r\n        return results;\r\n    }\r\n\r\n    /**\r\n     * Link current control with a target mesh\r\n     * @param mesh defines the mesh to link with\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#tracking-positions\r\n     */\r\n    public linkWithMesh(mesh: Nullable<TransformNode>): void {\r\n        if (!this._host || (this.parent && this.parent !== this._host._rootContainer)) {\r\n            if (mesh) {\r\n                Tools.Error(\"Cannot link a control to a mesh if the control is not at root level\");\r\n            }\r\n            return;\r\n        }\r\n\r\n        const index = this._host._linkedControls.indexOf(this);\r\n        if (index !== -1) {\r\n            this._linkedMesh = mesh;\r\n            if (!mesh) {\r\n                this._host._linkedControls.splice(index, 1);\r\n            }\r\n            return;\r\n        } else if (!mesh) {\r\n            return;\r\n        }\r\n\r\n        this.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n        this._linkedMesh = mesh;\r\n        this._host._linkedControls.push(this);\r\n    }\r\n\r\n    /**\r\n     * Shorthand function to set the top, right, bottom, and left padding values on the control.\r\n     * @param { string | number} paddingTop - The value of the top padding.\r\n     * @param { string | number} paddingRight - The value of the right padding. If omitted, top is used.\r\n     * @param { string | number} paddingBottom - The value of the bottom padding. If omitted, top is used.\r\n     * @param { string | number} paddingLeft - The value of the left padding. If omitted, right is used.\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public setPadding(paddingTop: string | number, paddingRight?: string | number, paddingBottom?: string | number, paddingLeft?: string | number) {\r\n        const top = paddingTop;\r\n        const right = paddingRight ?? top;\r\n        const bottom = paddingBottom ?? top;\r\n        const left = paddingLeft ?? right;\r\n\r\n        this.paddingTop = top;\r\n        this.paddingRight = right;\r\n        this.paddingBottom = bottom;\r\n        this.paddingLeft = left;\r\n    }\r\n\r\n    /**\r\n     * Shorthand funtion to set the top, right, bottom, and left padding values in pixels on the control.\r\n     * @param { number} paddingTop - The value in pixels of the top padding.\r\n     * @param { number} paddingRight - The value in pixels of the right padding. If omitted, top is used.\r\n     * @param { number} paddingBottom - The value in pixels of the bottom padding. If omitted, top is used.\r\n     * @param { number} paddingLeft - The value in pixels of the left padding. If omitted, right is used.\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    public setPaddingInPixels(paddingTop: number, paddingRight?: number, paddingBottom?: number, paddingLeft?: number) {\r\n        const top = paddingTop;\r\n        const right = paddingRight ?? top;\r\n        const bottom = paddingBottom ?? top;\r\n        const left = paddingLeft ?? right;\r\n\r\n        this.paddingTopInPixels = top;\r\n        this.paddingRightInPixels = right;\r\n        this.paddingBottomInPixels = bottom;\r\n        this.paddingLeftInPixels = left;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _moveToProjectedPosition(projectedPosition: Vector3): void {\r\n        const oldLeft = this._left.getValue(this._host);\r\n        const oldTop = this._top.getValue(this._host);\r\n\r\n        const parentMeasure = this.parent?._currentMeasure;\r\n        if (parentMeasure) {\r\n            this._processMeasures(parentMeasure, this._host.getContext());\r\n        }\r\n\r\n        let newLeft = projectedPosition.x + this._linkOffsetX.getValue(this._host) - this._currentMeasure.width / 2;\r\n        let newTop = projectedPosition.y + this._linkOffsetY.getValue(this._host) - this._currentMeasure.height / 2;\r\n\r\n        const leftAndTopIgnoreAdaptiveScaling = this._left.ignoreAdaptiveScaling && this._top.ignoreAdaptiveScaling;\r\n        if (leftAndTopIgnoreAdaptiveScaling) {\r\n            if (Math.abs(newLeft - oldLeft) < 0.5) {\r\n                newLeft = oldLeft;\r\n            }\r\n\r\n            if (Math.abs(newTop - oldTop) < 0.5) {\r\n                newTop = oldTop;\r\n            }\r\n        }\r\n\r\n        if (!leftAndTopIgnoreAdaptiveScaling && oldLeft === newLeft && oldTop === newTop) {\r\n            return;\r\n        }\r\n\r\n        this.left = newLeft + \"px\";\r\n        this.top = newTop + \"px\";\r\n\r\n        this._left.ignoreAdaptiveScaling = true;\r\n        this._top.ignoreAdaptiveScaling = true;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _offsetLeft(offset: number) {\r\n        this._isDirty = true;\r\n        this._currentMeasure.left += offset;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _offsetTop(offset: number) {\r\n        this._isDirty = true;\r\n        this._currentMeasure.top += offset;\r\n    }\r\n\r\n    /** @internal */\r\n    public _markMatrixAsDirty(): void {\r\n        this._isMatrixDirty = true;\r\n        this._flagDescendantsAsMatrixDirty();\r\n    }\r\n\r\n    /** @internal */\r\n    public _flagDescendantsAsMatrixDirty(): void {\r\n        // No child\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _intersectsRect(rect: Measure, context?: ICanvasRenderingContext) {\r\n        // make sure we are transformed correctly before checking intersections. no-op if nothing is dirty.\r\n        this._transform(context);\r\n        if (this._evaluatedMeasure.left >= rect.left + rect.width) {\r\n            return false;\r\n        }\r\n\r\n        if (this._evaluatedMeasure.top >= rect.top + rect.height) {\r\n            return false;\r\n        }\r\n\r\n        if (this._evaluatedMeasure.left + this._evaluatedMeasure.width <= rect.left) {\r\n            return false;\r\n        }\r\n\r\n        if (this._evaluatedMeasure.top + this._evaluatedMeasure.height <= rect.top) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /** @internal */\r\n    protected _computeAdditionnalOffsetX() {\r\n        return 0;\r\n    }\r\n\r\n    /** @internal */\r\n    protected _computeAdditionnalOffsetY() {\r\n        return 0;\r\n    }\r\n\r\n    /** @internal */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public invalidateRect() {\r\n        this._transform();\r\n        if (this.host && this.host.useInvalidateRectOptimization) {\r\n            // Rotate by transform to get the measure transformed to global space\r\n            this._currentMeasure.transformToRef(this._transformMatrix, this._tmpMeasureA);\r\n            // get the boudning box of the current measure and last frames measure in global space and invalidate it\r\n            // the previous measure is used to properly clear a control that is scaled down\r\n            Measure.CombineToRef(this._tmpMeasureA, this._prevCurrentMeasureTransformedIntoGlobalSpace, this._tmpMeasureA);\r\n\r\n            // Expand rect based on shadows\r\n            const shadowOffsetX = this.shadowOffsetX;\r\n            const shadowOffsetY = this.shadowOffsetY;\r\n            const shadowBlur = Math.max(this._previousShadowBlur, this.shadowBlur);\r\n\r\n            const leftShadowOffset = Math.min(Math.min(shadowOffsetX, 0) - shadowBlur * 2, 0);\r\n            const rightShadowOffset = Math.max(Math.max(shadowOffsetX, 0) + shadowBlur * 2, 0);\r\n            const topShadowOffset = Math.min(Math.min(shadowOffsetY, 0) - shadowBlur * 2, 0);\r\n            const bottomShadowOffset = Math.max(Math.max(shadowOffsetY, 0) + shadowBlur * 2, 0);\r\n\r\n            const offsetX = this._computeAdditionnalOffsetX();\r\n            const offsetY = this._computeAdditionnalOffsetY();\r\n\r\n            this.host.invalidateRect(\r\n                Math.floor(this._tmpMeasureA.left + leftShadowOffset - offsetX),\r\n                Math.floor(this._tmpMeasureA.top + topShadowOffset - offsetY),\r\n                Math.ceil(this._tmpMeasureA.left + this._tmpMeasureA.width + rightShadowOffset + offsetX),\r\n                Math.ceil(this._tmpMeasureA.top + this._tmpMeasureA.height + bottomShadowOffset + offsetY)\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _markAsDirty(force = false): void {\r\n        if (!this._isVisible && !force) {\r\n            return;\r\n        }\r\n\r\n        this._isDirty = true;\r\n        this._markMatrixAsDirty();\r\n\r\n        // Redraw only this rectangle\r\n        if (this._host) {\r\n            this._host.markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public _markAllAsDirty(): void {\r\n        this._markAsDirty();\r\n\r\n        if (this._font) {\r\n            this._prepareFont();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _link(host: AdvancedDynamicTexture): void {\r\n        this._host = host;\r\n        if (this._host) {\r\n            this.uniqueId = this._host.getScene()!.getUniqueId();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _transform(context?: ICanvasRenderingContext): void {\r\n        if (!this._isMatrixDirty && this._scaleX === 1 && this._scaleY === 1 && this._rotation === 0) {\r\n            return;\r\n        }\r\n\r\n        // postTranslate\r\n        const offsetX = this._currentMeasure.width * this._transformCenterX + this._currentMeasure.left;\r\n        const offsetY = this._currentMeasure.height * this._transformCenterY + this._currentMeasure.top;\r\n        if (context) {\r\n            context.translate(offsetX, offsetY);\r\n\r\n            // rotate\r\n            context.rotate(this._rotation);\r\n\r\n            // scale\r\n            context.scale(this._scaleX, this._scaleY);\r\n\r\n            // preTranslate\r\n            context.translate(-offsetX, -offsetY);\r\n        }\r\n        // Need to update matrices?\r\n        if (this._isMatrixDirty || this._cachedOffsetX !== offsetX || this._cachedOffsetY !== offsetY) {\r\n            this._cachedOffsetX = offsetX;\r\n            this._cachedOffsetY = offsetY;\r\n            this._isMatrixDirty = false;\r\n            this._flagDescendantsAsMatrixDirty();\r\n\r\n            Matrix2D.ComposeToRef(-offsetX, -offsetY, this._rotation, this._scaleX, this._scaleY, this.parent ? this.parent._transformMatrix : null, this._transformMatrix);\r\n\r\n            this._transformMatrix.invertToRef(this._invertTransformMatrix);\r\n            this._currentMeasure.transformToRef(this._transformMatrix, this._evaluatedMeasure);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _renderHighlight(context: ICanvasRenderingContext): void {\r\n        if (!this.isHighlighted) {\r\n            return;\r\n        }\r\n\r\n        context.save();\r\n        context.strokeStyle = this._highlightColor;\r\n        context.lineWidth = this._highlightLineWidth;\r\n\r\n        this._renderHighlightSpecific(context);\r\n        context.restore();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _renderHighlightSpecific(context: ICanvasRenderingContext): void {\r\n        context.strokeRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n    }\r\n\r\n    protected _getColor(context: ICanvasRenderingContext): string | ICanvasGradient {\r\n        return this.gradient ? this.gradient.getCanvasGradient(context) : this.color;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _applyStates(context: ICanvasRenderingContext): void {\r\n        if (this._isFontSizeInPercentage) {\r\n            this._fontSet = true;\r\n        }\r\n\r\n        if (this._host && this._host.useSmallestIdeal && !this._font) {\r\n            this._fontSet = true;\r\n        }\r\n\r\n        if (this._fontSet) {\r\n            this._prepareFont();\r\n            this._fontSet = false;\r\n        }\r\n\r\n        if (this._font) {\r\n            context.font = this._font;\r\n        }\r\n\r\n        if (this._color || this.gradient) {\r\n            context.fillStyle = this._getColor(context);\r\n        }\r\n\r\n        if (Control.AllowAlphaInheritance) {\r\n            context.globalAlpha *= this._alpha;\r\n        } else if (this._alphaSet) {\r\n            context.globalAlpha = this.parent && !this.parent.renderToIntermediateTexture ? this.parent.alpha * this._alpha : this._alpha;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _layout(parentMeasure: Measure, context: ICanvasRenderingContext): boolean {\r\n        if (!this.isDirty && (!this.isVisible || this.notRenderable)) {\r\n            return false;\r\n        }\r\n\r\n        if (this._isDirty || !this._cachedParentMeasure.isEqualsTo(parentMeasure)) {\r\n            this.host._numLayoutCalls++;\r\n\r\n            this._currentMeasure.addAndTransformToRef(\r\n                this._transformMatrix,\r\n                -this._paddingLeftInPixels | 0,\r\n                -this._paddingTopInPixels | 0,\r\n                this._paddingRightInPixels | 0,\r\n                this._paddingBottomInPixels | 0,\r\n                this._prevCurrentMeasureTransformedIntoGlobalSpace\r\n            );\r\n\r\n            context.save();\r\n\r\n            this._applyStates(context);\r\n\r\n            let rebuildCount = 0;\r\n            do {\r\n                this._rebuildLayout = false;\r\n                this._processMeasures(parentMeasure, context);\r\n                rebuildCount++;\r\n            } while (this._rebuildLayout && rebuildCount < 3);\r\n\r\n            if (rebuildCount >= 3) {\r\n                Logger.Error(`Layout cycle detected in GUI (Control name=${this.name}, uniqueId=${this.uniqueId})`);\r\n            }\r\n\r\n            context.restore();\r\n            this.invalidateRect();\r\n            this._evaluateClippingState(parentMeasure);\r\n        }\r\n\r\n        this._wasDirty = this._isDirty;\r\n        this._isDirty = false;\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _processMeasures(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        this._tempPaddingMeasure.copyFrom(parentMeasure);\r\n\r\n        // Apply padding if in correct mode\r\n        if (this.parent && this.parent.descendantsOnlyPadding) {\r\n            this._tempPaddingMeasure.left += this.parent.paddingLeftInPixels;\r\n            this._tempPaddingMeasure.top += this.parent.paddingTopInPixels;\r\n            this._tempPaddingMeasure.width -= this.parent.paddingLeftInPixels + this.parent.paddingRightInPixels;\r\n            this._tempPaddingMeasure.height -= this.parent.paddingTopInPixels + this.parent.paddingBottomInPixels;\r\n        }\r\n\r\n        this._currentMeasure.copyFrom(this._tempPaddingMeasure);\r\n\r\n        // Let children take some pre-measurement actions\r\n        this._preMeasure(this._tempPaddingMeasure, context);\r\n\r\n        this._measure();\r\n        this._computeAlignment(this._tempPaddingMeasure, context);\r\n\r\n        // Convert to int values\r\n        this._currentMeasure.left = this._currentMeasure.left | 0;\r\n        this._currentMeasure.top = this._currentMeasure.top | 0;\r\n        this._currentMeasure.width = this._currentMeasure.width | 0;\r\n        this._currentMeasure.height = this._currentMeasure.height | 0;\r\n\r\n        // Let children add more features\r\n        this._additionalProcessing(this._tempPaddingMeasure, context);\r\n\r\n        this._cachedParentMeasure.copyFrom(this._tempPaddingMeasure);\r\n\r\n        this._currentMeasure.transformToRef(this._transformMatrix, this._evaluatedMeasure);\r\n        if (this.onDirtyObservable.hasObservers()) {\r\n            this.onDirtyObservable.notifyObservers(this);\r\n        }\r\n    }\r\n\r\n    protected _evaluateClippingState(parentMeasure: Measure) {\r\n        // Since transformMatrix is used here, we need to have it freshly computed\r\n        this._transform();\r\n        this._currentMeasure.transformToRef(this._transformMatrix, this._evaluatedMeasure);\r\n        if (this.parent && this.parent.clipChildren) {\r\n            parentMeasure.transformToRef(this.parent._transformMatrix, this._evaluatedParentMeasure);\r\n            // Early clip\r\n            if (this._evaluatedMeasure.left > this._evaluatedParentMeasure.left + this._evaluatedParentMeasure.width) {\r\n                this._isClipped = true;\r\n                return;\r\n            }\r\n\r\n            if (this._evaluatedMeasure.left + this._evaluatedMeasure.width < this._evaluatedParentMeasure.left) {\r\n                this._isClipped = true;\r\n                return;\r\n            }\r\n\r\n            if (this._evaluatedMeasure.top > this._evaluatedParentMeasure.top + this._evaluatedParentMeasure.height) {\r\n                this._isClipped = true;\r\n                return;\r\n            }\r\n\r\n            if (this._evaluatedMeasure.top + this._evaluatedMeasure.height < this._evaluatedParentMeasure.top) {\r\n                this._isClipped = true;\r\n                return;\r\n            }\r\n        }\r\n\r\n        this._isClipped = false;\r\n    }\r\n\r\n    /** @internal */\r\n    public _measure(): void {\r\n        // Width / Height\r\n        if (this._width.isPixel) {\r\n            this._currentMeasure.width = this._width.getValue(this._host);\r\n        } else {\r\n            this._currentMeasure.width *= this._width.getValue(this._host);\r\n        }\r\n\r\n        if (this._height.isPixel) {\r\n            this._currentMeasure.height = this._height.getValue(this._host);\r\n        } else {\r\n            this._currentMeasure.height *= this._height.getValue(this._host);\r\n        }\r\n\r\n        if (this._fixedRatio !== 0) {\r\n            if (this._fixedRatioMasterIsWidth) {\r\n                this._currentMeasure.height = this._currentMeasure.width * this._fixedRatio;\r\n            } else {\r\n                this._currentMeasure.width = this._currentMeasure.height * this._fixedRatio;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _computeAlignment(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        const width = this._currentMeasure.width;\r\n        const height = this._currentMeasure.height;\r\n\r\n        const parentWidth = parentMeasure.width;\r\n        const parentHeight = parentMeasure.height;\r\n\r\n        // Left / top\r\n        let x = 0;\r\n        let y = 0;\r\n\r\n        switch (this.horizontalAlignment) {\r\n            case Control.HORIZONTAL_ALIGNMENT_LEFT:\r\n                x = 0;\r\n                break;\r\n            case Control.HORIZONTAL_ALIGNMENT_RIGHT:\r\n                x = parentWidth - width;\r\n                break;\r\n            case Control.HORIZONTAL_ALIGNMENT_CENTER:\r\n                x = (parentWidth - width) / 2;\r\n                break;\r\n        }\r\n\r\n        switch (this.verticalAlignment) {\r\n            case Control.VERTICAL_ALIGNMENT_TOP:\r\n                y = 0;\r\n                break;\r\n            case Control.VERTICAL_ALIGNMENT_BOTTOM:\r\n                y = parentHeight - height;\r\n                break;\r\n            case Control.VERTICAL_ALIGNMENT_CENTER:\r\n                y = (parentHeight - height) / 2;\r\n                break;\r\n        }\r\n\r\n        if (!this.descendantsOnlyPadding) {\r\n            if (this._paddingLeft.isPixel) {\r\n                this._currentMeasure.left += this._paddingLeft.getValue(this._host);\r\n                this._currentMeasure.width -= this._paddingLeft.getValue(this._host);\r\n            } else {\r\n                this._currentMeasure.left += parentWidth * this._paddingLeft.getValue(this._host);\r\n                this._currentMeasure.width -= parentWidth * this._paddingLeft.getValue(this._host);\r\n            }\r\n\r\n            if (this._paddingRight.isPixel) {\r\n                this._currentMeasure.width -= this._paddingRight.getValue(this._host);\r\n            } else {\r\n                this._currentMeasure.width -= parentWidth * this._paddingRight.getValue(this._host);\r\n            }\r\n\r\n            if (this._paddingTop.isPixel) {\r\n                this._currentMeasure.top += this._paddingTop.getValue(this._host);\r\n                this._currentMeasure.height -= this._paddingTop.getValue(this._host);\r\n            } else {\r\n                this._currentMeasure.top += parentHeight * this._paddingTop.getValue(this._host);\r\n                this._currentMeasure.height -= parentHeight * this._paddingTop.getValue(this._host);\r\n            }\r\n\r\n            if (this._paddingBottom.isPixel) {\r\n                this._currentMeasure.height -= this._paddingBottom.getValue(this._host);\r\n            } else {\r\n                this._currentMeasure.height -= parentHeight * this._paddingBottom.getValue(this._host);\r\n            }\r\n        }\r\n\r\n        if (this._left.isPixel) {\r\n            this._currentMeasure.left += this._left.getValue(this._host);\r\n        } else {\r\n            this._currentMeasure.left += parentWidth * this._left.getValue(this._host);\r\n        }\r\n\r\n        if (this._top.isPixel) {\r\n            this._currentMeasure.top += this._top.getValue(this._host);\r\n        } else {\r\n            this._currentMeasure.top += parentHeight * this._top.getValue(this._host);\r\n        }\r\n\r\n        this._currentMeasure.left += x;\r\n        this._currentMeasure.top += y;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _preMeasure(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        // Do nothing\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        // Do nothing\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _clipForChildren(context: ICanvasRenderingContext): void {\r\n        // DO nothing\r\n    }\r\n\r\n    private static _ClipMeasure = new Measure(0, 0, 0, 0);\r\n    private _tmpMeasureA = new Measure(0, 0, 0, 0);\r\n    private _clip(context: ICanvasRenderingContext, invalidatedRectangle?: Nullable<Measure>) {\r\n        context.beginPath();\r\n        Control._ClipMeasure.copyFrom(this._currentMeasure);\r\n        if (invalidatedRectangle) {\r\n            // Rotate the invalidated rect into the control's space\r\n            invalidatedRectangle.transformToRef(this._invertTransformMatrix, this._tmpMeasureA);\r\n\r\n            // Get the intersection of the rect in context space and the current context\r\n            const intersection = new Measure(0, 0, 0, 0);\r\n            intersection.left = Math.max(this._tmpMeasureA.left, this._currentMeasure.left);\r\n            intersection.top = Math.max(this._tmpMeasureA.top, this._currentMeasure.top);\r\n            intersection.width = Math.min(this._tmpMeasureA.left + this._tmpMeasureA.width, this._currentMeasure.left + this._currentMeasure.width) - intersection.left;\r\n            intersection.height = Math.min(this._tmpMeasureA.top + this._tmpMeasureA.height, this._currentMeasure.top + this._currentMeasure.height) - intersection.top;\r\n            Control._ClipMeasure.copyFrom(intersection);\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            const shadowOffsetX = this.shadowOffsetX;\r\n            const shadowOffsetY = this.shadowOffsetY;\r\n            const shadowBlur = this.shadowBlur;\r\n\r\n            const leftShadowOffset = Math.min(Math.min(shadowOffsetX, 0) - shadowBlur * 2, 0);\r\n            const rightShadowOffset = Math.max(Math.max(shadowOffsetX, 0) + shadowBlur * 2, 0);\r\n            const topShadowOffset = Math.min(Math.min(shadowOffsetY, 0) - shadowBlur * 2, 0);\r\n            const bottomShadowOffset = Math.max(Math.max(shadowOffsetY, 0) + shadowBlur * 2, 0);\r\n\r\n            context.rect(\r\n                Control._ClipMeasure.left + leftShadowOffset,\r\n                Control._ClipMeasure.top + topShadowOffset,\r\n                Control._ClipMeasure.width + rightShadowOffset - leftShadowOffset,\r\n                Control._ClipMeasure.height + bottomShadowOffset - topShadowOffset\r\n            );\r\n        } else {\r\n            context.rect(Control._ClipMeasure.left, Control._ClipMeasure.top, Control._ClipMeasure.width, Control._ClipMeasure.height);\r\n        }\r\n\r\n        context.clip();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _render(context: ICanvasRenderingContext, invalidatedRectangle?: Nullable<Measure>): boolean {\r\n        if (!this.isVisible || this.notRenderable || this._isClipped) {\r\n            this._isDirty = false;\r\n            return false;\r\n        }\r\n\r\n        this.host._numRenderCalls++;\r\n\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n\r\n        // Transform\r\n        this._transform(context);\r\n\r\n        // Clip\r\n        if (this.clipContent) {\r\n            this._clip(context, invalidatedRectangle);\r\n        }\r\n\r\n        if (this.onBeforeDrawObservable.hasObservers()) {\r\n            this.onBeforeDrawObservable.notifyObservers(this);\r\n        }\r\n\r\n        if (this.useBitmapCache && !this._wasDirty && this._cacheData) {\r\n            context.putImageData(this._cacheData, this._currentMeasure.left, this._currentMeasure.top);\r\n        } else {\r\n            this._draw(context, invalidatedRectangle);\r\n        }\r\n\r\n        if (this.useBitmapCache && this._wasDirty) {\r\n            this._cacheData = context.getImageData(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n        }\r\n\r\n        this._renderHighlight(context);\r\n\r\n        if (this.onAfterDrawObservable.hasObservers()) {\r\n            this.onAfterDrawObservable.notifyObservers(this);\r\n        }\r\n\r\n        context.restore();\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _draw(context: ICanvasRenderingContext, invalidatedRectangle?: Nullable<Measure>): void {\r\n        // Do nothing\r\n    }\r\n\r\n    /**\r\n     * Tests if a given coordinates belong to the current control\r\n     * @param x defines x coordinate to test\r\n     * @param y defines y coordinate to test\r\n     * @returns true if the coordinates are inside the control\r\n     */\r\n    public contains(x: number, y: number): boolean {\r\n        // Invert transform\r\n        this._invertTransformMatrix.transformCoordinates(x, y, this._transformedPosition);\r\n\r\n        x = this._transformedPosition.x;\r\n        y = this._transformedPosition.y;\r\n\r\n        // Check\r\n        if (x < this._currentMeasure.left) {\r\n            return false;\r\n        }\r\n\r\n        if (x > this._currentMeasure.left + this._currentMeasure.width) {\r\n            return false;\r\n        }\r\n\r\n        if (y < this._currentMeasure.top) {\r\n            return false;\r\n        }\r\n\r\n        if (y > this._currentMeasure.top + this._currentMeasure.height) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isPointerBlocker) {\r\n            this._host._shouldBlockPointer = true;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _processPicking(x: number, y: number, pi: Nullable<PointerInfoBase>, type: number, pointerId: number, buttonIndex: number, deltaX?: number, deltaY?: number): boolean {\r\n        if (!this._isEnabled) {\r\n            return false;\r\n        }\r\n        if (!this.isHitTestVisible || !this.isVisible || this._doNotRender) {\r\n            return false;\r\n        }\r\n\r\n        if (!this.contains(x, y)) {\r\n            return false;\r\n        }\r\n\r\n        this._processObservables(type, x, y, pi, pointerId, buttonIndex, deltaX, deltaY);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerMove(target: Control, coordinates: Vector2, pointerId: number, pi: Nullable<PointerInfoBase>): void {\r\n        const canNotify: boolean = this.onPointerMoveObservable.notifyObservers(coordinates, -1, target, this, pi);\r\n\r\n        if (canNotify && this.parent != null && !this.isPointerBlocker) {\r\n            this.parent._onPointerMove(target, coordinates, pointerId, pi);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerEnter(target: Control, pi: Nullable<PointerInfoBase>): boolean {\r\n        if (!this._isEnabled) {\r\n            return false;\r\n        }\r\n        if (this._enterCount > 0) {\r\n            return false;\r\n        }\r\n\r\n        if (this._enterCount === -1) {\r\n            // -1 is for touch input, we are now sure we are with a mouse or pencil\r\n            this._enterCount = 0;\r\n        }\r\n        this._enterCount++;\r\n\r\n        const canNotify: boolean = this.onPointerEnterObservable.notifyObservers(this, -1, target, this, pi);\r\n\r\n        if (canNotify && this.parent != null && !this.isPointerBlocker) {\r\n            this.parent._onPointerEnter(target, pi);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerOut(target: Control, pi: Nullable<PointerInfoBase>, force = false): void {\r\n        if (!force && (!this._isEnabled || target === this)) {\r\n            return;\r\n        }\r\n        this._enterCount = 0;\r\n\r\n        let canNotify: boolean = true;\r\n\r\n        if (!target.isAscendant(this)) {\r\n            canNotify = this.onPointerOutObservable.notifyObservers(this, -1, target, this, pi);\r\n        }\r\n\r\n        if (canNotify && this.parent != null && !this.isPointerBlocker) {\r\n            this.parent._onPointerOut(target, pi, force);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: Nullable<PointerInfoBase>): boolean {\r\n        // Prevent pointerout to lose control context.\r\n        // Event redundancy is checked inside the function.\r\n        this._onPointerEnter(this, pi);\r\n\r\n        if (this._downCount !== 0) {\r\n            return false;\r\n        }\r\n\r\n        this._downCount++;\r\n\r\n        this._downPointerIds[pointerId] = true;\r\n\r\n        const canNotify: boolean = this.onPointerDownObservable.notifyObservers(new Vector2WithInfo(coordinates, buttonIndex), -1, target, this, pi);\r\n\r\n        if (canNotify && this.parent != null && !this.isPointerBlocker) {\r\n            this.parent._onPointerDown(target, coordinates, pointerId, buttonIndex, pi);\r\n        }\r\n\r\n        if (pi && this.uniqueId !== this._host.rootContainer.uniqueId) {\r\n            this._host._capturedPointerIds.add((pi.event as IPointerEvent).pointerId);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerUp(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, notifyClick: boolean, pi?: Nullable<PointerInfoBase>): void {\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        this._downCount = 0;\r\n\r\n        delete this._downPointerIds[pointerId];\r\n\r\n        let canNotifyClick: boolean = notifyClick;\r\n        if (notifyClick && (this._enterCount > 0 || this._enterCount === -1)) {\r\n            canNotifyClick = this.onPointerClickObservable.notifyObservers(new Vector2WithInfo(coordinates, buttonIndex), -1, target, this, pi);\r\n        }\r\n        const canNotify: boolean = this.onPointerUpObservable.notifyObservers(new Vector2WithInfo(coordinates, buttonIndex), -1, target, this, pi);\r\n\r\n        if (canNotify && this.parent != null && !this.isPointerBlocker) {\r\n            this.parent._onPointerUp(target, coordinates, pointerId, buttonIndex, canNotifyClick, pi);\r\n        }\r\n\r\n        if (pi && this.uniqueId !== this._host.rootContainer.uniqueId) {\r\n            this._host._capturedPointerIds.delete((pi.event as IPointerEvent).pointerId);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _forcePointerUp(pointerId: Nullable<number> = null) {\r\n        if (pointerId !== null) {\r\n            this._onPointerUp(this, Vector2.Zero(), pointerId, 0, true);\r\n        } else {\r\n            for (const key in this._downPointerIds) {\r\n                this._onPointerUp(this, Vector2.Zero(), +key as number, 0, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onWheelScroll(deltaX?: number, deltaY?: number): void {\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        const canNotify: boolean = this.onWheelObservable.notifyObservers(new Vector2(deltaX, deltaY));\r\n\r\n        if (canNotify && this.parent != null) {\r\n            this.parent._onWheelScroll(deltaX, deltaY);\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public _onCanvasBlur(): void {}\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _processObservables(\r\n        type: number,\r\n        x: number,\r\n        y: number,\r\n        pi: Nullable<PointerInfoBase>,\r\n        pointerId: number,\r\n        buttonIndex: number,\r\n        deltaX?: number,\r\n        deltaY?: number\r\n    ): boolean {\r\n        if (!this._isEnabled) {\r\n            return false;\r\n        }\r\n        this._dummyVector2.copyFromFloats(x, y);\r\n        if (type === PointerEventTypes.POINTERMOVE) {\r\n            this._onPointerMove(this, this._dummyVector2, pointerId, pi);\r\n\r\n            const previousControlOver = this._host._lastControlOver[pointerId];\r\n            if (previousControlOver && previousControlOver !== this) {\r\n                previousControlOver._onPointerOut(this, pi);\r\n            }\r\n\r\n            if (previousControlOver !== this) {\r\n                this._onPointerEnter(this, pi);\r\n            }\r\n\r\n            this._host._lastControlOver[pointerId] = this;\r\n            return true;\r\n        }\r\n\r\n        if (type === PointerEventTypes.POINTERDOWN) {\r\n            this._onPointerDown(this, this._dummyVector2, pointerId, buttonIndex, pi);\r\n            this._host._registerLastControlDown(this, pointerId);\r\n            this._host._lastPickedControl = this;\r\n            return true;\r\n        }\r\n\r\n        if (type === PointerEventTypes.POINTERUP) {\r\n            if (this._host._lastControlDown[pointerId]) {\r\n                this._host._lastControlDown[pointerId]._onPointerUp(this, this._dummyVector2, pointerId, buttonIndex, true, pi);\r\n            }\r\n            delete this._host._lastControlDown[pointerId];\r\n            return true;\r\n        }\r\n\r\n        if (type === PointerEventTypes.POINTERWHEEL) {\r\n            if (this._host._lastControlOver[pointerId]) {\r\n                this._host._lastControlOver[pointerId]._onWheelScroll(deltaX, deltaY);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    private _prepareFont() {\r\n        if (!this._font && !this._fontSet) {\r\n            return;\r\n        }\r\n\r\n        if (this._style) {\r\n            this._font = this._style.fontStyle + \" \" + this._style.fontWeight + \" \" + this.fontSizeInPixels + \"px \" + this._style.fontFamily;\r\n        } else {\r\n            this._font = this._fontStyle + \" \" + this._fontWeight + \" \" + this.fontSizeInPixels + \"px \" + this._fontFamily;\r\n        }\r\n\r\n        this._fontOffset = Control._GetFontOffset(this._font);\r\n\r\n        //children need to be refreshed\r\n        this.getDescendants().forEach((child) => child._markAllAsDirty());\r\n    }\r\n\r\n    /**\r\n     * Clones a control and its descendants\r\n     * @param host the texture where the control will be instantiated. Can be empty, in which case the control will be created on the same texture\r\n     * @returns the cloned control\r\n     */\r\n    public clone(host?: AdvancedDynamicTexture): Control {\r\n        const serialization: any = {};\r\n        this.serialize(serialization);\r\n\r\n        const controlType = Tools.Instantiate(\"BABYLON.GUI.\" + serialization.className);\r\n        const cloned = new controlType();\r\n        cloned.parse(serialization, host);\r\n\r\n        return cloned;\r\n    }\r\n\r\n    /**\r\n     * Parses a serialized object into this control\r\n     * @param serializedObject the object with the serialized properties\r\n     * @param host the texture where the control will be instantiated. Can be empty, in which case the control will be created on the same texture\r\n     * @returns this control\r\n     */\r\n    public parse(serializedObject: any, host?: AdvancedDynamicTexture): Control {\r\n        SerializationHelper.Parse(() => this, serializedObject, null);\r\n\r\n        this.name = serializedObject.name;\r\n\r\n        this._parseFromContent(serializedObject, host ?? this._host);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Serializes the current control\r\n     * @param serializationObject defined the JSON serialized object\r\n     */\r\n    public serialize(serializationObject: any) {\r\n        SerializationHelper.Serialize(this, serializationObject);\r\n        serializationObject.name = this.name;\r\n        serializationObject.className = this.getClassName();\r\n\r\n        // Call prepareFont to guarantee the font is properly set before serializing\r\n        this._prepareFont();\r\n        if (this._font) {\r\n            serializationObject.fontFamily = this._fontFamily;\r\n            serializationObject.fontSize = this.fontSize;\r\n            serializationObject.fontWeight = this.fontWeight;\r\n            serializationObject.fontStyle = this.fontStyle;\r\n        }\r\n\r\n        if (this._gradient) {\r\n            serializationObject.gradient = {};\r\n            this._gradient.serialize(serializationObject.gradient);\r\n        }\r\n\r\n        // Animations\r\n        SerializationHelper.AppendSerializedAnimations(this, serializationObject);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        if (serializedObject.fontFamily) {\r\n            this.fontFamily = serializedObject.fontFamily;\r\n        }\r\n\r\n        if (serializedObject.fontSize) {\r\n            this.fontSize = serializedObject.fontSize;\r\n        }\r\n\r\n        if (serializedObject.fontWeight) {\r\n            this.fontWeight = serializedObject.fontWeight;\r\n        }\r\n\r\n        if (serializedObject.fontStyle) {\r\n            this.fontStyle = serializedObject.fontStyle;\r\n        }\r\n\r\n        // Gradient\r\n        if (serializedObject.gradient) {\r\n            const className = Tools.Instantiate(\"BABYLON.GUI.\" + serializedObject.gradient.className);\r\n            this._gradient = new className();\r\n            this._gradient?.parse(serializedObject.gradient);\r\n        }\r\n\r\n        // Animations\r\n        if (serializedObject.animations) {\r\n            this.animations = [];\r\n            for (let animationIndex = 0; animationIndex < serializedObject.animations.length; animationIndex++) {\r\n                const parsedAnimation = serializedObject.animations[animationIndex];\r\n                const internalClass = GetClass(\"BABYLON.Animation\");\r\n                if (internalClass) {\r\n                    this.animations.push(internalClass.Parse(parsedAnimation));\r\n                }\r\n            }\r\n\r\n            if (serializedObject.autoAnimate && this._host && this._host.getScene()) {\r\n                this._host\r\n                    .getScene()!\r\n                    .beginAnimation(\r\n                        this,\r\n                        serializedObject.autoAnimateFrom,\r\n                        serializedObject.autoAnimateTo,\r\n                        serializedObject.autoAnimateLoop,\r\n                        serializedObject.autoAnimateSpeed || 1.0\r\n                    );\r\n            }\r\n        }\r\n\r\n        this.fixedRatioMasterIsWidth = serializedObject.fixedRatioMasterIsWidth ?? this.fixedRatioMasterIsWidth;\r\n    }\r\n\r\n    /** Releases associated resources */\r\n    public dispose() {\r\n        this.onDirtyObservable.clear();\r\n        this.onBeforeDrawObservable.clear();\r\n        this.onAfterDrawObservable.clear();\r\n        this.onPointerDownObservable.clear();\r\n        this.onPointerEnterObservable.clear();\r\n        this.onPointerMoveObservable.clear();\r\n        this.onPointerOutObservable.clear();\r\n        this.onPointerUpObservable.clear();\r\n        this.onPointerClickObservable.clear();\r\n        this.onWheelObservable.clear();\r\n\r\n        if (this._styleObserver && this._style) {\r\n            this._style.onChangedObservable.remove(this._styleObserver);\r\n            this._styleObserver = null;\r\n        }\r\n\r\n        if (this.parent) {\r\n            this.parent.removeControl(this);\r\n            this.parent = null;\r\n        }\r\n\r\n        if (this._host) {\r\n            const index = this._host._linkedControls.indexOf(this);\r\n            if (index > -1) {\r\n                this.linkWithMesh(null);\r\n            }\r\n        }\r\n\r\n        // Callback\r\n        this.onDisposeObservable.notifyObservers(this);\r\n        this.onDisposeObservable.clear();\r\n    }\r\n\r\n    // Statics\r\n    private static _HORIZONTAL_ALIGNMENT_LEFT = 0;\r\n    private static _HORIZONTAL_ALIGNMENT_RIGHT = 1;\r\n    private static _HORIZONTAL_ALIGNMENT_CENTER = 2;\r\n\r\n    private static _VERTICAL_ALIGNMENT_TOP = 0;\r\n    private static _VERTICAL_ALIGNMENT_BOTTOM = 1;\r\n    private static _VERTICAL_ALIGNMENT_CENTER = 2;\r\n\r\n    /** HORIZONTAL_ALIGNMENT_LEFT */\r\n    public static get HORIZONTAL_ALIGNMENT_LEFT(): number {\r\n        return Control._HORIZONTAL_ALIGNMENT_LEFT;\r\n    }\r\n\r\n    /** HORIZONTAL_ALIGNMENT_RIGHT */\r\n    public static get HORIZONTAL_ALIGNMENT_RIGHT(): number {\r\n        return Control._HORIZONTAL_ALIGNMENT_RIGHT;\r\n    }\r\n\r\n    /** HORIZONTAL_ALIGNMENT_CENTER */\r\n    public static get HORIZONTAL_ALIGNMENT_CENTER(): number {\r\n        return Control._HORIZONTAL_ALIGNMENT_CENTER;\r\n    }\r\n\r\n    /** VERTICAL_ALIGNMENT_TOP */\r\n    public static get VERTICAL_ALIGNMENT_TOP(): number {\r\n        return Control._VERTICAL_ALIGNMENT_TOP;\r\n    }\r\n\r\n    /** VERTICAL_ALIGNMENT_BOTTOM */\r\n    public static get VERTICAL_ALIGNMENT_BOTTOM(): number {\r\n        return Control._VERTICAL_ALIGNMENT_BOTTOM;\r\n    }\r\n\r\n    /** VERTICAL_ALIGNMENT_CENTER */\r\n    public static get VERTICAL_ALIGNMENT_CENTER(): number {\r\n        return Control._VERTICAL_ALIGNMENT_CENTER;\r\n    }\r\n\r\n    private static _FontHeightSizes: { [key: string]: { ascent: number; height: number; descent: number } } = {};\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public static _GetFontOffset(font: string): { ascent: number; height: number; descent: number } {\r\n        if (Control._FontHeightSizes[font]) {\r\n            return Control._FontHeightSizes[font];\r\n        }\r\n\r\n        const engine = EngineStore.LastCreatedEngine;\r\n        if (!engine) {\r\n            throw new Error(\"Invalid engine. Unable to create a canvas.\");\r\n        }\r\n\r\n        const result = engine.getFontOffset(font);\r\n        Control._FontHeightSizes[font] = result;\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Creates a Control from parsed data\r\n     * @param serializedObject defines parsed data\r\n     * @param host defines the hosting AdvancedDynamicTexture\r\n     * @returns a new Control\r\n     */\r\n    public static Parse(serializedObject: any, host: AdvancedDynamicTexture): Control {\r\n        const controlType = Tools.Instantiate(\"BABYLON.GUI.\" + serializedObject.className);\r\n        const control = SerializationHelper.Parse(() => new controlType(), serializedObject, null);\r\n\r\n        control.name = serializedObject.name;\r\n\r\n        control._parseFromContent(serializedObject, host);\r\n\r\n        return control;\r\n    }\r\n\r\n    public static AddHeader: (control: Control, text: string, size: string | number, options: { isHorizontal: boolean; controlFirst: boolean }) => any = () => {};\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected static drawEllipse(x: number, y: number, width: number, height: number, context: ICanvasRenderingContext): void {\r\n        context.translate(x, y);\r\n        context.scale(width, height);\r\n\r\n        context.beginPath();\r\n        context.arc(0, 0, 1, 0, 2 * Math.PI);\r\n        context.closePath();\r\n\r\n        context.scale(1 / width, 1 / height);\r\n        context.translate(-x, -y);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the control is ready to be used\r\n     * @returns\r\n     */\r\n    public isReady(): boolean {\r\n        // Most controls are ready by default, so the default implementation is to return true\r\n        return true;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Control\", Control);\r\n","import type { Nullable } from \"core/types\";\r\nimport { Logger } from \"core/Misc/logger\";\r\n\r\nimport { Control } from \"./control\";\r\nimport { Measure } from \"../measure\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport { DynamicTexture } from \"core/Materials/Textures/dynamicTexture\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\nimport { Constants } from \"core/Engines/constants\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport type { BaseGradient } from \"./gradient/BaseGradient\";\r\nimport { Tools } from \"core/Misc/tools\";\r\nimport { Matrix2D } from \"../math2D\";\r\n\r\n/**\r\n * Root class for 2D containers\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#containers\r\n */\r\nexport class Container extends Control {\r\n    /** @internal */\r\n    public _children = new Array<Control>();\r\n    /** @internal */\r\n    protected _measureForChildren = Measure.Empty();\r\n    /** @internal */\r\n    protected _background = \"\";\r\n    /** @internal */\r\n    protected _backgroundGradient: Nullable<BaseGradient> = null;\r\n    /** @internal */\r\n    protected _adaptWidthToChildren = false;\r\n    /** @internal */\r\n    protected _adaptHeightToChildren = false;\r\n    /** @internal */\r\n    protected _renderToIntermediateTexture: boolean = false;\r\n    /** @internal */\r\n    protected _intermediateTexture: Nullable<DynamicTexture> = null;\r\n\r\n    /** Gets or sets boolean indicating if children should be rendered to an intermediate texture rather than directly to host, useful for alpha blending */\r\n    @serialize()\r\n    public get renderToIntermediateTexture(): boolean {\r\n        return this._renderToIntermediateTexture;\r\n    }\r\n    public set renderToIntermediateTexture(value: boolean) {\r\n        if (this._renderToIntermediateTexture === value) {\r\n            return;\r\n        }\r\n        this._renderToIntermediateTexture = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that layout cycle errors should be displayed on the console\r\n     */\r\n    public logLayoutCycleErrors = false;\r\n\r\n    /**\r\n     * Gets or sets the number of layout cycles (a change involved by a control while evaluating the layout) allowed\r\n     */\r\n    @serialize()\r\n    public maxLayoutCycle = 3;\r\n\r\n    /** Gets or sets a boolean indicating if the container should try to adapt to its children height */\r\n    @serialize()\r\n    public get adaptHeightToChildren(): boolean {\r\n        return this._adaptHeightToChildren;\r\n    }\r\n\r\n    public set adaptHeightToChildren(value: boolean) {\r\n        if (this._adaptHeightToChildren === value) {\r\n            return;\r\n        }\r\n\r\n        this._adaptHeightToChildren = value;\r\n\r\n        if (value) {\r\n            this.height = \"100%\";\r\n        }\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the container should try to adapt to its children width */\r\n    @serialize()\r\n    public get adaptWidthToChildren(): boolean {\r\n        return this._adaptWidthToChildren;\r\n    }\r\n\r\n    public set adaptWidthToChildren(value: boolean) {\r\n        if (this._adaptWidthToChildren === value) {\r\n            return;\r\n        }\r\n\r\n        this._adaptWidthToChildren = value;\r\n\r\n        if (value) {\r\n            this.width = \"100%\";\r\n        }\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background color */\r\n    @serialize()\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n\r\n        this._background = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background gradient color. Takes precedence over background */\r\n    @serialize()\r\n    public get backgroundGradient() {\r\n        return this._backgroundGradient;\r\n    }\r\n\r\n    public set backgroundGradient(value: Nullable<BaseGradient>) {\r\n        if (this._backgroundGradient === value) {\r\n            return;\r\n        }\r\n        this._backgroundGradient = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets the list of children */\r\n    public get children(): Control[] {\r\n        return this._children;\r\n    }\r\n\r\n    public get isReadOnly() {\r\n        return this._isReadOnly;\r\n    }\r\n\r\n    public set isReadOnly(value: boolean) {\r\n        this._isReadOnly = value;\r\n\r\n        for (const child of this._children) {\r\n            child.isReadOnly = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new Container\r\n     * @param name defines the name of the container\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Container\";\r\n    }\r\n\r\n    public _flagDescendantsAsMatrixDirty(): void {\r\n        for (const child of this.children) {\r\n            child._isClipped = false;\r\n            child._markMatrixAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets a child using its name\r\n     * @param name defines the child name to look for\r\n     * @returns the child control if found\r\n     */\r\n    public getChildByName(name: string): Nullable<Control> {\r\n        for (const child of this.children) {\r\n            if (child.name === name) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Gets a child using its type and its name\r\n     * @param name defines the child name to look for\r\n     * @param type defines the child type to look for\r\n     * @returns the child control if found\r\n     */\r\n    public getChildByType(name: string, type: string): Nullable<Control> {\r\n        for (const child of this.children) {\r\n            if (child.typeName === type) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Search for a specific control in children\r\n     * @param control defines the control to look for\r\n     * @returns true if the control is in child list\r\n     */\r\n    public containsControl(control: Control): boolean {\r\n        return this.children.indexOf(control) !== -1;\r\n    }\r\n\r\n    /**\r\n     * Adds a new control to the current container\r\n     * @param control defines the control to add\r\n     * @returns the current container\r\n     */\r\n    public addControl(control: Nullable<Control>): Container {\r\n        if (!control) {\r\n            return this;\r\n        }\r\n\r\n        const index = this._children.indexOf(control);\r\n\r\n        if (index !== -1) {\r\n            return this;\r\n        }\r\n        control._link(this._host);\r\n\r\n        control._markAllAsDirty();\r\n\r\n        this._reOrderControl(control);\r\n\r\n        this._markAsDirty();\r\n\r\n        this.onControlAddedObservable.notifyObservers(control);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Removes all controls from the current container\r\n     * @returns the current container\r\n     */\r\n    public clearControls(): Container {\r\n        const children = this.children.slice();\r\n\r\n        for (const child of children) {\r\n            this.removeControl(child);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Removes a control from the current container\r\n     * @param control defines the control to remove\r\n     * @returns the current container\r\n     */\r\n    public removeControl(control: Control): Container {\r\n        const index = this._children.indexOf(control);\r\n\r\n        if (index !== -1) {\r\n            this._children.splice(index, 1);\r\n\r\n            control.parent = null;\r\n        }\r\n\r\n        control.linkWithMesh(null);\r\n\r\n        if (this._host) {\r\n            this._host._cleanControlAfterRemoval(control);\r\n        }\r\n\r\n        this._markAsDirty();\r\n\r\n        this.onControlRemovedObservable.notifyObservers(control);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * An event triggered when any control is added to this container.\r\n     */\r\n    public onControlAddedObservable = new Observable<Nullable<Control>>();\r\n\r\n    /**\r\n     * An event triggered when any control is removed from this container.\r\n     */\r\n    public onControlRemovedObservable = new Observable<Nullable<Control>>();\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _reOrderControl(control: Control): void {\r\n        const linkedMesh = control.linkedMesh;\r\n\r\n        this.removeControl(control);\r\n\r\n        let wasAdded = false;\r\n        for (let index = 0; index < this._children.length; index++) {\r\n            if (this._children[index].zIndex > control.zIndex) {\r\n                this._children.splice(index, 0, control);\r\n                wasAdded = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!wasAdded) {\r\n            this._children.push(control);\r\n        }\r\n\r\n        control.parent = this;\r\n\r\n        if (linkedMesh) {\r\n            control.linkWithMesh(linkedMesh);\r\n        }\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _offsetLeft(offset: number) {\r\n        super._offsetLeft(offset);\r\n\r\n        for (const child of this._children) {\r\n            child._offsetLeft(offset);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _offsetTop(offset: number) {\r\n        super._offsetTop(offset);\r\n\r\n        for (const child of this._children) {\r\n            child._offsetTop(offset);\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public _markAllAsDirty(): void {\r\n        super._markAllAsDirty();\r\n\r\n        for (let index = 0; index < this._children.length; index++) {\r\n            this._children[index]._markAllAsDirty();\r\n        }\r\n    }\r\n\r\n    protected _getBackgroundColor(context: ICanvasRenderingContext) {\r\n        return this._backgroundGradient ? this._backgroundGradient.getCanvasGradient(context) : this._background;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _localDraw(context: ICanvasRenderingContext): void {\r\n        if (this._background || this._backgroundGradient) {\r\n            context.save();\r\n            if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n                context.shadowColor = this.shadowColor;\r\n                context.shadowBlur = this.shadowBlur;\r\n                context.shadowOffsetX = this.shadowOffsetX;\r\n                context.shadowOffsetY = this.shadowOffsetY;\r\n            }\r\n\r\n            context.fillStyle = this._getBackgroundColor(context);\r\n\r\n            context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n            context.restore();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _link(host: AdvancedDynamicTexture): void {\r\n        super._link(host);\r\n\r\n        for (const child of this._children) {\r\n            child._link(host);\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    protected _beforeLayout() {\r\n        // Do nothing\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _processMeasures(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        if (this._isDirty || !this._cachedParentMeasure.isEqualsTo(parentMeasure)) {\r\n            super._processMeasures(parentMeasure, context);\r\n            this._evaluateClippingState(parentMeasure);\r\n            if (this._renderToIntermediateTexture) {\r\n                if (this._intermediateTexture && this._host.getScene() != this._intermediateTexture.getScene()) {\r\n                    this._intermediateTexture.dispose();\r\n                    this._intermediateTexture = null;\r\n                }\r\n                if (!this._intermediateTexture) {\r\n                    this._intermediateTexture = new DynamicTexture(\r\n                        \"\",\r\n                        { width: this._currentMeasure.width, height: this._currentMeasure.height },\r\n                        this._host.getScene(),\r\n                        false,\r\n                        Texture.NEAREST_SAMPLINGMODE,\r\n                        Constants.TEXTUREFORMAT_RGBA,\r\n                        false\r\n                    );\r\n                    this._intermediateTexture.hasAlpha = true;\r\n                } else {\r\n                    this._intermediateTexture.scaleTo(this._currentMeasure.width, this._currentMeasure.height);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _layout(parentMeasure: Measure, context: ICanvasRenderingContext): boolean {\r\n        if (!this.isDirty && (!this.isVisible || this.notRenderable)) {\r\n            return false;\r\n        }\r\n\r\n        this.host._numLayoutCalls++;\r\n\r\n        if (this._isDirty) {\r\n            this._currentMeasure.transformToRef(this._transformMatrix, this._prevCurrentMeasureTransformedIntoGlobalSpace);\r\n        }\r\n\r\n        let rebuildCount = 0;\r\n\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n\r\n        this._beforeLayout();\r\n\r\n        do {\r\n            let computedWidth = -1;\r\n            let computedHeight = -1;\r\n            this._rebuildLayout = false;\r\n            this._processMeasures(parentMeasure, context);\r\n\r\n            if (!this._isClipped) {\r\n                for (const child of this._children) {\r\n                    child._tempParentMeasure.copyFrom(this._measureForChildren);\r\n\r\n                    if (child._layout(this._measureForChildren, context)) {\r\n                        if (child.isVisible && !child.notRenderable) {\r\n                            if (this.adaptWidthToChildren && child._width.isPixel) {\r\n                                computedWidth = Math.max(computedWidth, child._currentMeasure.width + child._paddingLeftInPixels + child._paddingRightInPixels);\r\n                            }\r\n                            if (this.adaptHeightToChildren && child._height.isPixel) {\r\n                                computedHeight = Math.max(computedHeight, child._currentMeasure.height + child._paddingTopInPixels + child._paddingBottomInPixels);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (this.adaptWidthToChildren && computedWidth >= 0) {\r\n                    computedWidth += this.paddingLeftInPixels + this.paddingRightInPixels;\r\n                    if (this.width !== computedWidth + \"px\") {\r\n                        this.parent?._markAsDirty();\r\n                        this.width = computedWidth + \"px\";\r\n                        this._width.ignoreAdaptiveScaling = true;\r\n                        this._rebuildLayout = true;\r\n                    }\r\n                }\r\n                if (this.adaptHeightToChildren && computedHeight >= 0) {\r\n                    computedHeight += this.paddingTopInPixels + this.paddingBottomInPixels;\r\n                    if (this.height !== computedHeight + \"px\") {\r\n                        this.parent?._markAsDirty();\r\n                        this.height = computedHeight + \"px\";\r\n                        this._height.ignoreAdaptiveScaling = true;\r\n                        this._rebuildLayout = true;\r\n                    }\r\n                }\r\n\r\n                this._postMeasure();\r\n            }\r\n            rebuildCount++;\r\n        } while (this._rebuildLayout && rebuildCount < this.maxLayoutCycle);\r\n\r\n        if (rebuildCount >= 3 && this.logLayoutCycleErrors) {\r\n            Logger.Error(`Layout cycle detected in GUI (Container name=${this.name}, uniqueId=${this.uniqueId})`);\r\n        }\r\n\r\n        context.restore();\r\n\r\n        if (this._isDirty) {\r\n            this.invalidateRect();\r\n\r\n            this._isDirty = false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    protected _postMeasure() {\r\n        // Do nothing by default\r\n    }\r\n\r\n    private _inverseTransformMatrix = Matrix2D.Identity();\r\n    private _inverseMeasure = new Measure(0, 0, 0, 0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _draw(context: ICanvasRenderingContext, invalidatedRectangle?: Measure): void {\r\n        const renderToIntermediateTextureThisDraw = this._renderToIntermediateTexture && this._intermediateTexture;\r\n        const contextToDrawTo = renderToIntermediateTextureThisDraw ? (<DynamicTexture>this._intermediateTexture).getContext() : context;\r\n\r\n        if (renderToIntermediateTextureThisDraw) {\r\n            contextToDrawTo.save();\r\n            contextToDrawTo.translate(-this._currentMeasure.left, -this._currentMeasure.top);\r\n            if (invalidatedRectangle) {\r\n                this._transformMatrix.invertToRef(this._inverseTransformMatrix);\r\n                invalidatedRectangle.transformToRef(this._inverseTransformMatrix, this._inverseMeasure);\r\n                contextToDrawTo.clearRect(this._inverseMeasure.left, this._inverseMeasure.top, this._inverseMeasure.width, this._inverseMeasure.height);\r\n            } else {\r\n                contextToDrawTo.clearRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n            }\r\n        }\r\n\r\n        this._localDraw(contextToDrawTo);\r\n\r\n        context.save();\r\n\r\n        if (this.clipChildren) {\r\n            this._clipForChildren(contextToDrawTo);\r\n        }\r\n\r\n        for (const child of this._children) {\r\n            // Only redraw parts of the screen that are invalidated\r\n            if (invalidatedRectangle) {\r\n                if (!child._intersectsRect(invalidatedRectangle)) {\r\n                    continue;\r\n                }\r\n            }\r\n            child._render(contextToDrawTo, invalidatedRectangle);\r\n        }\r\n\r\n        if (renderToIntermediateTextureThisDraw) {\r\n            contextToDrawTo.restore();\r\n            context.save();\r\n            context.globalAlpha = this.alpha;\r\n            context.drawImage(contextToDrawTo.canvas, this._currentMeasure.left, this._currentMeasure.top);\r\n            context.restore();\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    public getDescendantsToRef(results: Control[], directDescendantsOnly: boolean = false, predicate?: (control: Control) => boolean): void {\r\n        if (!this.children) {\r\n            return;\r\n        }\r\n\r\n        for (let index = 0; index < this.children.length; index++) {\r\n            const item = this.children[index];\r\n\r\n            if (!predicate || predicate(item)) {\r\n                results.push(item);\r\n            }\r\n\r\n            if (!directDescendantsOnly) {\r\n                item.getDescendantsToRef(results, false, predicate);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _processPicking(x: number, y: number, pi: Nullable<PointerInfoBase>, type: number, pointerId: number, buttonIndex: number, deltaX?: number, deltaY?: number): boolean {\r\n        if (!this._isEnabled || !this.isVisible || this.notRenderable) {\r\n            return false;\r\n        }\r\n\r\n        // checks if the picking position is within the container\r\n        const contains = super.contains(x, y);\r\n\r\n        // if clipChildren is off, we should still pass picking events to children even if we don't contain the pointer\r\n        if (!contains && this.clipChildren) {\r\n            return false;\r\n        }\r\n\r\n        // Checking backwards to pick closest first\r\n        for (let index = this._children.length - 1; index >= 0; index--) {\r\n            const child = this._children[index];\r\n            if (child._processPicking(x, y, pi, type, pointerId, buttonIndex, deltaX, deltaY)) {\r\n                if (child.hoverCursor) {\r\n                    this._host._changeCursor(child.hoverCursor);\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!contains) {\r\n            return false;\r\n        }\r\n\r\n        if (!this.isHitTestVisible) {\r\n            return false;\r\n        }\r\n\r\n        return this._processObservables(type, x, y, pi, pointerId, buttonIndex, deltaX, deltaY);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        super._additionalProcessing(parentMeasure, context);\r\n\r\n        this._measureForChildren.copyFrom(this._currentMeasure);\r\n    }\r\n\r\n    /**\r\n     * Serializes the current control\r\n     * @param serializationObject defined the JSON serialized object\r\n     */\r\n    public serialize(serializationObject: any) {\r\n        super.serialize(serializationObject);\r\n\r\n        if (this.backgroundGradient) {\r\n            serializationObject.backgroundGradient = {};\r\n            this.backgroundGradient.serialize(serializationObject.backgroundGradient);\r\n        }\r\n\r\n        if (!this.children.length) {\r\n            return;\r\n        }\r\n\r\n        serializationObject.children = [];\r\n\r\n        for (const child of this.children) {\r\n            const childSerializationObject = {};\r\n            child.serialize(childSerializationObject);\r\n            serializationObject.children.push(childSerializationObject);\r\n        }\r\n    }\r\n\r\n    /** Releases associated resources */\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        for (let index = this.children.length - 1; index >= 0; index--) {\r\n            this.children[index].dispose();\r\n        }\r\n        this._intermediateTexture?.dispose();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        super._parseFromContent(serializedObject, host);\r\n        this._link(host);\r\n\r\n        // Gradient\r\n        if (serializedObject.backgroundGradient) {\r\n            const className = Tools.Instantiate(\"BABYLON.GUI.\" + serializedObject.backgroundGradient.className);\r\n            this._backgroundGradient = new className();\r\n            this._backgroundGradient?.parse(serializedObject.backgroundGradient);\r\n        }\r\n\r\n        if (!serializedObject.children) {\r\n            return;\r\n        }\r\n\r\n        for (const childData of serializedObject.children) {\r\n            this.addControl(Control.Parse(childData, host));\r\n        }\r\n    }\r\n\r\n    public isReady(): boolean {\r\n        for (const child of this.children) {\r\n            if (!child.isReady()) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Container\", Container);\r\n","import { Container } from \"./container\";\r\nimport type { Measure } from \"../measure\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/** Class used to create rectangle container */\r\nexport class Rectangle extends Container {\r\n    private _thickness = 1;\r\n    private _cornerRadius = [0, 0, 0, 0];\r\n    private _cachedRadius = [0, 0, 0, 0];\r\n\r\n    /** Gets or sets border thickness */\r\n    @serialize()\r\n    public get thickness(): number {\r\n        return this._thickness;\r\n    }\r\n\r\n    public set thickness(value: number) {\r\n        if (this._thickness === value) {\r\n            return;\r\n        }\r\n\r\n        this._thickness = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the corner radius of all angles */\r\n    @serialize()\r\n    public get cornerRadius(): number {\r\n        return this._cornerRadius[0];\r\n    }\r\n\r\n    public set cornerRadius(value: number) {\r\n        if (value < 0) {\r\n            value = 0;\r\n        }\r\n\r\n        if (this._cornerRadius[0] === value && this._cornerRadius[1] === value && this._cornerRadius[2] === value && this._cornerRadius[3] === value) {\r\n            return;\r\n        }\r\n\r\n        this._cornerRadius[0] = this._cornerRadius[1] = this._cornerRadius[2] = this._cornerRadius[3] = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the corner radius top left angle */\r\n    @serialize()\r\n    public get cornerRadiusX(): number {\r\n        return this._cornerRadius[0];\r\n    }\r\n\r\n    public set cornerRadiusX(value: number) {\r\n        if (this._cornerRadius[0] === value) {\r\n            return;\r\n        }\r\n        this._cornerRadius[0] = value;\r\n    }\r\n\r\n    /** Gets or sets the corner radius top right angle */\r\n    @serialize()\r\n    public get cornerRadiusY(): number {\r\n        return this._cornerRadius[1];\r\n    }\r\n\r\n    public set cornerRadiusY(value: number) {\r\n        if (this._cornerRadius[1] === value) {\r\n            return;\r\n        }\r\n        this._cornerRadius[1] = value;\r\n    }\r\n\r\n    /** Gets or sets the corner radius bottom left angle */\r\n    @serialize()\r\n    public get cornerRadiusZ(): number {\r\n        return this._cornerRadius[2];\r\n    }\r\n\r\n    public set cornerRadiusZ(value: number) {\r\n        if (this._cornerRadius[2] === value) {\r\n            return;\r\n        }\r\n        this._cornerRadius[2] = value;\r\n    }\r\n\r\n    /** Gets or sets the corner radius bottom right angle */\r\n    @serialize()\r\n    public get cornerRadiusW(): number {\r\n        return this._cornerRadius[3];\r\n    }\r\n\r\n    public set cornerRadiusW(value: number) {\r\n        if (this._cornerRadius[3] === value) {\r\n            return;\r\n        }\r\n        this._cornerRadius[3] = value;\r\n    }\r\n\r\n    /**\r\n     * Creates a new Rectangle\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Rectangle\";\r\n    }\r\n\r\n    /** @internal */\r\n    protected _computeAdditionnalOffsetX() {\r\n        if (this._cornerRadius[0] !== 0 || this._cornerRadius[1] !== 0 || this._cornerRadius[2] !== 0 || this._cornerRadius[3] !== 0) {\r\n            // Take in account the aliasing\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    /** @internal */\r\n    protected _computeAdditionnalOffsetY() {\r\n        if (this._cornerRadius[0] !== 0 || this._cornerRadius[1] !== 0 || this._cornerRadius[2] !== 0 || this._cornerRadius[3] !== 0) {\r\n            // Take in account the aliasing\r\n            return 1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    protected _getRectangleFill(context: ICanvasRenderingContext) {\r\n        return this._getBackgroundColor(context);\r\n    }\r\n\r\n    protected _localDraw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        if (this._background || this._backgroundGradient) {\r\n            context.fillStyle = this._getRectangleFill(context);\r\n\r\n            if (this._cornerRadius[0] !== 0 || this._cornerRadius[1] !== 0 || this._cornerRadius[2] !== 0 || this._cornerRadius[3] !== 0) {\r\n                this._drawRoundedRect(context, this._thickness / 2);\r\n                context.fill();\r\n            } else {\r\n                context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n            }\r\n        }\r\n\r\n        if (this._thickness) {\r\n            if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n                context.shadowBlur = 0;\r\n                context.shadowOffsetX = 0;\r\n                context.shadowOffsetY = 0;\r\n            }\r\n\r\n            if (this.color || this.gradient) {\r\n                context.strokeStyle = this.gradient ? this.gradient.getCanvasGradient(context) : this.color;\r\n            }\r\n            context.lineWidth = this._thickness;\r\n\r\n            if (this._cornerRadius[0] !== 0 || this._cornerRadius[1] !== 0 || this._cornerRadius[2] !== 0 || this._cornerRadius[3] !== 0) {\r\n                this._drawRoundedRect(context, this._thickness / 2);\r\n                context.stroke();\r\n            } else {\r\n                context.strokeRect(\r\n                    this._currentMeasure.left + this._thickness / 2,\r\n                    this._currentMeasure.top + this._thickness / 2,\r\n                    this._currentMeasure.width - this._thickness,\r\n                    this._currentMeasure.height - this._thickness\r\n                );\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        super._additionalProcessing(parentMeasure, context);\r\n\r\n        this._measureForChildren.width -= 2 * this._thickness;\r\n        this._measureForChildren.height -= 2 * this._thickness;\r\n        this._measureForChildren.left += this._thickness;\r\n        this._measureForChildren.top += this._thickness;\r\n    }\r\n\r\n    private _drawRoundedRect(context: ICanvasRenderingContext, offset: number = 0): void {\r\n        const x = this._currentMeasure.left + offset;\r\n        const y = this._currentMeasure.top + offset;\r\n        const width = this._currentMeasure.width - offset * 2;\r\n        const height = this._currentMeasure.height - offset * 2;\r\n\r\n        for (let index = 0; index < this._cornerRadius.length; index++) {\r\n            this._cachedRadius[index] = Math.abs(Math.min(height / 2, Math.min(width / 2, this._cornerRadius[index])));\r\n        }\r\n\r\n        context.beginPath();\r\n        context.moveTo(x + this._cachedRadius[0], y);\r\n        context.lineTo(x + width - this._cachedRadius[1], y);\r\n        context.arc(x + width - this._cachedRadius[1], y + this._cachedRadius[1], this._cachedRadius[1], (3 * Math.PI) / 2, Math.PI * 2);\r\n        context.lineTo(x + width, y + height - this._cachedRadius[2]);\r\n        context.arc(x + width - this._cachedRadius[2], y + height - this._cachedRadius[2], this._cachedRadius[2], 0, Math.PI / 2);\r\n        context.lineTo(x + this._cachedRadius[3], y + height);\r\n        context.arc(x + this._cachedRadius[3], y + height - this._cachedRadius[3], this._cachedRadius[3], Math.PI / 2, Math.PI);\r\n        context.lineTo(x, y + this._cachedRadius[0]);\r\n        context.arc(x + this._cachedRadius[0], y + this._cachedRadius[0], this._cachedRadius[0], Math.PI, (3 * Math.PI) / 2);\r\n        context.closePath();\r\n    }\r\n\r\n    protected _clipForChildren(context: ICanvasRenderingContext) {\r\n        if (this._cornerRadius[0] !== 0 || this._cornerRadius[1] !== 0 || this._cornerRadius[2] !== 0 || this._cornerRadius[3] !== 0) {\r\n            this._drawRoundedRect(context, this._thickness);\r\n            context.clip();\r\n        }\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Rectangle\", Rectangle);\r\n","import { Observable } from \"core/Misc/observable\";\r\nimport type { Measure } from \"../measure\";\r\nimport { ValueAndUnit } from \"../valueAndUnit\";\r\nimport { Control } from \"./control\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { Nullable } from \"core/types\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext, ITextMetrics } from \"core/Engines/ICanvas\";\r\nimport { EngineStore } from \"core/Engines/engineStore\";\r\n\r\n/**\r\n * Enum that determines the text-wrapping mode to use.\r\n */\r\nexport enum TextWrapping {\r\n    /**\r\n     * Clip the text when it's larger than Control.width; this is the default mode.\r\n     */\r\n    Clip = 0,\r\n\r\n    /**\r\n     * Wrap the text word-wise, i.e. try to add line-breaks at word boundary to fit within Control.width.\r\n     */\r\n    WordWrap = 1,\r\n\r\n    /**\r\n     * Ellipsize the text, i.e. shrink with trailing  when text is larger than Control.width.\r\n     */\r\n    Ellipsis = 2,\r\n\r\n    /**\r\n     * Wrap the text word-wise and clip the text when the text's height is larger than the Control.height, and shrink the last line with trailing  .\r\n     */\r\n    WordWrapEllipsis,\r\n}\r\n\r\n/**\r\n * Class used to create text block control\r\n */\r\nexport class TextBlock extends Control {\r\n    private _text = \"\";\r\n    private _textWrapping = TextWrapping.Clip;\r\n    private _textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n    private _textVerticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n\r\n    private _lines: any[];\r\n    private _resizeToFit: boolean = false;\r\n    private _lineSpacing: ValueAndUnit = new ValueAndUnit(0);\r\n    private _outlineWidth: number = 0;\r\n    private _outlineColor: string = \"white\";\r\n    private _underline: boolean = false;\r\n    private _lineThrough: boolean = false;\r\n    private _wordDivider: string = \" \";\r\n    private _forceResizeWidth: boolean = false;\r\n    private _applyOutlineToUnderline: boolean = false;\r\n\r\n    /**\r\n     * An event triggered after the text is changed\r\n     */\r\n    public onTextChangedObservable = new Observable<TextBlock>();\r\n\r\n    /**\r\n     * An event triggered after the text was broken up into lines\r\n     */\r\n    public onLinesReadyObservable = new Observable<TextBlock>();\r\n\r\n    /**\r\n     * Function used to split a string into words. By default, a string is split at each space character found\r\n     */\r\n    public wordSplittingFunction: Nullable<(line: string) => string[]>;\r\n\r\n    /**\r\n     * Return the line list (you may need to use the onLinesReadyObservable to make sure the list is ready)\r\n     */\r\n    public get lines(): any[] {\r\n        return this._lines;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets an boolean indicating that the TextBlock will be resized to fit container\r\n     */\r\n    @serialize()\r\n    public get resizeToFit(): boolean {\r\n        return this._resizeToFit;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets an boolean indicating that the TextBlock will be resized to fit container\r\n     */\r\n    public set resizeToFit(value: boolean) {\r\n        if (this._resizeToFit === value) {\r\n            return;\r\n        }\r\n        this._resizeToFit = value;\r\n\r\n        if (this._resizeToFit) {\r\n            this._width.ignoreAdaptiveScaling = true;\r\n            this._height.ignoreAdaptiveScaling = true;\r\n        }\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if text must be wrapped\r\n     */\r\n    @serialize()\r\n    public get textWrapping(): TextWrapping | boolean {\r\n        return this._textWrapping;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if text must be wrapped\r\n     */\r\n    public set textWrapping(value: TextWrapping | boolean) {\r\n        if (this._textWrapping === value) {\r\n            return;\r\n        }\r\n        this._textWrapping = +value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text to display\r\n     */\r\n    @serialize()\r\n    public get text(): string {\r\n        return this._text;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text to display\r\n     */\r\n    public set text(value: string) {\r\n        if (this._text === value) {\r\n            return;\r\n        }\r\n        this._text = value + \"\"; // Making sure it is a text\r\n        this._markAsDirty();\r\n\r\n        this.onTextChangedObservable.notifyObservers(this);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text horizontal alignment (BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER by default)\r\n     */\r\n    @serialize()\r\n    public get textHorizontalAlignment(): number {\r\n        return this._textHorizontalAlignment;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text horizontal alignment (BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_CENTER by default)\r\n     */\r\n    public set textHorizontalAlignment(value: number) {\r\n        if (this._textHorizontalAlignment === value) {\r\n            return;\r\n        }\r\n\r\n        this._textHorizontalAlignment = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text vertical alignment (BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER by default)\r\n     */\r\n    @serialize()\r\n    public get textVerticalAlignment(): number {\r\n        return this._textVerticalAlignment;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text vertical alignment (BABYLON.GUI.Control.VERTICAL_ALIGNMENT_CENTER by default)\r\n     */\r\n    public set textVerticalAlignment(value: number) {\r\n        if (this._textVerticalAlignment === value) {\r\n            return;\r\n        }\r\n\r\n        this._textVerticalAlignment = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets line spacing value\r\n     */\r\n    @serialize()\r\n    public set lineSpacing(value: string | number) {\r\n        if (this._lineSpacing.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets line spacing value\r\n     */\r\n    public get lineSpacing(): string | number {\r\n        return this._lineSpacing.toString(this._host);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets outlineWidth of the text to display\r\n     */\r\n    @serialize()\r\n    public get outlineWidth(): number {\r\n        return this._outlineWidth;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets outlineWidth of the text to display\r\n     */\r\n    public set outlineWidth(value: number) {\r\n        if (this._outlineWidth === value) {\r\n            return;\r\n        }\r\n        this._outlineWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that text must have underline\r\n     */\r\n    @serialize()\r\n    public get underline(): boolean {\r\n        return this._underline;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that text must have underline\r\n     */\r\n    public set underline(value: boolean) {\r\n        if (this._underline === value) {\r\n            return;\r\n        }\r\n        this._underline = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets an boolean indicating that text must be crossed out\r\n     */\r\n    @serialize()\r\n    public get lineThrough(): boolean {\r\n        return this._lineThrough;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets an boolean indicating that text must be crossed out\r\n     */\r\n    public set lineThrough(value: boolean) {\r\n        if (this._lineThrough === value) {\r\n            return;\r\n        }\r\n        this._lineThrough = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * If the outline should be applied to the underline/strike-through too. Has different behavior in Edge/Chrome vs Firefox.\r\n     */\r\n    @serialize()\r\n    public get applyOutlineToUnderline(): boolean {\r\n        return this._applyOutlineToUnderline;\r\n    }\r\n\r\n    public set applyOutlineToUnderline(value: boolean) {\r\n        if (this._applyOutlineToUnderline === value) {\r\n            return;\r\n        }\r\n        this._applyOutlineToUnderline = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets outlineColor of the text to display\r\n     */\r\n    @serialize()\r\n    public get outlineColor(): string {\r\n        return this._outlineColor;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets outlineColor of the text to display\r\n     */\r\n    public set outlineColor(value: string) {\r\n        if (this._outlineColor === value) {\r\n            return;\r\n        }\r\n        this._outlineColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets word divider\r\n     */\r\n    @serialize()\r\n    public get wordDivider(): string {\r\n        return this._wordDivider;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets word divider\r\n     */\r\n    public set wordDivider(value: string) {\r\n        if (this._wordDivider === value) {\r\n            return;\r\n        }\r\n        this._wordDivider = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * By default, if a text block has text wrapping other than Clip, its width\r\n     * is not resized even if resizeToFit = true. This parameter forces the width\r\n     * to be resized.\r\n     */\r\n    @serialize()\r\n    public get forceResizeWidth(): boolean {\r\n        return this._forceResizeWidth;\r\n    }\r\n\r\n    public set forceResizeWidth(value: boolean) {\r\n        if (this._forceResizeWidth === value) {\r\n            return;\r\n        }\r\n        this._forceResizeWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new TextBlock object\r\n     * @param name defines the name of the control\r\n     * @param text defines the text to display (empty string by default)\r\n     */\r\n    constructor(\r\n        /**\r\n         * Defines the name of the control\r\n         */\r\n        public name?: string,\r\n        text: string = \"\"\r\n    ) {\r\n        super(name);\r\n\r\n        this.text = text;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"TextBlock\";\r\n    }\r\n\r\n    protected _processMeasures(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        if (!this._fontOffset || this.isDirty) {\r\n            this._fontOffset = Control._GetFontOffset(context.font);\r\n        }\r\n        super._processMeasures(parentMeasure, context);\r\n\r\n        // Prepare lines\r\n        this._lines = this._breakLines(this._currentMeasure.width, this._currentMeasure.height, context);\r\n        this.onLinesReadyObservable.notifyObservers(this);\r\n\r\n        let maxLineWidth: number = 0;\r\n\r\n        for (let i = 0; i < this._lines.length; i++) {\r\n            const line = this._lines[i];\r\n\r\n            if (line.width > maxLineWidth) {\r\n                maxLineWidth = line.width;\r\n            }\r\n        }\r\n\r\n        if (this._resizeToFit) {\r\n            if (this._textWrapping === TextWrapping.Clip || this._forceResizeWidth) {\r\n                const newWidth = Math.ceil(this._paddingLeftInPixels) + Math.ceil(this._paddingRightInPixels) + Math.ceil(maxLineWidth);\r\n                if (newWidth !== this._width.getValueInPixel(this._host, this._tempParentMeasure.width)) {\r\n                    this._width.updateInPlace(newWidth, ValueAndUnit.UNITMODE_PIXEL);\r\n                    this._rebuildLayout = true;\r\n                }\r\n            }\r\n            let newHeight = (this._paddingTopInPixels + this._paddingBottomInPixels + this._fontOffset.height * this._lines.length) | 0;\r\n\r\n            if (this._lines.length > 0 && this._lineSpacing.internalValue !== 0) {\r\n                let lineSpacing = 0;\r\n                if (this._lineSpacing.isPixel) {\r\n                    lineSpacing = this._lineSpacing.getValue(this._host);\r\n                } else {\r\n                    lineSpacing = this._lineSpacing.getValue(this._host) * this._height.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n                }\r\n\r\n                newHeight += (this._lines.length - 1) * lineSpacing;\r\n            }\r\n\r\n            if (newHeight !== this._height.internalValue) {\r\n                this._height.updateInPlace(newHeight, ValueAndUnit.UNITMODE_PIXEL);\r\n                this._rebuildLayout = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _drawText(text: string, textWidth: number, y: number, context: ICanvasRenderingContext): void {\r\n        const width = this._currentMeasure.width;\r\n        let x = 0;\r\n        switch (this._textHorizontalAlignment) {\r\n            case Control.HORIZONTAL_ALIGNMENT_LEFT:\r\n                x = 0;\r\n                break;\r\n            case Control.HORIZONTAL_ALIGNMENT_RIGHT:\r\n                x = width - textWidth;\r\n                break;\r\n            case Control.HORIZONTAL_ALIGNMENT_CENTER:\r\n                x = (width - textWidth) / 2;\r\n                break;\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        if (this.outlineWidth) {\r\n            context.strokeText(text, this._currentMeasure.left + x, y);\r\n        }\r\n        context.fillText(text, this._currentMeasure.left + x, y);\r\n\r\n        if (this._underline) {\r\n            this._drawLine(this._currentMeasure.left + x, y + 3, this._currentMeasure.left + x + textWidth, y + 3, context);\r\n        }\r\n\r\n        if (this._lineThrough) {\r\n            this._drawLine(this._currentMeasure.left + x, y - this.fontSizeInPixels / 3, this._currentMeasure.left + x + textWidth, y - this.fontSizeInPixels / 3, context);\r\n        }\r\n    }\r\n\r\n    private _drawLine(xFrom: number, yFrom: number, xTo: number, yTo: number, context: ICanvasRenderingContext): void {\r\n        context.beginPath();\r\n        context.lineWidth = Math.round(this.fontSizeInPixels * 0.05);\r\n        context.moveTo(xFrom, yFrom);\r\n        context.lineTo(xTo, yTo);\r\n        if (this.outlineWidth && this.applyOutlineToUnderline) {\r\n            context.stroke();\r\n            context.fill();\r\n        } else {\r\n            const currentStroke = context.strokeStyle;\r\n            context.strokeStyle = context.fillStyle;\r\n            context.stroke();\r\n            context.strokeStyle = currentStroke;\r\n        }\r\n        context.closePath();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n\r\n        // Render lines\r\n        this._renderLines(context);\r\n\r\n        context.restore();\r\n    }\r\n\r\n    protected _applyStates(context: ICanvasRenderingContext): void {\r\n        super._applyStates(context);\r\n        if (this.outlineWidth) {\r\n            context.lineWidth = this.outlineWidth;\r\n            context.strokeStyle = this.outlineColor;\r\n            context.lineJoin = \"miter\";\r\n            context.miterLimit = 2;\r\n        }\r\n    }\r\n\r\n    private _linesTemp: object[] = [];\r\n\r\n    protected _breakLines(refWidth: number, refHeight: number, context: ICanvasRenderingContext): object[] {\r\n        this._linesTemp.length = 0;\r\n        const _lines = this.text.split(\"\\n\");\r\n\r\n        if (this._textWrapping === TextWrapping.Ellipsis) {\r\n            for (const _line of _lines) {\r\n                this._linesTemp.push(this._parseLineEllipsis(_line, refWidth, context));\r\n            }\r\n        } else if (this._textWrapping === TextWrapping.WordWrap) {\r\n            for (const _line of _lines) {\r\n                this._linesTemp.push(...this._parseLineWordWrap(_line, refWidth, context));\r\n            }\r\n        } else if (this._textWrapping === TextWrapping.WordWrapEllipsis) {\r\n            for (const _line of _lines) {\r\n                this._linesTemp.push(...this._parseLineWordWrapEllipsis(_line, refWidth, refHeight!, context));\r\n            }\r\n        } else {\r\n            for (const _line of _lines) {\r\n                this._linesTemp.push(this._parseLine(_line, context));\r\n            }\r\n        }\r\n\r\n        return this._linesTemp;\r\n    }\r\n\r\n    protected _parseLine(line: string = \"\", context: ICanvasRenderingContext): object {\r\n        return { text: line, width: this._getTextMetricsWidth(context.measureText(line)) };\r\n    }\r\n\r\n    //Calculate how many characters approximately we need to remove\r\n    private _getCharsToRemove(lineWidth: number, width: number, lineLength: number) {\r\n        const diff = lineWidth > width ? lineWidth - width : 0;\r\n        // This isn't exact unless the font is monospaced\r\n        const charWidth = lineWidth / lineLength;\r\n        const removeChars = Math.max(Math.floor(diff / charWidth), 1);\r\n        return removeChars;\r\n    }\r\n\r\n    protected _parseLineEllipsis(line: string = \"\", width: number, context: ICanvasRenderingContext): object {\r\n        let lineWidth = this._getTextMetricsWidth(context.measureText(line));\r\n\r\n        let removeChars = this._getCharsToRemove(lineWidth, width, line.length);\r\n\r\n        // unicode support. split('') does not work with unicode!\r\n        // make sure Array.from is available\r\n        const characters = Array.from && Array.from(line);\r\n        if (!characters) {\r\n            // no array.from, use the old method\r\n            while (line.length > 2 && lineWidth > width) {\r\n                line = line.slice(0, -removeChars);\r\n                lineWidth = this._getTextMetricsWidth(context.measureText(line + \"\"));\r\n\r\n                removeChars = this._getCharsToRemove(lineWidth, width, line.length);\r\n            }\r\n            // Add on the end\r\n            line += \"\";\r\n        } else {\r\n            while (characters.length && lineWidth > width) {\r\n                characters.splice(characters.length - removeChars, removeChars);\r\n                line = `${characters.join(\"\")}`;\r\n                lineWidth = this._getTextMetricsWidth(context.measureText(line));\r\n\r\n                removeChars = this._getCharsToRemove(lineWidth, width, line.length);\r\n            }\r\n        }\r\n\r\n        return { text: line, width: lineWidth };\r\n    }\r\n\r\n    private _getTextMetricsWidth(textMetrics: ITextMetrics) {\r\n        if (textMetrics.actualBoundingBoxLeft !== undefined) {\r\n            return Math.abs(textMetrics.actualBoundingBoxLeft) + Math.abs(textMetrics.actualBoundingBoxRight);\r\n        }\r\n        return textMetrics.width;\r\n    }\r\n\r\n    protected _parseLineWordWrap(line: string = \"\", width: number, context: ICanvasRenderingContext): object[] {\r\n        const lines = [];\r\n        const words = this.wordSplittingFunction ? this.wordSplittingFunction(line) : line.split(this._wordDivider);\r\n        let lineWidth = this._getTextMetricsWidth(context.measureText(line));\r\n\r\n        for (let n = 0; n < words.length; n++) {\r\n            const testLine = n > 0 ? line + this._wordDivider + words[n] : words[0];\r\n            const testWidth = this._getTextMetricsWidth(context.measureText(testLine));\r\n            if (testWidth > width && n > 0) {\r\n                lines.push({ text: line, width: lineWidth });\r\n                line = words[n];\r\n                lineWidth = this._getTextMetricsWidth(context.measureText(line));\r\n            } else {\r\n                lineWidth = testWidth;\r\n                line = testLine;\r\n            }\r\n        }\r\n        lines.push({ text: line, width: lineWidth });\r\n\r\n        return lines;\r\n    }\r\n\r\n    protected _parseLineWordWrapEllipsis(line: string = \"\", width: number, height: number, context: ICanvasRenderingContext): object[] {\r\n        const lines = this._parseLineWordWrap(line, width, context);\r\n        for (let n = 1; n <= lines.length; n++) {\r\n            const currentHeight = this._computeHeightForLinesOf(n);\r\n            if (currentHeight > height && n > 1) {\r\n                const lastLine = lines[n - 2] as { text: string; width: number };\r\n                const currentLine = lines[n - 1] as { text: string; width: number };\r\n                lines[n - 2] = this._parseLineEllipsis(lastLine.text + this._wordDivider + currentLine.text, width, context);\r\n                const linesToRemove = lines.length - n + 1;\r\n                for (let i = 0; i < linesToRemove; i++) {\r\n                    lines.pop();\r\n                }\r\n                return lines;\r\n            }\r\n        }\r\n\r\n        return lines;\r\n    }\r\n\r\n    protected _renderLines(context: ICanvasRenderingContext): void {\r\n        if (!this._fontOffset || !this._lines) {\r\n            return;\r\n        }\r\n        const height = this._currentMeasure.height;\r\n        let rootY = 0;\r\n        switch (this._textVerticalAlignment) {\r\n            case Control.VERTICAL_ALIGNMENT_TOP:\r\n                rootY = this._fontOffset.ascent;\r\n                break;\r\n            case Control.VERTICAL_ALIGNMENT_BOTTOM:\r\n                rootY = height - this._fontOffset.height * (this._lines.length - 1) - this._fontOffset.descent;\r\n                break;\r\n            case Control.VERTICAL_ALIGNMENT_CENTER:\r\n                rootY = this._fontOffset.ascent + (height - this._fontOffset.height * this._lines.length) / 2;\r\n                break;\r\n        }\r\n\r\n        rootY += this._currentMeasure.top;\r\n\r\n        for (let i = 0; i < this._lines.length; i++) {\r\n            const line = this._lines[i];\r\n\r\n            if (i !== 0 && this._lineSpacing.internalValue !== 0) {\r\n                if (this._lineSpacing.isPixel) {\r\n                    rootY += this._lineSpacing.getValue(this._host);\r\n                } else {\r\n                    rootY = rootY + this._lineSpacing.getValue(this._host) * this._height.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n                }\r\n            }\r\n\r\n            this._drawText(line.text, line.width, rootY, context);\r\n            rootY += this._fontOffset.height;\r\n        }\r\n    }\r\n\r\n    private _computeHeightForLinesOf(lineCount: number): number {\r\n        let newHeight = this._paddingTopInPixels + this._paddingBottomInPixels + this._fontOffset.height * lineCount;\r\n\r\n        if (lineCount > 0 && this._lineSpacing.internalValue !== 0) {\r\n            let lineSpacing = 0;\r\n            if (this._lineSpacing.isPixel) {\r\n                lineSpacing = this._lineSpacing.getValue(this._host);\r\n            } else {\r\n                lineSpacing = this._lineSpacing.getValue(this._host) * this._height.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n            }\r\n\r\n            newHeight += (lineCount - 1) * lineSpacing;\r\n        }\r\n\r\n        return newHeight;\r\n    }\r\n\r\n    /**\r\n     * Given a width constraint applied on the text block, find the expected height\r\n     * @returns expected height\r\n     */\r\n    public computeExpectedHeight(): number {\r\n        if (this.text && this.widthInPixels) {\r\n            // Should abstract platform instead of using LastCreatedEngine\r\n            const context = EngineStore.LastCreatedEngine?.createCanvas(0, 0).getContext(\"2d\");\r\n            if (context) {\r\n                this._applyStates(context);\r\n                if (!this._fontOffset) {\r\n                    this._fontOffset = Control._GetFontOffset(context.font);\r\n                }\r\n                const lines = this._lines\r\n                    ? this._lines\r\n                    : this._breakLines(\r\n                          this.widthInPixels - this._paddingLeftInPixels - this._paddingRightInPixels,\r\n                          this.heightInPixels - this._paddingTopInPixels - this._paddingBottomInPixels,\r\n                          context\r\n                      );\r\n                return this._computeHeightForLinesOf(lines.length);\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    dispose(): void {\r\n        super.dispose();\r\n\r\n        this.onTextChangedObservable.clear();\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.TextBlock\", TextBlock);\r\n","import type { Nullable } from \"core/types\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport { Tools } from \"core/Misc/tools\";\r\n\r\nimport { Control } from \"./control\";\r\nimport type { Measure } from \"../measure\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvas, ICanvasRenderingContext, IImage } from \"core/Engines/ICanvas\";\r\nimport { EngineStore } from \"core/Engines/engineStore\";\r\n\r\n/**\r\n * Class used to create 2D images\r\n */\r\nexport class Image extends Control {\r\n    /**\r\n     *  Specifies an alternate text for the image, if the image for some reason cannot be displayed.\r\n     */\r\n    public alt?: string;\r\n\r\n    private _workingCanvas: Nullable<ICanvas> = null;\r\n\r\n    private _domImage: IImage;\r\n    private _imageWidth: number;\r\n    private _imageHeight: number;\r\n    private _loaded = false;\r\n    private _stretch = Image.STRETCH_FILL;\r\n    private _source: Nullable<string>;\r\n    private _autoScale = false;\r\n\r\n    private _sourceLeft = 0;\r\n    private _sourceTop = 0;\r\n    private _sourceWidth = 0;\r\n    private _sourceHeight = 0;\r\n    private _svgAttributesComputationCompleted: boolean = false;\r\n    private _isSVG: boolean = false;\r\n\r\n    private _cellWidth: number = 0;\r\n    private _cellHeight: number = 0;\r\n    private _cellId: number = -1;\r\n\r\n    private _sliceLeft: number;\r\n    private _sliceRight: number;\r\n    private _sliceTop: number;\r\n    private _sliceBottom: number;\r\n\r\n    private _populateNinePatchSlicesFromImage = false;\r\n\r\n    private _detectPointerOnOpaqueOnly: boolean;\r\n\r\n    private _imageDataCache: {\r\n        data: Uint8ClampedArray | null;\r\n        key: string;\r\n    } = { data: null, key: \"\" };\r\n\r\n    /**\r\n     * Cache of images to avoid loading the same image multiple times\r\n     */\r\n    public static SourceImgCache = new Map<string, { img: IImage; timesUsed: number; loaded: boolean; waitingForLoadCallback: Array<() => void> }>();\r\n\r\n    /**\r\n     * Observable notified when the content is loaded\r\n     */\r\n    public onImageLoadedObservable = new Observable<Image>();\r\n\r\n    /**\r\n     * Observable notified when _sourceLeft, _sourceTop, _sourceWidth and _sourceHeight are computed\r\n     */\r\n    public onSVGAttributesComputedObservable = new Observable<Image>();\r\n\r\n    /**\r\n     * Gets or sets the referrer policy to apply on the img element load request.\r\n     * You should set referrerPolicy before set the source of the image if you want to ensure the header will be present on the xhr loading request\r\n     */\r\n    public referrerPolicy: Nullable<ReferrerPolicy>;\r\n\r\n    /**\r\n     * Gets a boolean indicating that the content is loaded\r\n     */\r\n    public get isLoaded(): boolean {\r\n        return this._loaded;\r\n    }\r\n\r\n    public isReady(): boolean {\r\n        return this.isLoaded;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if pointers should only be validated on pixels with alpha > 0.\r\n     * Beware using this as this will consume more memory as the image has to be stored twice\r\n     */\r\n    @serialize()\r\n    public get detectPointerOnOpaqueOnly(): boolean {\r\n        return this._detectPointerOnOpaqueOnly;\r\n    }\r\n\r\n    public set detectPointerOnOpaqueOnly(value: boolean) {\r\n        if (this._detectPointerOnOpaqueOnly === value) {\r\n            return;\r\n        }\r\n\r\n        this._detectPointerOnOpaqueOnly = value;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the left value for slicing (9-patch)\r\n     */\r\n    @serialize()\r\n    public get sliceLeft(): number {\r\n        return this._sliceLeft;\r\n    }\r\n\r\n    public set sliceLeft(value: number) {\r\n        if (this._sliceLeft === value) {\r\n            return;\r\n        }\r\n\r\n        this._sliceLeft = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the right value for slicing (9-patch)\r\n     */\r\n    @serialize()\r\n    public get sliceRight(): number {\r\n        return this._sliceRight;\r\n    }\r\n\r\n    public set sliceRight(value: number) {\r\n        if (this._sliceRight === value) {\r\n            return;\r\n        }\r\n\r\n        this._sliceRight = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the top value for slicing (9-patch)\r\n     */\r\n    @serialize()\r\n    public get sliceTop(): number {\r\n        return this._sliceTop;\r\n    }\r\n\r\n    public set sliceTop(value: number) {\r\n        if (this._sliceTop === value) {\r\n            return;\r\n        }\r\n\r\n        this._sliceTop = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the bottom value for slicing (9-patch)\r\n     */\r\n    @serialize()\r\n    public get sliceBottom(): number {\r\n        return this._sliceBottom;\r\n    }\r\n\r\n    public set sliceBottom(value: number) {\r\n        if (this._sliceBottom === value) {\r\n            return;\r\n        }\r\n\r\n        this._sliceBottom = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the left coordinate in the source image\r\n     */\r\n    @serialize()\r\n    public get sourceLeft(): number {\r\n        return this._sourceLeft;\r\n    }\r\n\r\n    public set sourceLeft(value: number) {\r\n        if (this._sourceLeft === value) {\r\n            return;\r\n        }\r\n\r\n        this._sourceLeft = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the top coordinate in the source image\r\n     */\r\n    @serialize()\r\n    public get sourceTop(): number {\r\n        return this._sourceTop;\r\n    }\r\n\r\n    public set sourceTop(value: number) {\r\n        if (this._sourceTop === value) {\r\n            return;\r\n        }\r\n\r\n        this._sourceTop = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the width to capture in the source image\r\n     */\r\n    @serialize()\r\n    public get sourceWidth(): number {\r\n        return this._sourceWidth;\r\n    }\r\n\r\n    public set sourceWidth(value: number) {\r\n        if (this._sourceWidth === value) {\r\n            return;\r\n        }\r\n\r\n        this._sourceWidth = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the height to capture in the source image\r\n     */\r\n    @serialize()\r\n    public get sourceHeight(): number {\r\n        return this._sourceHeight;\r\n    }\r\n\r\n    public set sourceHeight(value: number) {\r\n        if (this._sourceHeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._sourceHeight = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets the image width\r\n     */\r\n    public get imageWidth(): number {\r\n        return this._imageWidth;\r\n    }\r\n\r\n    /**\r\n     * Gets the image height\r\n     */\r\n    public get imageHeight(): number {\r\n        return this._imageHeight;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if nine patch slices (left, top, right, bottom) should be read from image data\r\n     */\r\n    @serialize()\r\n    public get populateNinePatchSlicesFromImage(): boolean {\r\n        return this._populateNinePatchSlicesFromImage;\r\n    }\r\n\r\n    public set populateNinePatchSlicesFromImage(value: boolean) {\r\n        if (this._populateNinePatchSlicesFromImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._populateNinePatchSlicesFromImage = value;\r\n\r\n        if (this._populateNinePatchSlicesFromImage && this._loaded) {\r\n            this._extractNinePatchSliceDataFromImage();\r\n        }\r\n    }\r\n\r\n    /** Indicates if the format of the image is SVG */\r\n    public get isSVG(): boolean {\r\n        return this._isSVG;\r\n    }\r\n\r\n    /** Gets the status of the SVG attributes computation (sourceLeft, sourceTop, sourceWidth, sourceHeight) */\r\n    public get svgAttributesComputationCompleted(): boolean {\r\n        return this._svgAttributesComputationCompleted;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if the image can force its container to adapt its size\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#image\r\n     */\r\n    @serialize()\r\n    public get autoScale(): boolean {\r\n        return this._autoScale;\r\n    }\r\n\r\n    public set autoScale(value: boolean) {\r\n        if (this._autoScale === value) {\r\n            return;\r\n        }\r\n\r\n        this._autoScale = value;\r\n\r\n        if (value && this._loaded) {\r\n            this.synchronizeSizeWithContent();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the stretching mode used by the image */\r\n    @serialize()\r\n    public get stretch(): number {\r\n        return this._stretch;\r\n    }\r\n\r\n    public set stretch(value: number) {\r\n        if (this._stretch === value) {\r\n            return;\r\n        }\r\n\r\n        this._stretch = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _rotate90(n: number, preserveProperties: boolean = false): Image {\r\n        const width = this._domImage.width;\r\n        const height = this._domImage.height;\r\n\r\n        // Should abstract platform instead of using LastCreatedEngine\r\n        const engine = this._host?.getScene()?.getEngine() || EngineStore.LastCreatedEngine;\r\n        if (!engine) {\r\n            throw new Error(\"Invalid engine. Unable to create a canvas.\");\r\n        }\r\n        const canvas = engine.createCanvas(height, width);\r\n\r\n        const context = canvas.getContext(\"2d\")!;\r\n\r\n        context.translate(canvas.width / 2, canvas.height / 2);\r\n        context.rotate((n * Math.PI) / 2);\r\n\r\n        context.drawImage(this._domImage, 0, 0, width, height, -width / 2, -height / 2, width, height);\r\n\r\n        const dataUrl: string = canvas.toDataURL(\"image/jpg\");\r\n        const rotatedImage = new Image(this.name + \"rotated\", dataUrl);\r\n\r\n        if (preserveProperties) {\r\n            rotatedImage._stretch = this._stretch;\r\n            rotatedImage._autoScale = this._autoScale;\r\n            rotatedImage._cellId = this._cellId;\r\n            rotatedImage._cellWidth = n % 1 ? this._cellHeight : this._cellWidth;\r\n            rotatedImage._cellHeight = n % 1 ? this._cellWidth : this._cellHeight;\r\n        }\r\n\r\n        this._handleRotationForSVGImage(this, rotatedImage, n);\r\n\r\n        this._imageDataCache.data = null;\r\n\r\n        return rotatedImage;\r\n    }\r\n\r\n    private _handleRotationForSVGImage(srcImage: Image, dstImage: Image, n: number): void {\r\n        if (!srcImage._isSVG) {\r\n            return;\r\n        }\r\n\r\n        if (srcImage._svgAttributesComputationCompleted) {\r\n            this._rotate90SourceProperties(srcImage, dstImage, n);\r\n            this._markAsDirty();\r\n        } else {\r\n            srcImage.onSVGAttributesComputedObservable.addOnce(() => {\r\n                this._rotate90SourceProperties(srcImage, dstImage, n);\r\n                this._markAsDirty();\r\n            });\r\n        }\r\n    }\r\n\r\n    private _rotate90SourceProperties(srcImage: Image, dstImage: Image, n: number): void {\r\n        let srcLeft = srcImage.sourceLeft,\r\n            srcTop = srcImage.sourceTop,\r\n            srcWidth = srcImage.domImage.width,\r\n            srcHeight = srcImage.domImage.height;\r\n\r\n        let dstLeft = srcLeft,\r\n            dstTop = srcTop,\r\n            dstWidth = srcImage.sourceWidth,\r\n            dstHeight = srcImage.sourceHeight;\r\n\r\n        if (n != 0) {\r\n            const mult = n < 0 ? -1 : 1;\r\n            n = n % 4;\r\n            for (let i = 0; i < Math.abs(n); ++i) {\r\n                dstLeft = -(srcTop - srcHeight / 2) * mult + srcHeight / 2;\r\n                dstTop = (srcLeft - srcWidth / 2) * mult + srcWidth / 2;\r\n                [dstWidth, dstHeight] = [dstHeight, dstWidth];\r\n                if (n < 0) {\r\n                    dstTop -= dstHeight;\r\n                } else {\r\n                    dstLeft -= dstWidth;\r\n                }\r\n                srcLeft = dstLeft;\r\n                srcTop = dstTop;\r\n                [srcWidth, srcHeight] = [srcHeight, srcWidth];\r\n            }\r\n        }\r\n\r\n        dstImage.sourceLeft = dstLeft;\r\n        dstImage.sourceTop = dstTop;\r\n        dstImage.sourceWidth = dstWidth;\r\n        dstImage.sourceHeight = dstHeight;\r\n    }\r\n\r\n    private _extractNinePatchSliceDataFromImage() {\r\n        const width = this._domImage.width;\r\n        const height = this._domImage.height;\r\n\r\n        if (!this._workingCanvas) {\r\n            const engine = this._host?.getScene()?.getEngine() || EngineStore.LastCreatedEngine;\r\n            if (!engine) {\r\n                throw new Error(\"Invalid engine. Unable to create a canvas.\");\r\n            }\r\n            this._workingCanvas = engine.createCanvas(width, height);\r\n        }\r\n        const canvas = this._workingCanvas;\r\n        const context = canvas.getContext(\"2d\")!;\r\n\r\n        context.drawImage(this._domImage, 0, 0, width, height);\r\n        const imageData = context.getImageData(0, 0, width, height);\r\n\r\n        // Left and right\r\n        this._sliceLeft = -1;\r\n        this._sliceRight = -1;\r\n        for (let x = 0; x < width; x++) {\r\n            const alpha = imageData.data[x * 4 + 3];\r\n\r\n            if (alpha > 127 && this._sliceLeft === -1) {\r\n                this._sliceLeft = x;\r\n                continue;\r\n            }\r\n\r\n            if (alpha < 127 && this._sliceLeft > -1) {\r\n                this._sliceRight = x;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // top and bottom\r\n        this._sliceTop = -1;\r\n        this._sliceBottom = -1;\r\n        for (let y = 0; y < height; y++) {\r\n            const alpha = imageData.data[y * width * 4 + 3];\r\n\r\n            if (alpha > 127 && this._sliceTop === -1) {\r\n                this._sliceTop = y;\r\n                continue;\r\n            }\r\n\r\n            if (alpha < 127 && this._sliceTop > -1) {\r\n                this._sliceBottom = y;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the internal DOM image used to render the control\r\n     */\r\n    public set domImage(value: IImage) {\r\n        this._domImage = value;\r\n        this._loaded = false;\r\n        this._imageDataCache.data = null;\r\n\r\n        if (this._domImage.width) {\r\n            this._onImageLoaded();\r\n        } else {\r\n            this._domImage.onload = () => {\r\n                this._onImageLoaded();\r\n            };\r\n        }\r\n    }\r\n\r\n    public get domImage(): IImage {\r\n        return this._domImage;\r\n    }\r\n\r\n    private _onImageLoaded(): void {\r\n        this._imageDataCache.data = null;\r\n        this._imageWidth = this._domImage.width;\r\n        this._imageHeight = this._domImage.height;\r\n        this._loaded = true;\r\n\r\n        if (this._populateNinePatchSlicesFromImage) {\r\n            this._extractNinePatchSliceDataFromImage();\r\n        }\r\n\r\n        if (this._autoScale) {\r\n            this.synchronizeSizeWithContent();\r\n        }\r\n\r\n        this.onImageLoadedObservable.notifyObservers(this);\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets the image source url\r\n     */\r\n    @serialize()\r\n    public get source() {\r\n        return this._source;\r\n    }\r\n\r\n    /**\r\n     * Resets the internal Image Element cache. Can reduce memory usage.\r\n     */\r\n    public static ResetImageCache() {\r\n        Image.SourceImgCache.clear();\r\n    }\r\n\r\n    private _removeCacheUsage(source: Nullable<string>) {\r\n        const value = source && Image.SourceImgCache.get(source);\r\n        if (value) {\r\n            value.timesUsed -= 1;\r\n            // Since the image isn't being used anymore, we can clean it from the cache\r\n            if (value.timesUsed === 0) {\r\n                Image.SourceImgCache.delete(source);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets image source url\r\n     */\r\n    public set source(value: Nullable<string>) {\r\n        if (this._source === value) {\r\n            return;\r\n        }\r\n\r\n        this._removeCacheUsage(this._source);\r\n\r\n        this._loaded = false;\r\n        this._source = value;\r\n        this._imageDataCache.data = null;\r\n\r\n        if (value) {\r\n            value = this._svgCheck(value);\r\n        }\r\n\r\n        // Should abstract platform instead of using LastCreatedEngine\r\n        const engine = this._host?.getScene()?.getEngine() || EngineStore.LastCreatedEngine;\r\n        if (!engine) {\r\n            throw new Error(\"Invalid engine. Unable to create a canvas.\");\r\n        }\r\n        if (value && Image.SourceImgCache.has(value)) {\r\n            const cachedData = Image.SourceImgCache.get(value)!;\r\n            this._domImage = cachedData.img;\r\n            cachedData.timesUsed += 1;\r\n            if (cachedData.loaded) {\r\n                this._onImageLoaded();\r\n            } else {\r\n                cachedData.waitingForLoadCallback.push(this._onImageLoaded.bind(this));\r\n            }\r\n            return;\r\n        }\r\n        this._domImage = engine.createCanvasImage();\r\n        if (value) {\r\n            Image.SourceImgCache.set(value, { img: this._domImage, timesUsed: 1, loaded: false, waitingForLoadCallback: [this._onImageLoaded.bind(this)] });\r\n        }\r\n\r\n        this._domImage.onload = () => {\r\n            if (value) {\r\n                const cachedData = Image.SourceImgCache.get(value);\r\n                if (cachedData) {\r\n                    cachedData.loaded = true;\r\n                    for (const waitingCallback of cachedData.waitingForLoadCallback) {\r\n                        waitingCallback();\r\n                    }\r\n                    cachedData.waitingForLoadCallback.length = 0;\r\n                    return;\r\n                }\r\n            }\r\n            this._onImageLoaded();\r\n        };\r\n        if (value) {\r\n            Tools.SetCorsBehavior(value, this._domImage);\r\n            Tools.SetReferrerPolicyBehavior(this.referrerPolicy, this._domImage);\r\n            this._domImage.src = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks for svg document with icon id present\r\n     * @param value\r\n     */\r\n    private _svgCheck(value: string): string {\r\n        if (window.SVGSVGElement && value.search(/.svg#/gi) !== -1 && value.indexOf(\"#\") === value.lastIndexOf(\"#\")) {\r\n            this._isSVG = true;\r\n            const svgsrc = value.split(\"#\")[0];\r\n            const elemid = value.split(\"#\")[1];\r\n            // check if object alr exist in document\r\n            const svgExist = <HTMLObjectElement>document.body.querySelector('object[data=\"' + svgsrc + '\"]');\r\n            if (svgExist) {\r\n                const svgDoc = svgExist.contentDocument;\r\n                // get viewbox width and height, get svg document width and height in px\r\n                if (svgDoc && svgDoc.documentElement) {\r\n                    const vb = svgDoc.documentElement.getAttribute(\"viewBox\");\r\n                    const docwidth = Number(svgDoc.documentElement.getAttribute(\"width\"));\r\n                    const docheight = Number(svgDoc.documentElement.getAttribute(\"height\"));\r\n                    const elem = <SVGGraphicsElement>(<unknown>svgDoc.getElementById(elemid));\r\n                    if (elem && vb && docwidth && docheight) {\r\n                        this._getSVGAttribs(svgExist, elemid);\r\n                        return value;\r\n                    }\r\n                }\r\n\r\n                // wait for object to load\r\n                svgExist.addEventListener(\"load\", () => {\r\n                    this._getSVGAttribs(svgExist, elemid);\r\n                });\r\n            } else {\r\n                // create document object\r\n                const svgImage = document.createElement(\"object\");\r\n                svgImage.data = svgsrc;\r\n                svgImage.type = \"image/svg+xml\";\r\n                svgImage.width = \"0%\";\r\n                svgImage.height = \"0%\";\r\n                document.body.appendChild(svgImage);\r\n                // when the object has loaded, get the element attribs\r\n                svgImage.onload = () => {\r\n                    const svgobj = <HTMLObjectElement>document.body.querySelector('object[data=\"' + svgsrc + '\"]');\r\n                    if (svgobj) {\r\n                        this._getSVGAttribs(svgobj, elemid);\r\n                    }\r\n                };\r\n            }\r\n            return svgsrc;\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets sourceLeft, sourceTop, sourceWidth, sourceHeight automatically\r\n     * given external svg file and icon id\r\n     * @param svgsrc\r\n     * @param elemid\r\n     */\r\n    private _getSVGAttribs(svgsrc: HTMLObjectElement, elemid: string) {\r\n        const svgDoc = svgsrc.contentDocument;\r\n        // get viewbox width and height, get svg document width and height in px\r\n        if (svgDoc && svgDoc.documentElement) {\r\n            const vb = svgDoc.documentElement.getAttribute(\"viewBox\");\r\n            const docwidth = Number(svgDoc.documentElement.getAttribute(\"width\"));\r\n            const docheight = Number(svgDoc.documentElement.getAttribute(\"height\"));\r\n            // get element bbox and matrix transform\r\n            const elem = svgDoc.getElementById(elemid) as Nullable<SVGGraphicsElement>;\r\n            if (vb && docwidth && docheight && elem) {\r\n                const vb_width = Number(vb.split(\" \")[2]);\r\n                const vb_height = Number(vb.split(\" \")[3]);\r\n                const elem_bbox = elem.getBBox();\r\n                let elem_matrix_a = 1;\r\n                let elem_matrix_d = 1;\r\n                let elem_matrix_e = 0;\r\n                let elem_matrix_f = 0;\r\n                const mainMatrix = elem.transform.baseVal.consolidate()!.matrix;\r\n                if (elem.transform && elem.transform.baseVal.consolidate()) {\r\n                    elem_matrix_a = mainMatrix.a;\r\n                    elem_matrix_d = mainMatrix.d;\r\n                    elem_matrix_e = mainMatrix.e;\r\n                    elem_matrix_f = mainMatrix.f;\r\n                }\r\n\r\n                // compute source coordinates and dimensions\r\n                this.sourceLeft = ((elem_matrix_a * elem_bbox.x + elem_matrix_e) * docwidth) / vb_width;\r\n                this.sourceTop = ((elem_matrix_d * elem_bbox.y + elem_matrix_f) * docheight) / vb_height;\r\n                this.sourceWidth = elem_bbox.width * elem_matrix_a * (docwidth / vb_width);\r\n                this.sourceHeight = elem_bbox.height * elem_matrix_d * (docheight / vb_height);\r\n                this._svgAttributesComputationCompleted = true;\r\n                this.onSVGAttributesComputedObservable.notifyObservers(this);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the cell width to use when animation sheet is enabled\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#image\r\n     */\r\n    @serialize()\r\n    get cellWidth(): number {\r\n        return this._cellWidth;\r\n    }\r\n    set cellWidth(value: number) {\r\n        if (this._cellWidth === value) {\r\n            return;\r\n        }\r\n\r\n        this._cellWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the cell height to use when animation sheet is enabled\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#image\r\n     */\r\n    @serialize()\r\n    get cellHeight(): number {\r\n        return this._cellHeight;\r\n    }\r\n    set cellHeight(value: number) {\r\n        if (this._cellHeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._cellHeight = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the cell id to use (this will turn on the animation sheet mode)\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#image\r\n     */\r\n    @serialize()\r\n    get cellId(): number {\r\n        return this._cellId;\r\n    }\r\n    set cellId(value: number) {\r\n        if (this._cellId === value) {\r\n            return;\r\n        }\r\n\r\n        this._cellId = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new Image\r\n     * @param name defines the control name\r\n     * @param url defines the image url\r\n     */\r\n    constructor(public name?: string, url: Nullable<string> = null) {\r\n        super(name);\r\n        this.source = url;\r\n    }\r\n\r\n    /**\r\n     * Tests if a given coordinates belong to the current control\r\n     * @param x defines x coordinate to test\r\n     * @param y defines y coordinate to test\r\n     * @returns true if the coordinates are inside the control\r\n     */\r\n    public contains(x: number, y: number): boolean {\r\n        if (!super.contains(x, y)) {\r\n            return false;\r\n        }\r\n\r\n        if (!this._detectPointerOnOpaqueOnly || !this._workingCanvas) {\r\n            return true;\r\n        }\r\n\r\n        const width = this._currentMeasure.width | 0;\r\n        const height = this._currentMeasure.height | 0;\r\n        const key = width + \"_\" + height;\r\n\r\n        let imageData = this._imageDataCache.data;\r\n\r\n        if (!imageData || this._imageDataCache.key !== key) {\r\n            const canvas = this._workingCanvas;\r\n            const context = canvas.getContext(\"2d\")!;\r\n\r\n            this._imageDataCache.data = imageData = context.getImageData(0, 0, width, height).data;\r\n            this._imageDataCache.key = key;\r\n        }\r\n\r\n        x = (x - this._currentMeasure.left) | 0;\r\n        y = (y - this._currentMeasure.top) | 0;\r\n\r\n        const pickedPixel = imageData[(x + y * width) * 4 + 3];\r\n\r\n        return pickedPixel > 0;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Image\";\r\n    }\r\n\r\n    /** Force the control to synchronize with its content */\r\n    public synchronizeSizeWithContent() {\r\n        if (!this._loaded) {\r\n            return;\r\n        }\r\n\r\n        this.width = this._domImage.width + \"px\";\r\n        this.height = this._domImage.height + \"px\";\r\n    }\r\n\r\n    protected _processMeasures(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        if (this._loaded) {\r\n            switch (this._stretch) {\r\n                case Image.STRETCH_NONE:\r\n                    break;\r\n                case Image.STRETCH_FILL:\r\n                    break;\r\n                case Image.STRETCH_UNIFORM:\r\n                    break;\r\n                case Image.STRETCH_NINE_PATCH:\r\n                    break;\r\n                case Image.STRETCH_EXTEND:\r\n                    if (this._autoScale) {\r\n                        this.synchronizeSizeWithContent();\r\n                    }\r\n                    if (this.parent && this.parent.parent) {\r\n                        // Will update root size if root is not the top root\r\n                        this.parent.adaptWidthToChildren = true;\r\n                        this.parent.adaptHeightToChildren = true;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        super._processMeasures(parentMeasure, context);\r\n    }\r\n\r\n    private _prepareWorkingCanvasForOpaqueDetection() {\r\n        if (!this._detectPointerOnOpaqueOnly) {\r\n            return;\r\n        }\r\n\r\n        const width = this._currentMeasure.width;\r\n        const height = this._currentMeasure.height;\r\n\r\n        if (!this._workingCanvas) {\r\n            const engine = this._host?.getScene()?.getEngine() || EngineStore.LastCreatedEngine;\r\n            if (!engine) {\r\n                throw new Error(\"Invalid engine. Unable to create a canvas.\");\r\n            }\r\n            this._workingCanvas = engine.createCanvas(width, height);\r\n        }\r\n        const canvas = this._workingCanvas;\r\n\r\n        const context = canvas.getContext(\"2d\")!;\r\n\r\n        context.clearRect(0, 0, width, height);\r\n    }\r\n\r\n    private _drawImage(context: ICanvasRenderingContext, sx: number, sy: number, sw: number, sh: number, tx: number, ty: number, tw: number, th: number) {\r\n        context.drawImage(this._domImage, sx, sy, sw, sh, tx, ty, tw, th);\r\n\r\n        if (!this._detectPointerOnOpaqueOnly) {\r\n            return;\r\n        }\r\n\r\n        const canvas = this._workingCanvas!;\r\n        context = canvas.getContext(\"2d\")!;\r\n\r\n        context.drawImage(this._domImage, sx, sy, sw, sh, tx - this._currentMeasure.left, ty - this._currentMeasure.top, tw, th);\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        let x, y, width, height;\r\n        if (this.cellId == -1) {\r\n            x = this._sourceLeft;\r\n            y = this._sourceTop;\r\n\r\n            width = this._sourceWidth ? this._sourceWidth : this._imageWidth;\r\n            height = this._sourceHeight ? this._sourceHeight : this._imageHeight;\r\n        } else {\r\n            const rowCount = this._domImage.naturalWidth / this.cellWidth;\r\n            const column = (this.cellId / rowCount) >> 0;\r\n            const row = this.cellId % rowCount;\r\n\r\n            x = this.cellWidth * row;\r\n            y = this.cellHeight * column;\r\n            width = this.cellWidth;\r\n            height = this.cellHeight;\r\n        }\r\n\r\n        this._prepareWorkingCanvasForOpaqueDetection();\r\n\r\n        this._applyStates(context);\r\n        if (this._loaded) {\r\n            switch (this._stretch) {\r\n                case Image.STRETCH_NONE:\r\n                    this._drawImage(context, x, y, width, height, this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n                    break;\r\n                case Image.STRETCH_FILL:\r\n                    this._drawImage(context, x, y, width, height, this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n                    break;\r\n                case Image.STRETCH_UNIFORM: {\r\n                    const hRatio = this._currentMeasure.width / width;\r\n                    const vRatio = this._currentMeasure.height / height;\r\n                    const ratio = Math.min(hRatio, vRatio);\r\n                    const centerX = (this._currentMeasure.width - width * ratio) / 2;\r\n                    const centerY = (this._currentMeasure.height - height * ratio) / 2;\r\n\r\n                    this._drawImage(context, x, y, width, height, this._currentMeasure.left + centerX, this._currentMeasure.top + centerY, width * ratio, height * ratio);\r\n                    break;\r\n                }\r\n                case Image.STRETCH_EXTEND:\r\n                    this._drawImage(context, x, y, width, height, this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n                    break;\r\n                case Image.STRETCH_NINE_PATCH:\r\n                    this._renderNinePatch(context);\r\n                    break;\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    private _renderNinePatch(context: ICanvasRenderingContext): void {\r\n        const leftWidth = this._sliceLeft;\r\n        const topHeight = this._sliceTop;\r\n        const bottomHeight = this._imageHeight - this._sliceBottom;\r\n        const rightWidth = this._imageWidth - this._sliceRight;\r\n        const centerWidth = this._sliceRight - this._sliceLeft;\r\n        const centerHeight = this._sliceBottom - this._sliceTop;\r\n        const targetCenterWidth = this._currentMeasure.width - rightWidth - leftWidth + 2;\r\n        const targetCenterHeight = this._currentMeasure.height - bottomHeight - topHeight + 2;\r\n        const centerLeftOffset = this._currentMeasure.left + leftWidth - 1;\r\n        const centerTopOffset = this._currentMeasure.top + topHeight - 1;\r\n        const rightOffset = this._currentMeasure.left + this._currentMeasure.width - rightWidth;\r\n        const bottomOffset = this._currentMeasure.top + this._currentMeasure.height - bottomHeight;\r\n\r\n        //Top Left\r\n        this._drawImage(context, 0, 0, leftWidth, topHeight, this._currentMeasure.left, this._currentMeasure.top, leftWidth, topHeight);\r\n        //Top\r\n        context.clearRect(centerLeftOffset, this._currentMeasure.top, targetCenterWidth, topHeight);\r\n        this._drawImage(context, this._sliceLeft, 0, centerWidth, topHeight, centerLeftOffset, this._currentMeasure.top, targetCenterWidth, topHeight);\r\n        //Top Right\r\n        context.clearRect(rightOffset, this._currentMeasure.top, rightWidth, topHeight);\r\n        this._drawImage(context, this._sliceRight, 0, rightWidth, topHeight, rightOffset, this._currentMeasure.top, rightWidth, topHeight);\r\n        //Left\r\n        context.clearRect(this._currentMeasure.left, centerTopOffset, leftWidth, targetCenterHeight);\r\n        this._drawImage(context, 0, this._sliceTop, leftWidth, centerHeight, this._currentMeasure.left, centerTopOffset, leftWidth, targetCenterHeight);\r\n        // Center\r\n        context.clearRect(centerLeftOffset, centerTopOffset, targetCenterWidth, targetCenterHeight);\r\n        this._drawImage(context, this._sliceLeft, this._sliceTop, centerWidth, centerHeight, centerLeftOffset, centerTopOffset, targetCenterWidth, targetCenterHeight);\r\n        //Right\r\n        context.clearRect(rightOffset, centerTopOffset, rightWidth, targetCenterHeight);\r\n        this._drawImage(context, this._sliceRight, this._sliceTop, rightWidth, centerHeight, rightOffset, centerTopOffset, rightWidth, targetCenterHeight);\r\n        //Bottom Left\r\n        context.clearRect(this._currentMeasure.left, bottomOffset, leftWidth, bottomHeight);\r\n        this._drawImage(context, 0, this._sliceBottom, leftWidth, bottomHeight, this._currentMeasure.left, bottomOffset, leftWidth, bottomHeight);\r\n        //Bottom\r\n        context.clearRect(centerLeftOffset, bottomOffset, targetCenterWidth, bottomHeight);\r\n        this._drawImage(context, this.sliceLeft, this._sliceBottom, centerWidth, bottomHeight, centerLeftOffset, bottomOffset, targetCenterWidth, bottomHeight);\r\n        //Bottom Right\r\n        context.clearRect(rightOffset, bottomOffset, rightWidth, bottomHeight);\r\n        this._drawImage(context, this._sliceRight, this._sliceBottom, rightWidth, bottomHeight, rightOffset, bottomOffset, rightWidth, bottomHeight);\r\n    }\r\n\r\n    public dispose() {\r\n        super.dispose();\r\n        this.onImageLoadedObservable.clear();\r\n        this.onSVGAttributesComputedObservable.clear();\r\n        this._removeCacheUsage(this._source);\r\n    }\r\n\r\n    // Static\r\n    /** STRETCH_NONE */\r\n    public static readonly STRETCH_NONE = 0;\r\n    /** STRETCH_FILL */\r\n    public static readonly STRETCH_FILL = 1;\r\n    /** STRETCH_UNIFORM */\r\n    public static readonly STRETCH_UNIFORM = 2;\r\n    /** STRETCH_EXTEND */\r\n    public static readonly STRETCH_EXTEND = 3;\r\n    /** NINE_PATCH */\r\n    public static readonly STRETCH_NINE_PATCH = 4;\r\n}\r\nRegisterClass(\"BABYLON.GUI.Image\", Image);\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Rectangle } from \"./rectangle\";\r\nimport { Control } from \"./control\";\r\nimport { TextBlock } from \"./textBlock\";\r\nimport { Image } from \"./image\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Class used to create 2D buttons\r\n */\r\nexport class Button extends Rectangle {\r\n    /**\r\n     * Function called to generate a pointer enter animation\r\n     */\r\n    public pointerEnterAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer out animation\r\n     */\r\n    public pointerOutAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer down animation\r\n     */\r\n    public pointerDownAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer up animation\r\n     */\r\n    public pointerUpAnimation: () => void;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that the button will let internal controls handle picking instead of doing it directly using its bounding info\r\n     */\r\n    public delegatePickingToChildren = false;\r\n\r\n    private _image: Nullable<Image>;\r\n    /**\r\n     * Returns the image part of the button (if any)\r\n     */\r\n    public get image(): Nullable<Image> {\r\n        return this._image;\r\n    }\r\n\r\n    private _textBlock: Nullable<TextBlock>;\r\n    /**\r\n     * Returns the TextBlock part of the button (if any)\r\n     */\r\n    public get textBlock(): Nullable<TextBlock> {\r\n        return this._textBlock;\r\n    }\r\n\r\n    /**\r\n     * Creates a new Button\r\n     * @param name defines the name of the button\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n\r\n        this.thickness = 1;\r\n        this.isPointerBlocker = true;\r\n\r\n        let alphaStore: Nullable<number> = null;\r\n\r\n        this.pointerEnterAnimation = () => {\r\n            alphaStore = this.alpha;\r\n            this.alpha -= 0.1;\r\n        };\r\n\r\n        this.pointerOutAnimation = () => {\r\n            if (alphaStore !== null) {\r\n                this.alpha = alphaStore;\r\n            }\r\n        };\r\n\r\n        this.pointerDownAnimation = () => {\r\n            this.scaleX -= 0.05;\r\n            this.scaleY -= 0.05;\r\n        };\r\n\r\n        this.pointerUpAnimation = () => {\r\n            this.scaleX += 0.05;\r\n            this.scaleY += 0.05;\r\n        };\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Button\";\r\n    }\r\n\r\n    // While being a container, the button behaves like a control.\r\n    /**\r\n     * @internal\r\n     */\r\n    public _processPicking(x: number, y: number, pi: PointerInfoBase, type: number, pointerId: number, buttonIndex: number, deltaX?: number, deltaY?: number): boolean {\r\n        if (!this._isEnabled || !this.isHitTestVisible || !this.isVisible || this.notRenderable) {\r\n            return false;\r\n        }\r\n\r\n        if (!super.contains(x, y)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.delegatePickingToChildren) {\r\n            let contains = false;\r\n            for (let index = this._children.length - 1; index >= 0; index--) {\r\n                const child = this._children[index];\r\n                if (child.isEnabled && child.isHitTestVisible && child.isVisible && !child.notRenderable && child.contains(x, y)) {\r\n                    contains = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!contains) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        this._processObservables(type, x, y, pi, pointerId, buttonIndex, deltaX, deltaY);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerEnter(target: Control, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerEnter(target, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (!this.isReadOnly && this.pointerEnterAnimation) {\r\n            this.pointerEnterAnimation();\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerOut(target: Control, pi: PointerInfoBase, force = false): void {\r\n        if (!this.isReadOnly && this.pointerOutAnimation) {\r\n            this.pointerOutAnimation();\r\n        }\r\n\r\n        super._onPointerOut(target, pi, force);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (!this.isReadOnly && this.pointerDownAnimation) {\r\n            this.pointerDownAnimation();\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    protected _getRectangleFill(context: ICanvasRenderingContext) {\r\n        if (this.isEnabled) {\r\n            return this._getBackgroundColor(context);\r\n        } else {\r\n            return this._disabledColor;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerUp(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, notifyClick: boolean, pi: PointerInfoBase): void {\r\n        if (!this.isReadOnly && this.pointerUpAnimation) {\r\n            this.pointerUpAnimation();\r\n        }\r\n\r\n        super._onPointerUp(target, coordinates, pointerId, buttonIndex, notifyClick, pi);\r\n    }\r\n\r\n    /**\r\n     * Serializes the current button\r\n     * @param serializationObject defines the JSON serialized object\r\n     */\r\n    public serialize(serializationObject: any) {\r\n        super.serialize(serializationObject);\r\n\r\n        if (this._textBlock) {\r\n            serializationObject.textBlockName = this._textBlock.name;\r\n        }\r\n        if (this._image) {\r\n            serializationObject.imageName = this._image.name;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        super._parseFromContent(serializedObject, host);\r\n\r\n        if (serializedObject.textBlockName) {\r\n            this._textBlock = this.getChildByName(serializedObject.textBlockName) as Nullable<TextBlock>;\r\n        }\r\n\r\n        if (serializedObject.imageName) {\r\n            this._image = this.getChildByName(serializedObject.imageName) as Nullable<Image>;\r\n        }\r\n    }\r\n\r\n    // Statics\r\n    /**\r\n     * Creates a new button made with an image and a text\r\n     * @param name defines the name of the button\r\n     * @param text defines the text of the button\r\n     * @param imageUrl defines the url of the image\r\n     * @returns a new Button\r\n     */\r\n    public static CreateImageButton(name: string, text: string, imageUrl: string): Button {\r\n        const result = new this(name);\r\n\r\n        // Adding text\r\n        const textBlock = new TextBlock(name + \"_button\", text);\r\n        textBlock.textWrapping = true;\r\n        textBlock.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n        textBlock.paddingLeft = \"20%\";\r\n        result.addControl(textBlock);\r\n\r\n        // Adding image\r\n        const iconImage = new Image(name + \"_icon\", imageUrl);\r\n        iconImage.width = \"20%\";\r\n        iconImage.stretch = Image.STRETCH_UNIFORM;\r\n        iconImage.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        result.addControl(iconImage);\r\n\r\n        // Store\r\n        result._image = iconImage;\r\n        result._textBlock = textBlock;\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Creates a new button made with an image\r\n     * @param name defines the name of the button\r\n     * @param imageUrl defines the url of the image\r\n     * @returns a new Button\r\n     */\r\n    public static CreateImageOnlyButton(name: string, imageUrl: string): Button {\r\n        const result = new this(name);\r\n\r\n        // Adding image\r\n        const iconImage = new Image(name + \"_icon\", imageUrl);\r\n        iconImage.stretch = Image.STRETCH_FILL;\r\n        iconImage.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        result.addControl(iconImage);\r\n\r\n        // Store\r\n        result._image = iconImage;\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Creates a new button made with a text\r\n     * @param name defines the name of the button\r\n     * @param text defines the text of the button\r\n     * @returns a new Button\r\n     */\r\n    public static CreateSimpleButton(name: string, text: string): Button {\r\n        const result = new this(name);\r\n\r\n        // Adding text\r\n        const textBlock = new TextBlock(name + \"_button\", text);\r\n        textBlock.textWrapping = true;\r\n        textBlock.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n        result.addControl(textBlock);\r\n\r\n        // Store\r\n        result._textBlock = textBlock;\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Creates a new button made with an image and a centered text\r\n     * @param name defines the name of the button\r\n     * @param text defines the text of the button\r\n     * @param imageUrl defines the url of the image\r\n     * @returns a new Button\r\n     */\r\n    public static CreateImageWithCenterTextButton(name: string, text: string, imageUrl: string): Button {\r\n        const result = new this(name);\r\n\r\n        // Adding image\r\n        const iconImage = new Image(name + \"_icon\", imageUrl);\r\n        iconImage.stretch = Image.STRETCH_FILL;\r\n        result.addControl(iconImage);\r\n\r\n        // Adding text\r\n        const textBlock = new TextBlock(name + \"_button\", text);\r\n        textBlock.textWrapping = true;\r\n        textBlock.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n        result.addControl(textBlock);\r\n\r\n        // Store\r\n        result._image = iconImage;\r\n        result._textBlock = textBlock;\r\n\r\n        return result;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Button\", Button);\r\n","import { Tools } from \"core/Misc/tools\";\r\n\r\nimport { Container } from \"./container\";\r\nimport type { Measure } from \"../measure\";\r\nimport { Control } from \"./control\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport type { TextBlock } from \"./textBlock\";\r\nimport { TextWrapping } from \"./textBlock\";\r\n\r\n/**\r\n * Class used to create a 2D stack panel container\r\n */\r\nexport class StackPanel extends Container {\r\n    private _isVertical = true;\r\n    private _manualWidth = false;\r\n    private _manualHeight = false;\r\n    private _doNotTrackManualChanges = false;\r\n    private _spacing = 0;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that layout warnings should be ignored\r\n     */\r\n    @serialize()\r\n    public ignoreLayoutWarnings = false;\r\n\r\n    /** Gets or sets a boolean indicating if the stack panel is vertical or horizontal*/\r\n    @serialize()\r\n    public get isVertical(): boolean {\r\n        return this._isVertical;\r\n    }\r\n\r\n    public set isVertical(value: boolean) {\r\n        if (this._isVertical === value) {\r\n            return;\r\n        }\r\n\r\n        this._isVertical = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the spacing (in pixels) between each child.\r\n     */\r\n    @serialize()\r\n    public get spacing(): number {\r\n        return this._spacing;\r\n    }\r\n\r\n    public set spacing(value: number) {\r\n        if (this._spacing === value) {\r\n            return;\r\n        }\r\n\r\n        this._spacing = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets panel width.\r\n     * This value should not be set when in horizontal mode as it will be computed automatically\r\n     */\r\n    @serialize()\r\n    public set width(value: string | number) {\r\n        if (!this._doNotTrackManualChanges) {\r\n            this._manualWidth = true;\r\n        }\r\n\r\n        if (this._width.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._width.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    public get width(): string | number {\r\n        return this._width.toString(this._host);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets panel height.\r\n     * This value should not be set when in vertical mode as it will be computed automatically\r\n     */\r\n    @serialize()\r\n    public set height(value: string | number) {\r\n        if (!this._doNotTrackManualChanges) {\r\n            this._manualHeight = true;\r\n        }\r\n\r\n        if (this._height.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._height.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    public get height(): string | number {\r\n        return this._height.toString(this._host);\r\n    }\r\n\r\n    /**\r\n     * Creates a new StackPanel\r\n     * @param name defines control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"StackPanel\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _preMeasure(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        for (const child of this._children) {\r\n            if (this._isVertical) {\r\n                child.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n            } else {\r\n                child.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n            }\r\n        }\r\n\r\n        super._preMeasure(parentMeasure, context);\r\n    }\r\n\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        super._additionalProcessing(parentMeasure, context);\r\n\r\n        this._measureForChildren.copyFrom(parentMeasure);\r\n\r\n        this._measureForChildren.left = this._currentMeasure.left;\r\n        this._measureForChildren.top = this._currentMeasure.top;\r\n\r\n        if (!this.isVertical || this._manualWidth) {\r\n            this._measureForChildren.width = this._currentMeasure.width;\r\n        }\r\n\r\n        if (this.isVertical || this._manualHeight) {\r\n            this._measureForChildren.height = this._currentMeasure.height;\r\n        }\r\n    }\r\n\r\n    protected _postMeasure(): void {\r\n        let stackWidth = 0;\r\n        let stackHeight = 0;\r\n        const childrenCount = this._children.length;\r\n        for (let index = 0; index < childrenCount; index++) {\r\n            const child = this._children[index];\r\n            if (!child.isVisible || child.notRenderable) {\r\n                continue;\r\n            }\r\n\r\n            if (this._isVertical) {\r\n                if (child.top !== stackHeight + \"px\") {\r\n                    child.top = stackHeight + \"px\";\r\n                    this._rebuildLayout = true;\r\n                    child._top.ignoreAdaptiveScaling = true;\r\n                }\r\n\r\n                if (child._height.isPercentage && !child._automaticSize) {\r\n                    if (!this.ignoreLayoutWarnings) {\r\n                        Tools.Warn(`Control (Name:${child.name}, UniqueId:${child.uniqueId}) is using height in percentage mode inside a vertical StackPanel`);\r\n                    }\r\n                } else {\r\n                    stackHeight += child._currentMeasure.height + child._paddingTopInPixels + child._paddingBottomInPixels + (index < childrenCount - 1 ? this._spacing : 0);\r\n                }\r\n            } else {\r\n                if (child.left !== stackWidth + \"px\") {\r\n                    child.left = stackWidth + \"px\";\r\n                    this._rebuildLayout = true;\r\n                    child._left.ignoreAdaptiveScaling = true;\r\n                }\r\n\r\n                if (\r\n                    child._width.isPercentage &&\r\n                    !child._automaticSize &&\r\n                    child.getClassName() === \"TextBlock\" &&\r\n                    (child as TextBlock).textWrapping !== TextWrapping.Clip &&\r\n                    !(child as TextBlock).forceResizeWidth\r\n                ) {\r\n                    if (!this.ignoreLayoutWarnings) {\r\n                        Tools.Warn(`Control (Name:${child.name}, UniqueId:${child.uniqueId}) is using width in percentage mode inside a horizontal StackPanel`);\r\n                    }\r\n                } else {\r\n                    stackWidth += child._currentMeasure.width + child._paddingLeftInPixels + child._paddingRightInPixels + (index < childrenCount - 1 ? this._spacing : 0);\r\n                }\r\n            }\r\n        }\r\n\r\n        stackWidth += this._paddingLeftInPixels + this._paddingRightInPixels;\r\n        stackHeight += this._paddingTopInPixels + this._paddingBottomInPixels;\r\n\r\n        this._doNotTrackManualChanges = true;\r\n\r\n        // Let stack panel width or height default to stackHeight and stackWidth if dimensions are not specified.\r\n        // User can now define their own height and width for stack panel.\r\n\r\n        let panelWidthChanged = false;\r\n        let panelHeightChanged = false;\r\n\r\n        if ((!this._manualHeight || this.adaptHeightToChildren) && this._isVertical) {\r\n            // do not specify height if strictly defined by user\r\n            const previousHeight = this.height;\r\n            this.height = stackHeight + \"px\";\r\n            panelHeightChanged = previousHeight !== this.height || !this._height.ignoreAdaptiveScaling;\r\n        }\r\n        if ((!this._manualWidth || this.adaptWidthToChildren) && !this._isVertical) {\r\n            // do not specify width if strictly defined by user\r\n            const previousWidth = this.width;\r\n            this.width = stackWidth + \"px\";\r\n            panelWidthChanged = previousWidth !== this.width || !this._width.ignoreAdaptiveScaling;\r\n        }\r\n\r\n        if (panelHeightChanged) {\r\n            this._height.ignoreAdaptiveScaling = true;\r\n        }\r\n\r\n        if (panelWidthChanged) {\r\n            this._width.ignoreAdaptiveScaling = true;\r\n        }\r\n\r\n        this._doNotTrackManualChanges = false;\r\n\r\n        if (panelWidthChanged || panelHeightChanged) {\r\n            this._rebuildLayout = true;\r\n        }\r\n\r\n        super._postMeasure();\r\n    }\r\n\r\n    /**\r\n     * Serializes the current control\r\n     * @param serializationObject defined the JSON serialized object\r\n     */\r\n    public serialize(serializationObject: any) {\r\n        super.serialize(serializationObject);\r\n        serializationObject.manualWidth = this._manualWidth;\r\n        serializationObject.manualHeight = this._manualHeight;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        this._manualWidth = serializedObject.manualWidth;\r\n        this._manualHeight = serializedObject.manualHeight;\r\n\r\n        super._parseFromContent(serializedObject, host);\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.StackPanel\", StackPanel);\r\n","import { Observable } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Control } from \"./control\";\r\nimport { StackPanel } from \"./stackPanel\";\r\nimport { TextBlock } from \"./textBlock\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Class used to represent a 2D checkbox\r\n */\r\nexport class Checkbox extends Control {\r\n    private _isChecked = false;\r\n    private _background = \"black\";\r\n    private _checkSizeRatio = 0.8;\r\n    private _thickness = 1;\r\n\r\n    /** Gets or sets border thickness  */\r\n    @serialize()\r\n    public get thickness(): number {\r\n        return this._thickness;\r\n    }\r\n\r\n    public set thickness(value: number) {\r\n        if (this._thickness === value) {\r\n            return;\r\n        }\r\n\r\n        this._thickness = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Observable raised when isChecked property changes\r\n     */\r\n    public onIsCheckedChangedObservable = new Observable<boolean>();\r\n\r\n    /** Gets or sets a value indicating the ratio between overall size and check size */\r\n    @serialize()\r\n    public get checkSizeRatio(): number {\r\n        return this._checkSizeRatio;\r\n    }\r\n\r\n    public set checkSizeRatio(value: number) {\r\n        value = Math.max(Math.min(1, value), 0);\r\n\r\n        if (this._checkSizeRatio === value) {\r\n            return;\r\n        }\r\n\r\n        this._checkSizeRatio = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background color */\r\n    @serialize()\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n\r\n        this._background = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the checkbox is checked or not */\r\n    @serialize()\r\n    public get isChecked(): boolean {\r\n        return this._isChecked;\r\n    }\r\n\r\n    public set isChecked(value: boolean) {\r\n        if (this._isChecked === value) {\r\n            return;\r\n        }\r\n\r\n        this._isChecked = value;\r\n        this._markAsDirty();\r\n\r\n        this.onIsCheckedChangedObservable.notifyObservers(value);\r\n    }\r\n\r\n    /**\r\n     * Creates a new CheckBox\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n        this.isPointerBlocker = true;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Checkbox\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n        const actualWidth = this._currentMeasure.width - this._thickness;\r\n        const actualHeight = this._currentMeasure.height - this._thickness;\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        context.fillStyle = this._isEnabled ? this._background : this._disabledColor;\r\n        context.fillRect(this._currentMeasure.left + this._thickness / 2, this._currentMeasure.top + this._thickness / 2, actualWidth, actualHeight);\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n\r\n        if (this._isChecked) {\r\n            context.fillStyle = this._isEnabled ? this.color : this._disabledColorItem;\r\n            const offsetWidth = actualWidth * this._checkSizeRatio;\r\n            const offsetHeight = actualHeight * this._checkSizeRatio;\r\n\r\n            context.fillRect(\r\n                this._currentMeasure.left + this._thickness / 2 + (actualWidth - offsetWidth) / 2,\r\n                this._currentMeasure.top + this._thickness / 2 + (actualHeight - offsetHeight) / 2,\r\n                offsetWidth,\r\n                offsetHeight\r\n            );\r\n        }\r\n\r\n        context.strokeStyle = this.color;\r\n        context.lineWidth = this._thickness;\r\n\r\n        context.strokeRect(this._currentMeasure.left + this._thickness / 2, this._currentMeasure.top + this._thickness / 2, actualWidth, actualHeight);\r\n\r\n        context.restore();\r\n    }\r\n\r\n    // Events\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (!this.isReadOnly) {\r\n            this.isChecked = !this.isChecked;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Utility function to easily create a checkbox with a header\r\n     * @param title defines the label to use for the header\r\n     * @param onValueChanged defines the callback to call when value changes\r\n     * @returns a StackPanel containing the checkbox and a textBlock\r\n     */\r\n    public static AddCheckBoxWithHeader(title: string, onValueChanged: (value: boolean) => void): StackPanel {\r\n        const panel = new StackPanel();\r\n        panel.isVertical = false;\r\n        panel.height = \"30px\";\r\n\r\n        const checkbox = new Checkbox();\r\n        checkbox.width = \"20px\";\r\n        checkbox.height = \"20px\";\r\n        checkbox.isChecked = true;\r\n        checkbox.color = \"green\";\r\n        checkbox.onIsCheckedChangedObservable.add(onValueChanged);\r\n        panel.addControl(checkbox);\r\n\r\n        const header = new TextBlock();\r\n        header.text = title;\r\n        header.width = \"180px\";\r\n        header.paddingLeft = \"5px\";\r\n        header.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        header.color = \"white\";\r\n        panel.addControl(header);\r\n\r\n        return panel;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Checkbox\", Checkbox);\r\n","/** @internal */\r\nexport class TextWrapper {\r\n    private _text: string;\r\n    private _characters: string[] | undefined;\r\n\r\n    public get text(): string {\r\n        return this._characters ? this._characters.join(\"\") : this._text;\r\n    }\r\n\r\n    public set text(txt: string) {\r\n        this._text = txt;\r\n        this._characters = Array.from && Array.from(txt);\r\n    }\r\n\r\n    public get length(): number {\r\n        return this._characters ? this._characters.length : this._text.length;\r\n    }\r\n\r\n    public removePart(idxStart: number, idxEnd: number, insertTxt?: string): void {\r\n        this._text = this._text.slice(0, idxStart) + (insertTxt ? insertTxt : \"\") + this._text.slice(idxEnd);\r\n        if (this._characters) {\r\n            const newCharacters = insertTxt ? Array.from(insertTxt) : [];\r\n            this._characters.splice(idxStart, idxEnd - idxStart, ...newCharacters);\r\n        }\r\n    }\r\n\r\n    public charAt(idx: number): string {\r\n        return this._characters ? this._characters[idx] : this._text.charAt(idx);\r\n    }\r\n\r\n    public substr(from: number, length?: number): string {\r\n        if (this._characters) {\r\n            if (isNaN(from)) {\r\n                from = 0;\r\n            } else if (from >= 0) {\r\n                from = Math.min(from, this._characters.length);\r\n            } else {\r\n                from = this._characters.length + Math.max(from, -this._characters.length);\r\n            }\r\n            if (length === undefined) {\r\n                length = this._characters.length - from;\r\n            } else if (isNaN(length)) {\r\n                length = 0;\r\n            } else if (length < 0) {\r\n                length = 0;\r\n            }\r\n            const temp = [];\r\n            while (--length >= 0) {\r\n                temp[length] = this._characters[from + length];\r\n            }\r\n            return temp.join(\"\");\r\n        }\r\n\r\n        return this._text.substr(from, length);\r\n    }\r\n\r\n    public substring(from: number, to?: number): string {\r\n        if (this._characters) {\r\n            if (isNaN(from)) {\r\n                from = 0;\r\n            } else if (from > this._characters.length) {\r\n                from = this._characters.length;\r\n            } else if (from < 0) {\r\n                from = 0;\r\n            }\r\n            if (to === undefined) {\r\n                to = this._characters.length;\r\n            } else if (isNaN(to)) {\r\n                to = 0;\r\n            } else if (to > this._characters.length) {\r\n                to = this._characters.length;\r\n            } else if (to < 0) {\r\n                to = 0;\r\n            }\r\n            const temp = [];\r\n            let idx = 0;\r\n            while (from < to) {\r\n                temp[idx++] = this._characters[from++];\r\n            }\r\n            return temp.join(\"\");\r\n        }\r\n\r\n        return this._text.substring(from, to);\r\n    }\r\n\r\n    public isWord(index: number): boolean {\r\n        const rWord = /\\w/g;\r\n        return this._characters ? this._characters[index].search(rWord) !== -1 : this._text.search(rWord) !== -1;\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\nimport type { ClipboardInfo } from \"core/Events/clipboardEvents\";\r\nimport { ClipboardEventTypes } from \"core/Events/clipboardEvents\";\r\nimport type { PointerInfo, PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\n\r\nimport { Control } from \"./control\";\r\nimport type { IFocusableControl } from \"./focusableControl\";\r\nimport { ValueAndUnit } from \"../valueAndUnit\";\r\nimport type { VirtualKeyboard } from \"./virtualKeyboard\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { TextWrapper } from \"./textWrapper\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { IKeyboardEvent, IPointerEvent } from \"core/Events/deviceInputEvents\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Class used to create input text control\r\n */\r\nexport class InputText extends Control implements IFocusableControl {\r\n    protected _textWrapper: TextWrapper;\r\n    protected _placeholderText = \"\";\r\n    protected _background = \"#222222\";\r\n    protected _focusedBackground = \"#000000\";\r\n    protected _focusedColor = \"white\";\r\n    protected _placeholderColor = \"gray\";\r\n    protected _thickness = 1;\r\n    protected _margin = new ValueAndUnit(10, ValueAndUnit.UNITMODE_PIXEL);\r\n    protected _autoStretchWidth = true;\r\n    protected _maxWidth = new ValueAndUnit(1, ValueAndUnit.UNITMODE_PERCENTAGE, false);\r\n    protected _isFocused = false;\r\n    /** the type of device that most recently focused the input: \"mouse\", \"touch\" or \"pen\" */\r\n    protected _focusedBy: string;\r\n    protected _blinkTimeout: number;\r\n    protected _blinkIsEven = false;\r\n    private _cursorOffset = 0;\r\n    protected _scrollLeft: Nullable<number>;\r\n    protected _textWidth: number;\r\n    protected _clickedCoordinate: Nullable<number>;\r\n    protected _deadKey = false;\r\n    protected _addKey = true;\r\n    protected _currentKey = \"\";\r\n    protected _isTextHighlightOn = false;\r\n    protected _textHighlightColor = \"#d5e0ff\";\r\n    protected _highligherOpacity = 0.4;\r\n    protected _highlightedText = \"\";\r\n    private _startHighlightIndex = 0;\r\n    private _endHighlightIndex = 0;\r\n    private _cursorIndex = -1;\r\n    protected _onFocusSelectAll = false;\r\n    protected _isPointerDown = false;\r\n    protected _onClipboardObserver: Nullable<Observer<ClipboardInfo>>;\r\n    protected _onPointerDblTapObserver: Nullable<Observer<PointerInfo>>;\r\n\r\n    /** @internal */\r\n    public _connectedVirtualKeyboard: Nullable<VirtualKeyboard>;\r\n\r\n    /** Gets or sets a string representing the message displayed on mobile when the control gets the focus */\r\n    @serialize()\r\n    public promptMessage = \"Please enter text:\";\r\n    /** Force disable prompt on mobile device */\r\n    @serialize()\r\n    public disableMobilePrompt = false;\r\n\r\n    /** Observable raised when the text changes */\r\n    public onTextChangedObservable = new Observable<InputText>();\r\n    /** Observable raised just before an entered character is to be added */\r\n    public onBeforeKeyAddObservable = new Observable<InputText>();\r\n    /** Observable raised when the control gets the focus */\r\n    public onFocusObservable = new Observable<InputText>();\r\n    /** Observable raised when the control loses the focus */\r\n    public onBlurObservable = new Observable<InputText>();\r\n    /**Observable raised when the text is highlighted */\r\n    public onTextHighlightObservable = new Observable<InputText>();\r\n    /**Observable raised when copy event is triggered */\r\n    public onTextCopyObservable = new Observable<InputText>();\r\n    /** Observable raised when cut event is triggered */\r\n    public onTextCutObservable = new Observable<InputText>();\r\n    /** Observable raised when paste event is triggered */\r\n    public onTextPasteObservable = new Observable<InputText>();\r\n    /** Observable raised when a key event was processed */\r\n    public onKeyboardEventProcessedObservable = new Observable<IKeyboardEvent>();\r\n\r\n    /** Gets or sets the maximum width allowed by the control */\r\n    @serialize()\r\n    public get maxWidth(): string | number {\r\n        return this._maxWidth.toString(this._host);\r\n    }\r\n\r\n    /** Gets the maximum width allowed by the control in pixels */\r\n    public get maxWidthInPixels(): number {\r\n        return this._maxWidth.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set maxWidth(value: string | number) {\r\n        if (this._maxWidth.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._maxWidth.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the text highlighter transparency; default: 0.4 */\r\n    @serialize()\r\n    public get highligherOpacity(): number {\r\n        return this._highligherOpacity;\r\n    }\r\n\r\n    public set highligherOpacity(value: number) {\r\n        if (this._highligherOpacity === value) {\r\n            return;\r\n        }\r\n        this._highligherOpacity = value;\r\n        this._markAsDirty();\r\n    }\r\n    /** Gets or sets a boolean indicating whether to select complete text by default on input focus */\r\n    @serialize()\r\n    public get onFocusSelectAll(): boolean {\r\n        return this._onFocusSelectAll;\r\n    }\r\n\r\n    public set onFocusSelectAll(value: boolean) {\r\n        if (this._onFocusSelectAll === value) {\r\n            return;\r\n        }\r\n\r\n        this._onFocusSelectAll = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the text hightlight color */\r\n    @serialize()\r\n    public get textHighlightColor(): string {\r\n        return this._textHighlightColor;\r\n    }\r\n\r\n    public set textHighlightColor(value: string) {\r\n        if (this._textHighlightColor === value) {\r\n            return;\r\n        }\r\n        this._textHighlightColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets control margin */\r\n    @serialize()\r\n    public get margin(): string {\r\n        return this._margin.toString(this._host);\r\n    }\r\n\r\n    /** Gets control margin in pixels */\r\n    public get marginInPixels(): number {\r\n        return this._margin.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set margin(value: string) {\r\n        if (this._margin.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._margin.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the control can auto stretch its width to adapt to the text */\r\n    @serialize()\r\n    public get autoStretchWidth(): boolean {\r\n        return this._autoStretchWidth;\r\n    }\r\n\r\n    public set autoStretchWidth(value: boolean) {\r\n        if (this._autoStretchWidth === value) {\r\n            return;\r\n        }\r\n\r\n        this._autoStretchWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets border thickness */\r\n    @serialize()\r\n    public get thickness(): number {\r\n        return this._thickness;\r\n    }\r\n\r\n    public set thickness(value: number) {\r\n        if (this._thickness === value) {\r\n            return;\r\n        }\r\n\r\n        this._thickness = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the background color when focused */\r\n    @serialize()\r\n    public get focusedBackground(): string {\r\n        return this._focusedBackground;\r\n    }\r\n\r\n    public set focusedBackground(value: string) {\r\n        if (this._focusedBackground === value) {\r\n            return;\r\n        }\r\n\r\n        this._focusedBackground = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the background color when focused */\r\n    @serialize()\r\n    public get focusedColor(): string {\r\n        return this._focusedColor;\r\n    }\r\n\r\n    public set focusedColor(value: string) {\r\n        if (this._focusedColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._focusedColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the background color */\r\n    @serialize()\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n\r\n        this._background = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the placeholder color */\r\n    @serialize()\r\n    public get placeholderColor(): string {\r\n        return this._placeholderColor;\r\n    }\r\n\r\n    public set placeholderColor(value: string) {\r\n        if (this._placeholderColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._placeholderColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the text displayed when the control is empty */\r\n    @serialize()\r\n    public get placeholderText(): string {\r\n        return this._placeholderText;\r\n    }\r\n\r\n    public set placeholderText(value: string) {\r\n        if (this._placeholderText === value) {\r\n            return;\r\n        }\r\n        this._placeholderText = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the dead key. 0 to disable. */\r\n    @serialize()\r\n    public get deadKey(): boolean {\r\n        return this._deadKey;\r\n    }\r\n\r\n    public set deadKey(flag: boolean) {\r\n        this._deadKey = flag;\r\n    }\r\n\r\n    /** Gets or sets the highlight text */\r\n    public get highlightedText(): string {\r\n        return this._highlightedText;\r\n    }\r\n    public set highlightedText(text: string) {\r\n        if (this._highlightedText === text) {\r\n            return;\r\n        }\r\n        this._highlightedText = text;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets if the current key should be added */\r\n    public get addKey(): boolean {\r\n        return this._addKey;\r\n    }\r\n\r\n    public set addKey(flag: boolean) {\r\n        this._addKey = flag;\r\n    }\r\n\r\n    /** Gets or sets the value of the current key being entered */\r\n    public get currentKey(): string {\r\n        return this._currentKey;\r\n    }\r\n\r\n    public set currentKey(key: string) {\r\n        this._currentKey = key;\r\n    }\r\n\r\n    /** Gets or sets the text displayed in the control */\r\n    @serialize()\r\n    public get text(): string {\r\n        return this._textWrapper.text;\r\n    }\r\n\r\n    public set text(value: string) {\r\n        const valueAsString = value.toString(); // Forcing convertion\r\n\r\n        if (!this._textWrapper) {\r\n            this._textWrapper = new TextWrapper();\r\n        }\r\n\r\n        if (this._textWrapper.text === valueAsString) {\r\n            return;\r\n        }\r\n        this._textWrapper.text = valueAsString;\r\n        this._textHasChanged();\r\n    }\r\n\r\n    protected _textHasChanged(): void {\r\n        this._markAsDirty();\r\n        this.onTextChangedObservable.notifyObservers(this);\r\n    }\r\n\r\n    /** Gets or sets control width */\r\n    @serialize()\r\n    public get width(): string | number {\r\n        return this._width.toString(this._host);\r\n    }\r\n\r\n    public set width(value: string | number) {\r\n        if (this._width.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._width.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n\r\n        this.autoStretchWidth = false;\r\n    }\r\n\r\n    /**\r\n     * Creates a new InputText\r\n     * @param name defines the control name\r\n     * @param text defines the text of the control\r\n     */\r\n    constructor(public name?: string, text: string = \"\") {\r\n        super(name);\r\n\r\n        this.text = text;\r\n        this.isPointerBlocker = true;\r\n    }\r\n\r\n    /** @internal */\r\n    public onBlur(): void {\r\n        this._isFocused = false;\r\n        this._scrollLeft = null;\r\n        this._cursorOffset = 0;\r\n        clearTimeout(this._blinkTimeout);\r\n        this._markAsDirty();\r\n\r\n        this.onBlurObservable.notifyObservers(this);\r\n\r\n        this._host.unRegisterClipboardEvents();\r\n        if (this._onClipboardObserver) {\r\n            this._host.onClipboardObservable.remove(this._onClipboardObserver);\r\n        }\r\n        const scene = this._host.getScene();\r\n        if (this._onPointerDblTapObserver && scene) {\r\n            scene.onPointerObservable.remove(this._onPointerDblTapObserver);\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public onFocus(): void {\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        this._scrollLeft = null;\r\n        this._isFocused = true;\r\n        this._blinkIsEven = false;\r\n        this._cursorOffset = 0;\r\n        this._markAsDirty();\r\n\r\n        this.onFocusObservable.notifyObservers(this);\r\n\r\n        if (this._focusedBy === \"touch\" && !this.disableMobilePrompt) {\r\n            const value = prompt(this.promptMessage);\r\n\r\n            if (value !== null) {\r\n                this.text = value;\r\n            }\r\n            this._host.focusedControl = null;\r\n            return;\r\n        }\r\n\r\n        this._host.registerClipboardEvents();\r\n\r\n        this._onClipboardObserver = this._host.onClipboardObservable.add((clipboardInfo) => {\r\n            // process clipboard event, can be configured.\r\n            switch (clipboardInfo.type) {\r\n                case ClipboardEventTypes.COPY:\r\n                    this._onCopyText(clipboardInfo.event);\r\n                    this.onTextCopyObservable.notifyObservers(this);\r\n                    break;\r\n                case ClipboardEventTypes.CUT:\r\n                    this._onCutText(clipboardInfo.event);\r\n                    this.onTextCutObservable.notifyObservers(this);\r\n                    break;\r\n                case ClipboardEventTypes.PASTE:\r\n                    this._onPasteText(clipboardInfo.event);\r\n                    this.onTextPasteObservable.notifyObservers(this);\r\n                    break;\r\n                default:\r\n                    return;\r\n            }\r\n        });\r\n\r\n        const scene = this._host.getScene();\r\n        if (scene) {\r\n            //register the pointer double tap event\r\n            this._onPointerDblTapObserver = scene.onPointerObservable.add((pointerInfo) => {\r\n                if (!this._isFocused) {\r\n                    return;\r\n                }\r\n                if (pointerInfo.type === PointerEventTypes.POINTERDOUBLETAP) {\r\n                    this._processDblClick(pointerInfo);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (this._onFocusSelectAll) {\r\n            this._selectAllText();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Function to focus an inputText programmatically\r\n     */\r\n    public focus() {\r\n        this._host.moveFocusToControl(this);\r\n    }\r\n\r\n    /**\r\n     * Function to unfocus an inputText programmatically\r\n     */\r\n    public blur() {\r\n        this._host.focusedControl = null;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"InputText\";\r\n    }\r\n\r\n    /**\r\n     * Function called to get the list of controls that should not steal the focus from this control\r\n     * @returns an array of controls\r\n     */\r\n    public keepsFocusWith(): Nullable<Control[]> {\r\n        if (!this._connectedVirtualKeyboard) {\r\n            return null;\r\n        }\r\n        return [this._connectedVirtualKeyboard];\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public processKey(keyCode: number, key?: string, evt?: IKeyboardEvent) {\r\n        if (this.isReadOnly) {\r\n            return;\r\n        }\r\n\r\n        //return if clipboard event keys (i.e -ctr/cmd + c,v,x)\r\n        if (evt && (evt.ctrlKey || evt.metaKey) && (keyCode === 67 || keyCode === 86 || keyCode === 88)) {\r\n            return;\r\n        }\r\n\r\n        //select all\r\n        if (evt && (evt.ctrlKey || evt.metaKey) && keyCode === 65) {\r\n            this._selectAllText();\r\n            evt.preventDefault();\r\n            return;\r\n        }\r\n        // Specific cases\r\n        switch (keyCode) {\r\n            case 32: //SPACE\r\n                key = \" \"; //ie11 key for space is \"Spacebar\"\r\n                break;\r\n            case 191: //SLASH\r\n                if (evt) {\r\n                    evt.preventDefault();\r\n                }\r\n                break;\r\n            case 8: // BACKSPACE\r\n                if (this._textWrapper.text && this._textWrapper.length > 0) {\r\n                    //delete the highlighted text\r\n                    if (this.isTextHighlightOn) {\r\n                        this._textWrapper.removePart(this._startHighlightIndex, this._endHighlightIndex);\r\n                        this._textHasChanged();\r\n                        this.isTextHighlightOn = false;\r\n                        this._cursorOffset = this._textWrapper.length - this._startHighlightIndex;\r\n                        this._blinkIsEven = false;\r\n                        if (evt) {\r\n                            evt.preventDefault();\r\n                        }\r\n                        return;\r\n                    }\r\n                    //delete single character\r\n                    if (this._cursorOffset === 0) {\r\n                        this.text = this._textWrapper.substr(0, this._textWrapper.length - 1);\r\n                    } else {\r\n                        const deletePosition = this._textWrapper.length - this._cursorOffset;\r\n                        if (deletePosition > 0) {\r\n                            this._textWrapper.removePart(deletePosition - 1, deletePosition);\r\n                            this._textHasChanged();\r\n                        }\r\n                    }\r\n                }\r\n                if (evt) {\r\n                    evt.preventDefault();\r\n                }\r\n                return;\r\n            case 46: // DELETE\r\n                if (this.isTextHighlightOn) {\r\n                    this._textWrapper.removePart(this._startHighlightIndex, this._endHighlightIndex);\r\n                    this._textHasChanged();\r\n                    this.isTextHighlightOn = false;\r\n                    this._cursorOffset = this._textWrapper.length - this._startHighlightIndex;\r\n                    if (evt) {\r\n                        evt.preventDefault();\r\n                    }\r\n                    return;\r\n                }\r\n                if (this._textWrapper.text && this._textWrapper.length > 0 && this._cursorOffset > 0) {\r\n                    const deletePosition = this._textWrapper.length - this._cursorOffset;\r\n                    this._textWrapper.removePart(deletePosition, deletePosition + 1);\r\n                    this._textHasChanged();\r\n                    this._cursorOffset--;\r\n                }\r\n                if (evt) {\r\n                    evt.preventDefault();\r\n                }\r\n                return;\r\n            case 13: // RETURN\r\n                this._host.focusedControl = null;\r\n                this.isTextHighlightOn = false;\r\n                return;\r\n            case 35: // END\r\n                this._cursorOffset = 0;\r\n                this._blinkIsEven = false;\r\n                this.isTextHighlightOn = false;\r\n                this._markAsDirty();\r\n                return;\r\n            case 36: // HOME\r\n                this._cursorOffset = this._textWrapper.length;\r\n                this._blinkIsEven = false;\r\n                this.isTextHighlightOn = false;\r\n                this._markAsDirty();\r\n                return;\r\n            case 37: // LEFT\r\n                this._cursorOffset++;\r\n                if (this._cursorOffset > this._textWrapper.length) {\r\n                    this._cursorOffset = this._textWrapper.length;\r\n                }\r\n\r\n                if (evt && evt.shiftKey) {\r\n                    // update the cursor\r\n                    this._blinkIsEven = false;\r\n                    // shift + ctrl/cmd + <-\r\n                    if (evt.ctrlKey || evt.metaKey) {\r\n                        if (!this.isTextHighlightOn) {\r\n                            if (this._textWrapper.length === this._cursorOffset) {\r\n                                return;\r\n                            } else {\r\n                                this._endHighlightIndex = this._textWrapper.length - this._cursorOffset + 1;\r\n                            }\r\n                        }\r\n                        this._startHighlightIndex = 0;\r\n                        this._cursorIndex = this._textWrapper.length - this._endHighlightIndex;\r\n                        this._cursorOffset = this._textWrapper.length;\r\n                        this.isTextHighlightOn = true;\r\n                        this._markAsDirty();\r\n                        return;\r\n                    }\r\n                    //store the starting point\r\n                    if (!this.isTextHighlightOn) {\r\n                        this.isTextHighlightOn = true;\r\n                        this._cursorIndex = this._cursorOffset >= this._textWrapper.length ? this._textWrapper.length : this._cursorOffset - 1;\r\n                    }\r\n                    //if text is already highlighted\r\n                    else if (this._cursorIndex === -1) {\r\n                        this._cursorIndex = this._textWrapper.length - this._endHighlightIndex;\r\n                        this._cursorOffset = this._startHighlightIndex === 0 ? this._textWrapper.length : this._textWrapper.length - this._startHighlightIndex + 1;\r\n                    }\r\n                    //set the highlight indexes\r\n                    if (this._cursorIndex < this._cursorOffset) {\r\n                        this._endHighlightIndex = this._textWrapper.length - this._cursorIndex;\r\n                        this._startHighlightIndex = this._textWrapper.length - this._cursorOffset;\r\n                    } else if (this._cursorIndex > this._cursorOffset) {\r\n                        this._endHighlightIndex = this._textWrapper.length - this._cursorOffset;\r\n                        this._startHighlightIndex = this._textWrapper.length - this._cursorIndex;\r\n                    } else {\r\n                        this.isTextHighlightOn = false;\r\n                    }\r\n                    this._markAsDirty();\r\n                    return;\r\n                }\r\n                if (this.isTextHighlightOn) {\r\n                    this._cursorOffset = this._textWrapper.length - this._startHighlightIndex;\r\n                    this.isTextHighlightOn = false;\r\n                }\r\n                if (evt && (evt.ctrlKey || evt.metaKey)) {\r\n                    this._cursorOffset = this._textWrapper.length;\r\n                    evt.preventDefault();\r\n                }\r\n                this._blinkIsEven = false;\r\n                this.isTextHighlightOn = false;\r\n                this._cursorIndex = -1;\r\n                this._markAsDirty();\r\n                return;\r\n            case 39: // RIGHT\r\n                this._cursorOffset--;\r\n                if (this._cursorOffset < 0) {\r\n                    this._cursorOffset = 0;\r\n                }\r\n                if (evt && evt.shiftKey) {\r\n                    //update the cursor\r\n                    this._blinkIsEven = false;\r\n                    //shift + ctrl/cmd + ->\r\n                    if (evt.ctrlKey || evt.metaKey) {\r\n                        if (!this.isTextHighlightOn) {\r\n                            if (this._cursorOffset === 0) {\r\n                                return;\r\n                            } else {\r\n                                this._startHighlightIndex = this._textWrapper.length - this._cursorOffset - 1;\r\n                            }\r\n                        }\r\n                        this._endHighlightIndex = this._textWrapper.length;\r\n                        this.isTextHighlightOn = true;\r\n                        this._cursorIndex = this._textWrapper.length - this._startHighlightIndex;\r\n                        this._cursorOffset = 0;\r\n                        this._markAsDirty();\r\n                        return;\r\n                    }\r\n\r\n                    if (!this.isTextHighlightOn) {\r\n                        this.isTextHighlightOn = true;\r\n                        this._cursorIndex = this._cursorOffset <= 0 ? 0 : this._cursorOffset + 1;\r\n                    }\r\n                    //if text is already highlighted\r\n                    else if (this._cursorIndex === -1) {\r\n                        this._cursorIndex = this._textWrapper.length - this._startHighlightIndex;\r\n                        this._cursorOffset = this._textWrapper.length === this._endHighlightIndex ? 0 : this._textWrapper.length - this._endHighlightIndex - 1;\r\n                    }\r\n                    //set the highlight indexes\r\n                    if (this._cursorIndex < this._cursorOffset) {\r\n                        this._endHighlightIndex = this._textWrapper.length - this._cursorIndex;\r\n                        this._startHighlightIndex = this._textWrapper.length - this._cursorOffset;\r\n                    } else if (this._cursorIndex > this._cursorOffset) {\r\n                        this._endHighlightIndex = this._textWrapper.length - this._cursorOffset;\r\n                        this._startHighlightIndex = this._textWrapper.length - this._cursorIndex;\r\n                    } else {\r\n                        this.isTextHighlightOn = false;\r\n                    }\r\n                    this._markAsDirty();\r\n                    return;\r\n                }\r\n                if (this.isTextHighlightOn) {\r\n                    this._cursorOffset = this._textWrapper.length - this._endHighlightIndex;\r\n                    this.isTextHighlightOn = false;\r\n                }\r\n                //ctr + ->\r\n                if (evt && (evt.ctrlKey || evt.metaKey)) {\r\n                    this._cursorOffset = 0;\r\n                    evt.preventDefault();\r\n                }\r\n                this._blinkIsEven = false;\r\n                this.isTextHighlightOn = false;\r\n                this._cursorIndex = -1;\r\n                this._markAsDirty();\r\n                return;\r\n        }\r\n        if (keyCode === 32) {\r\n            key = evt?.key ?? \" \";\r\n        }\r\n        this._deadKey = key === \"Dead\";\r\n        // Printable characters\r\n        if (\r\n            key &&\r\n            (keyCode === -1 || // Direct access\r\n                keyCode === 32 || // Space\r\n                keyCode === 34 || // \"    add support for single and double quotes\r\n                keyCode === 39 || // '\r\n                (keyCode > 47 && keyCode < 64) || // Numbers\r\n                (keyCode > 64 && keyCode < 91) || // Letters\r\n                (keyCode > 159 && keyCode < 193) || // Special characters\r\n                (keyCode > 218 && keyCode < 223) || // Special characters\r\n                (keyCode > 95 && keyCode < 112))\r\n        ) {\r\n            // Numpad\r\n            this._currentKey = key;\r\n            this.onBeforeKeyAddObservable.notifyObservers(this);\r\n            key = this._currentKey;\r\n            if (this._addKey && !this._deadKey) {\r\n                if (this.isTextHighlightOn) {\r\n                    this._textWrapper.removePart(this._startHighlightIndex, this._endHighlightIndex, key);\r\n                    this._textHasChanged();\r\n                    this._cursorOffset = this._textWrapper.length - (this._startHighlightIndex + 1);\r\n                    this.isTextHighlightOn = false;\r\n                    this._blinkIsEven = false;\r\n                    this._markAsDirty();\r\n                } else if (this._cursorOffset === 0) {\r\n                    this.text += this._deadKey && evt?.key ? evt.key : key;\r\n                } else {\r\n                    const insertPosition = this._textWrapper.length - this._cursorOffset;\r\n                    this._textWrapper.removePart(insertPosition, insertPosition, key);\r\n                    this._textHasChanged();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _updateValueFromCursorIndex(offset: number) {\r\n        //update the cursor\r\n        this._blinkIsEven = false;\r\n\r\n        if (this._cursorIndex === -1) {\r\n            this._cursorIndex = offset;\r\n        } else {\r\n            if (this._cursorIndex < this._cursorOffset) {\r\n                this._endHighlightIndex = this._textWrapper.length - this._cursorIndex;\r\n                this._startHighlightIndex = this._textWrapper.length - this._cursorOffset;\r\n            } else if (this._cursorIndex > this._cursorOffset) {\r\n                this._endHighlightIndex = this._textWrapper.length - this._cursorOffset;\r\n                this._startHighlightIndex = this._textWrapper.length - this._cursorIndex;\r\n            } else {\r\n                this.isTextHighlightOn = false;\r\n                this._markAsDirty();\r\n                return;\r\n            }\r\n        }\r\n        this.isTextHighlightOn = true;\r\n        this._markAsDirty();\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    protected _processDblClick(evt: PointerInfo) {\r\n        //pre-find the start and end index of the word under cursor, speeds up the rendering\r\n        this._startHighlightIndex = this._textWrapper.length - this._cursorOffset;\r\n        this._endHighlightIndex = this._startHighlightIndex;\r\n        let moveLeft, moveRight;\r\n        do {\r\n            moveRight = this._endHighlightIndex < this._textWrapper.length && this._textWrapper.isWord(this._endHighlightIndex) ? ++this._endHighlightIndex : 0;\r\n            moveLeft = this._startHighlightIndex > 0 && this._textWrapper.isWord(this._startHighlightIndex - 1) ? --this._startHighlightIndex : 0;\r\n        } while (moveLeft || moveRight);\r\n\r\n        this._cursorOffset = this._textWrapper.length - this._startHighlightIndex;\r\n\r\n        this.isTextHighlightOn = true;\r\n        this._clickedCoordinate = null;\r\n        this._blinkIsEven = true;\r\n        this._cursorIndex = -1;\r\n        this._markAsDirty();\r\n    }\r\n    /** @internal */\r\n    protected _selectAllText() {\r\n        this._blinkIsEven = true;\r\n        this.isTextHighlightOn = true;\r\n\r\n        this._startHighlightIndex = 0;\r\n        this._endHighlightIndex = this._textWrapper.length;\r\n        this._cursorOffset = this._textWrapper.length;\r\n        this._cursorIndex = -1;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Handles the keyboard event\r\n     * @param evt Defines the KeyboardEvent\r\n     */\r\n    public processKeyboard(evt: IKeyboardEvent): void {\r\n        // process pressed key\r\n        this.processKey(evt.keyCode, evt.key, evt);\r\n\r\n        this.onKeyboardEventProcessedObservable.notifyObservers(evt);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _onCopyText(ev: ClipboardEvent): void {\r\n        this.isTextHighlightOn = false;\r\n        //when write permission to clipbaord data is denied\r\n        try {\r\n            ev.clipboardData && ev.clipboardData.setData(\"text/plain\", this._highlightedText);\r\n        } catch {} //pass\r\n        this._host.clipboardData = this._highlightedText;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _onCutText(ev: ClipboardEvent): void {\r\n        if (!this._highlightedText) {\r\n            return;\r\n        }\r\n        this._textWrapper.removePart(this._startHighlightIndex, this._endHighlightIndex);\r\n        this._textHasChanged();\r\n        this.isTextHighlightOn = false;\r\n        this._cursorOffset = this._textWrapper.length - this._startHighlightIndex;\r\n        //when write permission to clipbaord data is denied\r\n        try {\r\n            ev.clipboardData && ev.clipboardData.setData(\"text/plain\", this._highlightedText);\r\n        } catch {} //pass\r\n\r\n        this._host.clipboardData = this._highlightedText;\r\n        this._highlightedText = \"\";\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _onPasteText(ev: ClipboardEvent): void {\r\n        let data: string = \"\";\r\n        if (ev.clipboardData && ev.clipboardData.types.indexOf(\"text/plain\") !== -1) {\r\n            data = ev.clipboardData.getData(\"text/plain\");\r\n        } else {\r\n            //get the cached data; returns blank string by default\r\n            data = this._host.clipboardData;\r\n        }\r\n        const insertPosition = this._textWrapper.length - this._cursorOffset;\r\n        this._textWrapper.removePart(insertPosition, insertPosition, data);\r\n        this._textHasChanged();\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        // Background\r\n        if (this._isFocused) {\r\n            if (this._focusedBackground) {\r\n                context.fillStyle = this._isEnabled ? this._focusedBackground : this._disabledColor;\r\n\r\n                context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n            }\r\n        } else if (this._background) {\r\n            context.fillStyle = this._isEnabled ? this._background : this._disabledColor;\r\n\r\n            context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n\r\n        if (!this._fontOffset || this._wasDirty) {\r\n            this._fontOffset = Control._GetFontOffset(context.font);\r\n        }\r\n\r\n        // Text\r\n        const clipTextLeft = this._currentMeasure.left + this._margin.getValueInPixel(this._host, this._tempParentMeasure.width);\r\n        if (this.color) {\r\n            context.fillStyle = this.color;\r\n        }\r\n\r\n        let text = this._beforeRenderText(this._textWrapper);\r\n\r\n        if (!this._isFocused && !this._textWrapper.text && this._placeholderText) {\r\n            text = new TextWrapper();\r\n            text.text = this._placeholderText;\r\n\r\n            if (this._placeholderColor) {\r\n                context.fillStyle = this._placeholderColor;\r\n            }\r\n        }\r\n\r\n        this._textWidth = context.measureText(text.text).width;\r\n        const marginWidth = this._margin.getValueInPixel(this._host, this._tempParentMeasure.width) * 2;\r\n        if (this._autoStretchWidth) {\r\n            this.width = Math.min(this._maxWidth.getValueInPixel(this._host, this._tempParentMeasure.width), this._textWidth + marginWidth) + \"px\";\r\n            this._autoStretchWidth = true; // setting the width will have reset _autoStretchWidth to false!\r\n        }\r\n\r\n        const rootY = this._fontOffset.ascent + (this._currentMeasure.height - this._fontOffset.height) / 2;\r\n        const availableWidth = this._width.getValueInPixel(this._host, this._tempParentMeasure.width) - marginWidth;\r\n\r\n        context.save();\r\n        context.beginPath();\r\n        context.rect(clipTextLeft, this._currentMeasure.top + (this._currentMeasure.height - this._fontOffset.height) / 2, availableWidth + 2, this._currentMeasure.height);\r\n        context.clip();\r\n\r\n        if (this._isFocused && this._textWidth > availableWidth) {\r\n            const textLeft = clipTextLeft - this._textWidth + availableWidth;\r\n            if (!this._scrollLeft) {\r\n                this._scrollLeft = textLeft;\r\n            }\r\n        } else {\r\n            this._scrollLeft = clipTextLeft;\r\n        }\r\n\r\n        context.fillText(text.text, this._scrollLeft, this._currentMeasure.top + rootY);\r\n\r\n        // Cursor\r\n        if (this._isFocused) {\r\n            // Need to move cursor\r\n            if (this._clickedCoordinate) {\r\n                const rightPosition = this._scrollLeft + this._textWidth;\r\n                const absoluteCursorPosition = rightPosition - this._clickedCoordinate;\r\n                let currentSize = 0;\r\n                this._cursorOffset = 0;\r\n                let previousDist = 0;\r\n                do {\r\n                    if (this._cursorOffset) {\r\n                        previousDist = Math.abs(absoluteCursorPosition - currentSize);\r\n                    }\r\n                    this._cursorOffset++;\r\n                    currentSize = context.measureText(text.substr(text.length - this._cursorOffset, this._cursorOffset)).width;\r\n                } while (currentSize < absoluteCursorPosition && text.length >= this._cursorOffset);\r\n\r\n                // Find closest move\r\n                if (Math.abs(absoluteCursorPosition - currentSize) > previousDist) {\r\n                    this._cursorOffset--;\r\n                }\r\n\r\n                this._blinkIsEven = false;\r\n                this._clickedCoordinate = null;\r\n            }\r\n\r\n            // Render cursor\r\n            if (!this._blinkIsEven) {\r\n                const cursorOffsetText = text.substr(text.length - this._cursorOffset);\r\n                const cursorOffsetWidth = context.measureText(cursorOffsetText).width;\r\n                let cursorLeft = this._scrollLeft + this._textWidth - cursorOffsetWidth;\r\n\r\n                if (cursorLeft < clipTextLeft) {\r\n                    this._scrollLeft += clipTextLeft - cursorLeft;\r\n                    cursorLeft = clipTextLeft;\r\n                    this._markAsDirty();\r\n                } else if (cursorLeft > clipTextLeft + availableWidth) {\r\n                    this._scrollLeft += clipTextLeft + availableWidth - cursorLeft;\r\n                    cursorLeft = clipTextLeft + availableWidth;\r\n                    this._markAsDirty();\r\n                }\r\n                if (!this.isTextHighlightOn) {\r\n                    context.fillRect(cursorLeft, this._currentMeasure.top + (this._currentMeasure.height - this._fontOffset.height) / 2, 2, this._fontOffset.height);\r\n                }\r\n            }\r\n\r\n            clearTimeout(this._blinkTimeout);\r\n            this._blinkTimeout = <any>setTimeout(() => {\r\n                this._blinkIsEven = !this._blinkIsEven;\r\n                this._markAsDirty();\r\n            }, 500);\r\n\r\n            //show the highlighted text\r\n            if (this.isTextHighlightOn) {\r\n                clearTimeout(this._blinkTimeout);\r\n                const highlightCursorOffsetWidth = context.measureText(text.substring(this._startHighlightIndex)).width;\r\n                let highlightCursorLeft = this._scrollLeft + this._textWidth - highlightCursorOffsetWidth;\r\n                this._highlightedText = text.substring(this._startHighlightIndex, this._endHighlightIndex);\r\n                let width = context.measureText(text.substring(this._startHighlightIndex, this._endHighlightIndex)).width;\r\n                if (highlightCursorLeft < clipTextLeft) {\r\n                    width = width - (clipTextLeft - highlightCursorLeft);\r\n                    if (!width) {\r\n                        // when using left arrow on text.length > availableWidth;\r\n                        // assigns the width of the first letter after clipTextLeft\r\n                        width = context.measureText(text.charAt(text.length - this._cursorOffset)).width;\r\n                    }\r\n                    highlightCursorLeft = clipTextLeft;\r\n                }\r\n                //for transparancy\r\n                context.globalAlpha = this._highligherOpacity;\r\n                context.fillStyle = this._textHighlightColor;\r\n                context.fillRect(highlightCursorLeft, this._currentMeasure.top + (this._currentMeasure.height - this._fontOffset.height) / 2, width, this._fontOffset.height);\r\n                context.globalAlpha = 1.0;\r\n            }\r\n        }\r\n        context.restore();\r\n\r\n        // Border\r\n        if (this._thickness) {\r\n            if (this._isFocused) {\r\n                if (this.focusedColor) {\r\n                    context.strokeStyle = this.focusedColor;\r\n                }\r\n            } else {\r\n                if (this.color) {\r\n                    context.strokeStyle = this.color;\r\n                }\r\n            }\r\n\r\n            context.lineWidth = this._thickness;\r\n\r\n            context.strokeRect(\r\n                this._currentMeasure.left + this._thickness / 2,\r\n                this._currentMeasure.top + this._thickness / 2,\r\n                this._currentMeasure.width - this._thickness,\r\n                this._currentMeasure.height - this._thickness\r\n            );\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isReadOnly) {\r\n            return true;\r\n        }\r\n\r\n        this._clickedCoordinate = coordinates.x;\r\n        this.isTextHighlightOn = false;\r\n        this._highlightedText = \"\";\r\n        this._cursorIndex = -1;\r\n        this._isPointerDown = true;\r\n        this._host._capturingControl[pointerId] = this;\r\n        this._focusedBy = (pi.event as IPointerEvent).pointerType;\r\n        if (this._host.focusedControl === this) {\r\n            // Move cursor\r\n            clearTimeout(this._blinkTimeout);\r\n            this._markAsDirty();\r\n            return true;\r\n        }\r\n        if (!this._isEnabled) {\r\n            return false;\r\n        }\r\n        this._host.focusedControl = this;\r\n\r\n        return true;\r\n    }\r\n    public _onPointerMove(target: Control, coordinates: Vector2, pointerId: number, pi: PointerInfoBase): void {\r\n        if (this._host.focusedControl === this && this._isPointerDown && !this.isReadOnly) {\r\n            this._clickedCoordinate = coordinates.x;\r\n            this._markAsDirty();\r\n            this._updateValueFromCursorIndex(this._cursorOffset);\r\n        }\r\n        super._onPointerMove(target, coordinates, pointerId, pi);\r\n    }\r\n\r\n    public _onPointerUp(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, notifyClick: boolean): void {\r\n        this._isPointerDown = false;\r\n        delete this._host._capturingControl[pointerId];\r\n        super._onPointerUp(target, coordinates, pointerId, buttonIndex, notifyClick);\r\n    }\r\n\r\n    protected _beforeRenderText(textWrapper: TextWrapper): TextWrapper {\r\n        return textWrapper;\r\n    }\r\n\r\n    /** @internal */\r\n    private set isTextHighlightOn(value: boolean) {\r\n        if (this._isTextHighlightOn === value) {\r\n            return;\r\n        }\r\n        if (value) {\r\n            this.onTextHighlightObservable.notifyObservers(this);\r\n        }\r\n        this._isTextHighlightOn = value;\r\n    }\r\n\r\n    /** @internal */\r\n    private get isTextHighlightOn(): boolean {\r\n        return this._isTextHighlightOn;\r\n    }\r\n\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        this.onBlurObservable.clear();\r\n        this.onFocusObservable.clear();\r\n        this.onTextChangedObservable.clear();\r\n        this.onTextCopyObservable.clear();\r\n        this.onTextCutObservable.clear();\r\n        this.onTextPasteObservable.clear();\r\n        this.onTextHighlightObservable.clear();\r\n        this.onKeyboardEventProcessedObservable.clear();\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.InputText\", InputText);\r\n","import type { Nullable } from \"core/types\";\r\n\r\nimport { Container } from \"./container\";\r\nimport { ValueAndUnit } from \"../valueAndUnit\";\r\nimport { Control } from \"./control\";\r\nimport type { Measure } from \"../measure\";\r\nimport { Tools } from \"core/Misc/tools\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\n\r\n/**\r\n * Class used to create a 2D grid container\r\n */\r\nexport class Grid extends Container {\r\n    private _rowDefinitions = new Array<ValueAndUnit>();\r\n    private _rowDefinitionObservers: Observer<void>[] = [];\r\n    private _columnDefinitions = new Array<ValueAndUnit>();\r\n    private _columnDefinitionObservers: Observer<void>[] = [];\r\n    private _cells: { [key: string]: Container } = {};\r\n    private _childControls = new Array<Control>();\r\n\r\n    /**\r\n     * Sets/Gets a boolean indicating that control content must be clipped\r\n     * Please note that not clipping content may generate issues with adt.useInvalidateRectOptimization so it is recommended to turn this optimization off if you want to use unclipped children\r\n     */\r\n    public set clipContent(value: boolean) {\r\n        this._clipContent = value;\r\n\r\n        // This value has to be replicated on all of the container cells\r\n        for (const key in this._cells) {\r\n            this._cells[key].clipContent = value;\r\n        }\r\n    }\r\n\r\n    @serialize()\r\n    public get clipContent(): boolean {\r\n        return this._clipContent;\r\n    }\r\n\r\n    /**\r\n     * Sets/Gets a boolean indicating if the children are clipped to the current control bounds.\r\n     * Please note that not clipping children may generate issues with adt.useInvalidateRectOptimization so it is recommended to turn this optimization off if you want to use unclipped children\r\n     */\r\n    public set clipChildren(value: boolean) {\r\n        this._clipChildren = value;\r\n\r\n        // This value has to be replicated on all of the container cells\r\n        for (const key in this._cells) {\r\n            this._cells[key].clipChildren = value;\r\n        }\r\n    }\r\n\r\n    public get clipChildren(): boolean {\r\n        return this._clipChildren;\r\n    }\r\n\r\n    /**\r\n     * Gets the number of columns\r\n     */\r\n    public get columnCount(): number {\r\n        return this._columnDefinitions.length;\r\n    }\r\n\r\n    /**\r\n     * Gets the number of rows\r\n     */\r\n    public get rowCount(): number {\r\n        return this._rowDefinitions.length;\r\n    }\r\n\r\n    /** Gets the list of children */\r\n    public get children(): Control[] {\r\n        return this._childControls;\r\n    }\r\n\r\n    /** Gets the list of cells (e.g. the containers) */\r\n    public get cells(): { [key: string]: Container } {\r\n        return this._cells;\r\n    }\r\n\r\n    /**\r\n     * Gets the definition of a specific row\r\n     * @param index defines the index of the row\r\n     * @returns the row definition\r\n     */\r\n    public getRowDefinition(index: number): Nullable<ValueAndUnit> {\r\n        if (index < 0 || index >= this._rowDefinitions.length) {\r\n            return null;\r\n        }\r\n\r\n        return this._rowDefinitions[index];\r\n    }\r\n\r\n    /**\r\n     * Gets the definition of a specific column\r\n     * @param index defines the index of the column\r\n     * @returns the column definition\r\n     */\r\n    public getColumnDefinition(index: number): Nullable<ValueAndUnit> {\r\n        if (index < 0 || index >= this._columnDefinitions.length) {\r\n            return null;\r\n        }\r\n\r\n        return this._columnDefinitions[index];\r\n    }\r\n\r\n    /**\r\n     * Adds a new row to the grid\r\n     * @param height defines the height of the row (either in pixel or a value between 0 and 1)\r\n     * @param isPixel defines if the height is expressed in pixel (or in percentage)\r\n     * @returns the current grid\r\n     */\r\n    public addRowDefinition(height: number, isPixel = false): Grid {\r\n        this._rowDefinitions.push(new ValueAndUnit(height, isPixel ? ValueAndUnit.UNITMODE_PIXEL : ValueAndUnit.UNITMODE_PERCENTAGE));\r\n        this._rowDefinitionObservers.push(this._rowDefinitions[this.rowCount - 1].onChangedObservable.add(() => this._markAsDirty())!);\r\n        this._markAsDirty();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds a new column to the grid\r\n     * @param width defines the width of the column (either in pixel or a value between 0 and 1)\r\n     * @param isPixel defines if the width is expressed in pixel (or in percentage)\r\n     * @returns the current grid\r\n     */\r\n    public addColumnDefinition(width: number, isPixel = false): Grid {\r\n        this._columnDefinitions.push(new ValueAndUnit(width, isPixel ? ValueAndUnit.UNITMODE_PIXEL : ValueAndUnit.UNITMODE_PERCENTAGE));\r\n        this._columnDefinitionObservers.push(this._columnDefinitions[this.columnCount - 1].onChangedObservable.add(() => this._markAsDirty())!);\r\n        this._markAsDirty();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Update a row definition\r\n     * @param index defines the index of the row to update\r\n     * @param height defines the height of the row (either in pixel or a value between 0 and 1)\r\n     * @param isPixel defines if the weight is expressed in pixel (or in percentage)\r\n     * @returns the current grid\r\n     */\r\n    public setRowDefinition(index: number, height: number, isPixel = false): Grid {\r\n        if (index < 0 || index >= this._rowDefinitions.length) {\r\n            return this;\r\n        }\r\n\r\n        const current = this._rowDefinitions[index];\r\n        if (current && current.isPixel === isPixel && current.value === height) {\r\n            return this;\r\n        }\r\n\r\n        this._rowDefinitions[index].onChangedObservable.remove(this._rowDefinitionObservers[index]);\r\n        this._rowDefinitions[index] = new ValueAndUnit(height, isPixel ? ValueAndUnit.UNITMODE_PIXEL : ValueAndUnit.UNITMODE_PERCENTAGE);\r\n        this._rowDefinitionObservers[index] = this._rowDefinitions[index].onChangedObservable.add(() => this._markAsDirty())!;\r\n\r\n        this._markAsDirty();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Update a column definition\r\n     * @param index defines the index of the column to update\r\n     * @param width defines the width of the column (either in pixel or a value between 0 and 1)\r\n     * @param isPixel defines if the width is expressed in pixel (or in percentage)\r\n     * @returns the current grid\r\n     */\r\n    public setColumnDefinition(index: number, width: number, isPixel = false): Grid {\r\n        if (index < 0 || index >= this._columnDefinitions.length) {\r\n            return this;\r\n        }\r\n\r\n        const current = this._columnDefinitions[index];\r\n        if (current && current.isPixel === isPixel && current.value === width) {\r\n            return this;\r\n        }\r\n\r\n        this._columnDefinitions[index].onChangedObservable.remove(this._columnDefinitionObservers[index]);\r\n        this._columnDefinitions[index] = new ValueAndUnit(width, isPixel ? ValueAndUnit.UNITMODE_PIXEL : ValueAndUnit.UNITMODE_PERCENTAGE);\r\n        this._columnDefinitionObservers[index] = this._columnDefinitions[index].onChangedObservable.add(() => this._markAsDirty())!;\r\n\r\n        this._markAsDirty();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets the list of children stored in a specific cell\r\n     * @param row defines the row to check\r\n     * @param column defines the column to check\r\n     * @returns the list of controls\r\n     */\r\n    public getChildrenAt(row: number, column: number): Nullable<Array<Control>> {\r\n        const cell = this._cells[`${row}:${column}`];\r\n\r\n        if (!cell) {\r\n            return null;\r\n        }\r\n\r\n        return cell.children;\r\n    }\r\n\r\n    /**\r\n     * Gets a string representing the child cell info (row x column)\r\n     * @param child defines the control to get info from\r\n     * @returns a string containing the child cell info (row x column)\r\n     */\r\n    public getChildCellInfo(child: Control): string {\r\n        return child._tag;\r\n    }\r\n\r\n    private _removeCell(cell: Container, key: string) {\r\n        if (!cell) {\r\n            return;\r\n        }\r\n\r\n        super.removeControl(cell);\r\n\r\n        for (const control of cell.children) {\r\n            const childIndex = this._childControls.indexOf(control);\r\n\r\n            if (childIndex !== -1) {\r\n                this._childControls.splice(childIndex, 1);\r\n            }\r\n        }\r\n\r\n        delete this._cells[key];\r\n    }\r\n\r\n    private _offsetCell(previousKey: string, key: string) {\r\n        if (!this._cells[key]) {\r\n            return;\r\n        }\r\n\r\n        this._cells[previousKey] = this._cells[key];\r\n\r\n        for (const control of this._cells[previousKey].children) {\r\n            control._tag = previousKey;\r\n        }\r\n\r\n        delete this._cells[key];\r\n    }\r\n\r\n    /**\r\n     * Remove a column definition at specified index\r\n     * @param index defines the index of the column to remove\r\n     * @returns the current grid\r\n     */\r\n    public removeColumnDefinition(index: number): Grid {\r\n        if (index < 0 || index >= this._columnDefinitions.length) {\r\n            return this;\r\n        }\r\n\r\n        for (let x = 0; x < this._rowDefinitions.length; x++) {\r\n            const key = `${x}:${index}`;\r\n            const cell = this._cells[key];\r\n\r\n            this._removeCell(cell, key);\r\n        }\r\n\r\n        for (let x = 0; x < this._rowDefinitions.length; x++) {\r\n            for (let y = index + 1; y < this._columnDefinitions.length; y++) {\r\n                const previousKey = `${x}:${y - 1}`;\r\n                const key = `${x}:${y}`;\r\n\r\n                this._offsetCell(previousKey, key);\r\n            }\r\n        }\r\n\r\n        this._columnDefinitions[index].onChangedObservable.remove(this._columnDefinitionObservers[index]);\r\n        this._columnDefinitions.splice(index, 1);\r\n        this._columnDefinitionObservers.splice(index, 1);\r\n\r\n        this._markAsDirty();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Remove a row definition at specified index\r\n     * @param index defines the index of the row to remove\r\n     * @returns the current grid\r\n     */\r\n    public removeRowDefinition(index: number): Grid {\r\n        if (index < 0 || index >= this._rowDefinitions.length) {\r\n            return this;\r\n        }\r\n\r\n        for (let y = 0; y < this._columnDefinitions.length; y++) {\r\n            const key = `${index}:${y}`;\r\n            const cell = this._cells[key];\r\n\r\n            this._removeCell(cell, key);\r\n        }\r\n\r\n        for (let y = 0; y < this._columnDefinitions.length; y++) {\r\n            for (let x = index + 1; x < this._rowDefinitions.length; x++) {\r\n                const previousKey = `${x - 1}:${y}`;\r\n                const key = `${x}:${y}`;\r\n\r\n                this._offsetCell(previousKey, key);\r\n            }\r\n        }\r\n\r\n        this._rowDefinitions[index].onChangedObservable.remove(this._rowDefinitionObservers[index]);\r\n        this._rowDefinitions.splice(index, 1);\r\n        this._rowDefinitionObservers.splice(index, 1);\r\n\r\n        this._markAsDirty();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds a new control to the current grid\r\n     * @param control defines the control to add\r\n     * @param row defines the row where to add the control (0 by default)\r\n     * @param column defines the column where to add the control (0 by default)\r\n     * @returns the current grid\r\n     */\r\n    public addControl(control: Control, row: number = 0, column: number = 0): Grid {\r\n        if (this._rowDefinitions.length === 0) {\r\n            // Add default row definition\r\n            this.addRowDefinition(1, false);\r\n        }\r\n\r\n        if (this._columnDefinitions.length === 0) {\r\n            // Add default column definition\r\n            this.addColumnDefinition(1, false);\r\n        }\r\n\r\n        if (this._childControls.indexOf(control) !== -1) {\r\n            Tools.Warn(`Control (Name:${control.name}, UniqueId:${control.uniqueId}) is already associated with this grid. You must remove it before reattaching it`);\r\n            return this;\r\n        }\r\n\r\n        const x = Math.min(row, this._rowDefinitions.length - 1);\r\n        const y = Math.min(column, this._columnDefinitions.length - 1);\r\n        const key = `${x}:${y}`;\r\n        let goodContainer = this._cells[key];\r\n\r\n        if (!goodContainer) {\r\n            goodContainer = new Container(key);\r\n            this._cells[key] = goodContainer;\r\n            goodContainer.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n            goodContainer.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n            goodContainer.clipContent = this.clipContent;\r\n            goodContainer.clipChildren = this.clipChildren;\r\n            super.addControl(goodContainer);\r\n        }\r\n\r\n        goodContainer.addControl(control);\r\n        this._childControls.push(control);\r\n        control._tag = key;\r\n        control.parent = this;\r\n\r\n        this._markAsDirty();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Removes a control from the current container\r\n     * @param control defines the control to remove\r\n     * @returns the current container\r\n     */\r\n    public removeControl(control: Control): Container {\r\n        const index = this._childControls.indexOf(control);\r\n\r\n        if (index !== -1) {\r\n            this._childControls.splice(index, 1);\r\n        }\r\n\r\n        const cell = this._cells[control._tag];\r\n\r\n        if (cell) {\r\n            cell.removeControl(control);\r\n            control._tag = null;\r\n        }\r\n\r\n        this._markAsDirty();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Creates a new Grid\r\n     * @param name defines control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Grid\";\r\n    }\r\n\r\n    protected _getGridDefinitions(definitionCallback: (lefts: number[], tops: number[], widths: number[], heights: number[]) => void) {\r\n        const widths = [];\r\n        const heights = [];\r\n        const lefts = [];\r\n        const tops = [];\r\n\r\n        let availableWidth = this._currentMeasure.width;\r\n        let globalWidthPercentage = 0;\r\n        let availableHeight = this._currentMeasure.height;\r\n        let globalHeightPercentage = 0;\r\n\r\n        // Heights\r\n        let index = 0;\r\n        for (const rowDefinition of this._rowDefinitions) {\r\n            if (rowDefinition.isPixel) {\r\n                const height = rowDefinition.getValue(this._host);\r\n                availableHeight -= height;\r\n                heights[index] = height;\r\n            } else {\r\n                globalHeightPercentage += rowDefinition.value;\r\n            }\r\n            index++;\r\n        }\r\n\r\n        let top = 0;\r\n        index = 0;\r\n        for (const rowDefinition of this._rowDefinitions) {\r\n            tops.push(top);\r\n\r\n            if (!rowDefinition.isPixel) {\r\n                const height = Math.round((rowDefinition.value / globalHeightPercentage) * availableHeight);\r\n                top += height;\r\n                heights[index] = height;\r\n            } else {\r\n                top += rowDefinition.getValue(this._host);\r\n            }\r\n            index++;\r\n        }\r\n\r\n        // Widths\r\n        index = 0;\r\n        for (const columnDefinition of this._columnDefinitions) {\r\n            if (columnDefinition.isPixel) {\r\n                const width = columnDefinition.getValue(this._host);\r\n                availableWidth -= width;\r\n                widths[index] = width;\r\n            } else {\r\n                globalWidthPercentage += columnDefinition.value;\r\n            }\r\n            index++;\r\n        }\r\n\r\n        let left = 0;\r\n        index = 0;\r\n        for (const columnDefinition of this._columnDefinitions) {\r\n            lefts.push(left);\r\n            if (!columnDefinition.isPixel) {\r\n                const width = Math.round((columnDefinition.value / globalWidthPercentage) * availableWidth);\r\n                left += width;\r\n                widths[index] = width;\r\n            } else {\r\n                left += columnDefinition.getValue(this._host);\r\n            }\r\n            index++;\r\n        }\r\n\r\n        definitionCallback(lefts, tops, widths, heights);\r\n    }\r\n\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        this._getGridDefinitions((lefts: number[], tops: number[], widths: number[], heights: number[]) => {\r\n            // Setting child sizes\r\n            for (const key in this._cells) {\r\n                if (!Object.prototype.hasOwnProperty.call(this._cells, key)) {\r\n                    continue;\r\n                }\r\n                const split = key.split(\":\");\r\n                const x = parseInt(split[0]);\r\n                const y = parseInt(split[1]);\r\n                const cell = this._cells[key];\r\n\r\n                cell.leftInPixels = lefts[y];\r\n                cell.topInPixels = tops[x];\r\n                cell.widthInPixels = widths[y];\r\n                cell.heightInPixels = heights[x];\r\n                cell._left.ignoreAdaptiveScaling = true;\r\n                cell._top.ignoreAdaptiveScaling = true;\r\n                cell._width.ignoreAdaptiveScaling = true;\r\n                cell._height.ignoreAdaptiveScaling = true;\r\n            }\r\n        });\r\n\r\n        super._additionalProcessing(parentMeasure, context);\r\n    }\r\n\r\n    public _flagDescendantsAsMatrixDirty(): void {\r\n        for (const key in this._cells) {\r\n            if (!Object.prototype.hasOwnProperty.call(this._cells, key)) {\r\n                continue;\r\n            }\r\n\r\n            const child = this._cells[key];\r\n            child._markMatrixAsDirty();\r\n        }\r\n    }\r\n\r\n    public _renderHighlightSpecific(context: ICanvasRenderingContext): void {\r\n        super._renderHighlightSpecific(context);\r\n\r\n        this._getGridDefinitions((lefts: number[], tops: number[], widths: number[], heights: number[]) => {\r\n            // Columns\r\n            for (let index = 0; index < lefts.length; index++) {\r\n                const left = this._currentMeasure.left + lefts[index] + widths[index];\r\n                context.beginPath();\r\n                context.moveTo(left, this._currentMeasure.top);\r\n                context.lineTo(left, this._currentMeasure.top + this._currentMeasure.height);\r\n                context.stroke();\r\n            }\r\n\r\n            // Rows\r\n            for (let index = 0; index < tops.length; index++) {\r\n                const top = this._currentMeasure.top + tops[index] + heights[index];\r\n                context.beginPath();\r\n                context.moveTo(this._currentMeasure.left, top);\r\n                context.lineTo(this._currentMeasure.left + this._currentMeasure.width, top);\r\n                context.stroke();\r\n            }\r\n        });\r\n\r\n        context.restore();\r\n    }\r\n\r\n    /** Releases associated resources */\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        for (const control of this._childControls) {\r\n            control.dispose();\r\n        }\r\n        for (let index = 0; index < this._rowDefinitions.length; index++) {\r\n            this._rowDefinitions[index].onChangedObservable.remove(this._rowDefinitionObservers[index]);\r\n        }\r\n        for (let index = 0; index < this._columnDefinitions.length; index++) {\r\n            this._columnDefinitions[index].onChangedObservable.remove(this._columnDefinitionObservers[index]);\r\n        }\r\n        this._rowDefinitionObservers.length = 0;\r\n        this._rowDefinitions.length = 0;\r\n        this._columnDefinitionObservers.length = 0;\r\n        this._columnDefinitions.length = 0;\r\n        this._cells = {};\r\n        this._childControls.length = 0;\r\n    }\r\n\r\n    /**\r\n     * Serializes the current control\r\n     * @param serializationObject defined the JSON serialized object\r\n     */\r\n    public serialize(serializationObject: any) {\r\n        super.serialize(serializationObject);\r\n        serializationObject.columnCount = this.columnCount;\r\n        serializationObject.rowCount = this.rowCount;\r\n        serializationObject.columns = [];\r\n        serializationObject.rows = [];\r\n        serializationObject.tags = [];\r\n        for (let i = 0; i < this.columnCount; ++i) {\r\n            const cd = this.getColumnDefinition(i);\r\n            const childSerializationObject = { value: cd?.getValue(this.host), unit: cd?.unit };\r\n            serializationObject.columns.push(childSerializationObject);\r\n        }\r\n        for (let i = 0; i < this.rowCount; ++i) {\r\n            const rd = this.getRowDefinition(i);\r\n            const childSerializationObject = { value: rd?.getValue(this.host), unit: rd?.unit };\r\n            serializationObject.rows.push(childSerializationObject);\r\n        }\r\n        this.children.forEach((child) => {\r\n            serializationObject.tags.push(child._tag);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        super._parseFromContent(serializedObject, host);\r\n        const children: Control[] = [];\r\n        this.children.forEach((child) => {\r\n            children.push(child);\r\n        });\r\n        this.removeRowDefinition(0);\r\n        this.removeColumnDefinition(0);\r\n        for (let i = 0; i < serializedObject.columnCount; ++i) {\r\n            const columnValue = serializedObject.columns[i].value;\r\n            const unit = serializedObject.columns[i].unit;\r\n            this.addColumnDefinition(columnValue, unit === 1 ? true : false);\r\n        }\r\n        for (let i = 0; i < serializedObject.rowCount; ++i) {\r\n            const rowValue = serializedObject.rows[i].value;\r\n            const unit = serializedObject.rows[i].unit;\r\n            this.addRowDefinition(rowValue, unit === 1 ? true : false);\r\n        }\r\n\r\n        for (let i = 0; i < children.length; ++i) {\r\n            const cellInfo = serializedObject.tags[i];\r\n            let rowNumber = parseInt(cellInfo.substring(0, cellInfo.search(\":\")));\r\n            if (isNaN(rowNumber)) {\r\n                rowNumber = 0;\r\n            }\r\n            let columnNumber = parseInt(cellInfo.substring(cellInfo.search(\":\") + 1));\r\n            if (isNaN(columnNumber)) {\r\n                columnNumber = 0;\r\n            }\r\n            this.addControl(children[i], rowNumber, columnNumber);\r\n        }\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Grid\", Grid);\r\n","import { Observable } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Control } from \"./control\";\r\nimport type { Measure } from \"../measure\";\r\nimport { InputText } from \"./inputText\";\r\nimport { Rectangle } from \"./rectangle\";\r\nimport { Button } from \"./button\";\r\nimport { Grid } from \"./grid\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport { TextBlock } from \"../controls/textBlock\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvas, ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport { EngineStore } from \"core/Engines/engineStore\";\r\n\r\n/** Class used to create color pickers */\r\nexport class ColorPicker extends Control {\r\n    private static _Epsilon = 0.000001;\r\n    private _colorWheelCanvas: ICanvas;\r\n\r\n    private _value: Color3 = Color3.Red();\r\n    private _tmpColor = new Color3();\r\n\r\n    private _pointerStartedOnSquare = false;\r\n    private _pointerStartedOnWheel = false;\r\n\r\n    private _squareLeft = 0;\r\n    private _squareTop = 0;\r\n    private _squareSize = 0;\r\n\r\n    private _h = 360;\r\n    private _s = 1;\r\n    private _v = 1;\r\n\r\n    private _lastPointerDownId = -1;\r\n\r\n    /**\r\n     * Observable raised when the value changes\r\n     */\r\n    public onValueChangedObservable = new Observable<Color3>();\r\n\r\n    /** Gets or sets the color of the color picker */\r\n    @serialize()\r\n    public get value(): Color3 {\r\n        return this._value;\r\n    }\r\n\r\n    public set value(value: Color3) {\r\n        if (this._value.equals(value)) {\r\n            return;\r\n        }\r\n\r\n        this._value.copyFrom(value);\r\n\r\n        this._value.toHSVToRef(this._tmpColor);\r\n\r\n        this._h = this._tmpColor.r;\r\n        this._s = Math.max(this._tmpColor.g, 0.00001);\r\n        this._v = Math.max(this._tmpColor.b, 0.00001);\r\n\r\n        this._markAsDirty();\r\n\r\n        if (this._value.r <= ColorPicker._Epsilon) {\r\n            this._value.r = 0;\r\n        }\r\n\r\n        if (this._value.g <= ColorPicker._Epsilon) {\r\n            this._value.g = 0;\r\n        }\r\n\r\n        if (this._value.b <= ColorPicker._Epsilon) {\r\n            this._value.b = 0;\r\n        }\r\n\r\n        if (this._value.r >= 1.0 - ColorPicker._Epsilon) {\r\n            this._value.r = 1.0;\r\n        }\r\n\r\n        if (this._value.g >= 1.0 - ColorPicker._Epsilon) {\r\n            this._value.g = 1.0;\r\n        }\r\n\r\n        if (this._value.b >= 1.0 - ColorPicker._Epsilon) {\r\n            this._value.b = 1.0;\r\n        }\r\n\r\n        this.onValueChangedObservable.notifyObservers(this._value);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets control width\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get width(): string | number {\r\n        return this._width.toString(this._host);\r\n    }\r\n\r\n    public set width(value: string | number) {\r\n        if (this._width.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._width.fromString(value)) {\r\n            if (this._width.getValue(this._host) === 0) {\r\n                value = \"1px\";\r\n                this._width.fromString(value);\r\n            }\r\n            this._height.fromString(value);\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets control height\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#position-and-size\r\n     */\r\n    @serialize()\r\n    public get height(): string | number {\r\n        return this._height.toString(this._host);\r\n    }\r\n\r\n    /** Gets or sets control height */\r\n    public set height(value: string | number) {\r\n        if (this._height.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._height.fromString(value)) {\r\n            if (this._height.getValue(this._host) === 0) {\r\n                value = \"1px\";\r\n                this._height.fromString(value);\r\n            }\r\n            this._width.fromString(value);\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets control size */\r\n    @serialize()\r\n    public get size(): string | number {\r\n        return this.width;\r\n    }\r\n\r\n    public set size(value: string | number) {\r\n        this.width = value;\r\n    }\r\n\r\n    /**\r\n     * Creates a new ColorPicker\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n        this.value = new Color3(0.88, 0.1, 0.1);\r\n        this.size = \"200px\";\r\n        this.isPointerBlocker = true;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"ColorPicker\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _preMeasure(parentMeasure: Measure): void {\r\n        if (parentMeasure.width < parentMeasure.height) {\r\n            this._currentMeasure.height = parentMeasure.width;\r\n        } else {\r\n            this._currentMeasure.width = parentMeasure.height;\r\n        }\r\n    }\r\n\r\n    private _updateSquareProps(): void {\r\n        const radius = Math.min(this._currentMeasure.width, this._currentMeasure.height) * 0.5;\r\n        const wheelThickness = radius * 0.2;\r\n        const innerDiameter = (radius - wheelThickness) * 2;\r\n        const squareSize = innerDiameter / Math.sqrt(2);\r\n        const offset = radius - squareSize * 0.5;\r\n\r\n        this._squareLeft = this._currentMeasure.left + offset;\r\n        this._squareTop = this._currentMeasure.top + offset;\r\n        this._squareSize = squareSize;\r\n    }\r\n\r\n    private _drawGradientSquare(hueValue: number, left: number, top: number, width: number, height: number, context: ICanvasRenderingContext) {\r\n        const lgh = context.createLinearGradient(left, top, width + left, top);\r\n        lgh.addColorStop(0, \"#fff\");\r\n        lgh.addColorStop(1, \"hsl(\" + hueValue + \", 100%, 50%)\");\r\n\r\n        context.fillStyle = lgh;\r\n        context.fillRect(left, top, width, height);\r\n\r\n        const lgv = context.createLinearGradient(left, top, left, height + top);\r\n        lgv.addColorStop(0, \"rgba(0,0,0,0)\");\r\n        lgv.addColorStop(1, \"#000\");\r\n\r\n        context.fillStyle = lgv;\r\n        context.fillRect(left, top, width, height);\r\n    }\r\n\r\n    private _drawCircle(centerX: number, centerY: number, radius: number, context: ICanvasRenderingContext) {\r\n        context.beginPath();\r\n        context.arc(centerX, centerY, radius + 1, 0, 2 * Math.PI, false);\r\n        context.lineWidth = 3;\r\n        context.strokeStyle = \"#333333\";\r\n        context.stroke();\r\n        context.beginPath();\r\n        context.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);\r\n        context.lineWidth = 3;\r\n        context.strokeStyle = \"#ffffff\";\r\n        context.stroke();\r\n    }\r\n\r\n    private _createColorWheelCanvas(radius: number, thickness: number): ICanvas {\r\n        // Shoudl abstract platform instead of using LastCreatedEngine\r\n        const engine = EngineStore.LastCreatedEngine;\r\n        if (!engine) {\r\n            throw new Error(\"Invalid engine. Unable to create a canvas.\");\r\n        }\r\n        const canvas = engine.createCanvas(radius * 2, radius * 2);\r\n        const context = canvas.getContext(\"2d\");\r\n        const image = context.getImageData(0, 0, radius * 2, radius * 2);\r\n        const data = image.data;\r\n\r\n        const color = this._tmpColor;\r\n        const maxDistSq = radius * radius;\r\n        const innerRadius = radius - thickness;\r\n        const minDistSq = innerRadius * innerRadius;\r\n\r\n        for (let x = -radius; x < radius; x++) {\r\n            for (let y = -radius; y < radius; y++) {\r\n                const distSq = x * x + y * y;\r\n\r\n                if (distSq > maxDistSq || distSq < minDistSq) {\r\n                    continue;\r\n                }\r\n\r\n                const dist = Math.sqrt(distSq);\r\n                const ang = Math.atan2(y, x);\r\n\r\n                Color3.HSVtoRGBToRef((ang * 180) / Math.PI + 180, dist / radius, 1, color);\r\n\r\n                const index = (x + radius + (y + radius) * 2 * radius) * 4;\r\n\r\n                data[index] = color.r * 255;\r\n                data[index + 1] = color.g * 255;\r\n                data[index + 2] = color.b * 255;\r\n                let alphaRatio = (dist - innerRadius) / (radius - innerRadius);\r\n\r\n                //apply less alpha to bigger color pickers\r\n                let alphaAmount = 0.2;\r\n                const maxAlpha = 0.2;\r\n                const minAlpha = 0.04;\r\n                const lowerRadius = 50;\r\n                const upperRadius = 150;\r\n\r\n                if (radius < lowerRadius) {\r\n                    alphaAmount = maxAlpha;\r\n                } else if (radius > upperRadius) {\r\n                    alphaAmount = minAlpha;\r\n                } else {\r\n                    alphaAmount = ((minAlpha - maxAlpha) * (radius - lowerRadius)) / (upperRadius - lowerRadius) + maxAlpha;\r\n                }\r\n\r\n                alphaRatio = (dist - innerRadius) / (radius - innerRadius);\r\n\r\n                if (alphaRatio < alphaAmount) {\r\n                    data[index + 3] = 255 * (alphaRatio / alphaAmount);\r\n                } else if (alphaRatio > 1 - alphaAmount) {\r\n                    data[index + 3] = 255 * (1.0 - (alphaRatio - (1 - alphaAmount)) / alphaAmount);\r\n                } else {\r\n                    data[index + 3] = 255;\r\n                }\r\n            }\r\n        }\r\n\r\n        context.putImageData(image, 0, 0);\r\n\r\n        return canvas;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n\r\n        const radius = Math.min(this._currentMeasure.width, this._currentMeasure.height) * 0.5;\r\n        const wheelThickness = radius * 0.2;\r\n        const left = this._currentMeasure.left;\r\n        const top = this._currentMeasure.top;\r\n\r\n        if (!this._colorWheelCanvas || this._colorWheelCanvas.width != radius * 2) {\r\n            this._colorWheelCanvas = this._createColorWheelCanvas(radius, wheelThickness);\r\n        }\r\n\r\n        this._updateSquareProps();\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n\r\n            context.fillRect(this._squareLeft, this._squareTop, this._squareSize, this._squareSize);\r\n        }\r\n\r\n        context.drawImage(this._colorWheelCanvas, left, top);\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n\r\n        this._drawGradientSquare(this._h, this._squareLeft, this._squareTop, this._squareSize, this._squareSize, context);\r\n\r\n        let cx = this._squareLeft + this._squareSize * this._s;\r\n        let cy = this._squareTop + this._squareSize * (1 - this._v);\r\n\r\n        this._drawCircle(cx, cy, radius * 0.04, context);\r\n\r\n        const dist = radius - wheelThickness * 0.5;\r\n        cx = left + radius + Math.cos(((this._h - 180) * Math.PI) / 180) * dist;\r\n        cy = top + radius + Math.sin(((this._h - 180) * Math.PI) / 180) * dist;\r\n        this._drawCircle(cx, cy, wheelThickness * 0.35, context);\r\n\r\n        context.restore();\r\n    }\r\n\r\n    // Events\r\n    private _pointerIsDown = false;\r\n\r\n    private _updateValueFromPointer(x: number, y: number): void {\r\n        if (this._pointerStartedOnWheel) {\r\n            const radius = Math.min(this._currentMeasure.width, this._currentMeasure.height) * 0.5;\r\n            const centerX = radius + this._currentMeasure.left;\r\n            const centerY = radius + this._currentMeasure.top;\r\n            this._h = (Math.atan2(y - centerY, x - centerX) * 180) / Math.PI + 180;\r\n        } else if (this._pointerStartedOnSquare) {\r\n            this._updateSquareProps();\r\n            this._s = (x - this._squareLeft) / this._squareSize;\r\n            this._v = 1 - (y - this._squareTop) / this._squareSize;\r\n            this._s = Math.min(this._s, 1);\r\n            this._s = Math.max(this._s, ColorPicker._Epsilon);\r\n            this._v = Math.min(this._v, 1);\r\n            this._v = Math.max(this._v, ColorPicker._Epsilon);\r\n        }\r\n\r\n        Color3.HSVtoRGBToRef(this._h, this._s, this._v, this._tmpColor);\r\n\r\n        this.value = this._tmpColor;\r\n    }\r\n\r\n    private _isPointOnSquare(x: number, y: number): boolean {\r\n        this._updateSquareProps();\r\n\r\n        const left = this._squareLeft;\r\n        const top = this._squareTop;\r\n        const size = this._squareSize;\r\n\r\n        if (x >= left && x <= left + size && y >= top && y <= top + size) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    private _isPointOnWheel(x: number, y: number): boolean {\r\n        const radius = Math.min(this._currentMeasure.width, this._currentMeasure.height) * 0.5;\r\n        const centerX = radius + this._currentMeasure.left;\r\n        const centerY = radius + this._currentMeasure.top;\r\n        const wheelThickness = radius * 0.2;\r\n        const innerRadius = radius - wheelThickness;\r\n        const radiusSq = radius * radius;\r\n        const innerRadiusSq = innerRadius * innerRadius;\r\n\r\n        const dx = x - centerX;\r\n        const dy = y - centerY;\r\n\r\n        const distSq = dx * dx + dy * dy;\r\n\r\n        if (distSq <= radiusSq && distSq >= innerRadiusSq) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isReadOnly) {\r\n            return true;\r\n        }\r\n\r\n        this._pointerIsDown = true;\r\n\r\n        this._pointerStartedOnSquare = false;\r\n        this._pointerStartedOnWheel = false;\r\n\r\n        // Invert transform\r\n        this._invertTransformMatrix.transformCoordinates(coordinates.x, coordinates.y, this._transformedPosition);\r\n\r\n        const x = this._transformedPosition.x;\r\n        const y = this._transformedPosition.y;\r\n\r\n        if (this._isPointOnSquare(x, y)) {\r\n            this._pointerStartedOnSquare = true;\r\n        } else if (this._isPointOnWheel(x, y)) {\r\n            this._pointerStartedOnWheel = true;\r\n        }\r\n\r\n        this._updateValueFromPointer(x, y);\r\n        this._host._capturingControl[pointerId] = this;\r\n        this._lastPointerDownId = pointerId;\r\n        return true;\r\n    }\r\n\r\n    public _onPointerMove(target: Control, coordinates: Vector2, pointerId: number, pi: PointerInfoBase): void {\r\n        // Only listen to pointer move events coming from the last pointer to click on the element (To support dual vr controller interaction)\r\n        if (pointerId != this._lastPointerDownId) {\r\n            return;\r\n        }\r\n\r\n        if (!this.isReadOnly) {\r\n            // Invert transform\r\n            this._invertTransformMatrix.transformCoordinates(coordinates.x, coordinates.y, this._transformedPosition);\r\n\r\n            const x = this._transformedPosition.x;\r\n            const y = this._transformedPosition.y;\r\n\r\n            if (this._pointerIsDown) {\r\n                this._updateValueFromPointer(x, y);\r\n            }\r\n        }\r\n\r\n        super._onPointerMove(target, coordinates, pointerId, pi);\r\n    }\r\n\r\n    public _onPointerUp(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, notifyClick: boolean, pi: PointerInfoBase): void {\r\n        this._pointerIsDown = false;\r\n\r\n        delete this._host._capturingControl[pointerId];\r\n        super._onPointerUp(target, coordinates, pointerId, buttonIndex, notifyClick, pi);\r\n    }\r\n\r\n    public _onCanvasBlur() {\r\n        this._forcePointerUp();\r\n        super._onCanvasBlur();\r\n    }\r\n\r\n    /**\r\n     * This function expands the color picker by creating a color picker dialog with manual\r\n     * color value input and the ability to save colors into an array to be used later in\r\n     * subsequent launches of the dialogue.\r\n     * @param advancedTexture defines the AdvancedDynamicTexture the dialog is assigned to\r\n     * @param options defines size for dialog and options for saved colors. Also accepts last color picked as hex string and saved colors array as hex strings.\r\n     * @param options.pickerWidth\r\n     * @param options.pickerHeight\r\n     * @param options.headerHeight\r\n     * @param options.lastColor\r\n     * @param options.swatchLimit\r\n     * @param options.numSwatchesPerLine\r\n     * @param options.savedColors\r\n     * @returns picked color as a hex string and the saved colors array as hex strings.\r\n     */\r\n    public static ShowPickerDialogAsync(\r\n        advancedTexture: AdvancedDynamicTexture,\r\n        options: {\r\n            pickerWidth?: string;\r\n            pickerHeight?: string;\r\n            headerHeight?: string;\r\n            lastColor?: string;\r\n            swatchLimit?: number;\r\n            numSwatchesPerLine?: number;\r\n            savedColors?: Array<string>;\r\n        }\r\n    ): Promise<{\r\n        savedColors?: string[];\r\n        pickedColor: string;\r\n    }> {\r\n        return new Promise((resolve) => {\r\n            // Default options\r\n            options.pickerWidth = options.pickerWidth || \"640px\";\r\n            options.pickerHeight = options.pickerHeight || \"400px\";\r\n            options.headerHeight = options.headerHeight || \"35px\";\r\n            options.lastColor = options.lastColor || \"#000000\";\r\n            options.swatchLimit = options.swatchLimit || 20;\r\n            options.numSwatchesPerLine = options.numSwatchesPerLine || 10;\r\n\r\n            // Window size settings\r\n            const drawerMaxRows: number = options.swatchLimit / options.numSwatchesPerLine;\r\n            const rawSwatchSize: number = parseFloat(<string>options.pickerWidth) / options.numSwatchesPerLine;\r\n            const gutterSize: number = Math.floor(rawSwatchSize * 0.25);\r\n            const colGutters: number = gutterSize * (options.numSwatchesPerLine + 1);\r\n            const swatchSize: number = Math.floor((parseFloat(<string>options.pickerWidth) - colGutters) / options.numSwatchesPerLine);\r\n            const drawerMaxSize: number = swatchSize * drawerMaxRows + gutterSize * (drawerMaxRows + 1);\r\n            const containerSize: string = (parseInt(options.pickerHeight) + drawerMaxSize + Math.floor(swatchSize * 0.25)).toString() + \"px\";\r\n\r\n            // Button Colors\r\n            const buttonColor: string = \"#c0c0c0\";\r\n            const buttonBackgroundColor: string = \"#535353\";\r\n            const buttonBackgroundHoverColor: string = \"#414141\";\r\n            const buttonBackgroundClickColor: string = \"515151\";\r\n            const buttonDisabledColor: string = \"#555555\";\r\n            const buttonDisabledBackgroundColor: string = \"#454545\";\r\n            const currentSwatchesOutlineColor: string = \"#404040\";\r\n            const luminanceLimitColor: Color3 = Color3.FromHexString(\"#dddddd\");\r\n            const luminanceLimit: number = luminanceLimitColor.r + luminanceLimitColor.g + luminanceLimitColor.b;\r\n            const iconColorDark: string = \"#aaaaaa\";\r\n            const iconColorLight: string = \"#ffffff\";\r\n\r\n            // Button settings\r\n            let buttonFontSize: number;\r\n            let butEdit: Button;\r\n\r\n            // Input Text Colors\r\n            const inputFieldLabels: string[] = [\"R\", \"G\", \"B\"];\r\n            const inputTextBackgroundColor: string = \"#454545\";\r\n            const inputTextColor: string = \"#f0f0f0\";\r\n\r\n            // This int is used for naming swatches and serves as the index for calling them from the list\r\n            let swatchNumber: number;\r\n\r\n            // Menu Panel options. We need to know if the swatchDrawer exists so we can create it if needed.\r\n            let swatchDrawer: Grid;\r\n            let editSwatchMode: boolean = false;\r\n\r\n            // Color InputText fields that will be updated upon value change\r\n            let butSave: Button;\r\n            let lastVal: string;\r\n            let activeField: string;\r\n\r\n            // Dialog menu container which will contain both the main dialogue window and the swatch drawer which opens once a color is saved.\r\n            const dialogContainer: Grid = new Grid();\r\n            dialogContainer.name = \"Dialog Container\";\r\n            dialogContainer.width = options.pickerWidth;\r\n            if (options.savedColors) {\r\n                dialogContainer.height = containerSize;\r\n                const topRow: number = parseInt(options.pickerHeight) / parseInt(containerSize);\r\n                dialogContainer.addRowDefinition(topRow, false);\r\n                dialogContainer.addRowDefinition(1.0 - topRow, false);\r\n            } else {\r\n                dialogContainer.height = options.pickerHeight;\r\n                dialogContainer.addRowDefinition(1.0, false);\r\n            }\r\n            advancedTexture.addControl(dialogContainer);\r\n\r\n            // Swatch drawer which contains all saved color buttons\r\n            if (options.savedColors) {\r\n                swatchDrawer = new Grid();\r\n                swatchDrawer.name = \"Swatch Drawer\";\r\n                swatchDrawer.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n                swatchDrawer.background = buttonBackgroundColor;\r\n                swatchDrawer.width = options.pickerWidth!;\r\n                const initialRows: number = options.savedColors.length / options.numSwatchesPerLine;\r\n                let gutterCount: number;\r\n                if (initialRows == 0) {\r\n                    gutterCount = 0;\r\n                } else {\r\n                    gutterCount = initialRows + 1;\r\n                }\r\n                swatchDrawer.height = (swatchSize * initialRows + gutterCount * gutterSize).toString() + \"px\";\r\n                swatchDrawer.top = Math.floor(swatchSize * 0.25).toString() + \"px\";\r\n                for (let i = 0; i < Math.ceil(options.savedColors.length / options.numSwatchesPerLine) * 2 + 1; i++) {\r\n                    if (i % 2 != 0) {\r\n                        swatchDrawer.addRowDefinition(swatchSize, true);\r\n                    } else {\r\n                        swatchDrawer.addRowDefinition(gutterSize, true);\r\n                    }\r\n                }\r\n                for (let i = 0; i < options.numSwatchesPerLine! * 2 + 1; i++) {\r\n                    if (i % 2 != 0) {\r\n                        swatchDrawer.addColumnDefinition(swatchSize, true);\r\n                    } else {\r\n                        swatchDrawer.addColumnDefinition(gutterSize, true);\r\n                    }\r\n                }\r\n                dialogContainer.addControl(swatchDrawer, 1, 0);\r\n            }\r\n\r\n            // Picker container\r\n            const pickerPanel: Grid = new Grid();\r\n            pickerPanel.name = \"Picker Panel\";\r\n            pickerPanel.height = options.pickerHeight;\r\n            const panelHead: number = parseInt(options.headerHeight) / parseInt(options.pickerHeight);\r\n            const pickerPanelRows: number[] = [panelHead, 1.0 - panelHead];\r\n            pickerPanel.addRowDefinition(pickerPanelRows[0], false);\r\n            pickerPanel.addRowDefinition(pickerPanelRows[1], false);\r\n            dialogContainer.addControl(pickerPanel, 0, 0);\r\n\r\n            // Picker container header\r\n            const header: Rectangle = new Rectangle();\r\n            header.name = \"Dialogue Header Bar\";\r\n            header.background = \"#cccccc\";\r\n            header.thickness = 0;\r\n            pickerPanel.addControl(header, 0, 0);\r\n\r\n            // Header close button\r\n            const closeButton: Button = Button.CreateSimpleButton(\"closeButton\", \"a\");\r\n            closeButton.fontFamily = \"coreglyphs\";\r\n            const headerColor3: Color3 = Color3.FromHexString(header.background);\r\n            const closeIconColor = new Color3(1.0 - headerColor3.r, 1.0 - headerColor3.g, 1.0 - headerColor3.b);\r\n            closeButton.color = closeIconColor.toHexString();\r\n            closeButton.fontSize = Math.floor(parseInt(options.headerHeight!) * 0.6);\r\n            closeButton.textBlock!.textVerticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n            closeButton.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_RIGHT;\r\n            closeButton.height = closeButton.width = options.headerHeight;\r\n            closeButton.background = header.background;\r\n            closeButton.thickness = 0;\r\n            closeButton.pointerDownAnimation = () => {};\r\n            closeButton.pointerUpAnimation = () => {\r\n                closeButton.background = header.background;\r\n            };\r\n            closeButton.pointerEnterAnimation = () => {\r\n                closeButton.color = header.background;\r\n                closeButton.background = \"red\";\r\n            };\r\n            closeButton.pointerOutAnimation = () => {\r\n                closeButton.color = closeIconColor.toHexString();\r\n                closeButton.background = header.background;\r\n            };\r\n            closeButton.onPointerClickObservable.add(() => {\r\n                closePicker(currentSwatch.background);\r\n            });\r\n            pickerPanel.addControl(closeButton, 0, 0);\r\n\r\n            // Dialog container body\r\n            const dialogBody: Grid = new Grid();\r\n            dialogBody.name = \"Dialogue Body\";\r\n            dialogBody.background = buttonBackgroundColor;\r\n            const dialogBodyCols: number[] = [0.4375, 0.5625];\r\n            dialogBody.addRowDefinition(1.0, false);\r\n            dialogBody.addColumnDefinition(dialogBodyCols[0], false);\r\n            dialogBody.addColumnDefinition(dialogBodyCols[1], false);\r\n            pickerPanel.addControl(dialogBody, 1, 0);\r\n\r\n            // Picker grid\r\n            const pickerGrid: Grid = new Grid();\r\n            pickerGrid.name = \"Picker Grid\";\r\n            pickerGrid.addRowDefinition(0.85, false);\r\n            pickerGrid.addRowDefinition(0.15, false);\r\n            dialogBody.addControl(pickerGrid, 0, 0);\r\n\r\n            //  Picker control\r\n            const picker = new ColorPicker();\r\n            picker.name = \"GUI Color Picker\";\r\n            if (options.pickerHeight < options.pickerWidth) {\r\n                picker.width = 0.89;\r\n            } else {\r\n                picker.height = 0.89;\r\n            }\r\n            picker.value = Color3.FromHexString(options.lastColor);\r\n            picker.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n            picker.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n            picker.onPointerDownObservable.add(() => {\r\n                activeField = picker.name!;\r\n                lastVal = \"\";\r\n                editSwatches(false);\r\n            });\r\n            picker.onValueChangedObservable.add(function (value) {\r\n                // value is a color3\r\n                if (activeField == picker.name) {\r\n                    updateValues(value, picker.name);\r\n                }\r\n            });\r\n            pickerGrid.addControl(picker, 0, 0);\r\n\r\n            // Picker body right quarant\r\n            const pickerBodyRight: Grid = new Grid();\r\n            pickerBodyRight.name = \"Dialogue Right Half\";\r\n            pickerBodyRight.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n            const pickerBodyRightRows: number[] = [0.514, 0.486];\r\n            pickerBodyRight.addRowDefinition(pickerBodyRightRows[0], false);\r\n            pickerBodyRight.addRowDefinition(pickerBodyRightRows[1], false);\r\n            dialogBody.addControl(pickerBodyRight, 1, 1);\r\n\r\n            // Picker container swatches and buttons\r\n            const pickerSwatchesButtons: Grid = new Grid();\r\n            pickerSwatchesButtons.name = \"Swatches and Buttons\";\r\n            const pickerButtonsCol: number[] = [0.417, 0.583];\r\n            pickerSwatchesButtons.addRowDefinition(1.0, false);\r\n            pickerSwatchesButtons.addColumnDefinition(pickerButtonsCol[0], false);\r\n            pickerSwatchesButtons.addColumnDefinition(pickerButtonsCol[1], false);\r\n            pickerBodyRight.addControl(pickerSwatchesButtons, 0, 0);\r\n\r\n            // Picker Swatches quadrant\r\n            const pickerSwatches: Grid = new Grid();\r\n            pickerSwatches.name = \"New and Current Swatches\";\r\n            const pickeSwatchesRows: number[] = [0.04, 0.16, 0.64, 0.16];\r\n            pickerSwatches.addRowDefinition(pickeSwatchesRows[0], false);\r\n            pickerSwatches.addRowDefinition(pickeSwatchesRows[1], false);\r\n            pickerSwatches.addRowDefinition(pickeSwatchesRows[2], false);\r\n            pickerSwatches.addRowDefinition(pickeSwatchesRows[3], false);\r\n            pickerSwatchesButtons.addControl(pickerSwatches, 0, 0);\r\n\r\n            // Active swatches\r\n            const activeSwatches: Grid = new Grid();\r\n            activeSwatches.name = \"Active Swatches\";\r\n            activeSwatches.width = 0.67;\r\n            activeSwatches.addRowDefinition(0.5, false);\r\n            activeSwatches.addRowDefinition(0.5, false);\r\n            pickerSwatches.addControl(activeSwatches, 2, 0);\r\n\r\n            const labelWidth: number = Math.floor(parseInt(options.pickerWidth) * dialogBodyCols[1] * pickerButtonsCol[0] * 0.11);\r\n            const labelHeight: number = Math.floor(parseInt(options.pickerHeight) * pickerPanelRows[1] * pickerBodyRightRows[0] * pickeSwatchesRows[1] * 0.5);\r\n\r\n            let labelTextSize: number;\r\n            if (options.pickerWidth > options.pickerHeight) {\r\n                labelTextSize = labelHeight;\r\n            } else {\r\n                labelTextSize = labelWidth;\r\n            }\r\n            // New color swatch and previous color button\r\n            const newText: TextBlock = new TextBlock();\r\n            newText.text = \"new\";\r\n            newText.name = \"New Color Label\";\r\n            newText.color = buttonColor;\r\n            newText.fontSize = labelTextSize;\r\n            pickerSwatches.addControl(newText, 1, 0);\r\n\r\n            const newSwatch = new Rectangle();\r\n            newSwatch.name = \"New Color Swatch\";\r\n            newSwatch.background = options.lastColor;\r\n            newSwatch.thickness = 0;\r\n            activeSwatches.addControl(newSwatch, 0, 0);\r\n\r\n            const currentSwatch: Button = Button.CreateSimpleButton(\"currentSwatch\", \"\");\r\n            currentSwatch.background = options.lastColor;\r\n            currentSwatch.thickness = 0;\r\n            currentSwatch.onPointerClickObservable.add(() => {\r\n                const revertColor = Color3.FromHexString(currentSwatch.background);\r\n                updateValues(revertColor, currentSwatch.name!);\r\n                editSwatches(false);\r\n            });\r\n            currentSwatch.pointerDownAnimation = () => {};\r\n            currentSwatch.pointerUpAnimation = () => {};\r\n            currentSwatch.pointerEnterAnimation = () => {};\r\n            currentSwatch.pointerOutAnimation = () => {};\r\n            activeSwatches.addControl(currentSwatch, 1, 0);\r\n\r\n            const swatchOutline: Rectangle = new Rectangle();\r\n            swatchOutline.name = \"Swatch Outline\";\r\n            swatchOutline.width = 0.67;\r\n            swatchOutline.thickness = 2;\r\n            swatchOutline.color = currentSwatchesOutlineColor;\r\n            swatchOutline.isHitTestVisible = false;\r\n            pickerSwatches.addControl(swatchOutline, 2, 0);\r\n\r\n            const currentText: TextBlock = new TextBlock();\r\n            currentText.name = \"Current Color Label\";\r\n            currentText.text = \"current\";\r\n            currentText.color = buttonColor;\r\n            currentText.fontSize = labelTextSize;\r\n            pickerSwatches.addControl(currentText, 3, 0);\r\n\r\n            // Buttons grid\r\n            const buttonGrid: Grid = new Grid();\r\n            buttonGrid.name = \"Button Grid\";\r\n            buttonGrid.height = 0.8;\r\n            const buttonGridRows: number = 1 / 3;\r\n            buttonGrid.addRowDefinition(buttonGridRows, false);\r\n            buttonGrid.addRowDefinition(buttonGridRows, false);\r\n            buttonGrid.addRowDefinition(buttonGridRows, false);\r\n            pickerSwatchesButtons.addControl(buttonGrid, 0, 1);\r\n\r\n            // Determine pixel width and height for all buttons from overall panel dimensions\r\n            const buttonWidth = Math.floor(parseInt(options.pickerWidth) * dialogBodyCols[1] * pickerButtonsCol[1] * 0.67).toString() + \"px\";\r\n            const buttonHeight =\r\n                Math.floor(\r\n                    parseInt(options.pickerHeight) * pickerPanelRows[1] * pickerBodyRightRows[0] * (parseFloat(buttonGrid.height.toString()) / 100) * buttonGridRows * 0.7\r\n                ).toString() + \"px\";\r\n\r\n            // Determine button type size\r\n            if (parseFloat(buttonWidth) > parseFloat(buttonHeight)) {\r\n                buttonFontSize = Math.floor(parseFloat(buttonHeight) * 0.45);\r\n            } else {\r\n                buttonFontSize = Math.floor(parseFloat(buttonWidth) * 0.11);\r\n            }\r\n\r\n            // Panel Buttons\r\n            const butOK: Button = Button.CreateSimpleButton(\"butOK\", \"OK\");\r\n            butOK.width = buttonWidth;\r\n            butOK.height = buttonHeight;\r\n            butOK.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n            butOK.thickness = 2;\r\n            butOK.color = buttonColor;\r\n            butOK.fontSize = buttonFontSize;\r\n            butOK.background = buttonBackgroundColor;\r\n            butOK.onPointerEnterObservable.add(() => {\r\n                butOK.background = buttonBackgroundHoverColor;\r\n            });\r\n            butOK.onPointerOutObservable.add(() => {\r\n                butOK.background = buttonBackgroundColor;\r\n            });\r\n            butOK.pointerDownAnimation = () => {\r\n                butOK.background = buttonBackgroundClickColor;\r\n            };\r\n            butOK.pointerUpAnimation = () => {\r\n                butOK.background = buttonBackgroundHoverColor;\r\n            };\r\n            butOK.onPointerClickObservable.add(() => {\r\n                editSwatches(false);\r\n                closePicker(newSwatch.background);\r\n            });\r\n            buttonGrid.addControl(butOK, 0, 0);\r\n\r\n            const butCancel: Button = Button.CreateSimpleButton(\"butCancel\", \"Cancel\");\r\n            butCancel.width = buttonWidth;\r\n            butCancel.height = buttonHeight;\r\n            butCancel.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n            butCancel.thickness = 2;\r\n            butCancel.color = buttonColor;\r\n            butCancel.fontSize = buttonFontSize;\r\n            butCancel.background = buttonBackgroundColor;\r\n            butCancel.onPointerEnterObservable.add(() => {\r\n                butCancel.background = buttonBackgroundHoverColor;\r\n            });\r\n            butCancel.onPointerOutObservable.add(() => {\r\n                butCancel.background = buttonBackgroundColor;\r\n            });\r\n            butCancel.pointerDownAnimation = () => {\r\n                butCancel.background = buttonBackgroundClickColor;\r\n            };\r\n            butCancel.pointerUpAnimation = () => {\r\n                butCancel.background = buttonBackgroundHoverColor;\r\n            };\r\n            butCancel.onPointerClickObservable.add(() => {\r\n                editSwatches(false);\r\n                closePicker(currentSwatch.background);\r\n            });\r\n            buttonGrid.addControl(butCancel, 1, 0);\r\n\r\n            if (options.savedColors) {\r\n                butSave = Button.CreateSimpleButton(\"butSave\", \"Save\");\r\n                butSave.width = buttonWidth;\r\n                butSave.height = buttonHeight;\r\n                butSave.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n                butSave.thickness = 2;\r\n                butSave.fontSize = buttonFontSize;\r\n                if (options.savedColors.length < options.swatchLimit!) {\r\n                    butSave.color = buttonColor;\r\n                    butSave.background = buttonBackgroundColor;\r\n                } else {\r\n                    disableButton(butSave, true);\r\n                }\r\n                butSave.onPointerEnterObservable.add(() => {\r\n                    if (options.savedColors) {\r\n                        if (options.savedColors.length < options.swatchLimit!) {\r\n                            butSave.background = buttonBackgroundHoverColor;\r\n                        }\r\n                    }\r\n                });\r\n                butSave.onPointerOutObservable.add(() => {\r\n                    if (options.savedColors) {\r\n                        if (options.savedColors.length < options.swatchLimit!) {\r\n                            butSave.background = buttonBackgroundColor;\r\n                        }\r\n                    }\r\n                });\r\n                butSave.pointerDownAnimation = () => {\r\n                    if (options.savedColors) {\r\n                        if (options.savedColors.length < options.swatchLimit!) {\r\n                            butSave.background = buttonBackgroundClickColor;\r\n                        }\r\n                    }\r\n                };\r\n                butSave.pointerUpAnimation = () => {\r\n                    if (options.savedColors) {\r\n                        if (options.savedColors.length < options.swatchLimit!) {\r\n                            butSave.background = buttonBackgroundHoverColor;\r\n                        }\r\n                    }\r\n                };\r\n                butSave.onPointerClickObservable.add(() => {\r\n                    if (options.savedColors) {\r\n                        if (options.savedColors.length == 0) {\r\n                            setEditButtonVisibility(true);\r\n                        }\r\n                        if (options.savedColors.length < options.swatchLimit!) {\r\n                            updateSwatches(newSwatch.background, butSave);\r\n                        }\r\n                        editSwatches(false);\r\n                    }\r\n                });\r\n                if (options.savedColors.length > 0) {\r\n                    setEditButtonVisibility(true);\r\n                }\r\n                buttonGrid.addControl(butSave, 2, 0);\r\n            }\r\n\r\n            // Picker color values input\r\n            const pickerColorValues: Grid = new Grid();\r\n            pickerColorValues.name = \"Dialog Lower Right\";\r\n            pickerColorValues.addRowDefinition(0.02, false);\r\n            pickerColorValues.addRowDefinition(0.63, false);\r\n            pickerColorValues.addRowDefinition(0.21, false);\r\n            pickerColorValues.addRowDefinition(0.14, false);\r\n            pickerBodyRight.addControl(pickerColorValues, 1, 0);\r\n\r\n            // RGB values text boxes\r\n            const currentColor = Color3.FromHexString(options.lastColor);\r\n            const rgbValuesQuadrant: Grid = new Grid();\r\n            rgbValuesQuadrant.name = \"RGB Values\";\r\n            rgbValuesQuadrant.width = 0.82;\r\n            rgbValuesQuadrant.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n            rgbValuesQuadrant.addRowDefinition(1 / 3, false);\r\n            rgbValuesQuadrant.addRowDefinition(1 / 3, false);\r\n            rgbValuesQuadrant.addRowDefinition(1 / 3, false);\r\n            rgbValuesQuadrant.addColumnDefinition(0.1, false);\r\n            rgbValuesQuadrant.addColumnDefinition(0.2, false);\r\n            rgbValuesQuadrant.addColumnDefinition(0.7, false);\r\n            pickerColorValues.addControl(rgbValuesQuadrant, 1, 0);\r\n\r\n            for (let i = 0; i < inputFieldLabels.length; i++) {\r\n                const labelText: TextBlock = new TextBlock();\r\n                labelText.text = inputFieldLabels[i];\r\n                labelText.color = buttonColor;\r\n                labelText.fontSize = buttonFontSize;\r\n                rgbValuesQuadrant.addControl(labelText, i, 0);\r\n            }\r\n\r\n            // Input fields for RGB values\r\n            const rValInt = new InputText();\r\n            rValInt.width = 0.83;\r\n            rValInt.height = 0.72;\r\n            rValInt.name = \"rIntField\";\r\n            rValInt.fontSize = buttonFontSize;\r\n            rValInt.text = (currentColor.r * 255).toString();\r\n            rValInt.color = inputTextColor;\r\n            rValInt.background = inputTextBackgroundColor;\r\n            rValInt.onFocusObservable.add(() => {\r\n                activeField = rValInt.name!;\r\n                lastVal = rValInt.text;\r\n                editSwatches(false);\r\n            });\r\n            rValInt.onBlurObservable.add(() => {\r\n                if (rValInt.text == \"\") {\r\n                    rValInt.text = \"0\";\r\n                }\r\n                updateInt(rValInt, \"r\");\r\n                if (activeField == rValInt.name) {\r\n                    activeField = \"\";\r\n                }\r\n            });\r\n            rValInt.onTextChangedObservable.add(() => {\r\n                if (activeField == rValInt.name) {\r\n                    updateInt(rValInt, \"r\");\r\n                }\r\n            });\r\n            rgbValuesQuadrant.addControl(rValInt, 0, 1);\r\n\r\n            const gValInt = new InputText();\r\n            gValInt.width = 0.83;\r\n            gValInt.height = 0.72;\r\n            gValInt.name = \"gIntField\";\r\n            gValInt.fontSize = buttonFontSize;\r\n            gValInt.text = (currentColor.g * 255).toString();\r\n            gValInt.color = inputTextColor;\r\n            gValInt.background = inputTextBackgroundColor;\r\n            gValInt.onFocusObservable.add(() => {\r\n                activeField = gValInt.name!;\r\n                lastVal = gValInt.text;\r\n                editSwatches(false);\r\n            });\r\n            gValInt.onBlurObservable.add(() => {\r\n                if (gValInt.text == \"\") {\r\n                    gValInt.text = \"0\";\r\n                }\r\n                updateInt(gValInt, \"g\");\r\n                if (activeField == gValInt.name) {\r\n                    activeField = \"\";\r\n                }\r\n            });\r\n            gValInt.onTextChangedObservable.add(() => {\r\n                if (activeField == gValInt.name) {\r\n                    updateInt(gValInt, \"g\");\r\n                }\r\n            });\r\n            rgbValuesQuadrant.addControl(gValInt, 1, 1);\r\n\r\n            const bValInt = new InputText();\r\n            bValInt.width = 0.83;\r\n            bValInt.height = 0.72;\r\n            bValInt.name = \"bIntField\";\r\n            bValInt.fontSize = buttonFontSize;\r\n            bValInt.text = (currentColor.b * 255).toString();\r\n            bValInt.color = inputTextColor;\r\n            bValInt.background = inputTextBackgroundColor;\r\n            bValInt.onFocusObservable.add(() => {\r\n                activeField = bValInt.name!;\r\n                lastVal = bValInt.text;\r\n                editSwatches(false);\r\n            });\r\n            bValInt.onBlurObservable.add(() => {\r\n                if (bValInt.text == \"\") {\r\n                    bValInt.text = \"0\";\r\n                }\r\n                updateInt(bValInt, \"b\");\r\n                if (activeField == bValInt.name) {\r\n                    activeField = \"\";\r\n                }\r\n            });\r\n            bValInt.onTextChangedObservable.add(() => {\r\n                if (activeField == bValInt.name) {\r\n                    updateInt(bValInt, \"b\");\r\n                }\r\n            });\r\n            rgbValuesQuadrant.addControl(bValInt, 2, 1);\r\n\r\n            const rValDec = new InputText();\r\n            rValDec.width = 0.95;\r\n            rValDec.height = 0.72;\r\n            rValDec.name = \"rDecField\";\r\n            rValDec.fontSize = buttonFontSize;\r\n            rValDec.text = currentColor.r.toString();\r\n            rValDec.color = inputTextColor;\r\n            rValDec.background = inputTextBackgroundColor;\r\n            rValDec.onFocusObservable.add(() => {\r\n                activeField = rValDec.name!;\r\n                lastVal = rValDec.text;\r\n                editSwatches(false);\r\n            });\r\n            rValDec.onBlurObservable.add(() => {\r\n                if (parseFloat(rValDec.text) == 0 || rValDec.text == \"\") {\r\n                    rValDec.text = \"0\";\r\n                    updateFloat(rValDec, \"r\");\r\n                }\r\n                if (activeField == rValDec.name) {\r\n                    activeField = \"\";\r\n                }\r\n            });\r\n            rValDec.onTextChangedObservable.add(() => {\r\n                if (activeField == rValDec.name) {\r\n                    updateFloat(rValDec, \"r\");\r\n                }\r\n            });\r\n            rgbValuesQuadrant.addControl(rValDec, 0, 2);\r\n\r\n            const gValDec = new InputText();\r\n            gValDec.width = 0.95;\r\n            gValDec.height = 0.72;\r\n            gValDec.name = \"gDecField\";\r\n            gValDec.fontSize = buttonFontSize;\r\n            gValDec.text = currentColor.g.toString();\r\n            gValDec.color = inputTextColor;\r\n            gValDec.background = inputTextBackgroundColor;\r\n            gValDec.onFocusObservable.add(() => {\r\n                activeField = gValDec.name!;\r\n                lastVal = gValDec.text;\r\n                editSwatches(false);\r\n            });\r\n            gValDec.onBlurObservable.add(() => {\r\n                if (parseFloat(gValDec.text) == 0 || gValDec.text == \"\") {\r\n                    gValDec.text = \"0\";\r\n                    updateFloat(gValDec, \"g\");\r\n                }\r\n                if (activeField == gValDec.name) {\r\n                    activeField = \"\";\r\n                }\r\n            });\r\n            gValDec.onTextChangedObservable.add(() => {\r\n                if (activeField == gValDec.name) {\r\n                    updateFloat(gValDec, \"g\");\r\n                }\r\n            });\r\n            rgbValuesQuadrant.addControl(gValDec, 1, 2);\r\n\r\n            const bValDec = new InputText();\r\n            bValDec.width = 0.95;\r\n            bValDec.height = 0.72;\r\n            bValDec.name = \"bDecField\";\r\n            bValDec.fontSize = buttonFontSize;\r\n            bValDec.text = currentColor.b.toString();\r\n            bValDec.color = inputTextColor;\r\n            bValDec.background = inputTextBackgroundColor;\r\n            bValDec.onFocusObservable.add(() => {\r\n                activeField = bValDec.name!;\r\n                lastVal = bValDec.text;\r\n                editSwatches(false);\r\n            });\r\n            bValDec.onBlurObservable.add(() => {\r\n                if (parseFloat(bValDec.text) == 0 || bValDec.text == \"\") {\r\n                    bValDec.text = \"0\";\r\n                    updateFloat(bValDec, \"b\");\r\n                }\r\n                if (activeField == bValDec.name) {\r\n                    activeField = \"\";\r\n                }\r\n            });\r\n            bValDec.onTextChangedObservable.add(() => {\r\n                if (activeField == bValDec.name) {\r\n                    updateFloat(bValDec, \"b\");\r\n                }\r\n            });\r\n            rgbValuesQuadrant.addControl(bValDec, 2, 2);\r\n\r\n            // Hex value input\r\n            const hexValueQuadrant: Grid = new Grid();\r\n            hexValueQuadrant.name = \"Hex Value\";\r\n            hexValueQuadrant.width = 0.82;\r\n            hexValueQuadrant.addRowDefinition(1.0, false);\r\n            hexValueQuadrant.addColumnDefinition(0.1, false);\r\n            hexValueQuadrant.addColumnDefinition(0.9, false);\r\n            pickerColorValues.addControl(hexValueQuadrant, 2, 0);\r\n\r\n            const labelText: TextBlock = new TextBlock();\r\n            labelText.text = \"#\";\r\n            labelText.color = buttonColor;\r\n            labelText.fontSize = buttonFontSize;\r\n            hexValueQuadrant.addControl(labelText, 0, 0);\r\n\r\n            const hexVal = new InputText();\r\n            hexVal.width = 0.96;\r\n            hexVal.height = 0.72;\r\n            hexVal.name = \"hexField\";\r\n            hexVal.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n            hexVal.fontSize = buttonFontSize;\r\n            const minusPound = options.lastColor.split(\"#\");\r\n            hexVal.text = minusPound[1];\r\n            hexVal.color = inputTextColor;\r\n            hexVal.background = inputTextBackgroundColor;\r\n            hexVal.onFocusObservable.add(() => {\r\n                activeField = hexVal.name!;\r\n                lastVal = hexVal.text;\r\n                editSwatches(false);\r\n            });\r\n            hexVal.onBlurObservable.add(() => {\r\n                if (hexVal.text.length == 3) {\r\n                    const val = hexVal.text.split(\"\");\r\n                    hexVal.text = val[0] + val[0] + val[1] + val[1] + val[2] + val[2];\r\n                }\r\n                if (hexVal.text == \"\") {\r\n                    hexVal.text = \"000000\";\r\n                    updateValues(Color3.FromHexString(hexVal.text), \"b\");\r\n                }\r\n                if (activeField == hexVal.name) {\r\n                    activeField = \"\";\r\n                }\r\n            });\r\n            hexVal.onTextChangedObservable.add(() => {\r\n                let newHexValue: string = hexVal.text;\r\n                const checkHex: boolean = /[^0-9A-F]/i.test(newHexValue);\r\n                if ((hexVal.text.length > 6 || checkHex) && activeField == hexVal.name) {\r\n                    hexVal.text = lastVal;\r\n                } else {\r\n                    if (hexVal.text.length < 6) {\r\n                        const leadingZero: number = 6 - hexVal.text.length;\r\n                        for (let i = 0; i < leadingZero; i++) {\r\n                            newHexValue = \"0\" + newHexValue;\r\n                        }\r\n                    }\r\n                    if (hexVal.text.length == 3) {\r\n                        const val: string[] = hexVal.text.split(\"\");\r\n                        newHexValue = val[0] + val[0] + val[1] + val[1] + val[2] + val[2];\r\n                    }\r\n                    newHexValue = \"#\" + newHexValue;\r\n                    if (activeField == hexVal.name) {\r\n                        lastVal = hexVal.text;\r\n                        updateValues(Color3.FromHexString(newHexValue), hexVal.name);\r\n                    }\r\n                }\r\n            });\r\n            hexValueQuadrant.addControl(hexVal, 0, 1);\r\n\r\n            if (options.savedColors && options.savedColors.length > 0) {\r\n                updateSwatches(\"\", butSave!);\r\n            }\r\n\r\n            /**\r\n             * Will update all values for InputText and ColorPicker controls based on the BABYLON.Color3 passed to this function.\r\n             * Each InputText control and the ColorPicker control will be tested to see if they are the activeField and if they\r\n             * are will receive no update. This is to prevent the input from the user being overwritten.\r\n             * @param value\r\n             * @param inputField\r\n             */\r\n            function updateValues(value: Color3, inputField: string) {\r\n                activeField = inputField;\r\n                const pickedColor: string = value.toHexString();\r\n                newSwatch.background = pickedColor;\r\n                if (rValInt.name != activeField) {\r\n                    rValInt.text = Math.floor(value.r * 255).toString();\r\n                }\r\n                if (gValInt.name != activeField) {\r\n                    gValInt.text = Math.floor(value.g * 255).toString();\r\n                }\r\n                if (bValInt.name != activeField) {\r\n                    bValInt.text = Math.floor(value.b * 255).toString();\r\n                }\r\n                if (rValDec.name != activeField) {\r\n                    rValDec.text = value.r.toString();\r\n                }\r\n                if (gValDec.name != activeField) {\r\n                    gValDec.text = value.g.toString();\r\n                }\r\n                if (bValDec.name != activeField) {\r\n                    bValDec.text = value.b.toString();\r\n                }\r\n                if (hexVal.name != activeField) {\r\n                    const minusPound: string[] = pickedColor.split(\"#\");\r\n                    hexVal.text = minusPound[1];\r\n                }\r\n                if (picker.name != activeField) {\r\n                    picker.value = value;\r\n                }\r\n            }\r\n\r\n            // When the user enters an integer for R, G, or B we check to make sure it is a valid number and replace if not.\r\n            function updateInt(field: InputText, channel: string) {\r\n                let newValue: string = field.text;\r\n                const checkVal: boolean = /[^0-9]/g.test(newValue);\r\n                if (checkVal) {\r\n                    field.text = lastVal;\r\n                    return;\r\n                } else {\r\n                    if (newValue != \"\") {\r\n                        if (Math.floor(parseInt(newValue)) < 0) {\r\n                            newValue = \"0\";\r\n                        } else if (Math.floor(parseInt(newValue)) > 255) {\r\n                            newValue = \"255\";\r\n                        } else if (isNaN(parseInt(newValue))) {\r\n                            newValue = \"0\";\r\n                        }\r\n                    }\r\n                    if (activeField == field.name) {\r\n                        lastVal = newValue;\r\n                    }\r\n                }\r\n                if (newValue != \"\") {\r\n                    newValue = parseInt(newValue).toString();\r\n                    field.text = newValue;\r\n                    const newSwatchRGB: Color3 = Color3.FromHexString(newSwatch.background);\r\n                    if (activeField == field.name) {\r\n                        if (channel == \"r\") {\r\n                            updateValues(new Color3(parseInt(newValue) / 255, newSwatchRGB.g, newSwatchRGB.b), field.name);\r\n                        } else if (channel == \"g\") {\r\n                            updateValues(new Color3(newSwatchRGB.r, parseInt(newValue) / 255, newSwatchRGB.b), field.name);\r\n                        } else {\r\n                            updateValues(new Color3(newSwatchRGB.r, newSwatchRGB.g, parseInt(newValue) / 255), field.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // When the user enters a float for R, G, or B we check to make sure it is a valid number and replace if not.\r\n            function updateFloat(field: InputText, channel: string) {\r\n                let newValue: string = field.text;\r\n                const checkVal: boolean = /[^0-9.]/g.test(newValue);\r\n                if (checkVal) {\r\n                    field.text = lastVal;\r\n                    return;\r\n                } else {\r\n                    if (newValue != \"\" && newValue != \".\" && parseFloat(newValue) != 0) {\r\n                        if (parseFloat(newValue) < 0.0) {\r\n                            newValue = \"0.0\";\r\n                        } else if (parseFloat(newValue) > 1.0) {\r\n                            newValue = \"1.0\";\r\n                        } else if (isNaN(parseFloat(newValue))) {\r\n                            newValue = \"0.0\";\r\n                        }\r\n                    }\r\n                    if (activeField == field.name) {\r\n                        lastVal = newValue;\r\n                    }\r\n                }\r\n                if (newValue != \"\" && newValue != \".\" && parseFloat(newValue) != 0) {\r\n                    newValue = parseFloat(newValue).toString();\r\n                    field.text = newValue;\r\n                } else {\r\n                    newValue = \"0.0\";\r\n                }\r\n                const newSwatchRGB = Color3.FromHexString(newSwatch.background);\r\n                if (activeField == field.name) {\r\n                    if (channel == \"r\") {\r\n                        updateValues(new Color3(parseFloat(newValue), newSwatchRGB.g, newSwatchRGB.b), field.name);\r\n                    } else if (channel == \"g\") {\r\n                        updateValues(new Color3(newSwatchRGB.r, parseFloat(newValue), newSwatchRGB.b), field.name);\r\n                    } else {\r\n                        updateValues(new Color3(newSwatchRGB.r, newSwatchRGB.g, parseFloat(newValue)), field.name);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Removes the current index from the savedColors array. Drawer can then be regenerated.\r\n            function deleteSwatch(index: number) {\r\n                if (options.savedColors) {\r\n                    options.savedColors.splice(index, 1);\r\n                }\r\n                if (options.savedColors && options.savedColors.length == 0) {\r\n                    setEditButtonVisibility(false);\r\n                    editSwatchMode = false;\r\n                }\r\n            }\r\n\r\n            // Creates and styles an individual swatch when updateSwatches is called.\r\n            function createSwatch() {\r\n                if (options.savedColors && options.savedColors[swatchNumber]) {\r\n                    let icon: string;\r\n                    if (editSwatchMode) {\r\n                        icon = \"b\";\r\n                    } else {\r\n                        icon = \"\";\r\n                    }\r\n                    const swatch: Button = Button.CreateSimpleButton(\"Swatch_\" + swatchNumber, icon);\r\n                    swatch.fontFamily = \"coreglyphs\";\r\n                    const swatchColor: Color3 = Color3.FromHexString(options.savedColors[swatchNumber]);\r\n                    const swatchLuminence: number = swatchColor.r + swatchColor.g + swatchColor.b;\r\n\r\n                    // Set color of outline and textBlock based on luminance of the color swatch so feedback always visible\r\n                    if (swatchLuminence > luminanceLimit) {\r\n                        swatch.color = iconColorDark;\r\n                    } else {\r\n                        swatch.color = iconColorLight;\r\n                    }\r\n                    swatch.fontSize = Math.floor(swatchSize * 0.7);\r\n                    swatch.textBlock!.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n                    swatch.height = swatch.width = swatchSize.toString() + \"px\";\r\n                    swatch.background = options.savedColors[swatchNumber];\r\n                    swatch.thickness = 2;\r\n                    const metadata = swatchNumber;\r\n                    swatch.pointerDownAnimation = () => {\r\n                        swatch.thickness = 4;\r\n                    };\r\n                    swatch.pointerUpAnimation = () => {\r\n                        swatch.thickness = 3;\r\n                    };\r\n                    swatch.pointerEnterAnimation = () => {\r\n                        swatch.thickness = 3;\r\n                    };\r\n                    swatch.pointerOutAnimation = () => {\r\n                        swatch.thickness = 2;\r\n                    };\r\n                    swatch.onPointerClickObservable.add(() => {\r\n                        if (!editSwatchMode) {\r\n                            if (options.savedColors) {\r\n                                updateValues(Color3.FromHexString(options.savedColors[metadata]), swatch.name!);\r\n                            }\r\n                        } else {\r\n                            deleteSwatch(metadata);\r\n                            updateSwatches(\"\", butSave);\r\n                        }\r\n                    });\r\n                    return swatch;\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n\r\n            // Mode switch to render button text and close symbols on swatch controls\r\n            function editSwatches(mode?: boolean) {\r\n                if (mode !== undefined) {\r\n                    editSwatchMode = mode;\r\n                }\r\n                let thisButton: Button;\r\n                if (editSwatchMode) {\r\n                    for (let i = 0; i < swatchDrawer.children.length; i++) {\r\n                        thisButton = swatchDrawer.children[i] as Button;\r\n                        thisButton.textBlock!.text = \"b\";\r\n                    }\r\n                    if (butEdit !== undefined) {\r\n                        butEdit.textBlock!.text = \"Done\";\r\n                    }\r\n                } else {\r\n                    for (let i = 0; i < swatchDrawer.children.length; i++) {\r\n                        thisButton = swatchDrawer.children[i] as Button;\r\n                        thisButton.textBlock!.text = \"\";\r\n                    }\r\n                    if (butEdit !== undefined) {\r\n                        butEdit.textBlock!.text = \"Edit\";\r\n                    }\r\n                }\r\n            }\r\n\r\n            /**\r\n             * When Save Color button is pressed this function will first create a swatch drawer if one is not already\r\n             * made. Then all controls are removed from the drawer and we step through the savedColors array and\r\n             * creates one swatch per color. It will also set the height of the drawer control based on how many\r\n             * saved colors there are and how many can be stored per row.\r\n             * @param color\r\n             * @param button\r\n             */\r\n            function updateSwatches(color: string, button: Button) {\r\n                if (options.savedColors) {\r\n                    if (color != \"\") {\r\n                        options.savedColors.push(color);\r\n                    }\r\n                    swatchNumber = 0;\r\n                    swatchDrawer.clearControls();\r\n                    const rowCount: number = Math.ceil(options.savedColors.length / options.numSwatchesPerLine!);\r\n                    let gutterCount: number;\r\n                    if (rowCount == 0) {\r\n                        gutterCount = 0;\r\n                    } else {\r\n                        gutterCount = rowCount + 1;\r\n                    }\r\n                    if (swatchDrawer.rowCount != rowCount + gutterCount) {\r\n                        const currentRows: number = swatchDrawer.rowCount;\r\n                        for (let i = 0; i < currentRows; i++) {\r\n                            swatchDrawer.removeRowDefinition(0);\r\n                        }\r\n                        for (let i = 0; i < rowCount + gutterCount; i++) {\r\n                            if (i % 2) {\r\n                                swatchDrawer.addRowDefinition(swatchSize, true);\r\n                            } else {\r\n                                swatchDrawer.addRowDefinition(gutterSize, true);\r\n                            }\r\n                        }\r\n                    }\r\n                    swatchDrawer.height = (swatchSize * rowCount + gutterCount * gutterSize).toString() + \"px\";\r\n\r\n                    for (let y = 1, thisRow = 1; y < rowCount + gutterCount; y += 2, thisRow++) {\r\n                        // Determine number of buttons to create per row based on the button limit per row and number of saved colors\r\n                        let totalButtonsThisRow: number;\r\n                        if (options.savedColors.length > thisRow * options.numSwatchesPerLine!) {\r\n                            totalButtonsThisRow = options.numSwatchesPerLine!;\r\n                        } else {\r\n                            totalButtonsThisRow = options.savedColors.length - (thisRow - 1) * options.numSwatchesPerLine!;\r\n                        }\r\n                        const buttonIterations: number = Math.min(Math.max(totalButtonsThisRow, 0), options.numSwatchesPerLine!);\r\n                        for (let x = 0, w = 1; x < buttonIterations; x++) {\r\n                            if (x > options.numSwatchesPerLine!) {\r\n                                continue;\r\n                            }\r\n                            const swatch: Button | null = createSwatch();\r\n                            if (swatch != null) {\r\n                                swatchDrawer.addControl(swatch, y, w);\r\n                                w += 2;\r\n                                swatchNumber++;\r\n                            } else {\r\n                                continue;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (options.savedColors.length >= options.swatchLimit!) {\r\n                        disableButton(button, true);\r\n                    } else {\r\n                        disableButton(button, false);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Shows or hides edit swatches button depending on if there are saved swatches\r\n            function setEditButtonVisibility(enableButton: boolean) {\r\n                if (enableButton) {\r\n                    butEdit = Button.CreateSimpleButton(\"butEdit\", \"Edit\");\r\n                    butEdit.width = buttonWidth;\r\n                    butEdit.height = buttonHeight;\r\n                    butEdit.left = Math.floor(parseInt(buttonWidth) * 0.1).toString() + \"px\";\r\n                    butEdit.top = (parseFloat(butEdit.left) * -1).toString() + \"px\";\r\n                    butEdit.verticalAlignment = Control.VERTICAL_ALIGNMENT_BOTTOM;\r\n                    butEdit.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n                    butEdit.thickness = 2;\r\n                    butEdit.color = buttonColor;\r\n                    butEdit.fontSize = buttonFontSize;\r\n                    butEdit.background = buttonBackgroundColor;\r\n                    butEdit.onPointerEnterObservable.add(() => {\r\n                        butEdit.background = buttonBackgroundHoverColor;\r\n                    });\r\n                    butEdit.onPointerOutObservable.add(() => {\r\n                        butEdit.background = buttonBackgroundColor;\r\n                    });\r\n                    butEdit.pointerDownAnimation = () => {\r\n                        butEdit.background = buttonBackgroundClickColor;\r\n                    };\r\n                    butEdit.pointerUpAnimation = () => {\r\n                        butEdit.background = buttonBackgroundHoverColor;\r\n                    };\r\n                    butEdit.onPointerClickObservable.add(() => {\r\n                        if (editSwatchMode) {\r\n                            editSwatchMode = false;\r\n                        } else {\r\n                            editSwatchMode = true;\r\n                        }\r\n                        editSwatches();\r\n                    });\r\n                    pickerGrid.addControl(butEdit, 1, 0);\r\n                } else {\r\n                    pickerGrid.removeControl(butEdit);\r\n                }\r\n            }\r\n\r\n            // Called when the user hits the limit of saved colors in the drawer.\r\n            function disableButton(button: Button, disabled: boolean) {\r\n                if (disabled) {\r\n                    button.color = buttonDisabledColor;\r\n                    button.background = buttonDisabledBackgroundColor;\r\n                } else {\r\n                    button.color = buttonColor;\r\n                    button.background = buttonBackgroundColor;\r\n                }\r\n            }\r\n\r\n            // Passes last chosen color back to scene and kills dialog by removing from AdvancedDynamicTexture\r\n            function closePicker(color: string) {\r\n                if (options.savedColors && options.savedColors.length > 0) {\r\n                    resolve({\r\n                        savedColors: options.savedColors,\r\n                        pickedColor: color,\r\n                    });\r\n                } else {\r\n                    resolve({\r\n                        pickedColor: color,\r\n                    });\r\n                }\r\n                advancedTexture.removeControl(dialogContainer);\r\n            }\r\n        });\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.ColorPicker\", ColorPicker);\r\n","import { Container } from \"./container\";\r\nimport { Control } from \"./control\";\r\nimport type { Measure } from \"../measure\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/** Class used to create 2D ellipse containers */\r\nexport class Ellipse extends Container {\r\n    private _thickness = 1;\r\n\r\n    /** Gets or sets border thickness */\r\n    @serialize()\r\n    public get thickness(): number {\r\n        return this._thickness;\r\n    }\r\n\r\n    public set thickness(value: number) {\r\n        if (this._thickness === value) {\r\n            return;\r\n        }\r\n\r\n        this._thickness = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new Ellipse\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Ellipse\";\r\n    }\r\n\r\n    protected _localDraw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        Control.drawEllipse(\r\n            this._currentMeasure.left + this._currentMeasure.width / 2,\r\n            this._currentMeasure.top + this._currentMeasure.height / 2,\r\n            this._currentMeasure.width / 2 - this._thickness / 2,\r\n            this._currentMeasure.height / 2 - this._thickness / 2,\r\n            context\r\n        );\r\n\r\n        if (this._backgroundGradient || this._background) {\r\n            context.fillStyle = this._getBackgroundColor(context);\r\n\r\n            context.fill();\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n\r\n        if (this._thickness) {\r\n            if (this.color) {\r\n                context.strokeStyle = this.color;\r\n            }\r\n            context.lineWidth = this._thickness;\r\n\r\n            context.stroke();\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        super._additionalProcessing(parentMeasure, context);\r\n\r\n        this._measureForChildren.width -= 2 * this._thickness;\r\n        this._measureForChildren.height -= 2 * this._thickness;\r\n        this._measureForChildren.left += this._thickness;\r\n        this._measureForChildren.top += this._thickness;\r\n    }\r\n\r\n    protected _clipForChildren(context: ICanvasRenderingContext) {\r\n        Control.drawEllipse(\r\n            this._currentMeasure.left + this._currentMeasure.width / 2,\r\n            this._currentMeasure.top + this._currentMeasure.height / 2,\r\n            this._currentMeasure.width / 2,\r\n            this._currentMeasure.height / 2,\r\n            context\r\n        );\r\n\r\n        context.clip();\r\n    }\r\n\r\n    public _renderHighlightSpecific(context: ICanvasRenderingContext): void {\r\n        Control.drawEllipse(\r\n            this._currentMeasure.left + this._currentMeasure.width / 2,\r\n            this._currentMeasure.top + this._currentMeasure.height / 2,\r\n            this._currentMeasure.width / 2 - this._highlightLineWidth / 2,\r\n            this._currentMeasure.height / 2 - this._highlightLineWidth / 2,\r\n            context\r\n        );\r\n        context.stroke();\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Ellipse\", Ellipse);\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Button } from \"./button\";\r\nimport type { Control } from \"./control\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport type { IFocusableControl } from \"./focusableControl\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport type { IKeyboardEvent } from \"core/Events/deviceInputEvents\";\r\n\r\n/**\r\n * Class used to create a focusable button that can easily handle keyboard events\r\n * @since 5.0.0\r\n */\r\nexport class FocusableButton extends Button implements IFocusableControl {\r\n    /** Highlight color when button is focused */\r\n    public focusedColor: Nullable<string> = null;\r\n    private _isFocused = false;\r\n    private _unfocusedColor: Nullable<string> = null;\r\n\r\n    /** Observable raised when the control gets the focus */\r\n    public onFocusObservable = new Observable<Button>();\r\n    /** Observable raised when the control loses the focus */\r\n    public onBlurObservable = new Observable<Button>();\r\n    /** Observable raised when a key event was processed */\r\n    public onKeyboardEventProcessedObservable = new Observable<IKeyboardEvent>();\r\n\r\n    constructor(public name?: string) {\r\n        super(name);\r\n\r\n        this._unfocusedColor = this.color;\r\n    }\r\n\r\n    /** @internal */\r\n    public onBlur(): void {\r\n        if (this._isFocused) {\r\n            this._isFocused = false;\r\n            if (this.focusedColor && this._unfocusedColor != null) {\r\n                // Set color back to saved unfocused color\r\n                this.color = this._unfocusedColor;\r\n            }\r\n            this.onBlurObservable.notifyObservers(this);\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public onFocus(): void {\r\n        this._isFocused = true;\r\n\r\n        if (this.focusedColor) {\r\n            // Save the unfocused color\r\n            this._unfocusedColor = this.color;\r\n            this.color = this.focusedColor;\r\n        }\r\n        this.onFocusObservable.notifyObservers(this);\r\n    }\r\n\r\n    /**\r\n     * Function called to get the list of controls that should not steal the focus from this control\r\n     * @returns an array of controls\r\n     */\r\n    public keepsFocusWith(): Nullable<Control[]> {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Function to focus a button programmatically\r\n     */\r\n    public focus() {\r\n        this._host.moveFocusToControl(this);\r\n    }\r\n\r\n    /**\r\n     * Function to unfocus a button programmatically\r\n     */\r\n    public blur() {\r\n        this._host.focusedControl = null;\r\n    }\r\n\r\n    /**\r\n     * Handles the keyboard event\r\n     * @param evt Defines the KeyboardEvent\r\n     */\r\n    public processKeyboard(evt: IKeyboardEvent): void {\r\n        this.onKeyboardEventProcessedObservable.notifyObservers(evt, -1, this);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!this.isReadOnly) {\r\n            // Clicking on button should focus\r\n            this.focus();\r\n        }\r\n\r\n        return super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi);\r\n    }\r\n\r\n    /** @internal */\r\n    public displose() {\r\n        super.dispose();\r\n\r\n        this.onBlurObservable.clear();\r\n        this.onFocusObservable.clear();\r\n        this.onKeyboardEventProcessedObservable.clear();\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.FocusableButton\", FocusableButton);\r\n","import type { Nullable } from \"core/types\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Control } from \"./control\";\r\nimport { ValueAndUnit } from \"../valueAndUnit\";\r\nimport type { VirtualKeyboard } from \"./virtualKeyboard\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { Measure } from \"../measure\";\r\nimport { InputText } from \"./inputText\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport type { PointerInfo, PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport type { IKeyboardEvent } from \"core/Events/deviceInputEvents\";\r\n\r\nimport { serialize } from \"core/Misc/decorators\";\r\n\r\n/**\r\n * Class used to create input text control\r\n */\r\nexport class InputTextArea extends InputText {\r\n    private _textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n    private _textVerticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n\r\n    private _lines: any[];\r\n    private _lineSpacing: ValueAndUnit = new ValueAndUnit(0);\r\n    private _outlineWidth: number = 0;\r\n    private _outlineColor: string = \"white\";\r\n    private _maxHeight = new ValueAndUnit(1, ValueAndUnit.UNITMODE_PERCENTAGE, false);\r\n\r\n    private _clipTextTop: number;\r\n    private _clipTextLeft: number;\r\n\r\n    private _cursorInfo: { globalStartIndex: number; globalEndIndex: number; relativeStartIndex: number; relativeEndIndex: number; currentLineIndex: number };\r\n    private _highlightCursorInfo: { initialStartIndex: number; initialRelativeStartIndex: number; initialLineIndex: number };\r\n\r\n    /**\r\n     * An event triggered after the text was broken up into lines\r\n     */\r\n    public onLinesReadyObservable = new Observable<InputTextArea>();\r\n\r\n    /** @internal */\r\n    public _connectedVirtualKeyboard: Nullable<VirtualKeyboard>;\r\n    private _contextForBreakLines: ICanvasRenderingContext;\r\n    private _clickedCoordinateX: Nullable<number>;\r\n    private _clickedCoordinateY: Nullable<number>;\r\n\r\n    private _availableWidth: number;\r\n    private _availableHeight: number;\r\n\r\n    private _scrollTop: Nullable<number>;\r\n\r\n    private _autoStretchHeight: boolean;\r\n\r\n    /**\r\n     * Gets or sets outlineWidth of the text to display\r\n     */\r\n    public get outlineWidth(): number {\r\n        return this._outlineWidth;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets outlineWidth of the text to display\r\n     */\r\n    public set outlineWidth(value: number) {\r\n        if (this._outlineWidth === value) {\r\n            return;\r\n        }\r\n        this._outlineWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets outlineColor of the text to display\r\n     */\r\n    public get outlineColor(): string {\r\n        return this._outlineColor;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets outlineColor of the text to display\r\n     */\r\n    public set outlineColor(value: string) {\r\n        if (this._outlineColor === value) {\r\n            return;\r\n        }\r\n        this._outlineColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the control can auto stretch its height to adapt to the text */\r\n    @serialize()\r\n    public get autoStretchHeight(): boolean {\r\n        return this._autoStretchHeight;\r\n    }\r\n\r\n    public set autoStretchHeight(value: boolean) {\r\n        if (this._autoStretchHeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._autoStretchHeight = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    public set height(value: string | number) {\r\n        this.fixedRatioMasterIsWidth = false;\r\n\r\n        if (this._height.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._height.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n\r\n        this._autoStretchHeight = false;\r\n    }\r\n\r\n    @serialize()\r\n    public get maxHeight(): string | number {\r\n        return this._maxHeight.toString(this._host);\r\n    }\r\n\r\n    /** Gets the maximum width allowed by the control in pixels */\r\n    public get maxHeightInPixels(): number {\r\n        return this._maxHeight.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n    }\r\n\r\n    public set maxHeight(value: string | number) {\r\n        if (this._maxHeight.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._maxHeight.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new InputTextArea\r\n     * @param name defines the control name\r\n     * @param text defines the text of the control\r\n     */\r\n    constructor(public name?: string, text: string = \"\") {\r\n        super(name);\r\n\r\n        this.text = text;\r\n\r\n        this.isPointerBlocker = true;\r\n\r\n        this.onLinesReadyObservable.add(() => this._updateCursorPosition());\r\n\r\n        this._highlightCursorInfo = {\r\n            initialStartIndex: -1,\r\n            initialRelativeStartIndex: -1,\r\n            initialLineIndex: -1,\r\n        };\r\n\r\n        this._cursorInfo = {\r\n            globalStartIndex: 0,\r\n            globalEndIndex: 0,\r\n            relativeEndIndex: 0,\r\n            relativeStartIndex: 0,\r\n            currentLineIndex: 0,\r\n        };\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"InputTextArea\";\r\n    }\r\n\r\n    /**\r\n     * Handles the keyboard event\r\n     * @param evt Defines the KeyboardEvent\r\n     */\r\n    public processKeyboard(evt: IKeyboardEvent): void {\r\n        // process pressed key\r\n        this.alternativeProcessKey(evt.code, evt.key, evt);\r\n\r\n        this.onKeyboardEventProcessedObservable.notifyObservers(evt);\r\n    }\r\n\r\n    /**\r\n     * Process the last keyboard input\r\n     *\r\n     * @param code The ascii input number\r\n     * @param key The key string representation\r\n     * @param evt The keyboard event emits with input\r\n     * @internal\r\n     */\r\n    public alternativeProcessKey(code: string, key?: string, evt?: IKeyboardEvent) {\r\n        //return if clipboard event keys (i.e -ctr/cmd + c,v,x)\r\n        if (evt && (evt.ctrlKey || evt.metaKey) && (code === \"KeyC\" || code === \"KeyV\" || code === \"KeyX\")) {\r\n            return;\r\n        }\r\n\r\n        // Specific cases\r\n        switch (code) {\r\n            case \"KeyA\": // A - select all\r\n                if (evt && (evt.ctrlKey || evt.metaKey)) {\r\n                    this._selectAllText();\r\n                    evt.preventDefault();\r\n                    return;\r\n                }\r\n                break;\r\n            case \"Period\": //SLASH\r\n                if (evt && evt.shiftKey) {\r\n                    evt.preventDefault();\r\n                }\r\n                break;\r\n            case \"Backspace\": // BACKSPACE\r\n                if (!this._isTextHighlightOn && this._cursorInfo.globalStartIndex > 0) {\r\n                    this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n                    this._cursorInfo.globalStartIndex--;\r\n                }\r\n\r\n                this._textWrapper.removePart(this._cursorInfo.globalStartIndex, this._cursorInfo.globalEndIndex);\r\n\r\n                this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n\r\n                if (evt) {\r\n                    evt.preventDefault();\r\n                }\r\n\r\n                this._blinkIsEven = false;\r\n                this._isTextHighlightOn = false;\r\n\r\n                this._textHasChanged();\r\n                break;\r\n            case \"Delete\": // DELETE\r\n                if (!this._isTextHighlightOn && this._cursorInfo.globalEndIndex < this.text.length) {\r\n                    this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex + 1;\r\n                }\r\n\r\n                this._textWrapper.removePart(this._cursorInfo.globalStartIndex, this._cursorInfo.globalEndIndex);\r\n\r\n                this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n\r\n                if (evt) {\r\n                    evt.preventDefault();\r\n                }\r\n\r\n                this._blinkIsEven = false;\r\n                this._isTextHighlightOn = false;\r\n\r\n                this._textHasChanged();\r\n                break;\r\n            case \"Enter\": // RETURN\r\n                this._textWrapper.removePart(this._cursorInfo.globalStartIndex, this._cursorInfo.globalEndIndex, \"\\n\");\r\n                this._cursorInfo.globalStartIndex++;\r\n                this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n\r\n                this._blinkIsEven = false;\r\n                this._isTextHighlightOn = false;\r\n\r\n                this._textHasChanged();\r\n                return;\r\n            case \"End\": // END\r\n                this._cursorInfo.globalStartIndex = this.text.length;\r\n                this._blinkIsEven = false;\r\n                this._isTextHighlightOn = false;\r\n                this._markAsDirty();\r\n                return;\r\n            case \"Home\": // HOME\r\n                this._cursorInfo.globalStartIndex = 0;\r\n                this._blinkIsEven = false;\r\n                this._isTextHighlightOn = false;\r\n                this._markAsDirty();\r\n                return;\r\n            case \"ArrowLeft\": // LEFT\r\n                this._markAsDirty();\r\n\r\n                if (evt && evt.shiftKey) {\r\n                    // shift + ctrl/cmd + <-\r\n                    if (evt.ctrlKey || evt.metaKey) {\r\n                        // Go to line's start by substract the relativeStartIndex to the globalStartIndex\r\n                        this._cursorInfo.globalStartIndex -= this._cursorInfo.relativeStartIndex;\r\n                        this._cursorInfo.globalEndIndex = this._highlightCursorInfo.initialStartIndex;\r\n                    }\r\n                    // store the starting point\r\n                    if (!this._isTextHighlightOn) {\r\n                        this._highlightCursorInfo.initialLineIndex = this._cursorInfo.currentLineIndex;\r\n                        this._highlightCursorInfo.initialStartIndex = this._cursorInfo.globalStartIndex;\r\n                        this._highlightCursorInfo.initialRelativeStartIndex = this._cursorInfo.relativeStartIndex;\r\n\r\n                        this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n                        this._cursorInfo.globalStartIndex--;\r\n                        this._isTextHighlightOn = true;\r\n                    } else {\r\n                        if (this._cursorInfo.globalEndIndex > this._highlightCursorInfo.initialStartIndex) {\r\n                            this._cursorInfo.globalEndIndex--;\r\n                        } else {\r\n                            this._cursorInfo.globalStartIndex--;\r\n                        }\r\n                    }\r\n                    this._blinkIsEven = true;\r\n                    evt.preventDefault();\r\n                    return;\r\n                }\r\n\r\n                if (this._isTextHighlightOn) {\r\n                    this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n                } else if (evt && (evt.ctrlKey || evt.metaKey)) {\r\n                    // ctr + <-\r\n                    this._cursorInfo.globalStartIndex -= this._cursorInfo.relativeStartIndex;\r\n                    evt.preventDefault();\r\n                } else if (this._cursorInfo.globalStartIndex > 0) {\r\n                    this._cursorInfo.globalStartIndex--;\r\n                }\r\n\r\n                // update the cursor\r\n                this._blinkIsEven = false;\r\n                this._isTextHighlightOn = false;\r\n                return;\r\n            case \"ArrowRight\": // RIGHT\r\n                this._markAsDirty();\r\n\r\n                if (evt && evt.shiftKey) {\r\n                    // shift + ctrl/cmd + ->\r\n                    if (evt.ctrlKey || evt.metaKey) {\r\n                        const rightDelta = this._lines[this._cursorInfo.currentLineIndex].text.length - this._cursorInfo.relativeEndIndex - 1;\r\n                        this._cursorInfo.globalEndIndex += rightDelta;\r\n                        this._cursorInfo.globalStartIndex = this._highlightCursorInfo.initialStartIndex;\r\n                    }\r\n                    // store the starting point\r\n                    if (!this._isTextHighlightOn) {\r\n                        this._highlightCursorInfo.initialLineIndex = this._cursorInfo.currentLineIndex;\r\n                        this._highlightCursorInfo.initialStartIndex = this._cursorInfo.globalStartIndex;\r\n                        this._highlightCursorInfo.initialRelativeStartIndex = this._cursorInfo.relativeStartIndex;\r\n\r\n                        this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n                        this._cursorInfo.globalEndIndex++;\r\n                        this._isTextHighlightOn = true;\r\n                    } else {\r\n                        if (this._cursorInfo.globalStartIndex < this._highlightCursorInfo.initialStartIndex) {\r\n                            this._cursorInfo.globalStartIndex++;\r\n                        } else {\r\n                            this._cursorInfo.globalEndIndex++;\r\n                        }\r\n                    }\r\n                    this._blinkIsEven = true;\r\n                    evt.preventDefault();\r\n                    return;\r\n                }\r\n                if (this._isTextHighlightOn) {\r\n                    this._cursorInfo.globalStartIndex = this._cursorInfo.globalEndIndex;\r\n                } else if (evt && (evt.ctrlKey || evt.metaKey)) {\r\n                    //ctr + ->\r\n                    const rightDelta = this._lines[this._cursorInfo.currentLineIndex].text.length - this._cursorInfo.relativeEndIndex;\r\n                    this._cursorInfo.globalStartIndex += rightDelta;\r\n                } else if (this._cursorInfo.globalStartIndex < this.text.length) {\r\n                    this._cursorInfo.globalStartIndex++;\r\n                }\r\n\r\n                // update the cursor\r\n                this._blinkIsEven = false;\r\n                this._isTextHighlightOn = false;\r\n                return;\r\n            case \"ArrowUp\": // UP\r\n                // update the cursor\r\n                this._blinkIsEven = false;\r\n\r\n                if (evt) {\r\n                    if (evt.shiftKey) {\r\n                        if (!this._isTextHighlightOn) {\r\n                            this._highlightCursorInfo.initialLineIndex = this._cursorInfo.currentLineIndex;\r\n                            this._highlightCursorInfo.initialStartIndex = this._cursorInfo.globalStartIndex;\r\n                            this._highlightCursorInfo.initialRelativeStartIndex = this._cursorInfo.relativeStartIndex;\r\n                        }\r\n                        this._isTextHighlightOn = true;\r\n                        this._blinkIsEven = true;\r\n                    } else {\r\n                        this._isTextHighlightOn = false;\r\n                    }\r\n                    evt.preventDefault();\r\n                }\r\n\r\n                if (this._cursorInfo.currentLineIndex === 0) {\r\n                    // First line\r\n                    this._cursorInfo.globalStartIndex = 0;\r\n                } else {\r\n                    const currentLine = this._lines[this._cursorInfo.currentLineIndex];\r\n                    const upperLine = this._lines[this._cursorInfo.currentLineIndex - 1];\r\n\r\n                    let tmpIndex = 0;\r\n                    let relativeIndex = 0;\r\n                    if (!this._isTextHighlightOn || this._cursorInfo.currentLineIndex < this._highlightCursorInfo.initialLineIndex) {\r\n                        tmpIndex = this._cursorInfo.globalStartIndex;\r\n                        relativeIndex = this._cursorInfo.relativeStartIndex;\r\n                    } else {\r\n                        tmpIndex = this._cursorInfo.globalEndIndex;\r\n                        relativeIndex = this._cursorInfo.relativeEndIndex;\r\n                    }\r\n\r\n                    const currentText = currentLine.text.substr(0, relativeIndex);\r\n                    const currentWidth = this._contextForBreakLines.measureText(currentText).width;\r\n\r\n                    let upperWidth = 0;\r\n                    let previousWidth = 0;\r\n\r\n                    tmpIndex -= relativeIndex; // Start of current line\r\n                    tmpIndex -= upperLine.text.length + upperLine.lineEnding.length; // Start of upper line\r\n                    let upperLineRelativeIndex = 0;\r\n\r\n                    while (upperWidth < currentWidth && upperLineRelativeIndex < upperLine.text.length) {\r\n                        tmpIndex++;\r\n                        upperLineRelativeIndex++;\r\n                        previousWidth = Math.abs(currentWidth - upperWidth);\r\n                        upperWidth = this._contextForBreakLines.measureText(upperLine.text.substr(0, upperLineRelativeIndex)).width;\r\n                    }\r\n\r\n                    // Find closest move\r\n                    if (Math.abs(currentWidth - upperWidth) > previousWidth && upperLineRelativeIndex > 0) {\r\n                        tmpIndex--;\r\n                    }\r\n\r\n                    if (!this._isTextHighlightOn) {\r\n                        this._cursorInfo.globalStartIndex = tmpIndex;\r\n                    } else if (this._cursorInfo.currentLineIndex <= this._highlightCursorInfo.initialLineIndex) {\r\n                        this._cursorInfo.globalStartIndex = tmpIndex;\r\n                        this._cursorInfo.globalEndIndex = this._highlightCursorInfo.initialStartIndex;\r\n                        this._cursorInfo.relativeEndIndex = this._highlightCursorInfo.initialRelativeStartIndex;\r\n                    } else {\r\n                        this._cursorInfo.globalEndIndex = tmpIndex;\r\n                    }\r\n                }\r\n\r\n                this._markAsDirty();\r\n                return;\r\n            case \"ArrowDown\": // DOWN\r\n                // update the cursor\r\n                this._blinkIsEven = false;\r\n\r\n                if (evt) {\r\n                    if (evt.shiftKey) {\r\n                        if (!this._isTextHighlightOn) {\r\n                            this._highlightCursorInfo.initialLineIndex = this._cursorInfo.currentLineIndex;\r\n                            this._highlightCursorInfo.initialStartIndex = this._cursorInfo.globalStartIndex;\r\n                            this._highlightCursorInfo.initialRelativeStartIndex = this._cursorInfo.relativeStartIndex;\r\n                        }\r\n\r\n                        this._isTextHighlightOn = true;\r\n                        this._blinkIsEven = true;\r\n                    } else {\r\n                        this._isTextHighlightOn = false;\r\n                    }\r\n                    evt.preventDefault();\r\n                }\r\n\r\n                if (this._cursorInfo.currentLineIndex === this._lines.length - 1) {\r\n                    // Last line\r\n                    this._cursorInfo.globalStartIndex = this.text.length;\r\n                } else {\r\n                    const currentLine = this._lines[this._cursorInfo.currentLineIndex];\r\n                    const underLine = this._lines[this._cursorInfo.currentLineIndex + 1];\r\n\r\n                    let tmpIndex = 0;\r\n                    let relativeIndex = 0;\r\n                    if (!this._isTextHighlightOn || this._cursorInfo.currentLineIndex < this._highlightCursorInfo.initialLineIndex) {\r\n                        tmpIndex = this._cursorInfo.globalStartIndex;\r\n                        relativeIndex = this._cursorInfo.relativeStartIndex;\r\n                    } else {\r\n                        tmpIndex = this._cursorInfo.globalEndIndex;\r\n                        relativeIndex = this._cursorInfo.relativeEndIndex;\r\n                    }\r\n\r\n                    const currentText = currentLine.text.substr(0, relativeIndex);\r\n                    const currentWidth = this._contextForBreakLines.measureText(currentText).width;\r\n\r\n                    let underWidth = 0;\r\n                    let previousWidth = 0;\r\n\r\n                    tmpIndex += currentLine.text.length - relativeIndex + currentLine.lineEnding.length; // Start of current line\r\n                    let underLineRelativeIndex = 0;\r\n\r\n                    while (underWidth < currentWidth && underLineRelativeIndex < underLine.text.length) {\r\n                        tmpIndex++;\r\n                        underLineRelativeIndex++;\r\n                        previousWidth = Math.abs(currentWidth - underWidth);\r\n                        underWidth = this._contextForBreakLines.measureText(underLine.text.substr(0, underLineRelativeIndex)).width;\r\n                    }\r\n\r\n                    // Find closest move\r\n                    if (Math.abs(currentWidth - underWidth) > previousWidth && underLineRelativeIndex > 0) {\r\n                        tmpIndex--;\r\n                    }\r\n\r\n                    if (!this._isTextHighlightOn) {\r\n                        this._cursorInfo.globalStartIndex = tmpIndex;\r\n                    } else if (this._cursorInfo.currentLineIndex < this._highlightCursorInfo.initialLineIndex) {\r\n                        this._cursorInfo.globalStartIndex = tmpIndex;\r\n                        if (this._cursorInfo.globalStartIndex > this._cursorInfo.globalEndIndex) {\r\n                            this._cursorInfo.globalEndIndex += this._cursorInfo.globalStartIndex;\r\n                            this._cursorInfo.globalStartIndex = this._cursorInfo.globalEndIndex - this._cursorInfo.globalStartIndex;\r\n                            this._cursorInfo.globalEndIndex -= this._cursorInfo.globalStartIndex;\r\n                        }\r\n                    } else {\r\n                        this._cursorInfo.globalEndIndex = tmpIndex;\r\n                        this._cursorInfo.globalStartIndex = this._highlightCursorInfo.initialStartIndex;\r\n                    }\r\n                }\r\n\r\n                this._markAsDirty();\r\n                return;\r\n        }\r\n\r\n        // Printable characters\r\n        if (key?.length === 1) {\r\n            evt?.preventDefault();\r\n            this._currentKey = key;\r\n            this.onBeforeKeyAddObservable.notifyObservers(this);\r\n            key = this._currentKey;\r\n            if (this._addKey) {\r\n                this._isTextHighlightOn = false;\r\n                this._blinkIsEven = false;\r\n\r\n                this._textWrapper.removePart(this._cursorInfo.globalStartIndex, this._cursorInfo.globalEndIndex, key);\r\n                this._cursorInfo.globalStartIndex += key.length;\r\n                this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n\r\n                this._textHasChanged();\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _parseLineWordWrap(line: string = \"\", width: number, context: ICanvasRenderingContext): { text: string; width: number; lineEnding: string }[] {\r\n        const lines = [];\r\n        const words = line.split(\" \");\r\n        let lineWidth = 0;\r\n\r\n        for (let n = 0; n < words.length; n++) {\r\n            const testLine = n > 0 ? line + \" \" + words[n] : words[0];\r\n            const metrics = context.measureText(testLine);\r\n            const testWidth = metrics.width;\r\n            if (testWidth > width) {\r\n                if (n > 0) {\r\n                    // Avoid first word duplication if of too long\r\n                    lineWidth = context.measureText(line).width;\r\n                    lines.push({ text: line, width: lineWidth, lineEnding: \" \" });\r\n                }\r\n\r\n                line = words[n];\r\n\r\n                let flushedLine = \"\";\r\n\r\n                line.split(\"\").map((char) => {\r\n                    if (context.measureText(flushedLine + char).width > width) {\r\n                        lines.push({ text: flushedLine, width: context.measureText(flushedLine).width, lineEnding: \"\\n\" });\r\n                        flushedLine = \"\";\r\n                    }\r\n                    flushedLine += char;\r\n                });\r\n\r\n                line = flushedLine;\r\n                // Measure remaining characters\r\n                lineWidth = context.measureText(line).width;\r\n            } else {\r\n                lineWidth = testWidth;\r\n                line = testLine;\r\n            }\r\n        }\r\n        lines.push({ text: line, width: lineWidth, lineEnding: \" \" });\r\n\r\n        return lines;\r\n    }\r\n\r\n    protected _breakLines(refWidth: number, context: ICanvasRenderingContext): object[] {\r\n        const lines: { text: string; width: number; lineEnding: string }[] = [];\r\n        const _lines = this.text.split(\"\\n\");\r\n\r\n        if (this.clipContent) {\r\n            for (const _line of _lines) {\r\n                lines.push(...this._parseLineWordWrap(_line, refWidth, context));\r\n            }\r\n        } else {\r\n            for (const _line of _lines) {\r\n                lines.push(this._parseLine(_line, context));\r\n            }\r\n        }\r\n\r\n        lines[lines.length - 1].lineEnding = \"\\n\";\r\n\r\n        return lines;\r\n    }\r\n\r\n    protected _parseLine(line: string = \"\", context: ICanvasRenderingContext): { text: string; width: number; lineEnding: string } {\r\n        return { text: line, width: context.measureText(line).width, lineEnding: \" \" };\r\n    }\r\n\r\n    /**\r\n     * Processing of child right before the parent measurement update\r\n     *\r\n     * @param parentMeasure The parent measure\r\n     * @param context The rendering canvas\r\n     * @internal\r\n     */\r\n    protected _preMeasure(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        if (!this._fontOffset || this._wasDirty) {\r\n            this._fontOffset = Control._GetFontOffset(context.font);\r\n        }\r\n\r\n        let text = this._beforeRenderText(this._textWrapper).text;\r\n\r\n        // placeholder conditions and color setting\r\n        if (!this._isFocused && !this.text && this._placeholderText) {\r\n            text = this._placeholderText;\r\n\r\n            if (this._placeholderColor) {\r\n                context.fillStyle = this._placeholderColor;\r\n            }\r\n        }\r\n\r\n        // measures the textlength -> this.measure.width\r\n        this._textWidth = context.measureText(text).width;\r\n        // we double up the margin width\r\n        const marginWidth = this._margin.getValueInPixel(this._host, parentMeasure.width) * 2;\r\n\r\n        if (this._autoStretchWidth) {\r\n            const tmpLines = text.split(\"\\n\");\r\n            const longerString = tmpLines.reduce((acc: string, val: string) => {\r\n                const valueLength = context.measureText(val).width;\r\n                const accLength = context.measureText(acc).width;\r\n                return valueLength > accLength ? val : acc;\r\n            }, \"\");\r\n\r\n            const longerStringWidth = context.measureText(longerString).width;\r\n            this.width = Math.min(this._maxWidth.getValueInPixel(this._host, parentMeasure.width), longerStringWidth + marginWidth) + \"px\";\r\n\r\n            this.autoStretchWidth = true;\r\n        }\r\n\r\n        this._availableWidth = this._width.getValueInPixel(this._host, parentMeasure.width) - marginWidth;\r\n\r\n        // Prepare lines\r\n        this._lines = this._breakLines(this._availableWidth, context);\r\n        // can we find a cleaner implementation here?\r\n        this._contextForBreakLines = context;\r\n\r\n        if (this._autoStretchHeight) {\r\n            const textHeight = this._lines.length * this._fontOffset.height;\r\n            const totalHeight = textHeight + this._margin.getValueInPixel(this._host, parentMeasure.height) * 2;\r\n            this.height = Math.min(this._maxHeight.getValueInPixel(this._host, parentMeasure.height), totalHeight) + \"px\";\r\n\r\n            this._autoStretchHeight = true;\r\n        }\r\n\r\n        this._availableHeight = this._height.getValueInPixel(this._host, parentMeasure.height) - marginWidth;\r\n\r\n        if (this._isFocused) {\r\n            this._cursorInfo.currentLineIndex = 0;\r\n\r\n            let lineLength = this._lines[this._cursorInfo.currentLineIndex].text.length + this._lines[this._cursorInfo.currentLineIndex].lineEnding.length;\r\n            let tmpLength = 0;\r\n\r\n            while (tmpLength + lineLength <= this._cursorInfo.globalStartIndex) {\r\n                tmpLength += lineLength;\r\n\r\n                if (this._cursorInfo.currentLineIndex < this._lines.length - 1) {\r\n                    this._cursorInfo.currentLineIndex++;\r\n                    lineLength = this._lines[this._cursorInfo.currentLineIndex].text.length + this._lines[this._cursorInfo.currentLineIndex].lineEnding.length;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private _computeScroll() {\r\n        this._clipTextLeft = this._currentMeasure.left + this._margin.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n        this._clipTextTop = this._currentMeasure.top + this._margin.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n\r\n        if (this._isFocused && this._lines[this._cursorInfo.currentLineIndex].width > this._availableWidth) {\r\n            const textLeft = this._clipTextLeft - this._lines[this._cursorInfo.currentLineIndex].width + this._availableWidth;\r\n\r\n            if (!this._scrollLeft) {\r\n                this._scrollLeft = textLeft;\r\n            }\r\n        } else {\r\n            this._scrollLeft = this._clipTextLeft;\r\n        }\r\n\r\n        if (this._isFocused && !this._autoStretchHeight) {\r\n            const selectedHeight = (this._cursorInfo.currentLineIndex + 1) * this._fontOffset.height;\r\n            const textTop = this._clipTextTop - selectedHeight;\r\n\r\n            if (!this._scrollTop) {\r\n                this._scrollTop = textTop;\r\n            }\r\n        } else {\r\n            this._scrollTop = this._clipTextTop;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing of child after the parent measurement update\r\n     *\r\n     * @internal\r\n     */\r\n    protected _additionalProcessing(): void {\r\n        // Flush the highlighted text each frame\r\n        this.highlightedText = \"\";\r\n\r\n        this.onLinesReadyObservable.notifyObservers(this);\r\n    }\r\n\r\n    private _drawText(text: string, textWidth: number, y: number, context: ICanvasRenderingContext): void {\r\n        const width = this._currentMeasure.width;\r\n        let x = this._scrollLeft as number;\r\n        switch (this._textHorizontalAlignment) {\r\n            case Control.HORIZONTAL_ALIGNMENT_LEFT:\r\n                x += 0;\r\n                break;\r\n            case Control.HORIZONTAL_ALIGNMENT_RIGHT:\r\n                x += width - textWidth;\r\n                break;\r\n            case Control.HORIZONTAL_ALIGNMENT_CENTER:\r\n                x += (width - textWidth) / 2;\r\n                break;\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        if (this.outlineWidth) {\r\n            context.strokeText(text, this._currentMeasure.left + x, y);\r\n        }\r\n        context.fillText(text, x, y);\r\n    }\r\n\r\n    /**\r\n     * Copy the text in the clipboard\r\n     *\r\n     * @param ev The clipboard event\r\n     * @internal\r\n     */\r\n    protected _onCopyText(ev: ClipboardEvent): void {\r\n        this._isTextHighlightOn = false;\r\n        //when write permission to clipbaord data is denied\r\n        try {\r\n            ev.clipboardData && ev.clipboardData.setData(\"text/plain\", this._highlightedText);\r\n        } catch {} //pass\r\n        this._host.clipboardData = this._highlightedText;\r\n    }\r\n\r\n    /**\r\n     * Cut the text and copy it in the clipboard\r\n     *\r\n     * @param ev The clipboard event\r\n     * @internal\r\n     */\r\n    protected _onCutText(ev: ClipboardEvent): void {\r\n        if (!this._highlightedText) {\r\n            return;\r\n        }\r\n        //when write permission to clipbaord data is denied\r\n        try {\r\n            ev.clipboardData && ev.clipboardData.setData(\"text/plain\", this._highlightedText);\r\n        } catch {} //pass\r\n\r\n        this._host.clipboardData = this._highlightedText;\r\n\r\n        this._textWrapper.removePart(this._cursorInfo.globalStartIndex, this._cursorInfo.globalEndIndex);\r\n\r\n        this._textHasChanged();\r\n    }\r\n\r\n    /**\r\n     * Paste the copied text from the clipboard\r\n     *\r\n     * @param ev The clipboard event\r\n     * @internal\r\n     */\r\n    protected _onPasteText(ev: ClipboardEvent): void {\r\n        let data: string = \"\";\r\n        if (ev.clipboardData && ev.clipboardData.types.indexOf(\"text/plain\") !== -1) {\r\n            data = ev.clipboardData.getData(\"text/plain\");\r\n        } else {\r\n            //get the cached data; returns blank string by default\r\n            data = this._host.clipboardData;\r\n        }\r\n\r\n        this._isTextHighlightOn = false;\r\n\r\n        this._textWrapper.removePart(this._cursorInfo.globalStartIndex, this._cursorInfo.globalEndIndex, data);\r\n\r\n        const deltaIndex = data.length - (this._cursorInfo.globalEndIndex - this._cursorInfo.globalStartIndex);\r\n\r\n        this._cursorInfo.globalStartIndex += deltaIndex;\r\n        this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n\r\n        this._textHasChanged();\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        this._computeScroll();\r\n\r\n        this._scrollLeft = this._scrollLeft ?? 0;\r\n        this._scrollTop = this._scrollTop ?? 0;\r\n\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        // Background\r\n        if (this._isFocused) {\r\n            if (this._focusedBackground) {\r\n                context.fillStyle = this._isEnabled ? this._focusedBackground : this._disabledColor;\r\n\r\n                context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n            }\r\n        } else if (this._background) {\r\n            context.fillStyle = this._isEnabled ? this._background : this._disabledColor;\r\n\r\n            context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n\r\n        // sets the color of the rectangle (border if background available)\r\n        if (this.color) {\r\n            context.fillStyle = this.color;\r\n        }\r\n\r\n        const height = this._currentMeasure.height;\r\n        const width = this._currentMeasure.width;\r\n        let rootY = 0;\r\n\r\n        switch (this._textVerticalAlignment) {\r\n            case Control.VERTICAL_ALIGNMENT_TOP:\r\n                rootY = this._fontOffset.ascent;\r\n                break;\r\n            case Control.VERTICAL_ALIGNMENT_BOTTOM:\r\n                rootY = height - this._fontOffset.height * (this._lines.length - 1) - this._fontOffset.descent;\r\n                break;\r\n            case Control.VERTICAL_ALIGNMENT_CENTER:\r\n                rootY = this._fontOffset.ascent + (height - this._fontOffset.height * this._lines.length) / 2;\r\n                break;\r\n        }\r\n\r\n        context.save();\r\n        context.beginPath();\r\n        context.fillStyle = this.fontStyle;\r\n\r\n        // here we define the visible reactangle to clip it in next line\r\n        context.rect(this._clipTextLeft, this._clipTextTop, this._availableWidth + 2, this._availableHeight + 2);\r\n        context.clip();\r\n\r\n        // Text\r\n        rootY += this._scrollTop;\r\n\r\n        for (let i = 0; i < this._lines.length; i++) {\r\n            const line = this._lines[i];\r\n\r\n            if (i !== 0 && this._lineSpacing.internalValue !== 0) {\r\n                if (this._lineSpacing.isPixel) {\r\n                    rootY += this._lineSpacing.getValue(this._host);\r\n                } else {\r\n                    rootY = rootY + this._lineSpacing.getValue(this._host) * this._height.getValueInPixel(this._host, this._cachedParentMeasure.height);\r\n                }\r\n            }\r\n\r\n            this._drawText(line.text, line.width, rootY, context);\r\n            rootY += this._fontOffset.height;\r\n        }\r\n\r\n        context.restore();\r\n\r\n        // Cursor\r\n        if (this._isFocused) {\r\n            // Render cursor\r\n            if (!this._blinkIsEven || this._isTextHighlightOn) {\r\n                let cursorLeft = this._scrollLeft + context.measureText(this._lines[this._cursorInfo.currentLineIndex].text.substr(0, this._cursorInfo.relativeStartIndex)).width;\r\n\r\n                if (cursorLeft < this._clipTextLeft) {\r\n                    this._scrollLeft += this._clipTextLeft - cursorLeft;\r\n                    cursorLeft = this._clipTextLeft;\r\n                    this._markAsDirty();\r\n                } else if (cursorLeft > this._clipTextLeft + this._availableWidth) {\r\n                    this._scrollLeft += this._clipTextLeft + this._availableWidth - cursorLeft;\r\n                    cursorLeft = this._clipTextLeft + this._availableWidth;\r\n                    this._markAsDirty();\r\n                }\r\n\r\n                let cursorTop = this._scrollTop + this._cursorInfo.currentLineIndex * this._fontOffset.height; //cursorTop distance from top to cursor start\r\n\r\n                if (cursorTop < this._clipTextTop) {\r\n                    this._scrollTop += this._clipTextTop - cursorTop;\r\n                    cursorTop = this._clipTextTop;\r\n                    this._markAsDirty();\r\n                } else if (cursorTop + this._fontOffset.height > this._clipTextTop + this._availableHeight) {\r\n                    this._scrollTop += this._clipTextTop + this._availableHeight - cursorTop - this._fontOffset.height;\r\n                    cursorTop = this._clipTextTop + this._availableHeight - this._fontOffset.height;\r\n                    this._markAsDirty();\r\n                }\r\n\r\n                if (!this._isTextHighlightOn) {\r\n                    context.fillRect(cursorLeft, cursorTop, 2, this._fontOffset.height);\r\n                }\r\n            }\r\n\r\n            this._resetBlinking();\r\n\r\n            //show the highlighted text\r\n            if (this._isTextHighlightOn) {\r\n                clearTimeout(this._blinkTimeout);\r\n\r\n                this._highlightedText = this.text.substring(this._cursorInfo.globalStartIndex, this._cursorInfo.globalEndIndex);\r\n\r\n                context.globalAlpha = this._highligherOpacity;\r\n                context.fillStyle = this._textHighlightColor;\r\n\r\n                const startLineIndex = Math.min(this._cursorInfo.currentLineIndex, this._highlightCursorInfo.initialLineIndex);\r\n                const endLineIndex = Math.max(this._cursorInfo.currentLineIndex, this._highlightCursorInfo.initialLineIndex);\r\n\r\n                let highlightRootY = this._scrollTop + startLineIndex * this._fontOffset.height;\r\n\r\n                for (let i = startLineIndex; i <= endLineIndex; i++) {\r\n                    const line = this._lines[i];\r\n\r\n                    let highlightRootX = this._scrollLeft as number;\r\n                    switch (this._textHorizontalAlignment) {\r\n                        case Control.HORIZONTAL_ALIGNMENT_LEFT:\r\n                            highlightRootX += 0;\r\n                            break;\r\n                        case Control.HORIZONTAL_ALIGNMENT_RIGHT:\r\n                            highlightRootX += width - line.width;\r\n                            break;\r\n                        case Control.HORIZONTAL_ALIGNMENT_CENTER:\r\n                            highlightRootX += (width - line.width) / 2;\r\n                            break;\r\n                    }\r\n\r\n                    const begin = i === startLineIndex ? this._cursorInfo.relativeStartIndex : 0;\r\n                    const end = i === endLineIndex ? this._cursorInfo.relativeEndIndex : line.text.length;\r\n\r\n                    const leftOffsetWidth = context.measureText(line.text.substr(0, begin)).width;\r\n                    const selectedText = line.text.substring(begin, end);\r\n                    const hightlightWidth = context.measureText(selectedText).width;\r\n\r\n                    context.fillRect(highlightRootX + leftOffsetWidth, highlightRootY, hightlightWidth, this._fontOffset.height);\r\n\r\n                    highlightRootY += this._fontOffset.height;\r\n                }\r\n\r\n                if (this._cursorInfo.globalEndIndex === this._cursorInfo.globalStartIndex) {\r\n                    this._resetBlinking();\r\n                }\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n\r\n        // Border\r\n        if (this._thickness) {\r\n            if (this._isFocused) {\r\n                if (this.focusedColor) {\r\n                    context.strokeStyle = this.focusedColor;\r\n                }\r\n            } else {\r\n                if (this.color) {\r\n                    context.strokeStyle = this.color;\r\n                }\r\n            }\r\n\r\n            context.lineWidth = this._thickness;\r\n\r\n            context.strokeRect(\r\n                this._currentMeasure.left + this._thickness / 2,\r\n                this._currentMeasure.top + this._thickness / 2,\r\n                this._currentMeasure.width - this._thickness,\r\n                this._currentMeasure.height - this._thickness\r\n            );\r\n        }\r\n    }\r\n\r\n    private _resetBlinking() {\r\n        clearTimeout(this._blinkTimeout);\r\n        this._blinkTimeout = <any>setTimeout(() => {\r\n            this._blinkIsEven = !this._blinkIsEven;\r\n            this._markAsDirty();\r\n        }, 500);\r\n    }\r\n\r\n    protected _applyStates(context: ICanvasRenderingContext): void {\r\n        super._applyStates(context);\r\n        if (this.outlineWidth) {\r\n            context.lineWidth = this.outlineWidth;\r\n            context.strokeStyle = this.outlineColor;\r\n        }\r\n    }\r\n\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        this._clickedCoordinateX = coordinates.x;\r\n        this._clickedCoordinateY = coordinates.y;\r\n\r\n        this._isTextHighlightOn = false;\r\n        this._highlightedText = \"\";\r\n        this._isPointerDown = true;\r\n        this._host._capturingControl[pointerId] = this;\r\n        if (this._host.focusedControl === this) {\r\n            // Move cursor\r\n            clearTimeout(this._blinkTimeout);\r\n            this._markAsDirty();\r\n            return true;\r\n        }\r\n        if (!this._isEnabled) {\r\n            return false;\r\n        }\r\n        this._host.focusedControl = this;\r\n\r\n        return true;\r\n    }\r\n\r\n    // for textselection\r\n    public _onPointerMove(target: Control, coordinates: Vector2, pointerId: number, pi: PointerInfoBase): void {\r\n        // Avoid Chromium-like beahavior when this event is fired right after onPointerDown\r\n        if (pi.event.movementX === 0 && pi.event.movementY === 0) {\r\n            return;\r\n        }\r\n\r\n        if (this._host.focusedControl === this && this._isPointerDown) {\r\n            this._clickedCoordinateX = coordinates.x;\r\n            this._clickedCoordinateY = coordinates.y;\r\n\r\n            if (!this._isTextHighlightOn) {\r\n                this._highlightCursorInfo.initialLineIndex = this._cursorInfo.currentLineIndex;\r\n                this._highlightCursorInfo.initialStartIndex = this._cursorInfo.globalStartIndex;\r\n                this._highlightCursorInfo.initialRelativeStartIndex = this._cursorInfo.relativeStartIndex;\r\n\r\n                this._isTextHighlightOn = true;\r\n            }\r\n\r\n            this._markAsDirty();\r\n        }\r\n        super._onPointerMove(target, coordinates, pointerId, pi);\r\n    }\r\n\r\n    /**\r\n     * Apply the correct position of cursor according to current modification\r\n     */\r\n    private _updateCursorPosition() {\r\n        if (!this._isFocused) {\r\n            return;\r\n        }\r\n\r\n        if (this._clickedCoordinateX && this._clickedCoordinateY) {\r\n            if (!this._isTextHighlightOn) {\r\n                this._cursorInfo = {\r\n                    globalStartIndex: 0,\r\n                    globalEndIndex: 0,\r\n                    relativeStartIndex: 0,\r\n                    relativeEndIndex: 0,\r\n                    currentLineIndex: 0,\r\n                };\r\n            }\r\n\r\n            let globalIndex = 0;\r\n            let relativeIndex = 0;\r\n\r\n            const lastClickedCoordinateY = this._clickedCoordinateY - (this._scrollTop as number);\r\n\r\n            const relativeCoordinateY = Math.floor(lastClickedCoordinateY / this._fontOffset.height);\r\n            this._cursorInfo.currentLineIndex = Math.min(Math.max(relativeCoordinateY, 0), this._lines.length - 1);\r\n\r\n            let currentSize = 0;\r\n\r\n            const relativeXPosition = this._clickedCoordinateX - (this._scrollLeft ?? 0);\r\n\r\n            let previousDist = 0;\r\n\r\n            for (let index = 0; index < this._cursorInfo.currentLineIndex; index++) {\r\n                const line = this._lines[index];\r\n                globalIndex += line.text.length + line.lineEnding.length;\r\n            }\r\n\r\n            while (currentSize < relativeXPosition && this._lines[this._cursorInfo.currentLineIndex].text.length > relativeIndex) {\r\n                relativeIndex++;\r\n                previousDist = Math.abs(relativeXPosition - currentSize);\r\n                currentSize = this._contextForBreakLines.measureText(this._lines[this._cursorInfo.currentLineIndex].text.substr(0, relativeIndex)).width;\r\n            }\r\n\r\n            // Find closest move\r\n            if (Math.abs(relativeXPosition - currentSize) > previousDist && relativeIndex > 0) {\r\n                relativeIndex--;\r\n            }\r\n\r\n            globalIndex += relativeIndex;\r\n\r\n            if (!this._isTextHighlightOn) {\r\n                this._cursorInfo.globalStartIndex = globalIndex;\r\n                this._cursorInfo.relativeStartIndex = relativeIndex;\r\n                this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n                this._cursorInfo.relativeEndIndex = this._cursorInfo.relativeStartIndex;\r\n            } else {\r\n                if (globalIndex < this._highlightCursorInfo.initialStartIndex) {\r\n                    this._cursorInfo.globalStartIndex = globalIndex;\r\n                    this._cursorInfo.relativeStartIndex = relativeIndex;\r\n                    this._cursorInfo.globalEndIndex = this._highlightCursorInfo.initialStartIndex;\r\n                    this._cursorInfo.relativeEndIndex = this._highlightCursorInfo.initialRelativeStartIndex;\r\n                } else {\r\n                    this._cursorInfo.globalStartIndex = this._highlightCursorInfo.initialStartIndex;\r\n                    this._cursorInfo.relativeStartIndex = this._highlightCursorInfo.initialRelativeStartIndex;\r\n                    this._cursorInfo.globalEndIndex = globalIndex;\r\n                    this._cursorInfo.relativeEndIndex = relativeIndex;\r\n                }\r\n            }\r\n\r\n            // Avoid the caret during highlighting\r\n            this._blinkIsEven = this._isTextHighlightOn;\r\n            this._clickedCoordinateX = null;\r\n            this._clickedCoordinateY = null;\r\n        } else {\r\n            // Standard behavior same as Current line is at least above the initial highlight index\r\n            this._cursorInfo.relativeStartIndex = 0;\r\n            this._cursorInfo.currentLineIndex = 0;\r\n\r\n            let lineLength = this._lines[this._cursorInfo.currentLineIndex].text.length + this._lines[this._cursorInfo.currentLineIndex].lineEnding.length;\r\n            let tmpLength = 0;\r\n\r\n            while (tmpLength + lineLength <= this._cursorInfo.globalStartIndex) {\r\n                tmpLength += lineLength;\r\n\r\n                if (this._cursorInfo.currentLineIndex < this._lines.length - 1) {\r\n                    this._cursorInfo.currentLineIndex++;\r\n                    lineLength = this._lines[this._cursorInfo.currentLineIndex].text.length + this._lines[this._cursorInfo.currentLineIndex].lineEnding.length;\r\n                }\r\n            }\r\n\r\n            this._cursorInfo.relativeStartIndex = this._cursorInfo.globalStartIndex - tmpLength;\r\n\r\n            if (this._highlightCursorInfo.initialStartIndex !== -1 && this._cursorInfo.globalStartIndex >= this._highlightCursorInfo.initialStartIndex) {\r\n                // Current line is at least below the initial highlight index\r\n                while (tmpLength + lineLength <= this._cursorInfo.globalEndIndex) {\r\n                    tmpLength += lineLength;\r\n\r\n                    if (this._cursorInfo.currentLineIndex < this._lines.length - 1) {\r\n                        this._cursorInfo.currentLineIndex++;\r\n                        lineLength = this._lines[this._cursorInfo.currentLineIndex].text.length + this._lines[this._cursorInfo.currentLineIndex].lineEnding.length;\r\n                    }\r\n                }\r\n\r\n                this._cursorInfo.relativeEndIndex = this._cursorInfo.globalEndIndex - tmpLength;\r\n            } else if (!this._isTextHighlightOn) {\r\n                this._cursorInfo.relativeEndIndex = this._cursorInfo.relativeStartIndex;\r\n                this._cursorInfo.globalEndIndex = this._cursorInfo.globalStartIndex;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update all values of cursor information based on cursorIndex value\r\n     *\r\n     * @param offset The index to take care of\r\n     * @internal\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    protected _updateValueFromCursorIndex(offset: number) {\r\n        // Override to avoid parent behavior during _onPointerMove\r\n    }\r\n\r\n    /**\r\n     * Select the word immediatly under the cursor on double click\r\n     *\r\n     * @param _evt Pointer informations of double click\r\n     * @internal\r\n     */\r\n    protected _processDblClick(_evt: PointerInfo) {\r\n        //pre-find the start and end index of the word under cursor, speeds up the rendering\r\n        let moveLeft, moveRight;\r\n        do {\r\n            moveLeft = this._cursorInfo.globalStartIndex > 0 && this._textWrapper.isWord(this._cursorInfo.globalStartIndex - 1) ? --this._cursorInfo.globalStartIndex : 0;\r\n            moveRight =\r\n                this._cursorInfo.globalEndIndex < this._textWrapper.length && this._textWrapper.isWord(this._cursorInfo.globalEndIndex) ? ++this._cursorInfo.globalEndIndex : 0;\r\n        } while (moveLeft || moveRight);\r\n\r\n        this._highlightCursorInfo.initialLineIndex = this._cursorInfo.currentLineIndex;\r\n        this._highlightCursorInfo.initialStartIndex = this._cursorInfo.globalStartIndex;\r\n\r\n        this.onTextHighlightObservable.notifyObservers(this);\r\n\r\n        this._isTextHighlightOn = true;\r\n        this._blinkIsEven = true;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** @internal */\r\n    protected _selectAllText() {\r\n        this._isTextHighlightOn = true;\r\n        this._blinkIsEven = true;\r\n\r\n        this._highlightCursorInfo = {\r\n            initialStartIndex: 0,\r\n            initialRelativeStartIndex: 0,\r\n            initialLineIndex: 0,\r\n        };\r\n\r\n        this._cursorInfo = {\r\n            globalStartIndex: 0,\r\n            globalEndIndex: this._textWrapper.length,\r\n            relativeEndIndex: this._lines[this._lines.length - 1].text.length,\r\n            relativeStartIndex: 0,\r\n            currentLineIndex: this._lines.length - 1,\r\n        };\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    public dipose() {\r\n        super.dispose();\r\n\r\n        this.onLinesReadyObservable.clear();\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.InputTextArea\", InputTextArea);\r\n","import { InputText } from \"./inputText\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { TextWrapper } from \"./textWrapper\";\r\n\r\n/**\r\n * Class used to create a password control\r\n */\r\nexport class InputPassword extends InputText {\r\n    protected _getTypeName(): string {\r\n        return \"InputPassword\";\r\n    }\r\n\r\n    protected _beforeRenderText(textWrapper: TextWrapper): TextWrapper {\r\n        const pwdTextWrapper = new TextWrapper();\r\n        let txt = \"\";\r\n        for (let i = 0; i < textWrapper.length; i++) {\r\n            txt += \"\\u2022\";\r\n        }\r\n        pwdTextWrapper.text = txt;\r\n        return pwdTextWrapper;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.InputPassword\", InputPassword);\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Vector3, Matrix } from \"core/Maths/math.vector\";\r\nimport { Tools } from \"core/Misc/tools\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport { Control } from \"./control\";\r\nimport { ValueAndUnit } from \"../valueAndUnit\";\r\nimport type { Measure } from \"../measure\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/** Class used to render 2D lines */\r\nexport class Line extends Control {\r\n    private _lineWidth = 1;\r\n    /** @internal */\r\n    public _x1 = new ValueAndUnit(0);\r\n    /** @internal */\r\n    public _y1 = new ValueAndUnit(0);\r\n    /** @internal */\r\n    public _x2 = new ValueAndUnit(0);\r\n    /** @internal */\r\n    public _y2 = new ValueAndUnit(0);\r\n    private _dash = new Array<number>();\r\n    private _connectedControl: Control;\r\n    private _connectedControlDirtyObserver: Nullable<Observer<Control>>;\r\n\r\n    /** Gets or sets the dash pattern */\r\n    @serialize()\r\n    public get dash(): Array<number> {\r\n        return this._dash;\r\n    }\r\n\r\n    public set dash(value: Array<number>) {\r\n        if (this._dash === value) {\r\n            return;\r\n        }\r\n\r\n        this._dash = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the control connected with the line end */\r\n    public get connectedControl(): Control {\r\n        return this._connectedControl;\r\n    }\r\n\r\n    public set connectedControl(value: Control) {\r\n        if (this._connectedControl === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._connectedControlDirtyObserver && this._connectedControl) {\r\n            this._connectedControl.onDirtyObservable.remove(this._connectedControlDirtyObserver);\r\n            this._connectedControlDirtyObserver = null;\r\n        }\r\n\r\n        if (value) {\r\n            this._connectedControlDirtyObserver = value.onDirtyObservable.add(() => this._markAsDirty());\r\n        }\r\n\r\n        this._connectedControl = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets start coordinates on X axis */\r\n    @serialize()\r\n    public get x1(): string | number {\r\n        return this._x1.toString(this._host);\r\n    }\r\n\r\n    public set x1(value: string | number) {\r\n        if (this._x1.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._x1.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets start coordinates on Y axis */\r\n    @serialize()\r\n    public get y1(): string | number {\r\n        return this._y1.toString(this._host);\r\n    }\r\n\r\n    public set y1(value: string | number) {\r\n        if (this._y1.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._y1.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets end coordinates on X axis */\r\n    @serialize()\r\n    public get x2(): string | number {\r\n        return this._x2.toString(this._host);\r\n    }\r\n\r\n    public set x2(value: string | number) {\r\n        if (this._x2.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._x2.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets end coordinates on Y axis */\r\n    @serialize()\r\n    public get y2(): string | number {\r\n        return this._y2.toString(this._host);\r\n    }\r\n\r\n    public set y2(value: string | number) {\r\n        if (this._y2.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._y2.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets line width */\r\n    @serialize()\r\n    public get lineWidth(): number {\r\n        return this._lineWidth;\r\n    }\r\n\r\n    public set lineWidth(value: number) {\r\n        if (this._lineWidth === value) {\r\n            return;\r\n        }\r\n\r\n        this._lineWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets horizontal alignment */\r\n    public set horizontalAlignment(value: number) {\r\n        return;\r\n    }\r\n\r\n    /** Gets or sets vertical alignment */\r\n    public set verticalAlignment(value: number) {\r\n        return;\r\n    }\r\n\r\n    /** @internal */\r\n    public get _effectiveX2(): number {\r\n        return (this._connectedControl ? this._connectedControl.centerX : 0) + this._x2.getValue(this._host);\r\n    }\r\n\r\n    /** @internal */\r\n    public get _effectiveY2(): number {\r\n        return (this._connectedControl ? this._connectedControl.centerY : 0) + this._y2.getValue(this._host);\r\n    }\r\n\r\n    /**\r\n     * Creates a new Line\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n\r\n        this._automaticSize = true;\r\n\r\n        this.isHitTestVisible = false;\r\n        this._horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Line\";\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        this._applyStates(context);\r\n        context.strokeStyle = this._getColor(context);\r\n        context.lineWidth = this._lineWidth;\r\n        context.setLineDash(this._dash);\r\n\r\n        context.beginPath();\r\n        context.moveTo(this._cachedParentMeasure.left + this._x1.getValue(this._host), this._cachedParentMeasure.top + this._y1.getValue(this._host));\r\n\r\n        context.lineTo(this._cachedParentMeasure.left + this._effectiveX2, this._cachedParentMeasure.top + this._effectiveY2);\r\n        context.stroke();\r\n\r\n        context.restore();\r\n    }\r\n\r\n    public _measure(): void {\r\n        // Width / Height\r\n        this._currentMeasure.width = Math.abs(this._x1.getValue(this._host) - this._effectiveX2) + this._lineWidth;\r\n        this._currentMeasure.height = Math.abs(this._y1.getValue(this._host) - this._effectiveY2) + this._lineWidth;\r\n    }\r\n\r\n    protected _computeAlignment(parentMeasure: Measure): void {\r\n        this._currentMeasure.left = parentMeasure.left + Math.min(this._x1.getValue(this._host), this._effectiveX2) - this._lineWidth / 2;\r\n        this._currentMeasure.top = parentMeasure.top + Math.min(this._y1.getValue(this._host), this._effectiveY2) - this._lineWidth / 2;\r\n    }\r\n\r\n    /**\r\n     * Move one end of the line given 3D cartesian coordinates.\r\n     * @param position Targeted world position\r\n     * @param scene Scene\r\n     * @param end (opt) Set to true to assign x2 and y2 coordinates of the line. Default assign to x1 and y1.\r\n     */\r\n    public moveToVector3(position: Vector3, scene: Scene, end: boolean = false): void {\r\n        if (!this._host || this.parent !== this._host._rootContainer) {\r\n            Tools.Error(\"Cannot move a control to a vector3 if the control is not at root level\");\r\n            return;\r\n        }\r\n\r\n        const globalViewport = this._host._getGlobalViewport();\r\n        const projectedPosition = Vector3.Project(position, Matrix.IdentityReadOnly, scene.getTransformMatrix(), globalViewport);\r\n\r\n        this._moveToProjectedPosition(projectedPosition, end);\r\n\r\n        if (projectedPosition.z < 0 || projectedPosition.z > 1) {\r\n            this.notRenderable = true;\r\n            return;\r\n        }\r\n        this.notRenderable = false;\r\n    }\r\n\r\n    /**\r\n     * Move one end of the line to a position in screen absolute space.\r\n     * @param projectedPosition Position in screen absolute space (X, Y)\r\n     * @param end (opt) Set to true to assign x2 and y2 coordinates of the line. Default assign to x1 and y1.\r\n     */\r\n    public _moveToProjectedPosition(projectedPosition: Vector3, end: boolean = false): void {\r\n        const x: string = projectedPosition.x + this._linkOffsetX.getValue(this._host) + \"px\";\r\n        const y: string = projectedPosition.y + this._linkOffsetY.getValue(this._host) + \"px\";\r\n\r\n        if (end) {\r\n            this.x2 = x;\r\n            this.y2 = y;\r\n            this._x2.ignoreAdaptiveScaling = true;\r\n            this._y2.ignoreAdaptiveScaling = true;\r\n        } else {\r\n            this.x1 = x;\r\n            this.y1 = y;\r\n            this._x1.ignoreAdaptiveScaling = true;\r\n            this._y1.ignoreAdaptiveScaling = true;\r\n        }\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Line\", Line);\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport { Epsilon } from \"core/Maths/math.constants\";\r\nimport type { Camera } from \"core/Cameras/camera\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\n\r\nimport type { MultiLine } from \"./controls/multiLine\";\r\nimport { ValueAndUnit } from \"./valueAndUnit\";\r\nimport type { Control } from \"./controls/control\";\r\n\r\n/**\r\n * Class used to store a point for a MultiLine object.\r\n * The point can be pure 2D coordinates, a mesh or a control\r\n */\r\nexport class MultiLinePoint {\r\n    private _multiLine: MultiLine;\r\n\r\n    private _x: ValueAndUnit;\r\n    private _y: ValueAndUnit;\r\n    private _control: Nullable<Control>;\r\n    private _mesh: Nullable<AbstractMesh>;\r\n\r\n    private _controlObserver: Nullable<Observer<Control>>;\r\n    private _meshObserver: Nullable<Observer<Camera>>;\r\n\r\n    /** @internal */\r\n    public _point: Vector3;\r\n\r\n    /**\r\n     * Creates a new MultiLinePoint\r\n     * @param multiLine defines the source MultiLine object\r\n     */\r\n    constructor(multiLine: MultiLine) {\r\n        this._multiLine = multiLine;\r\n\r\n        this._x = new ValueAndUnit(0);\r\n        this._y = new ValueAndUnit(0);\r\n\r\n        this._point = new Vector3(0, 0, 0);\r\n    }\r\n\r\n    /** Gets or sets x coordinate */\r\n    public get x(): string | number {\r\n        return this._x.toString(this._multiLine._host);\r\n    }\r\n\r\n    public set x(value: string | number) {\r\n        if (this._x.toString(this._multiLine._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._x.fromString(value)) {\r\n            this._multiLine._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets y coordinate */\r\n    public get y(): string | number {\r\n        return this._y.toString(this._multiLine._host);\r\n    }\r\n\r\n    public set y(value: string | number) {\r\n        if (this._y.toString(this._multiLine._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._y.fromString(value)) {\r\n            this._multiLine._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the control associated with this point */\r\n    public get control(): Nullable<Control> {\r\n        return this._control;\r\n    }\r\n\r\n    public set control(value: Nullable<Control>) {\r\n        if (this._control === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._control && this._controlObserver) {\r\n            this._control.onDirtyObservable.remove(this._controlObserver);\r\n\r\n            this._controlObserver = null;\r\n        }\r\n\r\n        this._control = value;\r\n\r\n        if (this._control) {\r\n            this._controlObserver = this._control.onDirtyObservable.add(this._multiLine.onPointUpdate);\r\n        }\r\n\r\n        this._multiLine._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the mesh associated with this point */\r\n    public get mesh(): Nullable<AbstractMesh> {\r\n        return this._mesh;\r\n    }\r\n\r\n    public set mesh(value: Nullable<AbstractMesh>) {\r\n        if (this._mesh === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._mesh && this._meshObserver) {\r\n            this._mesh.getScene().onAfterCameraRenderObservable.remove(this._meshObserver);\r\n        }\r\n\r\n        this._mesh = value;\r\n\r\n        if (this._mesh) {\r\n            this._meshObserver = this._mesh.getScene().onAfterCameraRenderObservable.add(this._multiLine.onPointUpdate);\r\n        }\r\n\r\n        this._multiLine._markAsDirty();\r\n    }\r\n\r\n    /** Resets links */\r\n    public resetLinks(): void {\r\n        this.control = null;\r\n        this.mesh = null;\r\n    }\r\n\r\n    /**\r\n     * Gets a translation vector with Z component\r\n     * @returns the translation vector\r\n     */\r\n    public translate(): Vector3 {\r\n        this._point = this._translatePoint();\r\n\r\n        return this._point;\r\n    }\r\n\r\n    private _translatePoint(): Vector3 {\r\n        if (this._mesh != null) {\r\n            return this._multiLine._host.getProjectedPositionWithZ(this._mesh.getBoundingInfo().boundingSphere.center, this._mesh.getWorldMatrix());\r\n        } else if (this._control != null) {\r\n            return new Vector3(this._control.centerX, this._control.centerY, 1 - Epsilon);\r\n        } else {\r\n            const host: any = this._multiLine._host as any;\r\n\r\n            const xValue: number = this._x.getValueInPixel(host, Number(host._canvas.width));\r\n            const yValue: number = this._y.getValueInPixel(host, Number(host._canvas.height));\r\n\r\n            return new Vector3(xValue, yValue, 1 - Epsilon);\r\n        }\r\n    }\r\n\r\n    /** Release associated resources */\r\n    public dispose(): void {\r\n        this.resetLinks();\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\n\r\nimport { Control } from \"./control\";\r\nimport { MultiLinePoint } from \"../multiLinePoint\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { Vector3 } from \"core/Maths/math.vector\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Class used to create multi line control\r\n */\r\nexport class MultiLine extends Control {\r\n    private _lineWidth: number = 1;\r\n    private _dash: number[];\r\n    private _points: Nullable<MultiLinePoint>[];\r\n\r\n    private _minX: Nullable<number>;\r\n    private _minY: Nullable<number>;\r\n    private _maxX: Nullable<number>;\r\n    private _maxY: Nullable<number>;\r\n\r\n    /**\r\n     * Creates a new MultiLine\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n\r\n        this._automaticSize = true;\r\n        this.isHitTestVisible = false;\r\n        this._horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n\r\n        this._dash = [];\r\n        this._points = [];\r\n    }\r\n\r\n    /** Gets or sets dash pattern */\r\n    @serialize()\r\n    public get dash(): Array<number> {\r\n        return this._dash;\r\n    }\r\n\r\n    public set dash(value: Array<number>) {\r\n        if (this._dash === value) {\r\n            return;\r\n        }\r\n\r\n        this._dash = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets point stored at specified index\r\n     * @param index defines the index to look for\r\n     * @returns the requested point if found\r\n     */\r\n    public getAt(index: number): MultiLinePoint {\r\n        if (!this._points[index]) {\r\n            this._points[index] = new MultiLinePoint(this);\r\n        }\r\n\r\n        return this._points[index] as MultiLinePoint;\r\n    }\r\n\r\n    /** Function called when a point is updated */\r\n    public onPointUpdate = (): void => {\r\n        this._markAsDirty();\r\n    };\r\n\r\n    /**\r\n     * Adds new points to the point collection\r\n     * @param items defines the list of items (mesh, control or 2d coordinates) to add\r\n     * @returns the list of created MultiLinePoint\r\n     */\r\n    public add(...items: (AbstractMesh | Control | { x: string | number; y: string | number })[]): MultiLinePoint[] {\r\n        return items.map((item) => this.push(item));\r\n    }\r\n\r\n    /**\r\n     * Adds a new point to the point collection\r\n     * @param item defines the item (mesh, control or 2d coordinates) to add\r\n     * @returns the created MultiLinePoint\r\n     */\r\n    public push(item?: AbstractMesh | Control | { x: string | number; y: string | number }): MultiLinePoint {\r\n        const point: MultiLinePoint = this.getAt(this._points.length);\r\n\r\n        if (item == null) {\r\n            return point;\r\n        }\r\n\r\n        if (item instanceof AbstractMesh) {\r\n            point.mesh = item;\r\n        } else if (item instanceof Control) {\r\n            point.control = item;\r\n        } else if (item.x != null && item.y != null) {\r\n            point.x = item.x;\r\n            point.y = item.y;\r\n        }\r\n\r\n        return point;\r\n    }\r\n\r\n    /**\r\n     * Remove a specific value or point from the active point collection\r\n     * @param value defines the value or point to remove\r\n     */\r\n    public remove(value: number | MultiLinePoint): void {\r\n        let index: number;\r\n\r\n        if (value instanceof MultiLinePoint) {\r\n            index = this._points.indexOf(value);\r\n\r\n            if (index === -1) {\r\n                return;\r\n            }\r\n        } else {\r\n            index = value;\r\n        }\r\n\r\n        const point: Nullable<MultiLinePoint> = this._points[index];\r\n\r\n        if (!point) {\r\n            return;\r\n        }\r\n\r\n        point.dispose();\r\n\r\n        this._points.splice(index, 1);\r\n    }\r\n\r\n    /**\r\n     * Resets this object to initial state (no point)\r\n     */\r\n    public reset(): void {\r\n        while (this._points.length > 0) {\r\n            this.remove(this._points.length - 1);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Resets all links\r\n     */\r\n    public resetLinks(): void {\r\n        this._points.forEach((point) => {\r\n            if (point != null) {\r\n                point.resetLinks();\r\n            }\r\n        });\r\n    }\r\n\r\n    /** Gets or sets line width */\r\n    public get lineWidth(): number {\r\n        return this._lineWidth;\r\n    }\r\n\r\n    public set lineWidth(value: number) {\r\n        if (this._lineWidth === value) {\r\n            return;\r\n        }\r\n\r\n        this._lineWidth = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    public set horizontalAlignment(value: number) {\r\n        return;\r\n    }\r\n\r\n    public set verticalAlignment(value: number) {\r\n        return;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"MultiLine\";\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        this._applyStates(context);\r\n\r\n        context.strokeStyle = this.color;\r\n        context.lineWidth = this._lineWidth;\r\n        context.setLineDash(this._dash);\r\n\r\n        context.beginPath();\r\n\r\n        let first: boolean = true; //first index is not necessarily 0\r\n        let previousPoint: Vector3;\r\n\r\n        this._points.forEach((point) => {\r\n            if (!point) {\r\n                return;\r\n            }\r\n\r\n            if (first) {\r\n                context.moveTo(point._point.x, point._point.y);\r\n\r\n                first = false;\r\n            } else {\r\n                if (point._point.z < 1 && previousPoint.z < 1) {\r\n                    context.lineTo(point._point.x, point._point.y);\r\n                } else {\r\n                    context.moveTo(point._point.x, point._point.y);\r\n                }\r\n            }\r\n            previousPoint = point._point;\r\n        });\r\n\r\n        context.stroke();\r\n\r\n        context.restore();\r\n    }\r\n\r\n    protected _additionalProcessing(): void {\r\n        this._minX = null;\r\n        this._minY = null;\r\n        this._maxX = null;\r\n        this._maxY = null;\r\n\r\n        this._points.forEach((point) => {\r\n            if (!point) {\r\n                return;\r\n            }\r\n\r\n            point.translate();\r\n\r\n            if (this._minX == null || point._point.x < this._minX) {\r\n                this._minX = point._point.x;\r\n            }\r\n            if (this._minY == null || point._point.y < this._minY) {\r\n                this._minY = point._point.y;\r\n            }\r\n            if (this._maxX == null || point._point.x > this._maxX) {\r\n                this._maxX = point._point.x;\r\n            }\r\n            if (this._maxY == null || point._point.y > this._maxY) {\r\n                this._maxY = point._point.y;\r\n            }\r\n        });\r\n\r\n        if (this._minX == null) {\r\n            this._minX = 0;\r\n        }\r\n        if (this._minY == null) {\r\n            this._minY = 0;\r\n        }\r\n        if (this._maxX == null) {\r\n            this._maxX = 0;\r\n        }\r\n        if (this._maxY == null) {\r\n            this._maxY = 0;\r\n        }\r\n    }\r\n\r\n    public _measure(): void {\r\n        if (this._minX == null || this._maxX == null || this._minY == null || this._maxY == null) {\r\n            return;\r\n        }\r\n\r\n        this._currentMeasure.width = Math.abs(this._maxX - this._minX) + this._lineWidth;\r\n        this._currentMeasure.height = Math.abs(this._maxY - this._minY) + this._lineWidth;\r\n    }\r\n\r\n    protected _computeAlignment(): void {\r\n        if (this._minX == null || this._minY == null) {\r\n            return;\r\n        }\r\n\r\n        this._currentMeasure.left = this._minX - this._lineWidth / 2;\r\n        this._currentMeasure.top = this._minY - this._lineWidth / 2;\r\n    }\r\n\r\n    public dispose(): void {\r\n        this.reset();\r\n\r\n        super.dispose();\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.MultiLine\", MultiLine);\r\n","import { Observable } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Control } from \"./control\";\r\nimport { StackPanel } from \"./stackPanel\";\r\nimport { TextBlock } from \"./textBlock\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Class used to create radio button controls\r\n */\r\nexport class RadioButton extends Control {\r\n    private _isChecked = false;\r\n    private _background = \"black\";\r\n    private _checkSizeRatio = 0.8;\r\n    private _thickness = 1;\r\n\r\n    /** Gets or sets border thickness */\r\n    @serialize()\r\n    public get thickness(): number {\r\n        return this._thickness;\r\n    }\r\n\r\n    public set thickness(value: number) {\r\n        if (this._thickness === value) {\r\n            return;\r\n        }\r\n\r\n        this._thickness = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets group name */\r\n    @serialize()\r\n    public group = \"\";\r\n\r\n    /** Observable raised when isChecked is changed */\r\n    public onIsCheckedChangedObservable = new Observable<boolean>();\r\n\r\n    /** Gets or sets a value indicating the ratio between overall size and check size */\r\n    @serialize()\r\n    public get checkSizeRatio(): number {\r\n        return this._checkSizeRatio;\r\n    }\r\n\r\n    public set checkSizeRatio(value: number) {\r\n        value = Math.max(Math.min(1, value), 0);\r\n\r\n        if (this._checkSizeRatio === value) {\r\n            return;\r\n        }\r\n\r\n        this._checkSizeRatio = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background color */\r\n    @serialize()\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n\r\n        this._background = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the checkbox is checked or not */\r\n    @serialize()\r\n    public get isChecked(): boolean {\r\n        return this._isChecked;\r\n    }\r\n\r\n    public set isChecked(value: boolean) {\r\n        if (this._isChecked === value) {\r\n            return;\r\n        }\r\n\r\n        this._isChecked = value;\r\n        this._markAsDirty();\r\n\r\n        this.onIsCheckedChangedObservable.notifyObservers(value);\r\n\r\n        if (this._isChecked && this._host) {\r\n            // Update all controls from same group\r\n            this._host.executeOnAllControls((control) => {\r\n                if (control === this) {\r\n                    return;\r\n                }\r\n\r\n                if ((<any>control).group === undefined) {\r\n                    return;\r\n                }\r\n                const childRadio = <RadioButton>control;\r\n                if (childRadio.group === this.group) {\r\n                    childRadio.isChecked = false;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new RadioButton\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n\r\n        this.isPointerBlocker = true;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"RadioButton\";\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n        const actualWidth = this._currentMeasure.width - this._thickness;\r\n        const actualHeight = this._currentMeasure.height - this._thickness;\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        // Outer\r\n        Control.drawEllipse(\r\n            this._currentMeasure.left + this._currentMeasure.width / 2,\r\n            this._currentMeasure.top + this._currentMeasure.height / 2,\r\n            this._currentMeasure.width / 2 - this._thickness / 2,\r\n            this._currentMeasure.height / 2 - this._thickness / 2,\r\n            context\r\n        );\r\n\r\n        context.fillStyle = this._isEnabled ? this._background : this._disabledColor;\r\n        context.fill();\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n\r\n        context.strokeStyle = this.color;\r\n        context.lineWidth = this._thickness;\r\n\r\n        context.stroke();\r\n\r\n        // Inner\r\n        if (this._isChecked) {\r\n            context.fillStyle = this._isEnabled ? this.color : this._disabledColor;\r\n            const offsetWidth = actualWidth * this._checkSizeRatio;\r\n            const offseHeight = actualHeight * this._checkSizeRatio;\r\n\r\n            Control.drawEllipse(\r\n                this._currentMeasure.left + this._currentMeasure.width / 2,\r\n                this._currentMeasure.top + this._currentMeasure.height / 2,\r\n                offsetWidth / 2 - this._thickness / 2,\r\n                offseHeight / 2 - this._thickness / 2,\r\n                context\r\n            );\r\n\r\n            context.fill();\r\n        }\r\n        context.restore();\r\n    }\r\n\r\n    // Events\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isReadOnly) {\r\n            return true;\r\n        }\r\n\r\n        if (!this.isChecked) {\r\n            this.isChecked = true;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Utility function to easily create a radio button with a header\r\n     * @param title defines the label to use for the header\r\n     * @param group defines the group to use for the radio button\r\n     * @param isChecked defines the initial state of the radio button\r\n     * @param onValueChanged defines the callback to call when value changes\r\n     * @returns a StackPanel containing the radio button and a textBlock\r\n     */\r\n    public static AddRadioButtonWithHeader(title: string, group: string, isChecked: boolean, onValueChanged: (button: RadioButton, value: boolean) => void): StackPanel {\r\n        const panel = new StackPanel();\r\n        panel.isVertical = false;\r\n        panel.height = \"30px\";\r\n\r\n        const radio = new RadioButton();\r\n        radio.width = \"20px\";\r\n        radio.height = \"20px\";\r\n        radio.isChecked = isChecked;\r\n        radio.color = \"green\";\r\n        radio.group = group;\r\n        radio.onIsCheckedChangedObservable.add((value) => onValueChanged(radio, value));\r\n        panel.addControl(radio);\r\n\r\n        const header = new TextBlock();\r\n        header.text = title;\r\n        header.width = \"180px\";\r\n        header.paddingLeft = \"5px\";\r\n        header.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        header.color = \"white\";\r\n        panel.addControl(header);\r\n\r\n        return panel;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.RadioButton\", RadioButton);\r\n","import { Observable } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Control } from \"../control\";\r\nimport { ValueAndUnit } from \"../../valueAndUnit\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\n\r\n/**\r\n * Class used to create slider controls\r\n */\r\nexport class BaseSlider extends Control {\r\n    protected _thumbWidth = new ValueAndUnit(20, ValueAndUnit.UNITMODE_PIXEL, false);\r\n    private _minimum = 0;\r\n    private _maximum = 100;\r\n    private _value = 50;\r\n    private _isVertical = false;\r\n    protected _barOffset = new ValueAndUnit(5, ValueAndUnit.UNITMODE_PIXEL, false);\r\n    private _isThumbClamped = false;\r\n    protected _displayThumb = true;\r\n    private _step = 0;\r\n\r\n    private _lastPointerDownId = -1;\r\n\r\n    // Shared rendering info\r\n    protected _effectiveBarOffset = 0;\r\n    protected _renderLeft: number;\r\n    protected _renderTop: number;\r\n    protected _renderWidth: number;\r\n    protected _renderHeight: number;\r\n    protected _backgroundBoxLength: number;\r\n    protected _backgroundBoxThickness: number;\r\n    protected _effectiveThumbThickness: number;\r\n\r\n    /** Observable raised when the slider value changes */\r\n    public onValueChangedObservable = new Observable<number>();\r\n\r\n    /** Gets or sets a boolean indicating if the thumb must be rendered */\r\n    @serialize()\r\n    public get displayThumb(): boolean {\r\n        return this._displayThumb;\r\n    }\r\n\r\n    public set displayThumb(value: boolean) {\r\n        if (this._displayThumb === value) {\r\n            return;\r\n        }\r\n\r\n        this._displayThumb = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a step to apply to values (0 by default) */\r\n    @serialize()\r\n    public get step(): number {\r\n        return this._step;\r\n    }\r\n\r\n    public set step(value: number) {\r\n        if (this._step === value) {\r\n            return;\r\n        }\r\n\r\n        this._step = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets main bar offset (ie. the margin applied to the value bar) */\r\n    @serialize()\r\n    public get barOffset(): string | number {\r\n        return this._barOffset.toString(this._host);\r\n    }\r\n\r\n    /** Gets main bar offset in pixels*/\r\n    public get barOffsetInPixels(): number {\r\n        return this._barOffset.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set barOffset(value: string | number) {\r\n        if (this._barOffset.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._barOffset.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets thumb width */\r\n    @serialize()\r\n    public get thumbWidth(): string | number {\r\n        return this._thumbWidth.toString(this._host);\r\n    }\r\n\r\n    /** Gets thumb width in pixels */\r\n    public get thumbWidthInPixels(): number {\r\n        return this._thumbWidth.getValueInPixel(this._host, this._cachedParentMeasure.width);\r\n    }\r\n\r\n    public set thumbWidth(value: string | number) {\r\n        if (this._thumbWidth.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._thumbWidth.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /** Gets or sets minimum value */\r\n    @serialize()\r\n    public get minimum(): number {\r\n        return this._minimum;\r\n    }\r\n\r\n    public set minimum(value: number) {\r\n        if (this._minimum === value) {\r\n            return;\r\n        }\r\n\r\n        this._minimum = value;\r\n        this._markAsDirty();\r\n\r\n        this.value = Math.max(Math.min(this.value, this._maximum), this._minimum);\r\n    }\r\n\r\n    /** Gets or sets maximum value */\r\n    @serialize()\r\n    public get maximum(): number {\r\n        return this._maximum;\r\n    }\r\n\r\n    public set maximum(value: number) {\r\n        if (this._maximum === value) {\r\n            return;\r\n        }\r\n\r\n        this._maximum = value;\r\n        this._markAsDirty();\r\n\r\n        this.value = Math.max(Math.min(this.value, this._maximum), this._minimum);\r\n    }\r\n\r\n    /** Gets or sets current value */\r\n    @serialize()\r\n    public get value(): number {\r\n        return this._value;\r\n    }\r\n\r\n    public set value(value: number) {\r\n        value = Math.max(Math.min(value, this._maximum), this._minimum);\r\n\r\n        if (this._value === value) {\r\n            return;\r\n        }\r\n\r\n        this._value = value;\r\n        this._markAsDirty();\r\n        this.onValueChangedObservable.notifyObservers(this._value);\r\n    }\r\n\r\n    /**Gets or sets a boolean indicating if the slider should be vertical or horizontal */\r\n    @serialize()\r\n    public get isVertical(): boolean {\r\n        return this._isVertical;\r\n    }\r\n\r\n    public set isVertical(value: boolean) {\r\n        if (this._isVertical === value) {\r\n            return;\r\n        }\r\n\r\n        this._isVertical = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a value indicating if the thumb can go over main bar extends */\r\n    @serialize()\r\n    public get isThumbClamped(): boolean {\r\n        return this._isThumbClamped;\r\n    }\r\n\r\n    public set isThumbClamped(value: boolean) {\r\n        if (this._isThumbClamped === value) {\r\n            return;\r\n        }\r\n\r\n        this._isThumbClamped = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new BaseSlider\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n\r\n        this.isPointerBlocker = true;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"BaseSlider\";\r\n    }\r\n\r\n    protected _getThumbPosition() {\r\n        if (this.isVertical) {\r\n            return ((this.maximum - this.value) / (this.maximum - this.minimum)) * this._backgroundBoxLength;\r\n        }\r\n\r\n        return ((this.value - this.minimum) / (this.maximum - this.minimum)) * this._backgroundBoxLength;\r\n    }\r\n\r\n    protected _getThumbThickness(type: string): number {\r\n        let thumbThickness = 0;\r\n        switch (type) {\r\n            case \"circle\":\r\n                if (this._thumbWidth.isPixel) {\r\n                    thumbThickness = Math.max(this._thumbWidth.getValue(this._host), this._backgroundBoxThickness);\r\n                } else {\r\n                    thumbThickness = this._backgroundBoxThickness * this._thumbWidth.getValue(this._host);\r\n                }\r\n                break;\r\n            case \"rectangle\":\r\n                if (this._thumbWidth.isPixel) {\r\n                    thumbThickness = Math.min(this._thumbWidth.getValue(this._host), this._backgroundBoxThickness);\r\n                } else {\r\n                    thumbThickness = this._backgroundBoxThickness * this._thumbWidth.getValue(this._host);\r\n                }\r\n        }\r\n        return thumbThickness;\r\n    }\r\n\r\n    protected _prepareRenderingData(type: string) {\r\n        // Main bar\r\n        this._effectiveBarOffset = 0;\r\n        this._renderLeft = this._currentMeasure.left;\r\n        this._renderTop = this._currentMeasure.top;\r\n        this._renderWidth = this._currentMeasure.width;\r\n        this._renderHeight = this._currentMeasure.height;\r\n\r\n        this._backgroundBoxLength = Math.max(this._currentMeasure.width, this._currentMeasure.height);\r\n        this._backgroundBoxThickness = Math.min(this._currentMeasure.width, this._currentMeasure.height);\r\n        this._effectiveThumbThickness = this._getThumbThickness(type);\r\n\r\n        if (this.displayThumb) {\r\n            this._backgroundBoxLength -= this._effectiveThumbThickness;\r\n        }\r\n        //throw error when height is less than width for vertical slider\r\n        if (this.isVertical && this._currentMeasure.height < this._currentMeasure.width) {\r\n            console.error(\"Height should be greater than width\");\r\n            return;\r\n        }\r\n        if (this._barOffset.isPixel) {\r\n            this._effectiveBarOffset = Math.min(this._barOffset.getValue(this._host), this._backgroundBoxThickness);\r\n        } else {\r\n            this._effectiveBarOffset = this._backgroundBoxThickness * this._barOffset.getValue(this._host);\r\n        }\r\n\r\n        this._backgroundBoxThickness -= this._effectiveBarOffset * 2;\r\n\r\n        if (this.isVertical) {\r\n            this._renderLeft += this._effectiveBarOffset;\r\n            if (!this.isThumbClamped && this.displayThumb) {\r\n                this._renderTop += this._effectiveThumbThickness / 2;\r\n            }\r\n\r\n            this._renderHeight = this._backgroundBoxLength;\r\n            this._renderWidth = this._backgroundBoxThickness;\r\n        } else {\r\n            this._renderTop += this._effectiveBarOffset;\r\n            if (!this.isThumbClamped && this.displayThumb) {\r\n                this._renderLeft += this._effectiveThumbThickness / 2;\r\n            }\r\n            this._renderHeight = this._backgroundBoxThickness;\r\n            this._renderWidth = this._backgroundBoxLength;\r\n        }\r\n    }\r\n\r\n    // Events\r\n    private _pointerIsDown = false;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _updateValueFromPointer(x: number, y: number): void {\r\n        if (this.rotation != 0) {\r\n            this._invertTransformMatrix.transformCoordinates(x, y, this._transformedPosition);\r\n            x = this._transformedPosition.x;\r\n            y = this._transformedPosition.y;\r\n        }\r\n\r\n        let value: number;\r\n        if (this._isVertical) {\r\n            value = this._minimum + (1 - (y - this._currentMeasure.top) / this._currentMeasure.height) * (this._maximum - this._minimum);\r\n        } else {\r\n            value = this._minimum + ((x - this._currentMeasure.left) / this._currentMeasure.width) * (this._maximum - this._minimum);\r\n        }\r\n        this.value = this._step ? Math.round(value / this._step) * this._step : value;\r\n    }\r\n\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isReadOnly) {\r\n            return true;\r\n        }\r\n\r\n        this._pointerIsDown = true;\r\n\r\n        this._updateValueFromPointer(coordinates.x, coordinates.y);\r\n        this._host._capturingControl[pointerId] = this;\r\n        this._lastPointerDownId = pointerId;\r\n        return true;\r\n    }\r\n\r\n    public _onPointerMove(target: Control, coordinates: Vector2, pointerId: number, pi: PointerInfoBase): void {\r\n        // Only listen to pointer move events coming from the last pointer to click on the element (To support dual vr controller interaction)\r\n        if (pointerId != this._lastPointerDownId) {\r\n            return;\r\n        }\r\n\r\n        if (this._pointerIsDown && !this.isReadOnly) {\r\n            this._updateValueFromPointer(coordinates.x, coordinates.y);\r\n        }\r\n\r\n        super._onPointerMove(target, coordinates, pointerId, pi);\r\n    }\r\n\r\n    public _onPointerUp(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, notifyClick: boolean): void {\r\n        this._pointerIsDown = false;\r\n\r\n        delete this._host._capturingControl[pointerId];\r\n        super._onPointerUp(target, coordinates, pointerId, buttonIndex, notifyClick);\r\n    }\r\n\r\n    public _onCanvasBlur(): void {\r\n        this._forcePointerUp();\r\n        super._onCanvasBlur();\r\n    }\r\n}\r\n","import { BaseSlider } from \"./baseSlider\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { BaseGradient } from \"../gradient/BaseGradient\";\r\nimport type { AdvancedDynamicTexture } from \"gui/2D/advancedDynamicTexture\";\r\nimport { Tools } from \"core/Misc/tools\";\r\n\r\n/**\r\n * Class used to create slider controls\r\n */\r\nexport class Slider extends BaseSlider {\r\n    private _background = \"black\";\r\n    private _borderColor = \"white\";\r\n    private _thumbColor = \"\";\r\n    private _isThumbCircle = false;\r\n    protected _displayValueBar = true;\r\n    private _backgroundGradient: Nullable<BaseGradient> = null;\r\n\r\n    /** Gets or sets a boolean indicating if the value bar must be rendered */\r\n    @serialize()\r\n    public get displayValueBar(): boolean {\r\n        return this._displayValueBar;\r\n    }\r\n\r\n    public set displayValueBar(value: boolean) {\r\n        if (this._displayValueBar === value) {\r\n            return;\r\n        }\r\n\r\n        this._displayValueBar = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets border color */\r\n    @serialize()\r\n    public get borderColor(): string {\r\n        return this._borderColor;\r\n    }\r\n\r\n    public set borderColor(value: string) {\r\n        if (this._borderColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._borderColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background color */\r\n    @serialize()\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n\r\n        this._background = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background gradient */\r\n    public get backgroundGradient(): Nullable<BaseGradient> {\r\n        return this._backgroundGradient;\r\n    }\r\n\r\n    public set backgroundGradient(value: Nullable<BaseGradient>) {\r\n        if (this._backgroundGradient === value) {\r\n            return;\r\n        }\r\n\r\n        this._backgroundGradient = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets thumb's color */\r\n    @serialize()\r\n    public get thumbColor(): string {\r\n        return this._thumbColor;\r\n    }\r\n\r\n    public set thumbColor(value: string) {\r\n        if (this._thumbColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._thumbColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the thumb should be round or square */\r\n    @serialize()\r\n    public get isThumbCircle(): boolean {\r\n        return this._isThumbCircle;\r\n    }\r\n\r\n    public set isThumbCircle(value: boolean) {\r\n        if (this._isThumbCircle === value) {\r\n            return;\r\n        }\r\n\r\n        this._isThumbCircle = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new Slider\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Slider\";\r\n    }\r\n\r\n    protected _getBackgroundColor(context: ICanvasRenderingContext) {\r\n        return this._backgroundGradient ? this._backgroundGradient.getCanvasGradient(context) : this._background;\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n        this._prepareRenderingData(this.isThumbCircle ? \"circle\" : \"rectangle\");\r\n        let left = this._renderLeft;\r\n        let top = this._renderTop;\r\n        const width = this._renderWidth;\r\n        const height = this._renderHeight;\r\n\r\n        let radius = 0;\r\n\r\n        if (this.isThumbClamped && this.isThumbCircle) {\r\n            if (this.isVertical) {\r\n                top += this._effectiveThumbThickness / 2;\r\n            } else {\r\n                left += this._effectiveThumbThickness / 2;\r\n            }\r\n\r\n            radius = this._backgroundBoxThickness / 2;\r\n        } else {\r\n            radius = (this._effectiveThumbThickness - this._effectiveBarOffset) / 2;\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n        }\r\n\r\n        const thumbPosition = this._getThumbPosition();\r\n        context.fillStyle = this._getBackgroundColor(context);\r\n\r\n        if (this.isVertical) {\r\n            if (this.isThumbClamped) {\r\n                if (this.isThumbCircle) {\r\n                    context.beginPath();\r\n                    context.arc(left + this._backgroundBoxThickness / 2, top, radius, Math.PI, 2 * Math.PI);\r\n                    context.fill();\r\n                    context.fillRect(left, top, width, height);\r\n                } else {\r\n                    context.fillRect(left, top, width, height + this._effectiveThumbThickness);\r\n                }\r\n            } else {\r\n                context.fillRect(left, top, width, height);\r\n            }\r\n        } else {\r\n            if (this.isThumbClamped) {\r\n                if (this.isThumbCircle) {\r\n                    context.beginPath();\r\n                    context.arc(left + this._backgroundBoxLength, top + this._backgroundBoxThickness / 2, radius, 0, 2 * Math.PI);\r\n                    context.fill();\r\n                    context.fillRect(left, top, width, height);\r\n                } else {\r\n                    context.fillRect(left, top, width + this._effectiveThumbThickness, height);\r\n                }\r\n            } else {\r\n                context.fillRect(left, top, width, height);\r\n            }\r\n        }\r\n\r\n        if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n            context.shadowBlur = 0;\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n        }\r\n\r\n        // Value bar\r\n        context.fillStyle = this._getColor(context);\r\n        if (this._displayValueBar) {\r\n            if (this.isVertical) {\r\n                if (this.isThumbClamped) {\r\n                    if (this.isThumbCircle) {\r\n                        context.beginPath();\r\n                        context.arc(left + this._backgroundBoxThickness / 2, top + this._backgroundBoxLength, radius, 0, 2 * Math.PI);\r\n                        context.fill();\r\n                        context.fillRect(left, top + thumbPosition, width, height - thumbPosition);\r\n                    } else {\r\n                        context.fillRect(left, top + thumbPosition, width, height - thumbPosition + this._effectiveThumbThickness);\r\n                    }\r\n                } else {\r\n                    context.fillRect(left, top + thumbPosition, width, height - thumbPosition);\r\n                }\r\n            } else {\r\n                if (this.isThumbClamped) {\r\n                    if (this.isThumbCircle) {\r\n                        context.beginPath();\r\n                        context.arc(left, top + this._backgroundBoxThickness / 2, radius, 0, 2 * Math.PI);\r\n                        context.fill();\r\n                        context.fillRect(left, top, thumbPosition, height);\r\n                    } else {\r\n                        context.fillRect(left, top, thumbPosition, height);\r\n                    }\r\n                } else {\r\n                    context.fillRect(left, top, thumbPosition, height);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Thumb\r\n        context.fillStyle = this._thumbColor || this._getColor(context);\r\n        if (this.displayThumb) {\r\n            if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n                context.shadowColor = this.shadowColor;\r\n                context.shadowBlur = this.shadowBlur;\r\n                context.shadowOffsetX = this.shadowOffsetX;\r\n                context.shadowOffsetY = this.shadowOffsetY;\r\n            }\r\n            if (this._isThumbCircle) {\r\n                context.beginPath();\r\n                if (this.isVertical) {\r\n                    context.arc(left + this._backgroundBoxThickness / 2, top + thumbPosition, radius, 0, 2 * Math.PI);\r\n                } else {\r\n                    context.arc(left + thumbPosition, top + this._backgroundBoxThickness / 2, radius, 0, 2 * Math.PI);\r\n                }\r\n                context.fill();\r\n                if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n                    context.shadowBlur = 0;\r\n                    context.shadowOffsetX = 0;\r\n                    context.shadowOffsetY = 0;\r\n                }\r\n                context.strokeStyle = this._borderColor;\r\n                context.stroke();\r\n            } else {\r\n                if (this.isVertical) {\r\n                    context.fillRect(left - this._effectiveBarOffset, this._currentMeasure.top + thumbPosition, this._currentMeasure.width, this._effectiveThumbThickness);\r\n                } else {\r\n                    context.fillRect(this._currentMeasure.left + thumbPosition, this._currentMeasure.top, this._effectiveThumbThickness, this._currentMeasure.height);\r\n                }\r\n                if (this.shadowBlur || this.shadowOffsetX || this.shadowOffsetY) {\r\n                    context.shadowBlur = 0;\r\n                    context.shadowOffsetX = 0;\r\n                    context.shadowOffsetY = 0;\r\n                }\r\n                context.strokeStyle = this._borderColor;\r\n                if (this.isVertical) {\r\n                    context.strokeRect(left - this._effectiveBarOffset, this._currentMeasure.top + thumbPosition, this._currentMeasure.width, this._effectiveThumbThickness);\r\n                } else {\r\n                    context.strokeRect(this._currentMeasure.left + thumbPosition, this._currentMeasure.top, this._effectiveThumbThickness, this._currentMeasure.height);\r\n                }\r\n            }\r\n        }\r\n        context.restore();\r\n    }\r\n\r\n    public serialize(serializationObject: any) {\r\n        super.serialize(serializationObject);\r\n\r\n        if (this.backgroundGradient) {\r\n            serializationObject.backgroundGradient = {};\r\n            this.backgroundGradient.serialize(serializationObject.backgroundGradient);\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        super._parseFromContent(serializedObject, host);\r\n\r\n        if (serializedObject.backgroundGradient) {\r\n            const className = Tools.Instantiate(\"BABYLON.GUI.\" + serializedObject.backgroundGradient.className);\r\n            this.backgroundGradient = new className();\r\n            this.backgroundGradient!.parse(serializedObject.backgroundGradient);\r\n        }\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Slider\", Slider);\r\n","import { Rectangle } from \"./rectangle\";\r\nimport { StackPanel } from \"./stackPanel\";\r\nimport { Control } from \"./control\";\r\nimport { TextBlock } from \"./textBlock\";\r\nimport { Checkbox } from \"./checkbox\";\r\nimport { RadioButton } from \"./radioButton\";\r\nimport { Slider } from \"./sliders/slider\";\r\nimport { Container } from \"./container\";\r\n\r\n/** Class used to create a RadioGroup\r\n * which contains groups of radio buttons\r\n */\r\nexport class SelectorGroup {\r\n    private _groupPanel = new StackPanel();\r\n    private _selectors: StackPanel[] = new Array();\r\n    private _groupHeader: TextBlock;\r\n\r\n    /**\r\n     * Creates a new SelectorGroup\r\n     * @param name of group, used as a group heading\r\n     */\r\n    constructor(\r\n        /** name of SelectorGroup */\r\n        public name: string\r\n    ) {\r\n        this._groupPanel.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n        this._groupPanel.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._groupHeader = this._addGroupHeader(name);\r\n    }\r\n\r\n    /** Gets the groupPanel of the SelectorGroup  */\r\n    public get groupPanel(): StackPanel {\r\n        return this._groupPanel;\r\n    }\r\n\r\n    /** Gets the selectors array */\r\n    public get selectors(): StackPanel[] {\r\n        return this._selectors;\r\n    }\r\n\r\n    /** Gets and sets the group header */\r\n    public get header() {\r\n        return this._groupHeader.text;\r\n    }\r\n\r\n    public set header(label: string) {\r\n        if (this._groupHeader.text === \"label\") {\r\n            return;\r\n        }\r\n\r\n        this._groupHeader.text = label;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    private _addGroupHeader(text: string): TextBlock {\r\n        const groupHeading = new TextBlock(\"groupHead\", text);\r\n        groupHeading.width = 0.9;\r\n        groupHeading.height = \"30px\";\r\n        groupHeading.textWrapping = true;\r\n        groupHeading.color = \"black\";\r\n        groupHeading.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        groupHeading.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        groupHeading.left = \"2px\";\r\n        this._groupPanel.addControl(groupHeading);\r\n        return groupHeading;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _getSelector(selectorNb: number) {\r\n        if (selectorNb < 0 || selectorNb >= this._selectors.length) {\r\n            return;\r\n        }\r\n        return this._selectors[selectorNb];\r\n    }\r\n\r\n    /** Removes the selector at the given position\r\n     * @param selectorNb the position of the selector within the group\r\n     */\r\n    public removeSelector(selectorNb: number) {\r\n        if (selectorNb < 0 || selectorNb >= this._selectors.length) {\r\n            return;\r\n        }\r\n        this._groupPanel.removeControl(this._selectors[selectorNb]);\r\n        this._selectors.splice(selectorNb, 1);\r\n    }\r\n}\r\n\r\n/** Class used to create a CheckboxGroup\r\n * which contains groups of checkbox buttons\r\n */\r\nexport class CheckboxGroup extends SelectorGroup {\r\n    /** Adds a checkbox as a control\r\n     * @param text is the label for the selector\r\n     * @param func is the function called when the Selector is checked\r\n     * @param checked is true when Selector is checked\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    public addCheckbox(text: string, func = (s: boolean) => {}, checked: boolean = false): void {\r\n        checked = checked || false;\r\n        const button = new Checkbox();\r\n        button.width = \"20px\";\r\n        button.height = \"20px\";\r\n        button.color = \"#364249\";\r\n        button.background = \"#CCCCCC\";\r\n        button.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n\r\n        button.onIsCheckedChangedObservable.add(function (state) {\r\n            func(state);\r\n        });\r\n\r\n        const _selector = Control.AddHeader(button, text, \"200px\", { isHorizontal: true, controlFirst: true });\r\n        _selector.height = \"30px\";\r\n        _selector.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        _selector.left = \"4px\";\r\n\r\n        this.groupPanel.addControl(_selector);\r\n        this.selectors.push(_selector);\r\n        button.isChecked = checked;\r\n\r\n        if (this.groupPanel.parent && this.groupPanel.parent.parent) {\r\n            button.color = (<SelectionPanel>this.groupPanel.parent.parent).buttonColor;\r\n            button.background = (<SelectionPanel>this.groupPanel.parent.parent).buttonBackground;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorLabel(selectorNb: number, label: string) {\r\n        (<TextBlock>this.selectors[selectorNb].children[1]).text = label;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorLabelColor(selectorNb: number, color: string) {\r\n        (<TextBlock>this.selectors[selectorNb].children[1]).color = color;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorButtonColor(selectorNb: number, color: string) {\r\n        this.selectors[selectorNb].children[0].color = color;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorButtonBackground(selectorNb: number, color: string) {\r\n        (<Checkbox>this.selectors[selectorNb].children[0]).background = color;\r\n    }\r\n}\r\n\r\n/** Class used to create a RadioGroup\r\n * which contains groups of radio buttons\r\n */\r\nexport class RadioGroup extends SelectorGroup {\r\n    private _selectNb = 0;\r\n\r\n    /** Adds a radio button as a control\r\n     * @param label is the label for the selector\r\n     * @param func is the function called when the Selector is checked\r\n     * @param checked is true when Selector is checked\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    public addRadio(label: string, func = (n: number) => {}, checked = false): void {\r\n        const nb = this._selectNb++;\r\n        const button = new RadioButton();\r\n        button.name = label;\r\n        button.width = \"20px\";\r\n        button.height = \"20px\";\r\n        button.color = \"#364249\";\r\n        button.background = \"#CCCCCC\";\r\n        button.group = this.name;\r\n        button.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n\r\n        button.onIsCheckedChangedObservable.add(function (state) {\r\n            if (state) {\r\n                func(nb);\r\n            }\r\n        });\r\n\r\n        const _selector = Control.AddHeader(button, label, \"200px\", { isHorizontal: true, controlFirst: true });\r\n        _selector.height = \"30px\";\r\n        _selector.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        _selector.left = \"4px\";\r\n        this.groupPanel.addControl(_selector);\r\n        this.selectors.push(_selector);\r\n        button.isChecked = checked;\r\n\r\n        if (this.groupPanel.parent && this.groupPanel.parent.parent) {\r\n            button.color = (<SelectionPanel>this.groupPanel.parent.parent).buttonColor;\r\n            button.background = (<SelectionPanel>this.groupPanel.parent.parent).buttonBackground;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorLabel(selectorNb: number, label: string) {\r\n        (<TextBlock>this.selectors[selectorNb].children[1]).text = label;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorLabelColor(selectorNb: number, color: string) {\r\n        (<TextBlock>this.selectors[selectorNb].children[1]).color = color;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorButtonColor(selectorNb: number, color: string) {\r\n        this.selectors[selectorNb].children[0].color = color;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorButtonBackground(selectorNb: number, color: string) {\r\n        (<RadioButton>this.selectors[selectorNb].children[0]).background = color;\r\n    }\r\n}\r\n\r\n/** Class used to create a SliderGroup\r\n * which contains groups of slider buttons\r\n */\r\nexport class SliderGroup extends SelectorGroup {\r\n    /**\r\n     * Adds a slider to the SelectorGroup\r\n     * @param label is the label for the SliderBar\r\n     * @param func is the function called when the Slider moves\r\n     * @param unit is a string describing the units used, eg degrees or metres\r\n     * @param min is the minimum value for the Slider\r\n     * @param max is the maximum value for the Slider\r\n     * @param value is the start value for the Slider between min and max\r\n     * @param onValueChange is the function used to format the value displayed, eg radians to degrees\r\n     */\r\n    public addSlider(\r\n        label: string,\r\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n        func = (v: number) => {},\r\n        unit: string = \"Units\",\r\n        min: number = 0,\r\n        max: number = 0,\r\n        value: number = 0,\r\n        onValueChange = (v: number) => {\r\n            return v | 0;\r\n        }\r\n    ): void {\r\n        const button = new Slider();\r\n        button.name = unit;\r\n        button.value = value;\r\n        button.minimum = min;\r\n        button.maximum = max;\r\n        button.width = 0.9;\r\n        button.height = \"20px\";\r\n        button.color = \"#364249\";\r\n        button.background = \"#CCCCCC\";\r\n        button.borderColor = \"black\";\r\n        button.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        button.left = \"4px\";\r\n        button.paddingBottom = \"4px\";\r\n\r\n        button.onValueChangedObservable.add(function (value) {\r\n            (<TextBlock>button.parent!.children[0]).text = button.parent!.children[0].name + \": \" + onValueChange(value) + \" \" + button.name;\r\n            func(value);\r\n        });\r\n\r\n        const _selector = Control.AddHeader(button, label + \": \" + onValueChange(value) + \" \" + unit, \"30px\", { isHorizontal: false, controlFirst: false });\r\n        _selector.height = \"60px\";\r\n        _selector.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        _selector.left = \"4px\";\r\n        _selector.children[0].name = label;\r\n        this.groupPanel.addControl(_selector);\r\n        this.selectors.push(_selector);\r\n\r\n        if (this.groupPanel.parent && this.groupPanel.parent.parent) {\r\n            button.color = (<SelectionPanel>this.groupPanel.parent.parent).buttonColor;\r\n            button.background = (<SelectionPanel>this.groupPanel.parent.parent).buttonBackground;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorLabel(selectorNb: number, label: string) {\r\n        this.selectors[selectorNb].children[0].name = label;\r\n        (<TextBlock>this.selectors[selectorNb].children[0]).text =\r\n            label + \": \" + (<Slider>this.selectors[selectorNb].children[1]).value + \" \" + this.selectors[selectorNb].children[1].name;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorLabelColor(selectorNb: number, color: string) {\r\n        (<TextBlock>this.selectors[selectorNb].children[0]).color = color;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorButtonColor(selectorNb: number, color: string) {\r\n        this.selectors[selectorNb].children[1].color = color;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _setSelectorButtonBackground(selectorNb: number, color: string) {\r\n        (<Slider>this.selectors[selectorNb].children[1]).background = color;\r\n    }\r\n}\r\n\r\n/** Class used to hold the controls for the checkboxes, radio buttons and sliders\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/selector\r\n */\r\nexport class SelectionPanel extends Rectangle {\r\n    private _panel: StackPanel;\r\n    private _buttonColor: string = \"#364249\";\r\n    private _buttonBackground: string = \"#CCCCCC\";\r\n    private _headerColor: string = \"black\";\r\n    private _barColor: string = \"white\";\r\n    private _barHeight: string = \"2px\";\r\n    private _spacerHeight: string = \"20px\";\r\n    private _labelColor: string;\r\n    private _groups: SelectorGroup[];\r\n    private _bars: any[] = new Array();\r\n\r\n    /**\r\n     * Creates a new SelectionPanel\r\n     * @param name of SelectionPanel\r\n     * @param groups is an array of SelectionGroups\r\n     */\r\n    constructor(\r\n        /** name of SelectionPanel */\r\n        public name: string,\r\n        /** an array of SelectionGroups */\r\n        public groups: SelectorGroup[] = []\r\n    ) {\r\n        super(name);\r\n        this._groups = groups;\r\n        this.thickness = 2;\r\n        this._panel = new StackPanel();\r\n        this._panel.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n        this._panel.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._panel.top = 5;\r\n        this._panel.left = 5;\r\n        this._panel.width = 0.95;\r\n        if (groups.length > 0) {\r\n            for (let i = 0; i < groups.length - 1; i++) {\r\n                this._panel.addControl(groups[i].groupPanel);\r\n                this._addSpacer();\r\n            }\r\n            this._panel.addControl(groups[groups.length - 1].groupPanel);\r\n        }\r\n        this.addControl(this._panel);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"SelectionPanel\";\r\n    }\r\n\r\n    /** Gets the (stack) panel of the SelectionPanel  */\r\n    public get panel(): StackPanel {\r\n        return this._panel;\r\n    }\r\n\r\n    /** Gets or sets the headerColor */\r\n    public get headerColor(): string {\r\n        return this._headerColor;\r\n    }\r\n\r\n    public set headerColor(color: string) {\r\n        if (this._headerColor === color) {\r\n            return;\r\n        }\r\n        this._headerColor = color;\r\n        this._setHeaderColor();\r\n    }\r\n\r\n    private _setHeaderColor() {\r\n        for (let i = 0; i < this._groups.length; i++) {\r\n            this._groups[i].groupPanel.children[0].color = this._headerColor;\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the button color */\r\n    public get buttonColor(): string {\r\n        return this._buttonColor;\r\n    }\r\n\r\n    public set buttonColor(color: string) {\r\n        if (this._buttonColor === color) {\r\n            return;\r\n        }\r\n\r\n        this._buttonColor = color;\r\n        this._setbuttonColor();\r\n    }\r\n\r\n    private _setbuttonColor() {\r\n        for (let i = 0; i < this._groups.length; i++) {\r\n            for (let j = 0; j < this._groups[i].selectors.length; j++) {\r\n                (<CheckboxGroup | RadioGroup | SliderGroup>this._groups[i])._setSelectorButtonColor(j, this._buttonColor);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the label color */\r\n    public get labelColor(): string {\r\n        return this._labelColor;\r\n    }\r\n\r\n    public set labelColor(color: string) {\r\n        if (this._labelColor === color) {\r\n            return;\r\n        }\r\n        this._labelColor = color;\r\n        this._setLabelColor();\r\n    }\r\n\r\n    private _setLabelColor() {\r\n        for (let i = 0; i < this._groups.length; i++) {\r\n            for (let j = 0; j < this._groups[i].selectors.length; j++) {\r\n                (<CheckboxGroup | RadioGroup | SliderGroup>this._groups[i])._setSelectorLabelColor(j, this._labelColor);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the button background */\r\n    public get buttonBackground(): string {\r\n        return this._buttonBackground;\r\n    }\r\n\r\n    public set buttonBackground(color: string) {\r\n        if (this._buttonBackground === color) {\r\n            return;\r\n        }\r\n\r\n        this._buttonBackground = color;\r\n        this._setButtonBackground();\r\n    }\r\n\r\n    private _setButtonBackground() {\r\n        for (let i = 0; i < this._groups.length; i++) {\r\n            for (let j = 0; j < this._groups[i].selectors.length; j++) {\r\n                (<CheckboxGroup | RadioGroup | SliderGroup>this._groups[i])._setSelectorButtonBackground(j, this._buttonBackground);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the color of separator bar */\r\n    public get barColor(): string {\r\n        return this._barColor;\r\n    }\r\n\r\n    public set barColor(color: string) {\r\n        if (this._barColor === color) {\r\n            return;\r\n        }\r\n\r\n        this._barColor = color;\r\n        this._setBarColor();\r\n    }\r\n\r\n    private _setBarColor() {\r\n        for (let i = 0; i < this._bars.length; i++) {\r\n            this._bars[i].children[0].background = this._barColor;\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the height of separator bar */\r\n    public get barHeight(): string {\r\n        return this._barHeight;\r\n    }\r\n\r\n    public set barHeight(value: string) {\r\n        if (this._barHeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._barHeight = value;\r\n        this._setBarHeight();\r\n    }\r\n\r\n    private _setBarHeight() {\r\n        for (let i = 0; i < this._bars.length; i++) {\r\n            this._bars[i].children[0].height = this._barHeight;\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the height of spacers*/\r\n    public get spacerHeight(): string {\r\n        return this._spacerHeight;\r\n    }\r\n\r\n    public set spacerHeight(value: string) {\r\n        if (this._spacerHeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._spacerHeight = value;\r\n        this._setSpacerHeight();\r\n    }\r\n\r\n    private _setSpacerHeight() {\r\n        for (let i = 0; i < this._bars.length; i++) {\r\n            this._bars[i].height = this._spacerHeight;\r\n        }\r\n    }\r\n\r\n    /** Adds a bar between groups */\r\n    private _addSpacer(): void {\r\n        const separator = new Container();\r\n        separator.width = 1;\r\n        separator.height = this._spacerHeight;\r\n        separator.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n\r\n        const bar = new Rectangle();\r\n        bar.width = 1;\r\n        bar.height = this._barHeight;\r\n        bar.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        bar.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n        bar.background = this._barColor;\r\n        bar.color = \"transparent\";\r\n        separator.addControl(bar);\r\n\r\n        this._panel.addControl(separator);\r\n        this._bars.push(separator);\r\n    }\r\n\r\n    /** Add a group to the selection panel\r\n     * @param group is the selector group to add\r\n     */\r\n    public addGroup(group: SelectorGroup): void {\r\n        if (this._groups.length > 0) {\r\n            this._addSpacer();\r\n        }\r\n        this._panel.addControl(group.groupPanel);\r\n        this._groups.push(group);\r\n        group.groupPanel.children[0].color = this._headerColor;\r\n        for (let j = 0; j < group.selectors.length; j++) {\r\n            (<CheckboxGroup | RadioGroup | SliderGroup>group)._setSelectorButtonColor(j, this._buttonColor);\r\n            (<CheckboxGroup | RadioGroup | SliderGroup>group)._setSelectorButtonBackground(j, this._buttonBackground);\r\n        }\r\n    }\r\n\r\n    /** Remove the group from the given position\r\n     * @param groupNb is the position of the group in the list\r\n     */\r\n    public removeGroup(groupNb: number): void {\r\n        if (groupNb < 0 || groupNb >= this._groups.length) {\r\n            return;\r\n        }\r\n        const group = this._groups[groupNb];\r\n        this._panel.removeControl(group.groupPanel);\r\n        this._groups.splice(groupNb, 1);\r\n        if (groupNb < this._bars.length) {\r\n            this._panel.removeControl(this._bars[groupNb]);\r\n            this._bars.splice(groupNb, 1);\r\n        }\r\n    }\r\n\r\n    /** Change a group header label\r\n     * @param label is the new group header label\r\n     * @param groupNb is the number of the group to relabel\r\n     * */\r\n    public setHeaderName(label: string, groupNb: number) {\r\n        if (groupNb < 0 || groupNb >= this._groups.length) {\r\n            return;\r\n        }\r\n        const group = this._groups[groupNb];\r\n        (<TextBlock>group.groupPanel.children[0]).text = label;\r\n    }\r\n\r\n    /** Change selector label to the one given\r\n     * @param label is the new selector label\r\n     * @param groupNb is the number of the groupcontaining the selector\r\n     * @param selectorNb is the number of the selector within a group to relabel\r\n     * */\r\n    public relabel(label: string, groupNb: number, selectorNb: number): void {\r\n        if (groupNb < 0 || groupNb >= this._groups.length) {\r\n            return;\r\n        }\r\n        const group = this._groups[groupNb];\r\n        if (selectorNb < 0 || selectorNb >= group.selectors.length) {\r\n            return;\r\n        }\r\n        (<CheckboxGroup | RadioGroup | SliderGroup>group)._setSelectorLabel(selectorNb, label);\r\n    }\r\n\r\n    /** For a given group position remove the selector at the given position\r\n     * @param groupNb is the number of the group to remove the selector from\r\n     * @param selectorNb is the number of the selector within the group\r\n     */\r\n    public removeFromGroupSelector(groupNb: number, selectorNb: number): void {\r\n        if (groupNb < 0 || groupNb >= this._groups.length) {\r\n            return;\r\n        }\r\n        const group = this._groups[groupNb];\r\n        if (selectorNb < 0 || selectorNb >= group.selectors.length) {\r\n            return;\r\n        }\r\n        group.removeSelector(selectorNb);\r\n    }\r\n\r\n    /** For a given group position of correct type add a checkbox button\r\n     * @param groupNb is the number of the group to remove the selector from\r\n     * @param label is the label for the selector\r\n     * @param func is the function called when the Selector is checked\r\n     * @param checked is true when Selector is checked\r\n     */\r\n    public addToGroupCheckbox(groupNb: number, label: string, func = () => {}, checked: boolean = false): void {\r\n        if (groupNb < 0 || groupNb >= this._groups.length) {\r\n            return;\r\n        }\r\n        const group = this._groups[groupNb];\r\n        (<CheckboxGroup>group).addCheckbox(label, func, checked);\r\n    }\r\n\r\n    /** For a given group position of correct type add a radio button\r\n     * @param groupNb is the number of the group to remove the selector from\r\n     * @param label is the label for the selector\r\n     * @param func is the function called when the Selector is checked\r\n     * @param checked is true when Selector is checked\r\n     */\r\n    public addToGroupRadio(groupNb: number, label: string, func = () => {}, checked: boolean = false): void {\r\n        if (groupNb < 0 || groupNb >= this._groups.length) {\r\n            return;\r\n        }\r\n        const group = this._groups[groupNb];\r\n        (<RadioGroup>group).addRadio(label, func, checked);\r\n    }\r\n\r\n    /**\r\n     * For a given slider group add a slider\r\n     * @param groupNb is the number of the group to add the slider to\r\n     * @param label is the label for the Slider\r\n     * @param func is the function called when the Slider moves\r\n     * @param unit is a string describing the units used, eg degrees or metres\r\n     * @param min is the minimum value for the Slider\r\n     * @param max is the maximum value for the Slider\r\n     * @param value is the start value for the Slider between min and max\r\n     * @param onVal is the function used to format the value displayed, eg radians to degrees\r\n     */\r\n    public addToGroupSlider(\r\n        groupNb: number,\r\n        label: string,\r\n        func = () => {},\r\n        unit: string = \"Units\",\r\n        min: number = 0,\r\n        max: number = 0,\r\n        value: number = 0,\r\n        onVal = (v: number) => {\r\n            return v | 0;\r\n        }\r\n    ): void {\r\n        if (groupNb < 0 || groupNb >= this._groups.length) {\r\n            return;\r\n        }\r\n        const group = this._groups[groupNb];\r\n        (<SliderGroup>group).addSlider(label, func, unit, min, max, value, onVal);\r\n    }\r\n}\r\n","import { Measure } from \"../../measure\";\r\nimport { Container } from \"../container\";\r\nimport { ValueAndUnit } from \"../../valueAndUnit\";\r\nimport { Control } from \"../control\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Class used to hold a the container for ScrollViewer\r\n * @internal\r\n */\r\nexport class _ScrollViewerWindow extends Container {\r\n    public parentClientWidth: number;\r\n    public parentClientHeight: number;\r\n\r\n    private _freezeControls = false;\r\n    private _parentMeasure: Measure;\r\n    private _oldLeft: number | null;\r\n    private _oldTop: number | null;\r\n\r\n    public get freezeControls(): boolean {\r\n        return this._freezeControls;\r\n    }\r\n\r\n    public set freezeControls(value: boolean) {\r\n        if (this._freezeControls === value) {\r\n            return;\r\n        }\r\n\r\n        if (!value) {\r\n            this._restoreMeasures();\r\n        }\r\n\r\n        // trigger a full normal layout calculation to be sure all children have their measures up to date\r\n        this._freezeControls = false;\r\n\r\n        const textureSize = this.host.getSize();\r\n        const renderWidth = textureSize.width;\r\n        const renderHeight = textureSize.height;\r\n\r\n        const context = this.host.getContext();\r\n\r\n        const measure = new Measure(0, 0, renderWidth, renderHeight);\r\n\r\n        this.host._numLayoutCalls = 0;\r\n\r\n        this.host._rootContainer._layout(measure, context);\r\n\r\n        // in freeze mode, prepare children measures accordingly\r\n        if (value) {\r\n            this._updateMeasures();\r\n            if (this._useBuckets()) {\r\n                this._makeBuckets();\r\n            }\r\n        }\r\n\r\n        this._freezeControls = value;\r\n\r\n        this.host.markAsDirty(); // redraw with the (new) current settings\r\n    }\r\n\r\n    private _bucketWidth: number = 0;\r\n    private _bucketHeight: number = 0;\r\n    private _buckets: { [key: number]: Array<Control> } = {};\r\n    private _bucketLen: number;\r\n\r\n    public get bucketWidth(): number {\r\n        return this._bucketWidth;\r\n    }\r\n\r\n    public get bucketHeight(): number {\r\n        return this._bucketHeight;\r\n    }\r\n\r\n    public setBucketSizes(width: number, height: number): void {\r\n        this._bucketWidth = width;\r\n        this._bucketHeight = height;\r\n\r\n        if (this._useBuckets()) {\r\n            if (this._freezeControls) {\r\n                this._makeBuckets();\r\n            }\r\n        } else {\r\n            this._buckets = {};\r\n        }\r\n    }\r\n\r\n    private _useBuckets(): boolean {\r\n        return this._bucketWidth > 0 && this._bucketHeight > 0;\r\n    }\r\n\r\n    private _makeBuckets(): void {\r\n        this._buckets = {};\r\n        this._bucketLen = Math.ceil(this.widthInPixels / this._bucketWidth);\r\n        this._dispatchInBuckets(this._children);\r\n        this._oldLeft = null;\r\n        this._oldTop = null;\r\n    }\r\n\r\n    private _dispatchInBuckets(children: Control[]): void {\r\n        for (let i = 0; i < children.length; ++i) {\r\n            const child = children[i];\r\n\r\n            const bStartX = Math.max(0, Math.floor((child._customData._origLeft - this._customData.origLeft) / this._bucketWidth)),\r\n                bEndX = Math.floor((child._customData._origLeft - this._customData.origLeft + child._currentMeasure.width - 1) / this._bucketWidth),\r\n                bEndY = Math.floor((child._customData._origTop - this._customData.origTop + child._currentMeasure.height - 1) / this._bucketHeight);\r\n            let bStartY = Math.max(0, Math.floor((child._customData._origTop - this._customData.origTop) / this._bucketHeight));\r\n\r\n            while (bStartY <= bEndY) {\r\n                for (let x = bStartX; x <= bEndX; ++x) {\r\n                    const bucket = bStartY * this._bucketLen + x;\r\n                    let lstc = this._buckets[bucket];\r\n\r\n                    if (!lstc) {\r\n                        lstc = [];\r\n                        this._buckets[bucket] = lstc;\r\n                    }\r\n\r\n                    lstc.push(child);\r\n                }\r\n                bStartY++;\r\n            }\r\n\r\n            if (child instanceof Container && child._children.length > 0) {\r\n                this._dispatchInBuckets(child._children);\r\n            }\r\n        }\r\n    }\r\n\r\n    // reset left and top measures for the window and all its children\r\n    private _updateMeasures(): void {\r\n        const left = this.leftInPixels | 0,\r\n            top = this.topInPixels | 0;\r\n\r\n        this._measureForChildren.left -= left;\r\n        this._measureForChildren.top -= top;\r\n        this._currentMeasure.left -= left;\r\n        this._currentMeasure.top -= top;\r\n\r\n        this._customData.origLeftForChildren = this._measureForChildren.left;\r\n        this._customData.origTopForChildren = this._measureForChildren.top;\r\n        this._customData.origLeft = this._currentMeasure.left;\r\n        this._customData.origTop = this._currentMeasure.top;\r\n\r\n        this._updateChildrenMeasures(this._children, left, top);\r\n    }\r\n\r\n    private _updateChildrenMeasures(children: Control[], left: number, top: number): void {\r\n        for (let i = 0; i < children.length; ++i) {\r\n            const child = children[i];\r\n\r\n            child._currentMeasure.left -= left;\r\n            child._currentMeasure.top -= top;\r\n\r\n            child._customData._origLeft = child._currentMeasure.left; // save the original left and top values for each child\r\n            child._customData._origTop = child._currentMeasure.top;\r\n\r\n            if (child instanceof Container && child._children.length > 0) {\r\n                this._updateChildrenMeasures(child._children, left, top);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _restoreMeasures(): void {\r\n        const left = this.leftInPixels | 0,\r\n            top = this.topInPixels | 0;\r\n\r\n        this._measureForChildren.left = this._customData.origLeftForChildren + left;\r\n        this._measureForChildren.top = this._customData.origTopForChildren + top;\r\n        this._currentMeasure.left = this._customData.origLeft + left;\r\n        this._currentMeasure.top = this._customData.origTop + top;\r\n    }\r\n\r\n    /**\r\n     * Creates a new ScrollViewerWindow\r\n     * @param name of ScrollViewerWindow\r\n     */\r\n    constructor(name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"ScrollViewerWindow\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        super._additionalProcessing(parentMeasure, context);\r\n\r\n        this._parentMeasure = parentMeasure;\r\n\r\n        this._measureForChildren.left = this._currentMeasure.left;\r\n        this._measureForChildren.top = this._currentMeasure.top;\r\n\r\n        this._measureForChildren.width = parentMeasure.width;\r\n        this._measureForChildren.height = parentMeasure.height;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _layout(parentMeasure: Measure, context: ICanvasRenderingContext): boolean {\r\n        if (this._freezeControls) {\r\n            this.invalidateRect(); // will trigger a redraw of the window\r\n            return false;\r\n        }\r\n\r\n        return super._layout(parentMeasure, context);\r\n    }\r\n\r\n    private _scrollChildren(children: Control[], left: number, top: number): void {\r\n        for (let i = 0; i < children.length; ++i) {\r\n            const child = children[i];\r\n\r\n            child._currentMeasure.left = child._customData._origLeft + left;\r\n            child._currentMeasure.top = child._customData._origTop + top;\r\n            child._isClipped = false; // clipping will be handled by _draw and the call to _intersectsRect()\r\n\r\n            if (child instanceof Container && child._children.length > 0) {\r\n                this._scrollChildren(child._children, left, top);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _scrollChildrenWithBuckets(left: number, top: number, scrollLeft: number, scrollTop: number): void {\r\n        const bStartX = Math.max(0, Math.floor(-left / this._bucketWidth)),\r\n            bEndX = Math.floor((-left + this._parentMeasure.width - 1) / this._bucketWidth),\r\n            bEndY = Math.floor((-top + this._parentMeasure.height - 1) / this._bucketHeight);\r\n        let bStartY = Math.max(0, Math.floor(-top / this._bucketHeight));\r\n\r\n        while (bStartY <= bEndY) {\r\n            for (let x = bStartX; x <= bEndX; ++x) {\r\n                const bucket = bStartY * this._bucketLen + x,\r\n                    lstc = this._buckets[bucket];\r\n\r\n                if (lstc) {\r\n                    for (let i = 0; i < lstc.length; ++i) {\r\n                        const child = lstc[i];\r\n                        child._currentMeasure.left = child._customData._origLeft + scrollLeft;\r\n                        child._currentMeasure.top = child._customData._origTop + scrollTop;\r\n                        child._isClipped = false; // clipping will be handled by _draw and the call to _intersectsRect()\r\n                    }\r\n                }\r\n            }\r\n            bStartY++;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _draw(context: ICanvasRenderingContext, invalidatedRectangle?: Measure): void {\r\n        if (!this._freezeControls) {\r\n            super._draw(context, invalidatedRectangle);\r\n            return;\r\n        }\r\n\r\n        this._localDraw(context);\r\n\r\n        if (this.clipChildren) {\r\n            this._clipForChildren(context);\r\n        }\r\n\r\n        const left = this.leftInPixels | 0,\r\n            top = this.topInPixels | 0;\r\n\r\n        if (this._useBuckets()) {\r\n            if (this._oldLeft !== null && this._oldTop !== null) {\r\n                this._scrollChildrenWithBuckets(this._oldLeft, this._oldTop, left, top);\r\n                this._scrollChildrenWithBuckets(left, top, left, top);\r\n            } else {\r\n                this._scrollChildren(this._children, left, top);\r\n            }\r\n        } else {\r\n            this._scrollChildren(this._children, left, top);\r\n        }\r\n\r\n        this._oldLeft = left;\r\n        this._oldTop = top;\r\n\r\n        for (const child of this._children) {\r\n            if (!child._intersectsRect(this._parentMeasure)) {\r\n                continue;\r\n            }\r\n            child._render(context, this._parentMeasure);\r\n        }\r\n    }\r\n\r\n    protected _postMeasure(): void {\r\n        if (this._freezeControls) {\r\n            super._postMeasure();\r\n            return;\r\n        }\r\n\r\n        let maxWidth = this.parentClientWidth;\r\n        let maxHeight = this.parentClientHeight;\r\n        for (const child of this.children) {\r\n            if (!child.isVisible || child.notRenderable) {\r\n                continue;\r\n            }\r\n\r\n            if (child.horizontalAlignment === Control.HORIZONTAL_ALIGNMENT_CENTER) {\r\n                child._offsetLeft(this._currentMeasure.left - child._currentMeasure.left);\r\n            }\r\n\r\n            if (child.verticalAlignment === Control.VERTICAL_ALIGNMENT_CENTER) {\r\n                child._offsetTop(this._currentMeasure.top - child._currentMeasure.top);\r\n            }\r\n\r\n            maxWidth = Math.max(maxWidth, child._currentMeasure.left - this._currentMeasure.left + child._currentMeasure.width + child.paddingRightInPixels);\r\n            maxHeight = Math.max(maxHeight, child._currentMeasure.top - this._currentMeasure.top + child._currentMeasure.height + child.paddingBottomInPixels);\r\n        }\r\n\r\n        if (this._currentMeasure.width !== maxWidth) {\r\n            this._width.updateInPlace(maxWidth, ValueAndUnit.UNITMODE_PIXEL);\r\n            this._currentMeasure.width = maxWidth;\r\n            this._rebuildLayout = true;\r\n            this._isDirty = true;\r\n        }\r\n\r\n        if (this._currentMeasure.height !== maxHeight) {\r\n            this._height.updateInPlace(maxHeight, ValueAndUnit.UNITMODE_PIXEL);\r\n            this._currentMeasure.height = maxHeight;\r\n            this._rebuildLayout = true;\r\n            this._isDirty = true;\r\n        }\r\n\r\n        super._postMeasure();\r\n    }\r\n}\r\n","import type { Vector2 } from \"core/Maths/math.vector\";\r\nimport { BaseSlider } from \"./baseSlider\";\r\nimport type { Control } from \"../control\";\r\nimport { Measure } from \"../../measure\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { BaseGradient } from \"../gradient/BaseGradient\";\r\nimport type { AdvancedDynamicTexture } from \"gui/2D/advancedDynamicTexture\";\r\nimport { Tools } from \"core/Misc/tools\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\n\r\n/**\r\n * Class used to create slider controls\r\n */\r\nexport class ScrollBar extends BaseSlider {\r\n    private _background = \"black\";\r\n    private _borderColor = \"white\";\r\n    private _tempMeasure = new Measure(0, 0, 0, 0);\r\n    private _invertScrollDirection = false;\r\n    private _backgroundGradient: Nullable<BaseGradient> = null;\r\n\r\n    /** Gets or sets border color */\r\n    @serialize()\r\n    public get borderColor(): string {\r\n        return this._borderColor;\r\n    }\r\n\r\n    public set borderColor(value: string) {\r\n        if (this._borderColor === value) {\r\n            return;\r\n        }\r\n\r\n        this._borderColor = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background color */\r\n    @serialize()\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n\r\n        this._background = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background gradient. Takes precedence over gradient. */\r\n    public get backgroundGradient(): Nullable<BaseGradient> {\r\n        return this._backgroundGradient;\r\n    }\r\n\r\n    public set backgroundGradient(value: Nullable<BaseGradient>) {\r\n        if (this._backgroundGradient === value) {\r\n            return;\r\n        }\r\n\r\n        this._backgroundGradient = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Inverts the scrolling direction (default: false) */\r\n    @serialize()\r\n    public get invertScrollDirection() {\r\n        return this._invertScrollDirection;\r\n    }\r\n\r\n    public set invertScrollDirection(invert: boolean) {\r\n        this._invertScrollDirection = invert;\r\n    }\r\n\r\n    /**\r\n     * Creates a new Slider\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Scrollbar\";\r\n    }\r\n\r\n    protected _getThumbThickness(): number {\r\n        let thumbThickness = 0;\r\n        if (this._thumbWidth.isPixel) {\r\n            thumbThickness = this._thumbWidth.getValue(this._host);\r\n        } else {\r\n            thumbThickness = this._backgroundBoxThickness * this._thumbWidth.getValue(this._host);\r\n        }\r\n        return thumbThickness;\r\n    }\r\n\r\n    private _getBackgroundColor(context: ICanvasRenderingContext) {\r\n        return this._backgroundGradient ? this._backgroundGradient.getCanvasGradient(context) : this._background;\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n        this._prepareRenderingData(\"rectangle\");\r\n        const left = this._renderLeft;\r\n\r\n        const thumbPosition = this._getThumbPosition();\r\n        context.fillStyle = this._getBackgroundColor(context);\r\n\r\n        context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n\r\n        // Value bar\r\n        context.fillStyle = this._getColor(context);\r\n\r\n        // Thumb\r\n        if (this.isVertical) {\r\n            this._tempMeasure.left = left - this._effectiveBarOffset;\r\n            this._tempMeasure.top = this._currentMeasure.top + thumbPosition;\r\n            this._tempMeasure.width = this._currentMeasure.width;\r\n            this._tempMeasure.height = this._effectiveThumbThickness;\r\n        } else {\r\n            this._tempMeasure.left = this._currentMeasure.left + thumbPosition;\r\n            this._tempMeasure.top = this._currentMeasure.top;\r\n            this._tempMeasure.width = this._effectiveThumbThickness;\r\n            this._tempMeasure.height = this._currentMeasure.height;\r\n        }\r\n\r\n        context.fillRect(this._tempMeasure.left, this._tempMeasure.top, this._tempMeasure.width, this._tempMeasure.height);\r\n\r\n        context.restore();\r\n    }\r\n\r\n    private _first: boolean;\r\n    private _originX: number;\r\n    private _originY: number;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _updateValueFromPointer(x: number, y: number): void {\r\n        if (this.rotation != 0) {\r\n            this._invertTransformMatrix.transformCoordinates(x, y, this._transformedPosition);\r\n            x = this._transformedPosition.x;\r\n            y = this._transformedPosition.y;\r\n        }\r\n\r\n        const sign = this._invertScrollDirection ? -1 : 1;\r\n\r\n        if (this._first) {\r\n            this._first = false;\r\n            this._originX = x;\r\n            this._originY = y;\r\n\r\n            // Check if move is required\r\n            if (\r\n                x < this._tempMeasure.left ||\r\n                x > this._tempMeasure.left + this._tempMeasure.width ||\r\n                y < this._tempMeasure.top ||\r\n                y > this._tempMeasure.top + this._tempMeasure.height\r\n            ) {\r\n                if (this.isVertical) {\r\n                    this.value = this.minimum + (1 - (y - this._currentMeasure.top) / this._currentMeasure.height) * (this.maximum - this.minimum);\r\n                } else {\r\n                    this.value = this.minimum + ((x - this._currentMeasure.left) / this._currentMeasure.width) * (this.maximum - this.minimum);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Delta mode\r\n        let delta = 0;\r\n        if (this.isVertical) {\r\n            delta = -((y - this._originY) / (this._currentMeasure.height - this._effectiveThumbThickness));\r\n        } else {\r\n            delta = (x - this._originX) / (this._currentMeasure.width - this._effectiveThumbThickness);\r\n        }\r\n\r\n        this.value += sign * delta * (this.maximum - this.minimum);\r\n\r\n        this._originX = x;\r\n        this._originY = y;\r\n    }\r\n\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        this._first = true;\r\n\r\n        return super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi);\r\n    }\r\n\r\n    public serialize(serializationObject: any) {\r\n        super.serialize(serializationObject);\r\n\r\n        if (this.backgroundGradient) {\r\n            serializationObject.backgroundGradient = {};\r\n            this.backgroundGradient.serialize(serializationObject.backgroundGradient);\r\n        }\r\n    }\r\n\r\n    public _parseFromContent(serializationObject: any, host: AdvancedDynamicTexture) {\r\n        super._parseFromContent(serializationObject, host);\r\n\r\n        if (serializationObject.backgroundGradient) {\r\n            const className = Tools.Instantiate(\"BABYLON.GUI.\" + serializationObject.backgroundGradient.className);\r\n            this.backgroundGradient = new className();\r\n            this.backgroundGradient!.parse(serializationObject.backgroundGradient);\r\n        }\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.Scrollbar\", ScrollBar);\r\n","import type { Vector2 } from \"core/Maths/math.vector\";\r\nimport { BaseSlider } from \"./baseSlider\";\r\nimport type { Control } from \"../control\";\r\nimport type { Image } from \"../image\";\r\nimport { Measure } from \"../../measure\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Class used to create slider controls\r\n */\r\nexport class ImageScrollBar extends BaseSlider {\r\n    private _backgroundBaseImage: Image;\r\n    private _backgroundImage: Image;\r\n    private _thumbImage: Image;\r\n    private _thumbBaseImage: Image;\r\n    private _thumbLength: number = 0.5;\r\n    private _thumbHeight: number = 1;\r\n    private _barImageHeight: number = 1;\r\n    private _tempMeasure = new Measure(0, 0, 0, 0);\r\n    private _invertScrollDirection = false;\r\n\r\n    /** Number of 90 rotation to apply on the images when in vertical mode */\r\n    @serialize()\r\n    public num90RotationInVerticalMode = 1;\r\n\r\n    /** Inverts the scrolling direction (default: false) */\r\n    @serialize()\r\n    public get invertScrollDirection() {\r\n        return this._invertScrollDirection;\r\n    }\r\n\r\n    public set invertScrollDirection(invert: boolean) {\r\n        this._invertScrollDirection = invert;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image used to render the background for horizontal bar\r\n     */\r\n    public get backgroundImage(): Image {\r\n        return this._backgroundBaseImage;\r\n    }\r\n\r\n    public set backgroundImage(value: Image) {\r\n        if (this._backgroundBaseImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._backgroundBaseImage = value;\r\n\r\n        if (this.isVertical && this.num90RotationInVerticalMode !== 0) {\r\n            if (!value.isLoaded) {\r\n                value.onImageLoadedObservable.addOnce(() => {\r\n                    const rotatedValue = value._rotate90(this.num90RotationInVerticalMode, true);\r\n                    this._backgroundImage = rotatedValue;\r\n                    if (!rotatedValue.isLoaded) {\r\n                        rotatedValue.onImageLoadedObservable.addOnce(() => {\r\n                            this._markAsDirty();\r\n                        });\r\n                    }\r\n                    this._markAsDirty();\r\n                });\r\n            } else {\r\n                this._backgroundImage = value._rotate90(this.num90RotationInVerticalMode, true);\r\n                this._markAsDirty();\r\n            }\r\n        } else {\r\n            this._backgroundImage = value;\r\n            if (value && !value.isLoaded) {\r\n                value.onImageLoadedObservable.addOnce(() => {\r\n                    this._markAsDirty();\r\n                });\r\n            }\r\n\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image used to render the thumb\r\n     */\r\n    public get thumbImage(): Image {\r\n        return this._thumbBaseImage;\r\n    }\r\n\r\n    public set thumbImage(value: Image) {\r\n        if (this._thumbBaseImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._thumbBaseImage = value;\r\n\r\n        if (this.isVertical && this.num90RotationInVerticalMode !== 0) {\r\n            if (!value.isLoaded) {\r\n                value.onImageLoadedObservable.addOnce(() => {\r\n                    const rotatedValue = value._rotate90(-this.num90RotationInVerticalMode, true);\r\n                    this._thumbImage = rotatedValue;\r\n                    if (!rotatedValue.isLoaded) {\r\n                        rotatedValue.onImageLoadedObservable.addOnce(() => {\r\n                            this._markAsDirty();\r\n                        });\r\n                    }\r\n                    this._markAsDirty();\r\n                });\r\n            } else {\r\n                this._thumbImage = value._rotate90(-this.num90RotationInVerticalMode, true);\r\n                this._markAsDirty();\r\n            }\r\n        } else {\r\n            this._thumbImage = value;\r\n            if (value && !value.isLoaded) {\r\n                value.onImageLoadedObservable.addOnce(() => {\r\n                    this._markAsDirty();\r\n                });\r\n            }\r\n\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the length of the thumb\r\n     */\r\n    public get thumbLength(): number {\r\n        return this._thumbLength;\r\n    }\r\n\r\n    public set thumbLength(value: number) {\r\n        if (this._thumbLength === value) {\r\n            return;\r\n        }\r\n\r\n        this._thumbLength = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the height of the thumb\r\n     */\r\n    public get thumbHeight(): number {\r\n        return this._thumbHeight;\r\n    }\r\n\r\n    public set thumbHeight(value: number) {\r\n        if (this._thumbLength === value) {\r\n            return;\r\n        }\r\n\r\n        this._thumbHeight = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the height of the bar image\r\n     */\r\n    public get barImageHeight(): number {\r\n        return this._barImageHeight;\r\n    }\r\n\r\n    public set barImageHeight(value: number) {\r\n        if (this._barImageHeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._barImageHeight = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new ImageScrollBar\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"ImageScrollBar\";\r\n    }\r\n\r\n    protected _getThumbThickness(): number {\r\n        let thumbThickness = 0;\r\n        if (this._thumbWidth.isPixel) {\r\n            thumbThickness = this._thumbWidth.getValue(this._host);\r\n        } else {\r\n            thumbThickness = this._backgroundBoxThickness * this._thumbWidth.getValue(this._host);\r\n        }\r\n        return thumbThickness;\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n\r\n        this._prepareRenderingData(\"rectangle\");\r\n        const thumbPosition = this._getThumbPosition();\r\n        const left = this._renderLeft;\r\n        const top = this._renderTop;\r\n        const width = this._renderWidth;\r\n        const height = this._renderHeight;\r\n\r\n        // Background\r\n        if (this._backgroundImage) {\r\n            this._tempMeasure.copyFromFloats(left, top, width, height);\r\n            if (this.isVertical) {\r\n                this._tempMeasure.copyFromFloats(left + width * (1 - this._barImageHeight) * 0.5, this._currentMeasure.top, width * this._barImageHeight, height);\r\n                this._tempMeasure.height += this._effectiveThumbThickness;\r\n                this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure);\r\n            } else {\r\n                this._tempMeasure.copyFromFloats(this._currentMeasure.left, top + height * (1 - this._barImageHeight) * 0.5, width, height * this._barImageHeight);\r\n                this._tempMeasure.width += this._effectiveThumbThickness;\r\n                this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure);\r\n            }\r\n            this._backgroundImage._draw(context);\r\n        }\r\n\r\n        // Thumb\r\n        if (this.isVertical) {\r\n            this._tempMeasure.copyFromFloats(\r\n                left - this._effectiveBarOffset + this._currentMeasure.width * (1 - this._thumbHeight) * 0.5,\r\n                this._currentMeasure.top + thumbPosition,\r\n                this._currentMeasure.width * this._thumbHeight,\r\n                this._effectiveThumbThickness\r\n            );\r\n        } else {\r\n            this._tempMeasure.copyFromFloats(\r\n                this._currentMeasure.left + thumbPosition,\r\n                this._currentMeasure.top + this._currentMeasure.height * (1 - this._thumbHeight) * 0.5,\r\n                this._effectiveThumbThickness,\r\n                this._currentMeasure.height * this._thumbHeight\r\n            );\r\n        }\r\n\r\n        if (this._thumbImage) {\r\n            this._thumbImage._currentMeasure.copyFrom(this._tempMeasure);\r\n            this._thumbImage._draw(context);\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    private _first: boolean;\r\n    private _originX: number;\r\n    private _originY: number;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected _updateValueFromPointer(x: number, y: number): void {\r\n        if (this.rotation != 0) {\r\n            this._invertTransformMatrix.transformCoordinates(x, y, this._transformedPosition);\r\n            x = this._transformedPosition.x;\r\n            y = this._transformedPosition.y;\r\n        }\r\n\r\n        const sign = this._invertScrollDirection ? -1 : 1;\r\n\r\n        if (this._first) {\r\n            this._first = false;\r\n            this._originX = x;\r\n            this._originY = y;\r\n\r\n            // Check if move is required\r\n            if (\r\n                x < this._tempMeasure.left ||\r\n                x > this._tempMeasure.left + this._tempMeasure.width ||\r\n                y < this._tempMeasure.top ||\r\n                y > this._tempMeasure.top + this._tempMeasure.height\r\n            ) {\r\n                if (this.isVertical) {\r\n                    this.value = this.minimum + (1 - (y - this._currentMeasure.top) / this._currentMeasure.height) * (this.maximum - this.minimum);\r\n                } else {\r\n                    this.value = this.minimum + ((x - this._currentMeasure.left) / this._currentMeasure.width) * (this.maximum - this.minimum);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Delta mode\r\n        let delta = 0;\r\n        if (this.isVertical) {\r\n            delta = -((y - this._originY) / (this._currentMeasure.height - this._effectiveThumbThickness));\r\n        } else {\r\n            delta = (x - this._originX) / (this._currentMeasure.width - this._effectiveThumbThickness);\r\n        }\r\n\r\n        this.value += sign * delta * (this.maximum - this.minimum);\r\n\r\n        this._originX = x;\r\n        this._originY = y;\r\n    }\r\n\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        this._first = true;\r\n\r\n        return super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi);\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math\";\r\nimport { Rectangle } from \"../rectangle\";\r\nimport { Grid } from \"../grid\";\r\nimport type { Image } from \"../image\";\r\nimport { Control } from \"../control\";\r\nimport type { Container } from \"../container\";\r\nimport type { Measure } from \"../../measure\";\r\nimport type { AdvancedDynamicTexture } from \"../../advancedDynamicTexture\";\r\nimport { _ScrollViewerWindow } from \"./scrollViewerWindow\";\r\nimport { ScrollBar } from \"../sliders/scrollBar\";\r\nimport { ImageScrollBar } from \"../sliders/imageScrollBar\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\n\r\n/**\r\n * Class used to hold a viewer window and sliders in a grid\r\n */\r\nexport class ScrollViewer extends Rectangle {\r\n    private _grid: Grid;\r\n    private _horizontalBarSpace: Rectangle;\r\n    private _verticalBarSpace: Rectangle;\r\n    private _dragSpace: Rectangle;\r\n    private _horizontalBar: ScrollBar | ImageScrollBar;\r\n    private _verticalBar: ScrollBar | ImageScrollBar;\r\n    private _barColor: string;\r\n    private _barBackground: string;\r\n    private _barImage: Image;\r\n    private _horizontalBarImage: Image;\r\n    private _verticalBarImage: Image;\r\n    private _barBackgroundImage: Image;\r\n    private _horizontalBarBackgroundImage: Image;\r\n    private _verticalBarBackgroundImage: Image;\r\n    private _barSize: number = 20;\r\n    private _window: _ScrollViewerWindow;\r\n    private _pointerIsOver: Boolean = false;\r\n    private _wheelPrecision: number = 0.05;\r\n    private _onWheelObserver: Nullable<Observer<Vector2>>;\r\n    private _clientWidth: number;\r\n    private _clientHeight: number;\r\n    private _useImageBar: Boolean;\r\n    private _thumbLength: number = 0.5;\r\n    private _thumbHeight: number = 1;\r\n    private _barImageHeight: number = 1;\r\n    private _horizontalBarImageHeight: number = 1;\r\n    private _verticalBarImageHeight: number = 1;\r\n    private _oldWindowContentsWidth: number = 0;\r\n    private _oldWindowContentsHeight: number = 0;\r\n\r\n    /**\r\n     * Gets the horizontal scrollbar\r\n     */\r\n    public get horizontalBar(): ScrollBar | ImageScrollBar {\r\n        return this._horizontalBar;\r\n    }\r\n\r\n    /**\r\n     * Gets the vertical scrollbar\r\n     */\r\n    public get verticalBar(): ScrollBar | ImageScrollBar {\r\n        return this._verticalBar;\r\n    }\r\n\r\n    /**\r\n     * Adds a new control to the current container\r\n     * @param control defines the control to add\r\n     * @returns the current container\r\n     */\r\n    public addControl(control: Nullable<Control>): Container {\r\n        if (!control) {\r\n            return this;\r\n        }\r\n\r\n        this._window.addControl(control);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Removes a control from the current container\r\n     * @param control defines the control to remove\r\n     * @returns the current container\r\n     */\r\n    public removeControl(control: Control): Container {\r\n        this._window.removeControl(control);\r\n        return this;\r\n    }\r\n\r\n    /** Gets the list of children */\r\n    public get children(): Control[] {\r\n        return this._window.children;\r\n    }\r\n\r\n    public _flagDescendantsAsMatrixDirty(): void {\r\n        for (const child of this._children) {\r\n            child._markMatrixAsDirty();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Freezes or unfreezes the controls in the window.\r\n     * When controls are frozen, the scroll viewer can render a lot more quickly but updates to positions/sizes of controls\r\n     * are not taken into account. If you want to change positions/sizes, unfreeze, perform the changes then freeze again\r\n     */\r\n    public get freezeControls(): boolean {\r\n        return this._window.freezeControls;\r\n    }\r\n\r\n    public set freezeControls(value: boolean) {\r\n        this._window.freezeControls = value;\r\n    }\r\n\r\n    /** Gets the bucket width */\r\n    public get bucketWidth(): number {\r\n        return this._window.bucketWidth;\r\n    }\r\n\r\n    /** Gets the bucket height */\r\n    public get bucketHeight(): number {\r\n        return this._window.bucketHeight;\r\n    }\r\n\r\n    /**\r\n     * Sets the bucket sizes.\r\n     * When freezeControls is true, setting a non-zero bucket size will improve performances by updating only\r\n     * controls that are visible. The bucket sizes is used to subdivide (internally) the window area to smaller areas into which\r\n     * controls are dispatched. So, the size should be roughly equals to the mean size of all the controls of\r\n     * the window. To disable the usage of buckets, sets either width or height (or both) to 0.\r\n     * Please note that using this option will raise the memory usage (the higher the bucket sizes, the less memory\r\n     * used), that's why it is not enabled by default.\r\n     * @param width width of the bucket\r\n     * @param height height of the bucket\r\n     */\r\n    public setBucketSizes(width: number, height: number): void {\r\n        this._window.setBucketSizes(width, height);\r\n    }\r\n\r\n    private _forceHorizontalBar: boolean = false;\r\n    private _forceVerticalBar: boolean = false;\r\n\r\n    /**\r\n     * Forces the horizontal scroll bar to be displayed\r\n     */\r\n    public get forceHorizontalBar(): boolean {\r\n        return this._forceHorizontalBar;\r\n    }\r\n\r\n    public set forceHorizontalBar(value: boolean) {\r\n        this._grid.setRowDefinition(1, value ? this._barSize : 0, true);\r\n        this._horizontalBar.isVisible = value;\r\n        this._forceHorizontalBar = value;\r\n    }\r\n\r\n    /**\r\n     * Forces the vertical scroll bar to be displayed\r\n     */\r\n    public get forceVerticalBar(): boolean {\r\n        return this._forceVerticalBar;\r\n    }\r\n\r\n    public set forceVerticalBar(value: boolean) {\r\n        this._grid.setColumnDefinition(1, value ? this._barSize : 0, true);\r\n        this._verticalBar.isVisible = value;\r\n        this._forceVerticalBar = value;\r\n    }\r\n\r\n    /**\r\n     * Creates a new ScrollViewer\r\n     * @param name of ScrollViewer\r\n     * @param isImageBased\r\n     */\r\n    constructor(name?: string, isImageBased?: boolean) {\r\n        super(name);\r\n\r\n        this._useImageBar = isImageBased ? isImageBased : false;\r\n\r\n        this.onDirtyObservable.add(() => {\r\n            this._horizontalBarSpace.color = this.color;\r\n            this._verticalBarSpace.color = this.color;\r\n            this._dragSpace.color = this.color;\r\n        });\r\n\r\n        this.onPointerEnterObservable.add(() => {\r\n            this._pointerIsOver = true;\r\n        });\r\n\r\n        this.onPointerOutObservable.add(() => {\r\n            this._pointerIsOver = false;\r\n        });\r\n\r\n        this._grid = new Grid();\r\n        if (this._useImageBar) {\r\n            this._horizontalBar = new ImageScrollBar();\r\n            this._verticalBar = new ImageScrollBar();\r\n        } else {\r\n            this._horizontalBar = new ScrollBar();\r\n            this._verticalBar = new ScrollBar();\r\n        }\r\n\r\n        this._window = new _ScrollViewerWindow(\"scrollViewer_window\");\r\n        this._window.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._window.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n\r\n        this._grid.addColumnDefinition(1);\r\n        this._grid.addColumnDefinition(0, true);\r\n        this._grid.addRowDefinition(1);\r\n        this._grid.addRowDefinition(0, true);\r\n\r\n        super.addControl(this._grid);\r\n        this._grid.addControl(this._window, 0, 0);\r\n\r\n        this._verticalBarSpace = new Rectangle();\r\n        this._verticalBarSpace.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._verticalBarSpace.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n        this._verticalBarSpace.thickness = 1;\r\n        this._grid.addControl(this._verticalBarSpace, 0, 1);\r\n        this._addBar(this._verticalBar, this._verticalBarSpace, true, Math.PI);\r\n\r\n        this._horizontalBarSpace = new Rectangle();\r\n        this._horizontalBarSpace.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._horizontalBarSpace.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n        this._horizontalBarSpace.thickness = 1;\r\n        this._grid.addControl(this._horizontalBarSpace, 1, 0);\r\n        this._addBar(this._horizontalBar, this._horizontalBarSpace, false, 0);\r\n\r\n        this._dragSpace = new Rectangle();\r\n        this._dragSpace.thickness = 1;\r\n        this._grid.addControl(this._dragSpace, 1, 1);\r\n\r\n        // Colors\r\n        if (!this._useImageBar) {\r\n            this.barColor = \"grey\";\r\n            this.barBackground = \"transparent\";\r\n        }\r\n    }\r\n\r\n    /** Reset the scroll viewer window to initial size */\r\n    public resetWindow() {\r\n        this._window.width = \"100%\";\r\n        this._window.height = \"100%\";\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"ScrollViewer\";\r\n    }\r\n\r\n    private _buildClientSizes() {\r\n        const ratio = this.host.idealRatio;\r\n\r\n        this._window.parentClientWidth = this._currentMeasure.width - (this._verticalBar.isVisible || this.forceVerticalBar ? this._barSize * ratio : 0) - 2 * this.thickness;\r\n        this._window.parentClientHeight = this._currentMeasure.height - (this._horizontalBar.isVisible || this.forceHorizontalBar ? this._barSize * ratio : 0) - 2 * this.thickness;\r\n\r\n        this._clientWidth = this._window.parentClientWidth;\r\n        this._clientHeight = this._window.parentClientHeight;\r\n    }\r\n\r\n    protected _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        super._additionalProcessing(parentMeasure, context);\r\n\r\n        this._buildClientSizes();\r\n    }\r\n\r\n    protected _postMeasure(): void {\r\n        super._postMeasure();\r\n\r\n        this._updateScroller();\r\n\r\n        this._setWindowPosition(false);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the mouse wheel precision\r\n     * from 0 to 1 with a default value of 0.05\r\n     * */\r\n    @serialize()\r\n    public get wheelPrecision(): number {\r\n        return this._wheelPrecision;\r\n    }\r\n\r\n    public set wheelPrecision(value: number) {\r\n        if (this._wheelPrecision === value) {\r\n            return;\r\n        }\r\n\r\n        if (value < 0) {\r\n            value = 0;\r\n        }\r\n\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n\r\n        this._wheelPrecision = value;\r\n    }\r\n\r\n    /** Gets or sets the scroll bar container background color */\r\n    @serialize()\r\n    public get scrollBackground(): string {\r\n        return this._horizontalBarSpace.background;\r\n    }\r\n\r\n    public set scrollBackground(color: string) {\r\n        if (this._horizontalBarSpace.background === color) {\r\n            return;\r\n        }\r\n        this._horizontalBarSpace.background = color;\r\n        this._verticalBarSpace.background = color;\r\n    }\r\n\r\n    /** Gets or sets the bar color */\r\n    @serialize()\r\n    public get barColor(): string {\r\n        return this._barColor;\r\n    }\r\n\r\n    public set barColor(color: string) {\r\n        if (this._barColor === color) {\r\n            return;\r\n        }\r\n\r\n        this._barColor = color;\r\n        this._horizontalBar.color = color;\r\n        this._verticalBar.color = color;\r\n    }\r\n\r\n    /** Gets or sets the bar image */\r\n    public get thumbImage(): Image {\r\n        return this._barImage;\r\n    }\r\n\r\n    public set thumbImage(value: Image) {\r\n        if (this._barImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._barImage = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        hb.thumbImage = value;\r\n        vb.thumbImage = value;\r\n    }\r\n\r\n    /** Gets or sets the horizontal bar image */\r\n    public get horizontalThumbImage(): Image {\r\n        return this._horizontalBarImage;\r\n    }\r\n\r\n    public set horizontalThumbImage(value: Image) {\r\n        if (this._horizontalBarImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._horizontalBarImage = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        hb.thumbImage = value;\r\n    }\r\n\r\n    /** Gets or sets the vertical bar image */\r\n    public get verticalThumbImage(): Image {\r\n        return this._verticalBarImage;\r\n    }\r\n\r\n    public set verticalThumbImage(value: Image) {\r\n        if (this._verticalBarImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._verticalBarImage = value;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        vb.thumbImage = value;\r\n    }\r\n\r\n    /** Gets or sets the size of the bar */\r\n    @serialize()\r\n    public get barSize(): number {\r\n        return this._barSize;\r\n    }\r\n\r\n    public set barSize(value: number) {\r\n        if (this._barSize === value) {\r\n            return;\r\n        }\r\n\r\n        this._barSize = value;\r\n        this._markAsDirty();\r\n\r\n        if (this._horizontalBar.isVisible) {\r\n            this._grid.setRowDefinition(1, this._barSize, true);\r\n        }\r\n        if (this._verticalBar.isVisible) {\r\n            this._grid.setColumnDefinition(1, this._barSize, true);\r\n        }\r\n    }\r\n\r\n    /** Gets or sets the length of the thumb */\r\n    public get thumbLength(): number {\r\n        return this._thumbLength;\r\n    }\r\n\r\n    public set thumbLength(value: number) {\r\n        if (this._thumbLength === value) {\r\n            return;\r\n        }\r\n        if (value <= 0) {\r\n            value = 0.1;\r\n        }\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        this._thumbLength = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        hb.thumbLength = value;\r\n        vb.thumbLength = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the height of the thumb */\r\n    public get thumbHeight(): number {\r\n        return this._thumbHeight;\r\n    }\r\n\r\n    public set thumbHeight(value: number) {\r\n        if (this._thumbHeight === value) {\r\n            return;\r\n        }\r\n        if (value <= 0) {\r\n            value = 0.1;\r\n        }\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        this._thumbHeight = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        hb.thumbHeight = value;\r\n        vb.thumbHeight = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the height of the bar image */\r\n    public get barImageHeight(): number {\r\n        return this._barImageHeight;\r\n    }\r\n\r\n    public set barImageHeight(value: number) {\r\n        if (this._barImageHeight === value) {\r\n            return;\r\n        }\r\n        if (value <= 0) {\r\n            value = 0.1;\r\n        }\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        this._barImageHeight = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        hb.barImageHeight = value;\r\n        vb.barImageHeight = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the height of the horizontal bar image */\r\n    public get horizontalBarImageHeight(): number {\r\n        return this._horizontalBarImageHeight;\r\n    }\r\n\r\n    public set horizontalBarImageHeight(value: number) {\r\n        if (this._horizontalBarImageHeight === value) {\r\n            return;\r\n        }\r\n        if (value <= 0) {\r\n            value = 0.1;\r\n        }\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        this._horizontalBarImageHeight = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        hb.barImageHeight = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the height of the vertical bar image */\r\n    public get verticalBarImageHeight(): number {\r\n        return this._verticalBarImageHeight;\r\n    }\r\n\r\n    public set verticalBarImageHeight(value: number) {\r\n        if (this._verticalBarImageHeight === value) {\r\n            return;\r\n        }\r\n        if (value <= 0) {\r\n            value = 0.1;\r\n        }\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        this._verticalBarImageHeight = value;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        vb.barImageHeight = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the bar background */\r\n    @serialize()\r\n    public get barBackground(): string {\r\n        return this._barBackground;\r\n    }\r\n\r\n    public set barBackground(color: string) {\r\n        if (this._barBackground === color) {\r\n            return;\r\n        }\r\n\r\n        this._barBackground = color;\r\n        const hb = <ScrollBar>this._horizontalBar;\r\n        const vb = <ScrollBar>this._verticalBar;\r\n        hb.background = color;\r\n        vb.background = color;\r\n        this._dragSpace.background = color;\r\n    }\r\n\r\n    /** Gets or sets the bar background image */\r\n    public get barImage(): Image {\r\n        return this._barBackgroundImage;\r\n    }\r\n\r\n    public set barImage(value: Image) {\r\n        this._barBackgroundImage = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        hb.backgroundImage = value;\r\n        vb.backgroundImage = value;\r\n    }\r\n\r\n    /** Gets or sets the horizontal bar background image */\r\n    public get horizontalBarImage(): Image {\r\n        return this._horizontalBarBackgroundImage;\r\n    }\r\n\r\n    public set horizontalBarImage(value: Image) {\r\n        this._horizontalBarBackgroundImage = value;\r\n        const hb = <ImageScrollBar>this._horizontalBar;\r\n        hb.backgroundImage = value;\r\n    }\r\n\r\n    /** Gets or sets the vertical bar background image */\r\n    public get verticalBarImage(): Image {\r\n        return this._verticalBarBackgroundImage;\r\n    }\r\n\r\n    public set verticalBarImage(value: Image) {\r\n        this._verticalBarBackgroundImage = value;\r\n        const vb = <ImageScrollBar>this._verticalBar;\r\n        vb.backgroundImage = value;\r\n    }\r\n\r\n    private _setWindowPosition(force = true): void {\r\n        const ratio = this.host.idealRatio;\r\n        const windowContentsWidth = this._window._currentMeasure.width;\r\n        const windowContentsHeight = this._window._currentMeasure.height;\r\n\r\n        if (!force && this._oldWindowContentsWidth === windowContentsWidth && this._oldWindowContentsHeight === windowContentsHeight) {\r\n            return;\r\n        }\r\n\r\n        this._oldWindowContentsWidth = windowContentsWidth;\r\n        this._oldWindowContentsHeight = windowContentsHeight;\r\n\r\n        const _endLeft = this._clientWidth - windowContentsWidth;\r\n        const _endTop = this._clientHeight - windowContentsHeight;\r\n\r\n        const newLeft = (this._horizontalBar.value / ratio) * _endLeft + \"px\";\r\n        const newTop = (this._verticalBar.value / ratio) * _endTop + \"px\";\r\n\r\n        if (newLeft !== this._window.left) {\r\n            this._window.left = newLeft;\r\n            if (!this.freezeControls) {\r\n                this._rebuildLayout = true;\r\n            }\r\n        }\r\n\r\n        if (newTop !== this._window.top) {\r\n            this._window.top = newTop;\r\n            if (!this.freezeControls) {\r\n                this._rebuildLayout = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    private _updateScroller(): void {\r\n        const windowContentsWidth = this._window._currentMeasure.width;\r\n        const windowContentsHeight = this._window._currentMeasure.height;\r\n\r\n        if (this._horizontalBar.isVisible && windowContentsWidth <= this._clientWidth && !this.forceHorizontalBar) {\r\n            this._grid.setRowDefinition(1, 0, true);\r\n            this._horizontalBar.isVisible = false;\r\n            this._horizontalBar.value = 0;\r\n            this._rebuildLayout = true;\r\n        } else if (!this._horizontalBar.isVisible && (windowContentsWidth > this._clientWidth || this.forceHorizontalBar)) {\r\n            this._grid.setRowDefinition(1, this._barSize, true);\r\n            this._horizontalBar.isVisible = true;\r\n            this._rebuildLayout = true;\r\n        }\r\n\r\n        if (this._verticalBar.isVisible && windowContentsHeight <= this._clientHeight && !this.forceVerticalBar) {\r\n            this._grid.setColumnDefinition(1, 0, true);\r\n            this._verticalBar.isVisible = false;\r\n            this._verticalBar.value = 0;\r\n            this._rebuildLayout = true;\r\n        } else if (!this._verticalBar.isVisible && (windowContentsHeight > this._clientHeight || this.forceVerticalBar)) {\r\n            this._grid.setColumnDefinition(1, this._barSize, true);\r\n            this._verticalBar.isVisible = true;\r\n            this._rebuildLayout = true;\r\n        }\r\n\r\n        this._buildClientSizes();\r\n\r\n        const ratio = this.host.idealRatio;\r\n\r\n        this._horizontalBar.thumbWidth = this._thumbLength * 0.9 * (this._clientWidth / ratio) + \"px\";\r\n        this._verticalBar.thumbWidth = this._thumbLength * 0.9 * (this._clientHeight / ratio) + \"px\";\r\n    }\r\n\r\n    public _link(host: AdvancedDynamicTexture): void {\r\n        super._link(host);\r\n\r\n        this._attachWheel();\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    private _addBar(barControl: ScrollBar | ImageScrollBar, barContainer: Rectangle, isVertical: boolean, rotation: number) {\r\n        barControl.paddingLeft = 0;\r\n        barControl.width = \"100%\";\r\n        barControl.height = \"100%\";\r\n        barControl.barOffset = 0;\r\n        barControl.value = 0;\r\n        barControl.maximum = 1;\r\n        barControl.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\r\n        barControl.verticalAlignment = Control.VERTICAL_ALIGNMENT_CENTER;\r\n        barControl.isVertical = isVertical;\r\n        barControl.rotation = rotation;\r\n        barControl.isVisible = false;\r\n\r\n        barContainer.addControl(barControl);\r\n\r\n        barControl.onValueChangedObservable.add(() => {\r\n            this._setWindowPosition();\r\n        });\r\n    }\r\n\r\n    /** @internal */\r\n    private _attachWheel() {\r\n        if (!this._host || this._onWheelObserver) {\r\n            return;\r\n        }\r\n\r\n        this._onWheelObserver = this.onWheelObservable.add((pi) => {\r\n            if (!this._pointerIsOver || this.isReadOnly) {\r\n                return;\r\n            }\r\n            if (this._verticalBar.isVisible == true) {\r\n                if (pi.y < 0 && this._verticalBar.value > 0) {\r\n                    this._verticalBar.value -= this._wheelPrecision;\r\n                } else if (pi.y > 0 && this._verticalBar.value < this._verticalBar.maximum) {\r\n                    this._verticalBar.value += this._wheelPrecision;\r\n                }\r\n            }\r\n            if (this._horizontalBar.isVisible == true) {\r\n                if (pi.x < 0 && this._horizontalBar.value < this._horizontalBar.maximum) {\r\n                    this._horizontalBar.value += this._wheelPrecision;\r\n                } else if (pi.x > 0 && this._horizontalBar.value > 0) {\r\n                    this._horizontalBar.value -= this._wheelPrecision;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    public _renderHighlightSpecific(context: ICanvasRenderingContext): void {\r\n        if (!this.isHighlighted) {\r\n            return;\r\n        }\r\n\r\n        super._renderHighlightSpecific(context);\r\n\r\n        this._grid._renderHighlightSpecific(context);\r\n\r\n        context.restore();\r\n    }\r\n\r\n    /** Releases associated resources */\r\n    public dispose() {\r\n        this.onWheelObservable.remove(this._onWheelObserver);\r\n        this._onWheelObserver = null;\r\n        super.dispose();\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.ScrollViewer\", ScrollViewer);\r\n","import type { Nullable } from \"core/types\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport type { Vector2 } from \"core/Maths/math.vector\";\r\n\r\nimport { Rectangle } from \"./rectangle\";\r\nimport type { Control } from \"./control\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { PointerInfoBase } from \"core/Events/pointerEvents\";\r\n\r\n/**\r\n * Class used to create toggle buttons\r\n * @since 5.0.0\r\n */\r\nexport class ToggleButton extends Rectangle {\r\n    /**\r\n     * Function called to generate the toActive animation\r\n     */\r\n    public toActiveAnimation: () => void;\r\n\r\n    /**\r\n     * Function called to generate the toInactive animation\r\n     */\r\n    public toInactiveAnimation: () => void;\r\n\r\n    /**\r\n     * Function called to generate a pointer enter animation when the toggle button is active.\r\n     */\r\n    public pointerEnterActiveAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer out animation when the toggle button is active.\r\n     */\r\n    public pointerOutActiveAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer down animation when the toggle button is active.\r\n     */\r\n    public pointerDownActiveAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer up animation when the toggle button is active.\r\n     */\r\n    public pointerUpActiveAnimation: () => void;\r\n\r\n    /**\r\n     * Function called to generate a pointer enter animation when the toggle button is inactive.\r\n     */\r\n    public pointerEnterInactiveAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer out animation when the toggle button is inactive.\r\n     */\r\n    public pointerOutInactiveAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer down animation when the toggle button is inactive.\r\n     */\r\n    public pointerDownInactiveAnimation: () => void;\r\n    /**\r\n     * Function called to generate a pointer up animation when the toggle button is inactive.\r\n     */\r\n    public pointerUpInactiveAnimation: () => void;\r\n\r\n    /** Observable raised when isActive is changed */\r\n    public onIsActiveChangedObservable = new Observable<boolean>();\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that the toggle button will let internal controls handle picking instead of doing it directly using its bounding info\r\n     */\r\n    public delegatePickingToChildren = false;\r\n\r\n    private _group: string;\r\n    /** Gets or sets group name this toggle button belongs to */\r\n    public get group(): string {\r\n        return this._group;\r\n    }\r\n    public set group(value: string) {\r\n        if (this._group === value) {\r\n            return;\r\n        }\r\n\r\n        this._group = value;\r\n    }\r\n\r\n    private _isActive = false;\r\n    /** Gets or sets a boolean indicating if the toggle button is active or not */\r\n    public get isActive(): boolean {\r\n        return this._isActive;\r\n    }\r\n    public set isActive(value: boolean) {\r\n        // Function modeled after radioButton.ts\r\n        if (this._isActive === value) {\r\n            return;\r\n        }\r\n\r\n        this._isActive = value;\r\n\r\n        // Update the visual state based on the new value\r\n        if (this._isActive) {\r\n            this.toActiveAnimation?.();\r\n        } else {\r\n            this.toInactiveAnimation?.();\r\n        }\r\n\r\n        this._markAsDirty();\r\n\r\n        this.onIsActiveChangedObservable.notifyObservers(value);\r\n\r\n        if (this._isActive && this._host && this._group) {\r\n            // A toggle button in a group can only have 1 active element at a given time.\r\n            // If this toggle button has a group, set other toggle buttons in the group to inactive.\r\n            this._host.executeOnAllControls((control) => {\r\n                // Check for control type ToggleButton\r\n                if (control.typeName === \"ToggleButton\") {\r\n                    // Don't do anything to this toggle button\r\n                    if (control === this) {\r\n                        return;\r\n                    }\r\n\r\n                    const childToggle = <ToggleButton>control;\r\n                    // If toggle button is in same group, set isActive to false\r\n                    if (childToggle.group === this.group) {\r\n                        childToggle.isActive = false;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new ToggleButton\r\n     * @param name defines the control name\r\n     * @param group defines the toggle group this toggle belongs to\r\n     */\r\n    constructor(public name?: string, group?: string) {\r\n        super(name);\r\n        this.group = group ?? \"\";\r\n\r\n        this.thickness = 0;\r\n        this.isPointerBlocker = true;\r\n\r\n        let alphaStore: Nullable<number> = null;\r\n\r\n        this.toActiveAnimation = () => {\r\n            this.thickness = 1;\r\n        };\r\n        this.toInactiveAnimation = () => {\r\n            this.thickness = 0;\r\n        };\r\n\r\n        this.pointerEnterActiveAnimation = () => {\r\n            alphaStore = this.alpha;\r\n            this.alpha -= 0.1;\r\n        };\r\n\r\n        this.pointerOutActiveAnimation = () => {\r\n            if (alphaStore !== null) {\r\n                this.alpha = alphaStore;\r\n            }\r\n        };\r\n\r\n        this.pointerDownActiveAnimation = () => {\r\n            this.scaleX -= 0.05;\r\n            this.scaleY -= 0.05;\r\n        };\r\n\r\n        this.pointerUpActiveAnimation = () => {\r\n            this.scaleX += 0.05;\r\n            this.scaleY += 0.05;\r\n        };\r\n\r\n        this.pointerEnterInactiveAnimation = () => {\r\n            alphaStore = this.alpha;\r\n            this.alpha -= 0.1;\r\n        };\r\n\r\n        this.pointerOutInactiveAnimation = () => {\r\n            if (alphaStore !== null) {\r\n                this.alpha = alphaStore;\r\n            }\r\n        };\r\n\r\n        this.pointerDownInactiveAnimation = () => {\r\n            this.scaleX -= 0.05;\r\n            this.scaleY -= 0.05;\r\n        };\r\n\r\n        this.pointerUpInactiveAnimation = () => {\r\n            this.scaleX += 0.05;\r\n            this.scaleY += 0.05;\r\n        };\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"ToggleButton\";\r\n    }\r\n\r\n    // While being a container, the toggle button behaves like a control.\r\n    /**\r\n     * @internal\r\n     */\r\n    public _processPicking(x: number, y: number, pi: PointerInfoBase, type: number, pointerId: number, buttonIndex: number, deltaX?: number, deltaY?: number): boolean {\r\n        if (!this._isEnabled || !this.isHitTestVisible || !this.isVisible || this.notRenderable) {\r\n            return false;\r\n        }\r\n\r\n        if (!super.contains(x, y)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.delegatePickingToChildren) {\r\n            let contains = false;\r\n            for (let index = this._children.length - 1; index >= 0; index--) {\r\n                const child = this._children[index];\r\n                if (child.isEnabled && child.isHitTestVisible && child.isVisible && !child.notRenderable && child.contains(x, y)) {\r\n                    contains = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!contains) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        this._processObservables(type, x, y, pi, pointerId, buttonIndex, deltaX, deltaY);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerEnter(target: Control, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerEnter(target, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isReadOnly) {\r\n            return true;\r\n        }\r\n\r\n        if (this._isActive) {\r\n            if (this.pointerEnterActiveAnimation) {\r\n                this.pointerEnterActiveAnimation();\r\n            }\r\n        } else {\r\n            if (this.pointerEnterInactiveAnimation) {\r\n                this.pointerEnterInactiveAnimation();\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerOut(target: Control, pi: PointerInfoBase, force = false): void {\r\n        if (!this.isReadOnly) {\r\n            if (this._isActive) {\r\n                if (this.pointerOutActiveAnimation) {\r\n                    this.pointerOutActiveAnimation();\r\n                }\r\n            } else {\r\n                if (this.pointerOutInactiveAnimation) {\r\n                    this.pointerOutInactiveAnimation();\r\n                }\r\n            }\r\n        }\r\n\r\n        super._onPointerOut(target, pi, force);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerDown(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, pi: PointerInfoBase): boolean {\r\n        if (!super._onPointerDown(target, coordinates, pointerId, buttonIndex, pi)) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isReadOnly) {\r\n            return true;\r\n        }\r\n\r\n        if (this._isActive) {\r\n            if (this.pointerDownActiveAnimation) {\r\n                this.pointerDownActiveAnimation();\r\n            }\r\n        } else {\r\n            if (this.pointerDownInactiveAnimation) {\r\n                this.pointerDownInactiveAnimation();\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerUp(target: Control, coordinates: Vector2, pointerId: number, buttonIndex: number, notifyClick: boolean, pi: PointerInfoBase): void {\r\n        if (!this.isReadOnly) {\r\n            if (this._isActive) {\r\n                if (this.pointerUpActiveAnimation) {\r\n                    this.pointerUpActiveAnimation();\r\n                }\r\n            } else {\r\n                if (this.pointerUpInactiveAnimation) {\r\n                    this.pointerUpInactiveAnimation();\r\n                }\r\n            }\r\n        }\r\n\r\n        super._onPointerUp(target, coordinates, pointerId, buttonIndex, notifyClick, pi);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.ToggleButton\", ToggleButton);\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Observable } from \"core/Misc/observable\";\r\n\r\nimport { StackPanel } from \"./stackPanel\";\r\nimport { Button } from \"./button\";\r\nimport type { Container } from \"./container\";\r\nimport type { TextBlock } from \"./textBlock\";\r\nimport type { InputText } from \"./inputText\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport { InputTextArea } from \"./inputTextArea\";\r\n\r\n/**\r\n * Class used to store key control properties\r\n */\r\nexport class KeyPropertySet {\r\n    /** Width */\r\n    width?: string;\r\n    /** Height */\r\n    height?: string;\r\n    /** Left padding */\r\n    paddingLeft?: string;\r\n    /** Right padding */\r\n    paddingRight?: string;\r\n    /** Top padding */\r\n    paddingTop?: string;\r\n    /** Bottom padding */\r\n    paddingBottom?: string;\r\n    /** Foreground color */\r\n    color?: string;\r\n    /** Background color */\r\n    background?: string;\r\n}\r\n\r\ntype ConnectedInputText = {\r\n    input: InputText;\r\n    onFocusObserver: Nullable<Observer<InputText>>;\r\n    onBlurObserver: Nullable<Observer<InputText>>;\r\n};\r\n\r\n/**\r\n * Class used to create virtual keyboard\r\n */\r\nexport class VirtualKeyboard extends StackPanel {\r\n    /** Observable raised when a key is pressed */\r\n    public onKeyPressObservable = new Observable<string>();\r\n\r\n    /** Gets or sets default key button width */\r\n    public defaultButtonWidth = \"40px\";\r\n    /** Gets or sets default key button height */\r\n    public defaultButtonHeight = \"40px\";\r\n\r\n    /** Gets or sets default key button left padding */\r\n    public defaultButtonPaddingLeft = \"2px\";\r\n    /** Gets or sets default key button right padding */\r\n    public defaultButtonPaddingRight = \"2px\";\r\n    /** Gets or sets default key button top padding */\r\n    public defaultButtonPaddingTop = \"2px\";\r\n    /** Gets or sets default key button bottom padding */\r\n    public defaultButtonPaddingBottom = \"2px\";\r\n\r\n    /** Gets or sets default key button foreground color */\r\n    public defaultButtonColor = \"#DDD\";\r\n    /** Gets or sets default key button background color */\r\n    public defaultButtonBackground = \"#070707\";\r\n\r\n    /** Gets or sets shift button foreground color */\r\n    public shiftButtonColor = \"#7799FF\";\r\n    /** Gets or sets shift button thickness*/\r\n    public selectedShiftThickness = 1;\r\n\r\n    /** Gets shift key state */\r\n    public shiftState = 0;\r\n\r\n    protected _getTypeName(): string {\r\n        return \"VirtualKeyboard\";\r\n    }\r\n\r\n    private _createKey(key: string, propertySet: Nullable<KeyPropertySet>) {\r\n        const button = Button.CreateSimpleButton(key, key);\r\n\r\n        button.width = propertySet && propertySet.width ? propertySet.width : this.defaultButtonWidth;\r\n        button.height = propertySet && propertySet.height ? propertySet.height : this.defaultButtonHeight;\r\n        button.color = propertySet && propertySet.color ? propertySet.color : this.defaultButtonColor;\r\n        button.background = propertySet && propertySet.background ? propertySet.background : this.defaultButtonBackground;\r\n        button.paddingLeft = propertySet && propertySet.paddingLeft ? propertySet.paddingLeft : this.defaultButtonPaddingLeft;\r\n        button.paddingRight = propertySet && propertySet.paddingRight ? propertySet.paddingRight : this.defaultButtonPaddingRight;\r\n        button.paddingTop = propertySet && propertySet.paddingTop ? propertySet.paddingTop : this.defaultButtonPaddingTop;\r\n        button.paddingBottom = propertySet && propertySet.paddingBottom ? propertySet.paddingBottom : this.defaultButtonPaddingBottom;\r\n\r\n        button.thickness = 0;\r\n        button.isFocusInvisible = true;\r\n\r\n        button.shadowColor = this.shadowColor;\r\n        button.shadowBlur = this.shadowBlur;\r\n        button.shadowOffsetX = this.shadowOffsetX;\r\n        button.shadowOffsetY = this.shadowOffsetY;\r\n\r\n        button.onPointerUpObservable.add(() => {\r\n            this.onKeyPressObservable.notifyObservers(key);\r\n        });\r\n\r\n        return button;\r\n    }\r\n\r\n    /**\r\n     * Adds a new row of keys\r\n     * @param keys defines the list of keys to add\r\n     * @param propertySets defines the associated property sets\r\n     */\r\n    public addKeysRow(keys: Array<string>, propertySets?: Array<KeyPropertySet>): void {\r\n        const panel = new StackPanel();\r\n        panel.isVertical = false;\r\n        panel.isFocusInvisible = true;\r\n\r\n        let maxKey: Nullable<Button> = null;\r\n        for (let i = 0; i < keys.length; i++) {\r\n            let properties = null;\r\n\r\n            if (propertySets && propertySets.length === keys.length) {\r\n                properties = propertySets[i];\r\n            }\r\n\r\n            const key = this._createKey(keys[i], properties);\r\n            if (!maxKey || key.heightInPixels > maxKey.heightInPixels) {\r\n                maxKey = key;\r\n            }\r\n\r\n            panel.addControl(key);\r\n        }\r\n\r\n        panel.height = maxKey ? maxKey.height : this.defaultButtonHeight;\r\n\r\n        this.addControl(panel);\r\n    }\r\n\r\n    /**\r\n     * Set the shift key to a specific state\r\n     * @param shiftState defines the new shift state\r\n     */\r\n    public applyShiftState(shiftState: number): void {\r\n        if (!this.children) {\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            const row = this.children[i];\r\n            if (!row || !(<Container>row).children) {\r\n                continue;\r\n            }\r\n\r\n            const rowContainer = <Container>row;\r\n            for (let j = 0; j < rowContainer.children.length; j++) {\r\n                const button = rowContainer.children[j] as Button;\r\n\r\n                if (!button || !button.children[0]) {\r\n                    continue;\r\n                }\r\n\r\n                const button_tblock = button.children[0] as TextBlock;\r\n\r\n                if (button_tblock.text === \"\\u21E7\") {\r\n                    button.color = shiftState ? this.shiftButtonColor : this.defaultButtonColor;\r\n                    button.thickness = shiftState > 1 ? this.selectedShiftThickness : 0;\r\n                }\r\n\r\n                button_tblock.text = shiftState > 0 ? button_tblock.text.toUpperCase() : button_tblock.text.toLowerCase();\r\n            }\r\n        }\r\n    }\r\n\r\n    private _currentlyConnectedInputText: Nullable<InputText | InputTextArea> = null;\r\n    private _connectedInputTexts: ConnectedInputText[] = [];\r\n    private _onKeyPressObserver: Nullable<Observer<string>> = null;\r\n\r\n    /** Gets the input text control currently attached to the keyboard */\r\n    public get connectedInputText(): Nullable<InputText | InputTextArea> {\r\n        return this._currentlyConnectedInputText;\r\n    }\r\n\r\n    /**\r\n     * Connects the keyboard with an input text control\r\n     *\r\n     * @param input defines the target control\r\n     */\r\n    public connect(input: InputText): void {\r\n        const inputTextAlreadyConnected = this._connectedInputTexts.some((a) => a.input === input);\r\n        if (inputTextAlreadyConnected) {\r\n            return;\r\n        }\r\n\r\n        if (this._onKeyPressObserver === null) {\r\n            this._onKeyPressObserver = this.onKeyPressObservable.add((key) => {\r\n                if (!this._currentlyConnectedInputText) {\r\n                    return;\r\n                }\r\n\r\n                this._currentlyConnectedInputText._host.focusedControl = this._currentlyConnectedInputText;\r\n\r\n                switch (key) {\r\n                    case \"\\u21E7\":\r\n                        this.shiftState++;\r\n                        if (this.shiftState > 2) {\r\n                            this.shiftState = 0;\r\n                        }\r\n                        this.applyShiftState(this.shiftState);\r\n                        return;\r\n                    case \"\\u2190\":\r\n                        if (this._currentlyConnectedInputText instanceof InputTextArea) {\r\n                            this._currentlyConnectedInputText.alternativeProcessKey(\"Backspace\");\r\n                        } else {\r\n                            this._currentlyConnectedInputText.processKey(8);\r\n                        }\r\n                        return;\r\n                    case \"\\u21B5\":\r\n                        if (this._currentlyConnectedInputText instanceof InputTextArea) {\r\n                            this._currentlyConnectedInputText.alternativeProcessKey(\"Enter\");\r\n                        } else {\r\n                            this._currentlyConnectedInputText.processKey(13);\r\n                        }\r\n                        return;\r\n                }\r\n                if (this._currentlyConnectedInputText instanceof InputTextArea) {\r\n                    this._currentlyConnectedInputText.alternativeProcessKey(\"\", this.shiftState ? key.toUpperCase() : key);\r\n                } else {\r\n                    this._currentlyConnectedInputText.processKey(-1, this.shiftState ? key.toUpperCase() : key);\r\n                }\r\n\r\n                if (this.shiftState === 1) {\r\n                    this.shiftState = 0;\r\n                    this.applyShiftState(this.shiftState);\r\n                }\r\n            });\r\n        }\r\n\r\n        this.isVisible = false;\r\n        this._currentlyConnectedInputText = input;\r\n        input._connectedVirtualKeyboard = this;\r\n\r\n        // Events hooking\r\n        const onFocusObserver: Nullable<Observer<InputText>> = input.onFocusObservable.add(() => {\r\n            this._currentlyConnectedInputText = input;\r\n            input._connectedVirtualKeyboard = this;\r\n            this.isVisible = true;\r\n        });\r\n\r\n        const onBlurObserver: Nullable<Observer<InputText>> = input.onBlurObservable.add(() => {\r\n            input._connectedVirtualKeyboard = null;\r\n            this._currentlyConnectedInputText = null;\r\n            this.isVisible = false;\r\n        });\r\n\r\n        this._connectedInputTexts.push({\r\n            input,\r\n            onBlurObserver,\r\n            onFocusObserver,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Disconnects the keyboard from connected InputText controls\r\n     *\r\n     * @param input optionally defines a target control, otherwise all are disconnected\r\n     */\r\n    public disconnect(input?: InputText): void {\r\n        if (input) {\r\n            // .find not available on IE\r\n            const filtered = this._connectedInputTexts.filter((a) => a.input === input);\r\n            if (filtered.length === 1) {\r\n                this._removeConnectedInputObservables(filtered[0]);\r\n\r\n                this._connectedInputTexts = this._connectedInputTexts.filter((a) => a.input !== input);\r\n                if (this._currentlyConnectedInputText === input) {\r\n                    this._currentlyConnectedInputText = null;\r\n                }\r\n            }\r\n        } else {\r\n            this._connectedInputTexts.forEach((connectedInputText: ConnectedInputText) => {\r\n                this._removeConnectedInputObservables(connectedInputText);\r\n            });\r\n            this._connectedInputTexts.length = 0;\r\n        }\r\n\r\n        if (this._connectedInputTexts.length === 0) {\r\n            this._currentlyConnectedInputText = null;\r\n            this.onKeyPressObservable.remove(this._onKeyPressObserver);\r\n            this._onKeyPressObserver = null;\r\n        }\r\n    }\r\n\r\n    private _removeConnectedInputObservables(connectedInputText: ConnectedInputText): void {\r\n        connectedInputText.input._connectedVirtualKeyboard = null;\r\n        connectedInputText.input.onFocusObservable.remove(connectedInputText.onFocusObserver);\r\n        connectedInputText.input.onBlurObservable.remove(connectedInputText.onBlurObserver);\r\n    }\r\n\r\n    /**\r\n     * Release all resources\r\n     */\r\n    public dispose(): void {\r\n        super.dispose();\r\n\r\n        this.disconnect();\r\n    }\r\n\r\n    // Statics\r\n\r\n    /**\r\n     * Creates a new keyboard using a default layout\r\n     *\r\n     * @param name defines control name\r\n     * @returns a new VirtualKeyboard\r\n     */\r\n    public static CreateDefaultLayout(name?: string): VirtualKeyboard {\r\n        const returnValue = new VirtualKeyboard(name);\r\n\r\n        returnValue.addKeysRow([\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"0\", \"\\u2190\"]);\r\n        returnValue.addKeysRow([\"q\", \"w\", \"e\", \"r\", \"t\", \"y\", \"u\", \"i\", \"o\", \"p\"]);\r\n        returnValue.addKeysRow([\"a\", \"s\", \"d\", \"f\", \"g\", \"h\", \"j\", \"k\", \"l\", \";\", \"'\", \"\\u21B5\"]);\r\n        returnValue.addKeysRow([\"\\u21E7\", \"z\", \"x\", \"c\", \"v\", \"b\", \"n\", \"m\", \",\", \".\", \"/\"]);\r\n        returnValue.addKeysRow([\" \"], [{ width: \"200px\" }]);\r\n\r\n        return returnValue;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        super._parseFromContent(serializedObject, host);\r\n        for (const row of this.children) {\r\n            if (row.getClassName() === \"StackPanel\") {\r\n                const stackPanel = row as StackPanel;\r\n                for (const key of stackPanel.children) {\r\n                    if (key.getClassName() === \"Button\" && key.name) {\r\n                        key.onPointerUpObservable.add(() => {\r\n                            this.onKeyPressObservable.notifyObservers(key.name as string);\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.VirtualKeyboard\", VirtualKeyboard);\r\n","import { Control } from \"./control\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/** Class used to render a grid  */\r\nexport class DisplayGrid extends Control {\r\n    private _cellWidth = 20;\r\n    private _cellHeight = 20;\r\n\r\n    private _minorLineTickness = 1;\r\n    private _minorLineColor = \"DarkGray\";\r\n\r\n    private _majorLineTickness = 2;\r\n    private _majorLineColor = \"White\";\r\n\r\n    private _majorLineFrequency = 5;\r\n\r\n    private _background = \"Black\";\r\n\r\n    private _displayMajorLines = true;\r\n    private _displayMinorLines = true;\r\n\r\n    /** Gets or sets a boolean indicating if minor lines must be rendered (true by default)) */\r\n    @serialize()\r\n    public get displayMinorLines(): boolean {\r\n        return this._displayMinorLines;\r\n    }\r\n\r\n    public set displayMinorLines(value: boolean) {\r\n        if (this._displayMinorLines === value) {\r\n            return;\r\n        }\r\n\r\n        this._displayMinorLines = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if major lines must be rendered (true by default)) */\r\n    @serialize()\r\n    public get displayMajorLines(): boolean {\r\n        return this._displayMajorLines;\r\n    }\r\n\r\n    public set displayMajorLines(value: boolean) {\r\n        if (this._displayMajorLines === value) {\r\n            return;\r\n        }\r\n\r\n        this._displayMajorLines = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets background color (Black by default) */\r\n    @serialize()\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n\r\n        this._background = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the width of each cell (20 by default) */\r\n    @serialize()\r\n    public get cellWidth(): number {\r\n        return this._cellWidth;\r\n    }\r\n\r\n    public set cellWidth(value: number) {\r\n        this._cellWidth = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the height of each cell (20 by default) */\r\n    @serialize()\r\n    public get cellHeight(): number {\r\n        return this._cellHeight;\r\n    }\r\n\r\n    public set cellHeight(value: number) {\r\n        this._cellHeight = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the tickness of minor lines (1 by default) */\r\n    @serialize()\r\n    public get minorLineTickness(): number {\r\n        return this._minorLineTickness;\r\n    }\r\n\r\n    public set minorLineTickness(value: number) {\r\n        this._minorLineTickness = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the color of minor lines (DarkGray by default) */\r\n    @serialize()\r\n    public get minorLineColor(): string {\r\n        return this._minorLineColor;\r\n    }\r\n\r\n    public set minorLineColor(value: string) {\r\n        this._minorLineColor = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the tickness of major lines (2 by default) */\r\n    @serialize()\r\n    public get majorLineTickness(): number {\r\n        return this._majorLineTickness;\r\n    }\r\n\r\n    public set majorLineTickness(value: number) {\r\n        this._majorLineTickness = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the color of major lines (White by default) */\r\n    @serialize()\r\n    public get majorLineColor(): string {\r\n        return this._majorLineColor;\r\n    }\r\n\r\n    public set majorLineColor(value: string) {\r\n        this._majorLineColor = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /** Gets or sets the frequency of major lines (default is 1 every 5 minor lines)*/\r\n    @serialize()\r\n    public get majorLineFrequency(): number {\r\n        return this._majorLineFrequency;\r\n    }\r\n\r\n    public set majorLineFrequency(value: number) {\r\n        this._majorLineFrequency = value;\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new GridDisplayRectangle\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n\r\n        if (this._isEnabled) {\r\n            if (this._background) {\r\n                context.fillStyle = this._background;\r\n                context.fillRect(this._currentMeasure.left, this._currentMeasure.top, this._currentMeasure.width, this._currentMeasure.height);\r\n            }\r\n\r\n            const cellCountX = this._currentMeasure.width / this._cellWidth;\r\n            const cellCountY = this._currentMeasure.height / this._cellHeight;\r\n\r\n            // Minor lines\r\n            const left = this._currentMeasure.left + this._currentMeasure.width / 2;\r\n            const top = this._currentMeasure.top + this._currentMeasure.height / 2;\r\n\r\n            if (this._displayMinorLines) {\r\n                context.strokeStyle = this._minorLineColor;\r\n                context.lineWidth = this._minorLineTickness;\r\n\r\n                for (let x = -cellCountX / 2 + 1; x < cellCountX / 2; x++) {\r\n                    const cellX = left + x * this.cellWidth;\r\n\r\n                    context.beginPath();\r\n                    context.moveTo(cellX, this._currentMeasure.top);\r\n                    context.lineTo(cellX, this._currentMeasure.top + this._currentMeasure.height);\r\n\r\n                    context.stroke();\r\n                }\r\n\r\n                for (let y = -cellCountY / 2 + 1; y < cellCountY / 2; y++) {\r\n                    const cellY = top + y * this.cellHeight;\r\n\r\n                    context.beginPath();\r\n                    context.moveTo(this._currentMeasure.left, cellY);\r\n                    context.lineTo(this._currentMeasure.left + this._currentMeasure.width, cellY);\r\n                    context.stroke();\r\n                }\r\n            }\r\n\r\n            // Major lines\r\n            if (this._displayMajorLines) {\r\n                context.strokeStyle = this._majorLineColor;\r\n                context.lineWidth = this._majorLineTickness;\r\n\r\n                for (let x = -cellCountX / 2 + this._majorLineFrequency; x < cellCountX / 2; x += this._majorLineFrequency) {\r\n                    const cellX = left + x * this.cellWidth;\r\n\r\n                    context.beginPath();\r\n                    context.moveTo(cellX, this._currentMeasure.top);\r\n                    context.lineTo(cellX, this._currentMeasure.top + this._currentMeasure.height);\r\n                    context.stroke();\r\n                }\r\n\r\n                for (let y = -cellCountY / 2 + this._majorLineFrequency; y < cellCountY / 2; y += this._majorLineFrequency) {\r\n                    const cellY = top + y * this.cellHeight;\r\n                    context.moveTo(this._currentMeasure.left, cellY);\r\n                    context.lineTo(this._currentMeasure.left + this._currentMeasure.width, cellY);\r\n                    context.closePath();\r\n                    context.stroke();\r\n                }\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"DisplayGrid\";\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.DisplayGrid\", DisplayGrid);\r\n","import { BaseSlider } from \"./baseSlider\";\r\nimport { Measure } from \"../../measure\";\r\nimport { Image } from \"../image\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport type { AdvancedDynamicTexture } from \"../../advancedDynamicTexture\";\r\n\r\n/**\r\n * Class used to create slider controls based on images\r\n */\r\nexport class ImageBasedSlider extends BaseSlider {\r\n    private _backgroundImage: Image;\r\n    private _thumbImage: Image;\r\n    private _valueBarImage: Image;\r\n    private _tempMeasure = new Measure(0, 0, 0, 0);\r\n\r\n    @serialize()\r\n    public get displayThumb(): boolean {\r\n        return this._displayThumb && this.thumbImage != null;\r\n    }\r\n\r\n    public set displayThumb(value: boolean) {\r\n        if (this._displayThumb === value) {\r\n            return;\r\n        }\r\n\r\n        this._displayThumb = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image used to render the background\r\n     */\r\n    public get backgroundImage(): Image {\r\n        return this._backgroundImage;\r\n    }\r\n\r\n    public set backgroundImage(value: Image) {\r\n        if (this._backgroundImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._backgroundImage = value;\r\n\r\n        if (value && !value.isLoaded) {\r\n            value.onImageLoadedObservable.addOnce(() => this._markAsDirty());\r\n        }\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image used to render the value bar\r\n     */\r\n    public get valueBarImage(): Image {\r\n        return this._valueBarImage;\r\n    }\r\n\r\n    public set valueBarImage(value: Image) {\r\n        if (this._valueBarImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._valueBarImage = value;\r\n\r\n        if (value && !value.isLoaded) {\r\n            value.onImageLoadedObservable.addOnce(() => this._markAsDirty());\r\n        }\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image used to render the thumb\r\n     */\r\n    public get thumbImage(): Image {\r\n        return this._thumbImage;\r\n    }\r\n\r\n    public set thumbImage(value: Image) {\r\n        if (this._thumbImage === value) {\r\n            return;\r\n        }\r\n\r\n        this._thumbImage = value;\r\n\r\n        if (value && !value.isLoaded) {\r\n            value.onImageLoadedObservable.addOnce(() => this._markAsDirty());\r\n        }\r\n\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Creates a new ImageBasedSlider\r\n     * @param name defines the control name\r\n     */\r\n    constructor(public name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"ImageBasedSlider\";\r\n    }\r\n\r\n    public _draw(context: ICanvasRenderingContext): void {\r\n        context.save();\r\n\r\n        this._applyStates(context);\r\n\r\n        this._prepareRenderingData(\"rectangle\");\r\n        const thumbPosition = this._getThumbPosition();\r\n        const left = this._renderLeft;\r\n        const top = this._renderTop;\r\n        const width = this._renderWidth;\r\n        const height = this._renderHeight;\r\n\r\n        // Background\r\n        if (this._backgroundImage) {\r\n            this._tempMeasure.copyFromFloats(left, top, width, height);\r\n            if (this.isThumbClamped && this.displayThumb) {\r\n                if (this.isVertical) {\r\n                    this._tempMeasure.height += this._effectiveThumbThickness;\r\n                } else {\r\n                    this._tempMeasure.width += this._effectiveThumbThickness;\r\n                }\r\n            }\r\n            this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure);\r\n            this._backgroundImage._draw(context);\r\n        }\r\n\r\n        // Bar\r\n        if (this._valueBarImage) {\r\n            if (this.isVertical) {\r\n                if (this.isThumbClamped && this.displayThumb) {\r\n                    this._tempMeasure.copyFromFloats(left, top + thumbPosition, width, height - thumbPosition + this._effectiveThumbThickness);\r\n                } else {\r\n                    this._tempMeasure.copyFromFloats(left, top + thumbPosition, width, height - thumbPosition);\r\n                }\r\n            } else {\r\n                if (this.isThumbClamped && this.displayThumb) {\r\n                    this._tempMeasure.copyFromFloats(left, top, thumbPosition + this._effectiveThumbThickness / 2, height);\r\n                } else {\r\n                    this._tempMeasure.copyFromFloats(left, top, thumbPosition, height);\r\n                }\r\n            }\r\n            this._valueBarImage._currentMeasure.copyFrom(this._tempMeasure);\r\n            this._valueBarImage._draw(context);\r\n        }\r\n\r\n        // Thumb\r\n        if (this.displayThumb) {\r\n            if (this.isVertical) {\r\n                this._tempMeasure.copyFromFloats(\r\n                    left - this._effectiveBarOffset,\r\n                    this._currentMeasure.top + thumbPosition,\r\n                    this._currentMeasure.width,\r\n                    this._effectiveThumbThickness\r\n                );\r\n            } else {\r\n                this._tempMeasure.copyFromFloats(this._currentMeasure.left + thumbPosition, this._currentMeasure.top, this._effectiveThumbThickness, this._currentMeasure.height);\r\n            }\r\n\r\n            this._thumbImage._currentMeasure.copyFrom(this._tempMeasure);\r\n            this._thumbImage._draw(context);\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    /**\r\n     * Serializes the current control\r\n     * @param serializationObject defined the JSON serialized object\r\n     */\r\n    public serialize(serializationObject: any) {\r\n        super.serialize(serializationObject);\r\n        const backgroundImage = {};\r\n        const thumbImage = {};\r\n        const valueBarImage = {};\r\n        this.backgroundImage.serialize(backgroundImage);\r\n        this.thumbImage.serialize(thumbImage);\r\n        this.valueBarImage.serialize(valueBarImage);\r\n        serializationObject.backgroundImage = backgroundImage;\r\n        serializationObject.thumbImage = thumbImage;\r\n        serializationObject.valueBarImage = valueBarImage;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        super._parseFromContent(serializedObject, host);\r\n        this.backgroundImage = Image.Parse(serializedObject.backgroundImage, host) as Image;\r\n        this.thumbImage = Image.Parse(serializedObject.thumbImage, host) as Image;\r\n        this.valueBarImage = Image.Parse(serializedObject.valueBarImage, host) as Image;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.ImageBasedSlider\", ImageBasedSlider);\r\n","import { Control } from \"./control\";\r\nimport { StackPanel } from \"./stackPanel\";\r\nimport { TextBlock } from \"./textBlock\";\r\n\r\n/**\r\n * Forcing an export so that this code will execute\r\n * @internal\r\n */\r\nconst name = \"Statics\";\r\n\r\nexport { name };\r\n\r\n/**\r\n * Creates a stack panel that can be used to render headers\r\n * @param control defines the control to associate with the header\r\n * @param text defines the text of the header\r\n * @param size defines the size of the header\r\n * @param options defines options used to configure the header\r\n * @param options.isHorizontal\r\n * @param options.controlFirst\r\n * @returns a new StackPanel\r\n */\r\nControl.AddHeader = function (control: Control, text: string, size: string | number, options: { isHorizontal: boolean; controlFirst: boolean }): StackPanel {\r\n    const panel = new StackPanel(\"panel\");\r\n    const isHorizontal = options ? options.isHorizontal : true;\r\n    const controlFirst = options ? options.controlFirst : true;\r\n\r\n    panel.isVertical = !isHorizontal;\r\n\r\n    const header = new TextBlock(\"header\");\r\n    header.text = text;\r\n    header.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n    if (isHorizontal) {\r\n        header.width = size;\r\n    } else {\r\n        header.height = size;\r\n    }\r\n\r\n    if (controlFirst) {\r\n        panel.addControl(control);\r\n        panel.addControl(header);\r\n        header.paddingLeft = \"5px\";\r\n    } else {\r\n        panel.addControl(header);\r\n        panel.addControl(control);\r\n        header.paddingRight = \"5px\";\r\n    }\r\n\r\n    header.shadowBlur = control.shadowBlur;\r\n    header.shadowColor = control.shadowColor;\r\n    header.shadowOffsetX = control.shadowOffsetX;\r\n    header.shadowOffsetY = control.shadowOffsetY;\r\n\r\n    return panel;\r\n};\r\n","/*\r\n * Base Gradient class. Should not be used directly.\r\n */\r\n\r\nimport type { ICanvasGradient, ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\n\r\n/**\r\n * Type that represents a single stop on the gradient.\r\n */\r\nexport type GradientColorStop = {\r\n    /**\r\n     * Offset from the start where the color will be applied.\r\n     */\r\n    offset: number;\r\n    /**\r\n     * Color to be applied.\r\n     */\r\n    color: string;\r\n};\r\n\r\n/**\r\n * Class that serves as a base for all the gradients created from context.\r\n */\r\nexport abstract class BaseGradient {\r\n    private _colorStops: GradientColorStop[] = [];\r\n\r\n    private _canvasGradient: CanvasGradient;\r\n    private _context: ICanvasRenderingContext;\r\n    private _gradientDirty: boolean = true;\r\n\r\n    /**\r\n     * Overwritten by child classes to create the canvas gradient.\r\n     * @param context\r\n     */\r\n    protected abstract _createCanvasGradient(context: ICanvasRenderingContext): ICanvasGradient;\r\n\r\n    private _addColorStopsToCanvasGradient() {\r\n        for (const stop of this._colorStops) {\r\n            this._canvasGradient.addColorStop(stop.offset, stop.color);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * If there are any changes or the context changed, regenerate the canvas gradient object. Else,\r\n     * reuse the existing gradient.\r\n     **/\r\n    public getCanvasGradient(context: ICanvasRenderingContext) {\r\n        if (this._gradientDirty || this._context !== context) {\r\n            this._context = context;\r\n            this._canvasGradient = this._createCanvasGradient(context);\r\n            this._addColorStopsToCanvasGradient();\r\n            this._gradientDirty = false;\r\n        }\r\n        return this._canvasGradient;\r\n    }\r\n\r\n    /**\r\n     * Adds a new color stop to the gradient.\r\n     * @param offset the offset of the stop on the gradient. Should be between 0 and 1\r\n     * @param color the color of the stop\r\n     */\r\n    public addColorStop(offset: number, color: string) {\r\n        this._colorStops.push({ offset, color });\r\n        this._gradientDirty = true;\r\n    }\r\n\r\n    /**\r\n     * Removes an existing color stop with the specified offset from the gradient\r\n     * @param offset the offset of the stop to be removed\r\n     */\r\n    public removeColorStop(offset: number) {\r\n        this._colorStops = this._colorStops.filter((colorStop) => colorStop.offset !== offset);\r\n        this._gradientDirty = true;\r\n    }\r\n\r\n    /**\r\n     * Removes all color stops from the gradient\r\n     */\r\n    public clearColorStops() {\r\n        this._colorStops = [];\r\n        this._gradientDirty = true;\r\n    }\r\n\r\n    /** Color stops of the gradient */\r\n    public get colorStops() {\r\n        return this._colorStops;\r\n    }\r\n\r\n    /** Type of the gradient */\r\n    public getClassName() {\r\n        return \"BaseGradient\";\r\n    }\r\n\r\n    /** Serialize into a json object */\r\n    public serialize(serializationObject: any) {\r\n        serializationObject.colorStops = this._colorStops;\r\n        serializationObject.className = this.getClassName();\r\n    }\r\n\r\n    /** Parse from json object */\r\n    public parse(serializationObject: any) {\r\n        this._colorStops = serializationObject.colorStops;\r\n    }\r\n}\r\n","import type { ICanvasGradient, ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport { BaseGradient } from \"./BaseGradient\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\n\r\n/**\r\n * Gradient along a line that connects two coordinates.\r\n * These coordinates are relative to the canvas' space, not to any control's space.\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\r\n */\r\nexport class LinearGradient extends BaseGradient {\r\n    private _x0: number;\r\n    private _y0: number;\r\n    private _x1: number;\r\n    private _y1: number;\r\n\r\n    /**\r\n     * Creates a new linear gradient\r\n     * @param x0\r\n     * @param y0\r\n     * @param x1\r\n     * @param y1\r\n     */\r\n    constructor(x0?: number, y0?: number, x1?: number, y1?: number) {\r\n        super();\r\n        this._x0 = x0 ?? 0;\r\n        this._y0 = y0 ?? 0;\r\n        this._x1 = x1 ?? 0;\r\n        this._y1 = y1 ?? 0;\r\n    }\r\n\r\n    protected _createCanvasGradient(context: ICanvasRenderingContext): ICanvasGradient {\r\n        return context.createLinearGradient(this._x0, this._y0, this._x1, this._y1);\r\n    }\r\n\r\n    /** X axis coordinate of the starting point in the line */\r\n    public get x0() {\r\n        return this._x0;\r\n    }\r\n\r\n    /** X axis coordinate of the ending point in the line */\r\n    public get x1() {\r\n        return this._x1;\r\n    }\r\n\r\n    /** Y axis coordinate of the starting point in the line */\r\n    public get y0() {\r\n        return this._y0;\r\n    }\r\n\r\n    /** Y axis coordinate of the ending point in the line */\r\n    public get y1() {\r\n        return this._y1;\r\n    }\r\n\r\n    /**\r\n     * Class name of the gradient\r\n     * @returns the class name of the gradient\r\n     */\r\n    public getClassName(): string {\r\n        return \"LinearGradient\";\r\n    }\r\n\r\n    /**\r\n     * Serializes this gradient\r\n     * @param serializationObject the object to serialize to\r\n     */\r\n    public serialize(serializationObject: any): void {\r\n        super.serialize(serializationObject);\r\n        serializationObject.x0 = this._x0;\r\n        serializationObject.y0 = this._y0;\r\n        serializationObject.x1 = this._x1;\r\n        serializationObject.y1 = this._y1;\r\n    }\r\n\r\n    /**\r\n     * Parses a gradient from a serialization object\r\n     * @param serializationObject the object to parse from\r\n     */\r\n    public parse(serializationObject: any): void {\r\n        super.parse(serializationObject);\r\n        this._x0 = serializationObject.x0;\r\n        this._y0 = serializationObject.y0;\r\n        this._x1 = serializationObject.x1;\r\n        this._y1 = serializationObject.y1;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.LinearGradient\", LinearGradient);\r\n","import type { ICanvasGradient, ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport { BaseGradient } from \"./BaseGradient\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\n\r\n/**\r\n * Gradient formed from two circles with their own centers and radius.\r\n * The coordinates of the circles centers are relative to the canvas' space, not to any control's space.\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\r\n */\r\nexport class RadialGradient extends BaseGradient {\r\n    private _x0: number;\r\n    private _y0: number;\r\n    private _r0: number;\r\n    private _x1: number;\r\n    private _y1: number;\r\n    private _r1: number;\r\n\r\n    /**\r\n     * Creates a new radial gradient\r\n     * @param x0 x coordinate of the first circle's center\r\n     * @param y0 y coordinate of the first circle's center\r\n     * @param r0 radius of the first circle\r\n     * @param x1 x coordinate of the second circle's center\r\n     * @param y1 y coordinate of the second circle's center\r\n     * @param r1 radius of the second circle\r\n     */\r\n    constructor(x0?: number, y0?: number, r0?: number, x1?: number, y1?: number, r1?: number) {\r\n        super();\r\n        this._x0 = x0 ?? 0;\r\n        this._y0 = y0 ?? 0;\r\n        this._r0 = r0 ?? 0;\r\n        this._x1 = x1 ?? 0;\r\n        this._y1 = y1 ?? 0;\r\n        this._r1 = r1 ?? 0;\r\n    }\r\n\r\n    protected _createCanvasGradient(context: ICanvasRenderingContext): ICanvasGradient {\r\n        return context.createRadialGradient(this._x0, this._y0, this._r0, this._x1, this._y1, this._r1);\r\n    }\r\n\r\n    /** x coordinate of the first circle's center */\r\n    public get x0() {\r\n        return this._x0;\r\n    }\r\n\r\n    /** x coordinate of the second circle's center */\r\n    public get x1() {\r\n        return this._x1;\r\n    }\r\n\r\n    /** y coordinate of the first circle's center */\r\n    public get y0() {\r\n        return this._y0;\r\n    }\r\n\r\n    /** y coordinate of the second circle's center */\r\n    public get y1() {\r\n        return this._y1;\r\n    }\r\n\r\n    /** radius of the first circle */\r\n    public get r0() {\r\n        return this._r0;\r\n    }\r\n\r\n    /** radius of the second circle */\r\n    public get r1() {\r\n        return this._r1;\r\n    }\r\n\r\n    /**\r\n     * Class name of the gradient\r\n     * @returns the class name of the gradient\r\n     */\r\n    public getClassName() {\r\n        return \"RadialGradient\";\r\n    }\r\n\r\n    /**\r\n     * Serializes this gradient\r\n     * @param serializationObject the object to serialize to\r\n     */\r\n    public serialize(serializationObject: any): void {\r\n        super.serialize(serializationObject);\r\n        serializationObject.x0 = this._x0;\r\n        serializationObject.y0 = this._y0;\r\n        serializationObject.r0 = this._r0;\r\n        serializationObject.x1 = this._x1;\r\n        serializationObject.y1 = this._y1;\r\n        serializationObject.r1 = this._r1;\r\n    }\r\n\r\n    /**\r\n     * Parses a gradient from a serialization object\r\n     * @param serializationObject the object to parse from\r\n     */\r\n    public parse(serializationObject: any): void {\r\n        super.parse(serializationObject);\r\n        this._x0 = serializationObject.x0;\r\n        this._y0 = serializationObject.y0;\r\n        this._r0 = serializationObject.r0;\r\n        this._x1 = serializationObject.x1;\r\n        this._y1 = serializationObject.y1;\r\n        this._r1 = serializationObject.r1;\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.RadialGradient\", RadialGradient);\r\n","import { Observable } from \"core/Misc/observable\";\r\nimport type { IDisposable } from \"core/scene\";\r\nimport type { AdvancedDynamicTexture } from \"./advancedDynamicTexture\";\r\nimport { ValueAndUnit } from \"./valueAndUnit\";\r\n\r\n/**\r\n * Define a style used by control to automatically setup properties based on a template.\r\n * Only support font related properties so far\r\n */\r\nexport class Style implements IDisposable {\r\n    private _fontFamily = \"Arial\";\r\n    private _fontStyle = \"\";\r\n    private _fontWeight = \"\";\r\n    /** @internal */\r\n    public _host: AdvancedDynamicTexture;\r\n    /** @internal */\r\n    public _fontSize = new ValueAndUnit(18, ValueAndUnit.UNITMODE_PIXEL, false);\r\n\r\n    /**\r\n     * Observable raised when the style values are changed\r\n     */\r\n    public onChangedObservable = new Observable<Style>();\r\n\r\n    /**\r\n     * Creates a new style object\r\n     * @param host defines the AdvancedDynamicTexture which hosts this style\r\n     */\r\n    public constructor(host: AdvancedDynamicTexture) {\r\n        this._host = host;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the font size\r\n     */\r\n    public get fontSize(): string | number {\r\n        return this._fontSize.toString(this._host);\r\n    }\r\n\r\n    public set fontSize(value: string | number) {\r\n        if (this._fontSize.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._fontSize.fromString(value)) {\r\n            this.onChangedObservable.notifyObservers(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the font family\r\n     */\r\n    public get fontFamily(): string {\r\n        return this._fontFamily;\r\n    }\r\n\r\n    public set fontFamily(value: string) {\r\n        if (this._fontFamily === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontFamily = value;\r\n        this.onChangedObservable.notifyObservers(this);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the font style\r\n     */\r\n    public get fontStyle(): string {\r\n        return this._fontStyle;\r\n    }\r\n\r\n    public set fontStyle(value: string) {\r\n        if (this._fontStyle === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontStyle = value;\r\n        this.onChangedObservable.notifyObservers(this);\r\n    }\r\n\r\n    /** Gets or sets font weight */\r\n    public get fontWeight(): string {\r\n        return this._fontWeight;\r\n    }\r\n\r\n    public set fontWeight(value: string) {\r\n        if (this._fontWeight === value) {\r\n            return;\r\n        }\r\n\r\n        this._fontWeight = value;\r\n        this.onChangedObservable.notifyObservers(this);\r\n    }\r\n\r\n    /** Dispose all associated resources */\r\n    public dispose() {\r\n        this.onChangedObservable.clear();\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Vector2, Vector3, TmpVectors } from \"core/Maths/math.vector\";\r\nimport { Tools } from \"core/Misc/tools\";\r\nimport type { PointerInfoPre, PointerInfo, PointerInfoBase } from \"core/Events/pointerEvents\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\nimport { ClipboardEventTypes, ClipboardInfo } from \"core/Events/clipboardEvents\";\r\nimport type { KeyboardInfoPre } from \"core/Events/keyboardEvents\";\r\nimport { KeyboardEventTypes } from \"core/Events/keyboardEvents\";\r\nimport type { Camera } from \"core/Cameras/camera\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\nimport { DynamicTexture } from \"core/Materials/Textures/dynamicTexture\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { Layer } from \"core/Layers/layer\";\r\nimport type { Engine } from \"core/Engines/engine\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport { Container } from \"./controls/container\";\r\nimport { Control } from \"./controls/control\";\r\nimport type { IFocusableControl } from \"./controls/focusableControl\";\r\nimport { Style } from \"./style\";\r\nimport { Measure } from \"./measure\";\r\nimport { Constants } from \"core/Engines/constants\";\r\nimport { Viewport } from \"core/Maths/math.viewport\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\nimport { WebRequest } from \"core/Misc/webRequest\";\r\nimport type { IPointerEvent, IWheelEvent } from \"core/Events/deviceInputEvents\";\r\nimport { RandomGUID } from \"core/Misc/guid\";\r\nimport { GetClass } from \"core/Misc/typeStore\";\r\nimport { DecodeBase64ToBinary } from \"core/Misc/stringTools\";\r\n\r\nimport type { StandardMaterial } from \"core/Materials/standardMaterial\";\r\n\r\n/**\r\n * Class used to create texture to support 2D GUI elements\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui\r\n */\r\nexport class AdvancedDynamicTexture extends DynamicTexture {\r\n    /** Define the Uurl to load snippets */\r\n    public static SnippetUrl = Constants.SnippetUrl;\r\n\r\n    /** Indicates if some optimizations can be performed in GUI GPU management (the downside is additional memory/GPU texture memory used) */\r\n    public static AllowGPUOptimizations = true;\r\n\r\n    /** Snippet ID if the content was created from the snippet server */\r\n    public snippetId: string;\r\n\r\n    /** Observable that fires when the GUI is ready */\r\n    public onGuiReadyObservable = new Observable<AdvancedDynamicTexture>();\r\n\r\n    private _isDirty = false;\r\n    private _renderObserver: Nullable<Observer<Camera>>;\r\n    private _resizeObserver: Nullable<Observer<Engine>>;\r\n    private _preKeyboardObserver: Nullable<Observer<KeyboardInfoPre>>;\r\n    private _prePointerObserver: Nullable<Observer<PointerInfoPre>>;\r\n    private _sceneRenderObserver: Nullable<Observer<Scene>>;\r\n    private _pointerObserver: Nullable<Observer<PointerInfo>>;\r\n    private _canvasPointerOutObserver: Nullable<Observer<PointerEvent>>;\r\n    private _canvasBlurObserver: Nullable<Observer<Engine>>;\r\n    private _controlAddedObserver: Nullable<Observer<Nullable<Control>>>;\r\n    private _controlRemovedObserver: Nullable<Observer<Nullable<Control>>>;\r\n    private _background: string;\r\n    /** @internal */\r\n    public _rootContainer = new Container(\"root\");\r\n    /** @internal */\r\n    public _lastPickedControl: Control;\r\n    /** @internal */\r\n    public _lastControlOver: { [pointerId: number]: Control } = {};\r\n    /** @internal */\r\n    public _lastControlDown: { [pointerId: number]: Control } = {};\r\n    /** @internal */\r\n    public _capturingControl: { [pointerId: number]: Control } = {};\r\n    /** @internal */\r\n    public _shouldBlockPointer: boolean;\r\n    /** @internal */\r\n    public _layerToDispose: Nullable<Layer>;\r\n    /** @internal */\r\n    public _linkedControls = new Array<Control>();\r\n    private _isFullscreen = false;\r\n    private _fullscreenViewport = new Viewport(0, 0, 1, 1);\r\n    private _idealWidth = 0;\r\n    private _idealHeight = 0;\r\n    private _useSmallestIdeal: boolean = false;\r\n    private _renderAtIdealSize = false;\r\n    private _focusedControl: Nullable<IFocusableControl>;\r\n    private _blockNextFocusCheck = false;\r\n    private _renderScale = 1;\r\n    private _rootElement: Nullable<HTMLElement>;\r\n    private _cursorChanged = false;\r\n    private _defaultMousePointerId = 0;\r\n    private _rootChildrenHaveChanged: boolean = false;\r\n\r\n    /** @internal */\r\n    public _capturedPointerIds = new Set<number>();\r\n\r\n    /** @internal */\r\n    public _numLayoutCalls = 0;\r\n    /** Gets the number of layout calls made the last time the ADT has been rendered */\r\n    public get numLayoutCalls(): number {\r\n        return this._numLayoutCalls;\r\n    }\r\n\r\n    /** @internal */\r\n    public _numRenderCalls = 0;\r\n    /** Gets the number of render calls made the last time the ADT has been rendered */\r\n    public get numRenderCalls(): number {\r\n        return this._numRenderCalls;\r\n    }\r\n\r\n    /**\r\n     * Define type to string to ensure compatibility across browsers\r\n     * Safari doesn't support DataTransfer constructor\r\n     */\r\n    private _clipboardData: string = \"\";\r\n    /**\r\n     * Observable event triggered each time an clipboard event is received from the rendering canvas\r\n     */\r\n    public onClipboardObservable = new Observable<ClipboardInfo>();\r\n    /**\r\n     * Observable event triggered each time a pointer down is intercepted by a control\r\n     */\r\n    public onControlPickedObservable = new Observable<Control>();\r\n    /**\r\n     * Observable event triggered before layout is evaluated\r\n     */\r\n    public onBeginLayoutObservable = new Observable<AdvancedDynamicTexture>();\r\n    /**\r\n     * Observable event triggered after the layout was evaluated\r\n     */\r\n    public onEndLayoutObservable = new Observable<AdvancedDynamicTexture>();\r\n    /**\r\n     * Observable event triggered before the texture is rendered\r\n     */\r\n    public onBeginRenderObservable = new Observable<AdvancedDynamicTexture>();\r\n    /**\r\n     * Observable event triggered after the texture was rendered\r\n     */\r\n    public onEndRenderObservable = new Observable<AdvancedDynamicTexture>();\r\n    /**\r\n     * Gets or sets a boolean defining if alpha is stored as premultiplied\r\n     */\r\n    public premulAlpha = false;\r\n    /**\r\n     * Gets or sets a boolean indicating that the canvas must be reverted on Y when updating the texture\r\n     */\r\n    public applyYInversionOnUpdate = true;\r\n    /**\r\n     * Gets or sets a number used to scale rendering size (2 means that the texture will be twice bigger).\r\n     * Useful when you want more antialiasing\r\n     */\r\n    public get renderScale(): number {\r\n        return this._renderScale;\r\n    }\r\n    public set renderScale(value: number) {\r\n        if (value === this._renderScale) {\r\n            return;\r\n        }\r\n        this._renderScale = value;\r\n        this._onResize();\r\n    }\r\n    /** Gets or sets the background color */\r\n    public get background(): string {\r\n        return this._background;\r\n    }\r\n    public set background(value: string) {\r\n        if (this._background === value) {\r\n            return;\r\n        }\r\n        this._background = value;\r\n        this.markAsDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the ideal width used to design controls.\r\n     * The GUI will then rescale everything accordingly\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#adaptive-scaling\r\n     */\r\n    public get idealWidth(): number {\r\n        return this._idealWidth;\r\n    }\r\n    public set idealWidth(value: number) {\r\n        if (this._idealWidth === value) {\r\n            return;\r\n        }\r\n        this._idealWidth = value;\r\n        this.markAsDirty();\r\n        this._rootContainer._markAllAsDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the ideal height used to design controls.\r\n     * The GUI will then rescale everything accordingly\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#adaptive-scaling\r\n     */\r\n    public get idealHeight(): number {\r\n        return this._idealHeight;\r\n    }\r\n    public set idealHeight(value: number) {\r\n        if (this._idealHeight === value) {\r\n            return;\r\n        }\r\n        this._idealHeight = value;\r\n        this.markAsDirty();\r\n        this._rootContainer._markAllAsDirty();\r\n    }\r\n    /**\r\n     * Gets or sets a boolean indicating if the smallest ideal value must be used if idealWidth and idealHeight are both set\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#adaptive-scaling\r\n     */\r\n    public get useSmallestIdeal(): boolean {\r\n        return this._useSmallestIdeal;\r\n    }\r\n    public set useSmallestIdeal(value: boolean) {\r\n        if (this._useSmallestIdeal === value) {\r\n            return;\r\n        }\r\n        this._useSmallestIdeal = value;\r\n        this.markAsDirty();\r\n        this._rootContainer._markAllAsDirty();\r\n    }\r\n    /**\r\n     * Gets or sets a boolean indicating if adaptive scaling must be used\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#adaptive-scaling\r\n     */\r\n    public get renderAtIdealSize(): boolean {\r\n        return this._renderAtIdealSize;\r\n    }\r\n    public set renderAtIdealSize(value: boolean) {\r\n        if (this._renderAtIdealSize === value) {\r\n            return;\r\n        }\r\n        this._renderAtIdealSize = value;\r\n        this._onResize();\r\n    }\r\n\r\n    /**\r\n     * Gets the ratio used when in \"ideal mode\"\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#adaptive-scaling\r\n     * */\r\n    public get idealRatio(): number {\r\n        let rwidth: number = 0;\r\n        let rheight: number = 0;\r\n\r\n        if (this._idealWidth) {\r\n            rwidth = this.getSize().width / this._idealWidth;\r\n        }\r\n\r\n        if (this._idealHeight) {\r\n            rheight = this.getSize().height / this._idealHeight;\r\n        }\r\n\r\n        if (this._useSmallestIdeal && this._idealWidth && this._idealHeight) {\r\n            return window.innerWidth < window.innerHeight ? rwidth : rheight;\r\n        }\r\n\r\n        if (this._idealWidth) {\r\n            // horizontal\r\n            return rwidth;\r\n        }\r\n\r\n        if (this._idealHeight) {\r\n            // vertical\r\n            return rheight;\r\n        }\r\n\r\n        return 1;\r\n    }\r\n\r\n    /**\r\n     * Gets the underlying layer used to render the texture when in fullscreen mode\r\n     */\r\n    public get layer(): Nullable<Layer> {\r\n        return this._layerToDispose;\r\n    }\r\n    /**\r\n     * Gets the root container control\r\n     */\r\n    public get rootContainer(): Container {\r\n        return this._rootContainer;\r\n    }\r\n    /**\r\n     * Returns an array containing the root container.\r\n     * This is mostly used to let the Inspector introspects the ADT\r\n     * @returns an array containing the rootContainer\r\n     */\r\n    public getChildren(): Array<Container> {\r\n        return [this._rootContainer];\r\n    }\r\n    /**\r\n     * Will return all controls that are inside this texture\r\n     * @param directDescendantsOnly defines if true only direct descendants of 'this' will be considered, if false direct and also indirect (children of children, an so on in a recursive manner) descendants of 'this' will be considered\r\n     * @param predicate defines an optional predicate that will be called on every evaluated child, the predicate must return true for a given child to be part of the result, otherwise it will be ignored\r\n     * @returns all child controls\r\n     */\r\n    public getDescendants(directDescendantsOnly?: boolean, predicate?: (control: Control) => boolean): Control[] {\r\n        return this._rootContainer.getDescendants(directDescendantsOnly, predicate);\r\n    }\r\n\r\n    /**\r\n     * Will return all controls with the given type name\r\n     * @param typeName defines the type name to search for\r\n     * @returns an array of all controls found\r\n     */\r\n    public getControlsByType(typeName: string): Control[] {\r\n        return this._rootContainer.getDescendants(false, (control) => control.typeName === typeName);\r\n    }\r\n\r\n    /**\r\n     * Will return the first control with the given name\r\n     * @param name defines the name to search for\r\n     * @returns the first control found or null\r\n     */\r\n    public getControlByName(name: string): Nullable<Control> {\r\n        return this._getControlByKey(\"name\", name);\r\n    }\r\n\r\n    private _getControlByKey(key: string, value: any): Nullable<Control> {\r\n        return this._rootContainer.getDescendants().find((control) => control[key as keyof Control] === value) || null;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the current focused control\r\n     */\r\n    public get focusedControl(): Nullable<IFocusableControl> {\r\n        return this._focusedControl;\r\n    }\r\n    public set focusedControl(control: Nullable<IFocusableControl>) {\r\n        if (this._focusedControl == control) {\r\n            return;\r\n        }\r\n        if (this._focusedControl) {\r\n            this._focusedControl.onBlur();\r\n        }\r\n        if (control) {\r\n            control.onFocus();\r\n        }\r\n        this._focusedControl = control;\r\n    }\r\n    /**\r\n     * Gets or sets a boolean indicating if the texture must be rendered in background or foreground when in fullscreen mode\r\n     */\r\n    public get isForeground(): boolean {\r\n        if (!this.layer) {\r\n            return true;\r\n        }\r\n        return !this.layer.isBackground;\r\n    }\r\n    public set isForeground(value: boolean) {\r\n        if (!this.layer) {\r\n            return;\r\n        }\r\n        if (this.layer.isBackground === !value) {\r\n            return;\r\n        }\r\n        this.layer.isBackground = !value;\r\n    }\r\n    /**\r\n     * Gets or set information about clipboardData\r\n     */\r\n    public get clipboardData(): string {\r\n        return this._clipboardData;\r\n    }\r\n    public set clipboardData(value: string) {\r\n        this._clipboardData = value;\r\n    }\r\n\r\n    /**\r\n     * If set to true, every scene render will trigger a pointer event for the GUI\r\n     * if it is linked to a mesh or has controls linked to a mesh. This will allow\r\n     * you to catch the pointer moving around the GUI due to camera or mesh movements,\r\n     * but it has a performance cost.\r\n     */\r\n    public checkPointerEveryFrame = false;\r\n    /**\r\n     * Creates a new AdvancedDynamicTexture\r\n     * @param name defines the name of the texture\r\n     * @param width defines the width of the texture\r\n     * @param height defines the height of the texture\r\n     * @param scene defines the hosting scene\r\n     * @param generateMipMaps defines a boolean indicating if mipmaps must be generated (false by default)\r\n     * @param samplingMode defines the texture sampling mode (Texture.NEAREST_SAMPLINGMODE by default)\r\n     * @param invertY defines if the texture needs to be inverted on the y axis during loading (true by default)\r\n     */\r\n    constructor(name: string, width = 0, height = 0, scene?: Nullable<Scene>, generateMipMaps = false, samplingMode = Texture.NEAREST_SAMPLINGMODE, invertY = true) {\r\n        super(name, { width: width, height: height }, scene, generateMipMaps, samplingMode, Constants.TEXTUREFORMAT_RGBA, invertY);\r\n        scene = this.getScene();\r\n        if (!scene || !this._texture) {\r\n            return;\r\n        }\r\n        this.applyYInversionOnUpdate = invertY;\r\n        this._rootElement = scene.getEngine().getInputElement();\r\n        this._renderObserver = scene.onBeforeCameraRenderObservable.add((camera: Camera) => this._checkUpdate(camera));\r\n\r\n        /** Whenever a control is added or removed to the root, we have to recheck the camera projection as it can have changed  */\r\n        this._controlAddedObserver = this._rootContainer.onControlAddedObservable.add((control) => {\r\n            if (control) {\r\n                this._rootChildrenHaveChanged = true;\r\n            }\r\n        });\r\n        this._controlRemovedObserver = this._rootContainer.onControlRemovedObservable.add((control) => {\r\n            if (control) {\r\n                this._rootChildrenHaveChanged = true;\r\n            }\r\n        });\r\n        this._preKeyboardObserver = scene.onPreKeyboardObservable.add((info) => {\r\n            if (!this._focusedControl) {\r\n                return;\r\n            }\r\n            if (info.type === KeyboardEventTypes.KEYDOWN) {\r\n                this._focusedControl.processKeyboard(info.event);\r\n            }\r\n            info.skipOnPointerObservable = true;\r\n        });\r\n        this._rootContainer._link(this);\r\n        this.hasAlpha = true;\r\n        if (!width || !height) {\r\n            this._resizeObserver = scene.getEngine().onResizeObservable.add(() => this._onResize());\r\n            this._onResize();\r\n        }\r\n        this._texture.isReady = true;\r\n    }\r\n    /**\r\n     * Get the current class name of the texture useful for serialization or dynamic coding.\r\n     * @returns \"AdvancedDynamicTexture\"\r\n     */\r\n    public getClassName(): string {\r\n        return \"AdvancedDynamicTexture\";\r\n    }\r\n    /**\r\n     * Function used to execute a function on all controls\r\n     * @param func defines the function to execute\r\n     * @param container defines the container where controls belong. If null the root container will be used\r\n     */\r\n    public executeOnAllControls(func: (control: Control) => void, container?: Container) {\r\n        if (!container) {\r\n            container = this._rootContainer;\r\n        }\r\n        func(container);\r\n        for (const child of container.children) {\r\n            if ((<any>child).children) {\r\n                this.executeOnAllControls(func, <Container>child);\r\n                continue;\r\n            }\r\n            func(child);\r\n        }\r\n    }\r\n\r\n    private _useInvalidateRectOptimization = true;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if the InvalidateRect optimization should be turned on\r\n     */\r\n    public get useInvalidateRectOptimization(): boolean {\r\n        return this._useInvalidateRectOptimization;\r\n    }\r\n\r\n    public set useInvalidateRectOptimization(value: boolean) {\r\n        this._useInvalidateRectOptimization = value;\r\n    }\r\n\r\n    // Invalidated rectangle which is the combination of all invalidated controls after they have been rotated into absolute position\r\n    private _invalidatedRectangle: Nullable<Measure> = null;\r\n    /**\r\n     * Invalidates a rectangle area on the gui texture\r\n     * @param invalidMinX left most position of the rectangle to invalidate in the texture\r\n     * @param invalidMinY top most position of the rectangle to invalidate in the texture\r\n     * @param invalidMaxX right most position of the rectangle to invalidate in the texture\r\n     * @param invalidMaxY bottom most position of the rectangle to invalidate in the texture\r\n     */\r\n    public invalidateRect(invalidMinX: number, invalidMinY: number, invalidMaxX: number, invalidMaxY: number) {\r\n        if (!this._useInvalidateRectOptimization) {\r\n            return;\r\n        }\r\n        if (!this._invalidatedRectangle) {\r\n            this._invalidatedRectangle = new Measure(invalidMinX, invalidMinY, invalidMaxX - invalidMinX + 1, invalidMaxY - invalidMinY + 1);\r\n        } else {\r\n            // Compute intersection\r\n            const maxX = Math.ceil(Math.max(this._invalidatedRectangle.left + this._invalidatedRectangle.width - 1, invalidMaxX));\r\n            const maxY = Math.ceil(Math.max(this._invalidatedRectangle.top + this._invalidatedRectangle.height - 1, invalidMaxY));\r\n            this._invalidatedRectangle.left = Math.floor(Math.min(this._invalidatedRectangle.left, invalidMinX));\r\n            this._invalidatedRectangle.top = Math.floor(Math.min(this._invalidatedRectangle.top, invalidMinY));\r\n            this._invalidatedRectangle.width = maxX - this._invalidatedRectangle.left + 1;\r\n            this._invalidatedRectangle.height = maxY - this._invalidatedRectangle.top + 1;\r\n        }\r\n    }\r\n    /**\r\n     * Marks the texture as dirty forcing a complete update\r\n     */\r\n    public markAsDirty() {\r\n        this._isDirty = true;\r\n    }\r\n    /**\r\n     * Helper function used to create a new style\r\n     * @returns a new style\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui#styles\r\n     */\r\n    public createStyle(): Style {\r\n        return new Style(this);\r\n    }\r\n    /**\r\n     * Adds a new control to the root container\r\n     * @param control defines the control to add\r\n     * @returns the current texture\r\n     */\r\n    public addControl(control: Control): AdvancedDynamicTexture {\r\n        this._rootContainer.addControl(control);\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes a control from the root container\r\n     * @param control defines the control to remove\r\n     * @returns the current texture\r\n     */\r\n    public removeControl(control: Control): AdvancedDynamicTexture {\r\n        this._rootContainer.removeControl(control);\r\n        return this;\r\n    }\r\n    /**\r\n     * Moves overlapped controls towards a position where it is not overlapping anymore.\r\n     * Please note that this method alters linkOffsetXInPixels and linkOffsetYInPixels.\r\n     * @param overlapGroup the overlap group which will be processed or undefined to process all overlap groups\r\n     * @param deltaStep the step size (speed) to reach the target non overlapping position (default 0.1)\r\n     * @param repelFactor how much is the control repelled by other controls\r\n     */\r\n    public moveToNonOverlappedPosition(overlapGroup?: number | Control[], deltaStep = 1, repelFactor = 1) {\r\n        let controlsForGroup: Control[];\r\n        if (Array.isArray(overlapGroup)) {\r\n            controlsForGroup = overlapGroup;\r\n        } else {\r\n            const descendants = this.getDescendants(true);\r\n            // get only the controls with an overlapGroup property set\r\n            // if the overlapGroup parameter is set, filter the controls and get only the controls belonging to that overlapGroup\r\n            controlsForGroup = overlapGroup === undefined ? descendants.filter((c) => c.overlapGroup !== undefined) : descendants.filter((c) => c.overlapGroup === overlapGroup);\r\n        }\r\n\r\n        controlsForGroup.forEach((control1) => {\r\n            let velocity = Vector2.Zero();\r\n            const center = new Vector2(control1.centerX, control1.centerY);\r\n\r\n            controlsForGroup.forEach((control2) => {\r\n                if (control1 !== control2 && AdvancedDynamicTexture._Overlaps(control1, control2)) {\r\n                    // if the two controls overlaps get a direction vector from one control's center to another control's center\r\n                    const diff = center.subtract(new Vector2(control2.centerX, control2.centerY));\r\n                    const diffLength = diff.length();\r\n\r\n                    if (diffLength > 0) {\r\n                        // calculate the velocity\r\n                        velocity = velocity.add(diff.normalize().scale(repelFactor / diffLength));\r\n                    }\r\n                }\r\n            });\r\n\r\n            if (velocity.length() > 0) {\r\n                // move the control along the direction vector away from the overlapping control\r\n                velocity = velocity.normalize().scale(deltaStep * (control1.overlapDeltaMultiplier ?? 1));\r\n                control1.linkOffsetXInPixels += velocity.x;\r\n                control1.linkOffsetYInPixels += velocity.y;\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Release all resources\r\n     */\r\n    public dispose(): void {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        this._rootElement = null;\r\n        scene.onBeforeCameraRenderObservable.remove(this._renderObserver);\r\n        if (this._resizeObserver) {\r\n            scene.getEngine().onResizeObservable.remove(this._resizeObserver);\r\n        }\r\n        if (this._prePointerObserver) {\r\n            scene.onPrePointerObservable.remove(this._prePointerObserver);\r\n        }\r\n        if (this._sceneRenderObserver) {\r\n            scene.onBeforeRenderObservable.remove(this._sceneRenderObserver);\r\n        }\r\n        if (this._pointerObserver) {\r\n            scene.onPointerObservable.remove(this._pointerObserver);\r\n        }\r\n        if (this._preKeyboardObserver) {\r\n            scene.onPreKeyboardObservable.remove(this._preKeyboardObserver);\r\n        }\r\n        if (this._canvasPointerOutObserver) {\r\n            scene.getEngine().onCanvasPointerOutObservable.remove(this._canvasPointerOutObserver);\r\n        }\r\n        if (this._canvasBlurObserver) {\r\n            scene.getEngine().onCanvasBlurObservable.remove(this._canvasBlurObserver);\r\n        }\r\n        if (this._controlAddedObserver) {\r\n            this._rootContainer.onControlAddedObservable.remove(this._controlAddedObserver);\r\n        }\r\n        if (this._controlRemovedObserver) {\r\n            this._rootContainer.onControlRemovedObservable.remove(this._controlRemovedObserver);\r\n        }\r\n        if (this._layerToDispose) {\r\n            this._layerToDispose.texture = null;\r\n            this._layerToDispose.dispose();\r\n            this._layerToDispose = null;\r\n        }\r\n        this._rootContainer.dispose();\r\n        this.onClipboardObservable.clear();\r\n        this.onControlPickedObservable.clear();\r\n        this.onBeginRenderObservable.clear();\r\n        this.onEndRenderObservable.clear();\r\n        this.onBeginLayoutObservable.clear();\r\n        this.onEndLayoutObservable.clear();\r\n        this.onGuiReadyObservable.clear();\r\n        super.dispose();\r\n    }\r\n    private _onResize(): void {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        // Check size\r\n        const engine = scene.getEngine();\r\n        const textureSize = this.getSize();\r\n        let renderWidth = engine.getRenderWidth() * this._renderScale;\r\n        let renderHeight = engine.getRenderHeight() * this._renderScale;\r\n\r\n        if (this._renderAtIdealSize) {\r\n            if (this._idealWidth) {\r\n                renderHeight = (renderHeight * this._idealWidth) / renderWidth;\r\n                renderWidth = this._idealWidth;\r\n            } else if (this._idealHeight) {\r\n                renderWidth = (renderWidth * this._idealHeight) / renderHeight;\r\n                renderHeight = this._idealHeight;\r\n            }\r\n        }\r\n        if (textureSize.width !== renderWidth || textureSize.height !== renderHeight) {\r\n            this.scaleTo(renderWidth, renderHeight);\r\n            this.markAsDirty();\r\n            if (this._idealWidth || this._idealHeight) {\r\n                this._rootContainer._markAllAsDirty();\r\n            }\r\n        }\r\n        this.invalidateRect(0, 0, textureSize.width - 1, textureSize.height - 1);\r\n    }\r\n    /** @internal */\r\n    public _getGlobalViewport(): Viewport {\r\n        const size = this.getSize();\r\n        const globalViewPort = this._fullscreenViewport.toGlobal(size.width, size.height);\r\n\r\n        const targetX = Math.round(globalViewPort.width * (1 / this.rootContainer.scaleX));\r\n        const targetY = Math.round(globalViewPort.height * (1 / this.rootContainer.scaleY));\r\n\r\n        globalViewPort.x += (globalViewPort.width - targetX) / 2;\r\n        globalViewPort.y += (globalViewPort.height - targetY) / 2;\r\n\r\n        globalViewPort.width = targetX;\r\n        globalViewPort.height = targetY;\r\n\r\n        return globalViewPort;\r\n    }\r\n    /**\r\n     * Get screen coordinates for a vector3\r\n     * @param position defines the position to project\r\n     * @param worldMatrix defines the world matrix to use\r\n     * @returns the projected position\r\n     */\r\n    public getProjectedPosition(position: Vector3, worldMatrix: Matrix): Vector2 {\r\n        const result = this.getProjectedPositionWithZ(position, worldMatrix);\r\n        return new Vector2(result.x, result.y);\r\n    }\r\n\r\n    /**\r\n     * Get screen coordinates for a vector3\r\n     * @param position defines the position to project\r\n     * @param worldMatrix defines the world matrix to use\r\n     * @returns the projected position with Z\r\n     */\r\n    public getProjectedPositionWithZ(position: Vector3, worldMatrix: Matrix): Vector3 {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return Vector3.Zero();\r\n        }\r\n        const globalViewport = this._getGlobalViewport();\r\n        const projectedPosition = Vector3.Project(position, worldMatrix, scene.getTransformMatrix(), globalViewport);\r\n        return new Vector3(projectedPosition.x, projectedPosition.y, projectedPosition.z);\r\n    }\r\n\r\n    private _checkUpdate(camera: Camera, skipUpdate?: boolean): void {\r\n        if (this._layerToDispose) {\r\n            if ((camera.layerMask & this._layerToDispose.layerMask) === 0) {\r\n                return;\r\n            }\r\n        }\r\n        if (this._isFullscreen && this._linkedControls.length) {\r\n            const scene = this.getScene();\r\n            if (!scene) {\r\n                return;\r\n            }\r\n            const globalViewport = this._getGlobalViewport();\r\n            for (const control of this._linkedControls) {\r\n                if (!control.isVisible) {\r\n                    continue;\r\n                }\r\n                const mesh = control._linkedMesh as AbstractMesh;\r\n                if (!mesh || mesh.isDisposed()) {\r\n                    Tools.SetImmediate(() => {\r\n                        control.linkWithMesh(null);\r\n                    });\r\n                    continue;\r\n                }\r\n                const position = mesh.getBoundingInfo ? mesh.getBoundingInfo().boundingSphere.center : (Vector3.ZeroReadOnly as Vector3);\r\n                const projectedPosition = Vector3.Project(position, mesh.getWorldMatrix(), scene.getTransformMatrix(), globalViewport);\r\n                if (projectedPosition.z < 0 || projectedPosition.z > 1) {\r\n                    control.notRenderable = true;\r\n                    continue;\r\n                }\r\n                control.notRenderable = false;\r\n                if (this.useInvalidateRectOptimization) {\r\n                    control.invalidateRect();\r\n                }\r\n\r\n                control._moveToProjectedPosition(projectedPosition);\r\n            }\r\n        }\r\n        if (!this._isDirty && !this._rootContainer.isDirty) {\r\n            return;\r\n        }\r\n        this._isDirty = false;\r\n        this._render(skipUpdate);\r\n        if (!skipUpdate) {\r\n            this.update(this.applyYInversionOnUpdate, this.premulAlpha, AdvancedDynamicTexture.AllowGPUOptimizations);\r\n        }\r\n    }\r\n\r\n    private _clearMeasure = new Measure(0, 0, 0, 0);\r\n\r\n    private _render(skipRender?: boolean): void {\r\n        const textureSize = this.getSize();\r\n        const renderWidth = textureSize.width;\r\n        const renderHeight = textureSize.height;\r\n\r\n        const context = this.getContext();\r\n        context.font = \"18px Arial\";\r\n        context.strokeStyle = \"white\";\r\n\r\n        if (this.onGuiReadyObservable.hasObservers()) {\r\n            this._checkGuiIsReady();\r\n        }\r\n\r\n        /** We have to recheck the camera projection in the case the root control's children have changed  */\r\n        if (this._rootChildrenHaveChanged) {\r\n            const camera = this.getScene()?.activeCamera;\r\n            if (camera) {\r\n                this._rootChildrenHaveChanged = false;\r\n                this._checkUpdate(camera, true);\r\n            }\r\n        }\r\n\r\n        // Layout\r\n        this.onBeginLayoutObservable.notifyObservers(this);\r\n        const measure = new Measure(0, 0, renderWidth, renderHeight);\r\n        this._numLayoutCalls = 0;\r\n        this._rootContainer._layout(measure, context);\r\n        this.onEndLayoutObservable.notifyObservers(this);\r\n        this._isDirty = false; // Restoring the dirty state that could have been set by controls during layout processing\r\n\r\n        if (skipRender) {\r\n            return;\r\n        }\r\n\r\n        // Clear\r\n        if (this._invalidatedRectangle) {\r\n            this._clearMeasure.copyFrom(this._invalidatedRectangle);\r\n        } else {\r\n            this._clearMeasure.copyFromFloats(0, 0, renderWidth, renderHeight);\r\n        }\r\n        context.clearRect(this._clearMeasure.left, this._clearMeasure.top, this._clearMeasure.width, this._clearMeasure.height);\r\n        if (this._background) {\r\n            context.save();\r\n            context.fillStyle = this._background;\r\n            context.fillRect(this._clearMeasure.left, this._clearMeasure.top, this._clearMeasure.width, this._clearMeasure.height);\r\n            context.restore();\r\n        }\r\n\r\n        // Render\r\n        this.onBeginRenderObservable.notifyObservers(this);\r\n        this._numRenderCalls = 0;\r\n        this._rootContainer._render(context, this._invalidatedRectangle);\r\n        this.onEndRenderObservable.notifyObservers(this);\r\n        this._invalidatedRectangle = null;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    public _changeCursor(cursor: string) {\r\n        if (this._rootElement) {\r\n            this._rootElement.style.cursor = cursor;\r\n            this._cursorChanged = true;\r\n        }\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    public _registerLastControlDown(control: Control, pointerId: number) {\r\n        this._lastControlDown[pointerId] = control;\r\n        this.onControlPickedObservable.notifyObservers(control);\r\n    }\r\n    private _doPicking(x: number, y: number, pi: Nullable<PointerInfoBase>, type: number, pointerId: number, buttonIndex: number, deltaX?: number, deltaY?: number): void {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        const engine = scene.getEngine();\r\n        const textureSize = this.getSize();\r\n        if (this._isFullscreen) {\r\n            const camera = scene.cameraToUseForPointers || scene.activeCamera;\r\n            if (!camera) {\r\n                return;\r\n            }\r\n            const viewport = camera.viewport;\r\n            x = x * (textureSize.width / (engine.getRenderWidth() * viewport.width));\r\n            y = y * (textureSize.height / (engine.getRenderHeight() * viewport.height));\r\n        }\r\n        if (this._capturingControl[pointerId]) {\r\n            if (this._capturingControl[pointerId].isPointerBlocker) {\r\n                this._shouldBlockPointer = true;\r\n            }\r\n            this._capturingControl[pointerId]._processObservables(type, x, y, pi, pointerId, buttonIndex);\r\n            return;\r\n        }\r\n\r\n        this._cursorChanged = false;\r\n        if (!this._rootContainer._processPicking(x, y, pi, type, pointerId, buttonIndex, deltaX, deltaY)) {\r\n            if (!scene.doNotHandleCursors) {\r\n                this._changeCursor(\"\");\r\n            }\r\n            if (type === PointerEventTypes.POINTERMOVE) {\r\n                if (this._lastControlOver[pointerId]) {\r\n                    this._lastControlOver[pointerId]._onPointerOut(this._lastControlOver[pointerId], pi);\r\n                    delete this._lastControlOver[pointerId];\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!this._cursorChanged && !scene.doNotHandleCursors) {\r\n            this._changeCursor(\"\");\r\n        }\r\n        this._manageFocus();\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    public _cleanControlAfterRemovalFromList(list: { [pointerId: number]: Control }, control: Control) {\r\n        for (const pointerId in list) {\r\n            if (!Object.prototype.hasOwnProperty.call(list, pointerId)) {\r\n                continue;\r\n            }\r\n            const lastControlOver = list[pointerId];\r\n            if (lastControlOver === control) {\r\n                delete list[pointerId];\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    public _cleanControlAfterRemoval(control: Control) {\r\n        this._cleanControlAfterRemovalFromList(this._lastControlDown, control);\r\n        this._cleanControlAfterRemovalFromList(this._lastControlOver, control);\r\n    }\r\n\r\n    /**\r\n     * This function will run a pointer event on this ADT and will trigger any pointer events on any controls\r\n     * This will work on a fullscreen ADT only. For mesh based ADT, simulate pointer events using the scene directly.\r\n     * @param x pointer X on the canvas for the picking\r\n     * @param y pointer Y on the canvas for the picking\r\n     * @param pi optional pointer information\r\n     */\r\n    public pick(x: number, y: number, pi: Nullable<PointerInfoPre> = null) {\r\n        if (this._isFullscreen && this._scene) {\r\n            this._translateToPicking(this._scene, new Viewport(0, 0, 0, 0), pi, x, y);\r\n        }\r\n    }\r\n\r\n    private _translateToPicking(scene: Scene, tempViewport: Viewport, pi: Nullable<PointerInfoPre>, x: number = scene.pointerX, y: number = scene.pointerY) {\r\n        const camera = scene.cameraToUseForPointers || scene.activeCamera;\r\n        const engine = scene.getEngine();\r\n        const originalCameraToUseForPointers = scene.cameraToUseForPointers;\r\n\r\n        if (!camera) {\r\n            tempViewport.x = 0;\r\n            tempViewport.y = 0;\r\n            tempViewport.width = engine.getRenderWidth();\r\n            tempViewport.height = engine.getRenderHeight();\r\n        } else {\r\n            if (camera.rigCameras.length) {\r\n                // rig camera - we need to find the camera to use for this event\r\n                const rigViewport = new Viewport(0, 0, 1, 1);\r\n                camera.rigCameras.forEach((rigCamera) => {\r\n                    // generate the viewport of this camera\r\n                    rigCamera.viewport.toGlobalToRef(engine.getRenderWidth(), engine.getRenderHeight(), rigViewport);\r\n                    const transformedX = x / engine.getHardwareScalingLevel() - rigViewport.x;\r\n                    const transformedY = y / engine.getHardwareScalingLevel() - (engine.getRenderHeight() - rigViewport.y - rigViewport.height);\r\n                    // check if the pointer is in the camera's viewport\r\n                    if (transformedX < 0 || transformedY < 0 || x > rigViewport.width || y > rigViewport.height) {\r\n                        // out of viewport - don't use this camera\r\n                        return;\r\n                    }\r\n                    // set the camera to use for pointers until this pointer loop is over\r\n                    scene.cameraToUseForPointers = rigCamera;\r\n                    // set the viewport\r\n                    tempViewport.x = rigViewport.x;\r\n                    tempViewport.y = rigViewport.y;\r\n                    tempViewport.width = rigViewport.width;\r\n                    tempViewport.height = rigViewport.height;\r\n                });\r\n            } else {\r\n                camera.viewport.toGlobalToRef(engine.getRenderWidth(), engine.getRenderHeight(), tempViewport);\r\n            }\r\n        }\r\n\r\n        const transformedX = x / engine.getHardwareScalingLevel() - tempViewport.x;\r\n        const transformedY = y / engine.getHardwareScalingLevel() - (engine.getRenderHeight() - tempViewport.y - tempViewport.height);\r\n        this._shouldBlockPointer = false;\r\n        // Do picking modifies _shouldBlockPointer\r\n        if (pi) {\r\n            const pointerId = (pi.event as IPointerEvent).pointerId || this._defaultMousePointerId;\r\n            this._doPicking(transformedX, transformedY, pi, pi.type, pointerId, pi.event.button, (<IWheelEvent>pi.event).deltaX, (<IWheelEvent>pi.event).deltaY);\r\n            // Avoid overwriting a true skipOnPointerObservable to false\r\n            if (this._shouldBlockPointer || this._capturingControl[pointerId]) {\r\n                pi.skipOnPointerObservable = true;\r\n            }\r\n        } else {\r\n            this._doPicking(transformedX, transformedY, null, PointerEventTypes.POINTERMOVE, this._defaultMousePointerId, 0);\r\n        }\r\n        // if overridden by a rig camera - reset back to the original value\r\n        scene.cameraToUseForPointers = originalCameraToUseForPointers;\r\n    }\r\n\r\n    /** Attach to all scene events required to support pointer events */\r\n    public attach(): void {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return;\r\n        }\r\n\r\n        const tempViewport = new Viewport(0, 0, 0, 0);\r\n\r\n        this._prePointerObserver = scene.onPrePointerObservable.add((pi) => {\r\n            if (\r\n                scene.isPointerCaptured((<IPointerEvent>pi.event).pointerId) &&\r\n                pi.type === PointerEventTypes.POINTERUP &&\r\n                !this._capturedPointerIds.has((pi.event as IPointerEvent).pointerId)\r\n            ) {\r\n                return;\r\n            }\r\n            if (\r\n                pi.type !== PointerEventTypes.POINTERMOVE &&\r\n                pi.type !== PointerEventTypes.POINTERUP &&\r\n                pi.type !== PointerEventTypes.POINTERDOWN &&\r\n                pi.type !== PointerEventTypes.POINTERWHEEL\r\n            ) {\r\n                return;\r\n            }\r\n\r\n            if (pi.type === PointerEventTypes.POINTERMOVE) {\r\n                // Avoid pointerMove events firing while the pointer is captured by the scene\r\n                if (scene.isPointerCaptured((<IPointerEvent>pi.event).pointerId)) {\r\n                    return;\r\n                }\r\n                if ((pi.event as IPointerEvent).pointerId) {\r\n                    this._defaultMousePointerId = (pi.event as IPointerEvent).pointerId; // This is required to make sure we have the correct pointer ID for wheel\r\n                }\r\n            }\r\n            this._translateToPicking(scene, tempViewport, pi);\r\n        });\r\n        this._attachPickingToSceneRender(scene, () => this._translateToPicking(scene, tempViewport, null), false);\r\n        this._attachToOnPointerOut(scene);\r\n        this._attachToOnBlur(scene);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    private _onClipboardCopy = (rawEvt: Event) => {\r\n        const evt = rawEvt as ClipboardEvent;\r\n        const ev = new ClipboardInfo(ClipboardEventTypes.COPY, evt);\r\n        this.onClipboardObservable.notifyObservers(ev);\r\n        evt.preventDefault();\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    private _onClipboardCut = (rawEvt: Event) => {\r\n        const evt = rawEvt as ClipboardEvent;\r\n        const ev = new ClipboardInfo(ClipboardEventTypes.CUT, evt);\r\n        this.onClipboardObservable.notifyObservers(ev);\r\n        evt.preventDefault();\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    private _onClipboardPaste = (rawEvt: Event) => {\r\n        const evt = rawEvt as ClipboardEvent;\r\n        const ev = new ClipboardInfo(ClipboardEventTypes.PASTE, evt);\r\n        this.onClipboardObservable.notifyObservers(ev);\r\n        evt.preventDefault();\r\n    };\r\n    /**\r\n     * Register the clipboard Events onto the canvas\r\n     */\r\n    public registerClipboardEvents(): void {\r\n        self.addEventListener(\"copy\", this._onClipboardCopy, false);\r\n        self.addEventListener(\"cut\", this._onClipboardCut, false);\r\n        self.addEventListener(\"paste\", this._onClipboardPaste, false);\r\n    }\r\n    /**\r\n     * Unregister the clipboard Events from the canvas\r\n     */\r\n    public unRegisterClipboardEvents(): void {\r\n        self.removeEventListener(\"copy\", this._onClipboardCopy);\r\n        self.removeEventListener(\"cut\", this._onClipboardCut);\r\n        self.removeEventListener(\"paste\", this._onClipboardPaste);\r\n    }\r\n\r\n    /**\r\n     * Transform uvs from mesh space to texture space, taking the texture into account\r\n     * @param uv the uvs in mesh space\r\n     * @returns the uvs in texture space\r\n     */\r\n    private _transformUvs(uv: Vector2): Vector2 {\r\n        const textureMatrix = this.getTextureMatrix();\r\n        let result;\r\n        if (textureMatrix.isIdentityAs3x2()) {\r\n            result = uv;\r\n        } else {\r\n            const homogeneousTextureMatrix = TmpVectors.Matrix[0];\r\n\r\n            textureMatrix.getRowToRef(0, TmpVectors.Vector4[0]);\r\n            textureMatrix.getRowToRef(1, TmpVectors.Vector4[1]);\r\n            textureMatrix.getRowToRef(2, TmpVectors.Vector4[2]);\r\n\r\n            const r0 = TmpVectors.Vector4[0];\r\n            const r1 = TmpVectors.Vector4[1];\r\n            const r2 = TmpVectors.Vector4[2];\r\n\r\n            homogeneousTextureMatrix.setRowFromFloats(0, r0.x, r0.y, 0, 0);\r\n            homogeneousTextureMatrix.setRowFromFloats(1, r1.x, r1.y, 0, 0);\r\n            homogeneousTextureMatrix.setRowFromFloats(2, 0, 0, 1, 0);\r\n            homogeneousTextureMatrix.setRowFromFloats(3, r2.x, r2.y, 0, 1);\r\n\r\n            result = TmpVectors.Vector2[0];\r\n            Vector2.TransformToRef(uv, homogeneousTextureMatrix, result);\r\n        }\r\n\r\n        // In wrap and mirror mode, the texture coordinate for coordinates more than 1 is the fractional part of the coordinate\r\n        if (this.wrapU === Texture.WRAP_ADDRESSMODE || this.wrapU === Texture.MIRROR_ADDRESSMODE) {\r\n            if (result.x > 1) {\r\n                let fX = result.x - Math.trunc(result.x);\r\n                // In mirror mode, the sign of the texture coordinate depends on the integer part -\r\n                // odd integers means it is mirrored from the original coordinate\r\n                if (this.wrapU === Texture.MIRROR_ADDRESSMODE && Math.trunc(result.x) % 2 === 1) {\r\n                    fX = 1 - fX;\r\n                }\r\n                result.x = fX;\r\n            }\r\n        }\r\n        if (this.wrapV === Texture.WRAP_ADDRESSMODE || this.wrapV === Texture.MIRROR_ADDRESSMODE) {\r\n            if (result.y > 1) {\r\n                let fY = result.y - Math.trunc(result.y);\r\n                if (this.wrapV === Texture.MIRROR_ADDRESSMODE && Math.trunc(result.x) % 2 === 1) {\r\n                    fY = 1 - fY;\r\n                }\r\n                result.y = fY;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Connect the texture to a hosting mesh to enable interactions\r\n     * @param mesh defines the mesh to attach to\r\n     * @param supportPointerMove defines a boolean indicating if pointer move events must be catched as well\r\n     */\r\n    public attachToMesh(mesh: AbstractMesh, supportPointerMove = true): void {\r\n        const scene = this.getScene();\r\n        if (!scene) {\r\n            return;\r\n        }\r\n\r\n        if (this._pointerObserver) {\r\n            scene.onPointerObservable.remove(this._pointerObserver);\r\n        }\r\n\r\n        this._pointerObserver = scene.onPointerObservable.add((pi) => {\r\n            if (\r\n                pi.type !== PointerEventTypes.POINTERMOVE &&\r\n                pi.type !== PointerEventTypes.POINTERUP &&\r\n                pi.type !== PointerEventTypes.POINTERDOWN &&\r\n                pi.type !== PointerEventTypes.POINTERWHEEL\r\n            ) {\r\n                return;\r\n            }\r\n\r\n            if (pi.type === PointerEventTypes.POINTERMOVE && (pi.event as IPointerEvent).pointerId) {\r\n                this._defaultMousePointerId = (pi.event as IPointerEvent).pointerId; // This is required to make sure we have the correct pointer ID for wheel\r\n            }\r\n\r\n            const pointerId = (pi.event as IPointerEvent).pointerId || this._defaultMousePointerId;\r\n            if (pi.pickInfo && pi.pickInfo.hit && pi.pickInfo.pickedMesh === mesh) {\r\n                let uv = pi.pickInfo.getTextureCoordinates();\r\n                if (uv) {\r\n                    uv = this._transformUvs(uv);\r\n                    const size = this.getSize();\r\n                    this._doPicking(\r\n                        uv.x * size.width,\r\n                        (this.applyYInversionOnUpdate ? 1.0 - uv.y : uv.y) * size.height,\r\n                        pi,\r\n                        pi.type,\r\n                        pointerId,\r\n                        pi.event.button,\r\n                        (<IWheelEvent>pi.event).deltaX,\r\n                        (<IWheelEvent>pi.event).deltaY\r\n                    );\r\n                }\r\n            } else if (pi.type === PointerEventTypes.POINTERUP) {\r\n                if (this._lastControlDown[pointerId]) {\r\n                    this._lastControlDown[pointerId]._forcePointerUp(pointerId);\r\n                }\r\n                delete this._lastControlDown[pointerId];\r\n                if (this.focusedControl) {\r\n                    const friendlyControls = this.focusedControl.keepsFocusWith();\r\n                    let canMoveFocus = true;\r\n                    if (friendlyControls) {\r\n                        for (const control of friendlyControls) {\r\n                            // Same host, no need to keep the focus\r\n                            if (this === control._host) {\r\n                                continue;\r\n                            }\r\n                            // Different hosts\r\n                            const otherHost = control._host;\r\n                            if (otherHost._lastControlOver[pointerId] && otherHost._lastControlOver[pointerId].isAscendant(control)) {\r\n                                canMoveFocus = false;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (canMoveFocus) {\r\n                        this.focusedControl = null;\r\n                    }\r\n                }\r\n            } else if (pi.type === PointerEventTypes.POINTERMOVE) {\r\n                if (this._lastControlOver[pointerId]) {\r\n                    this._lastControlOver[pointerId]._onPointerOut(this._lastControlOver[pointerId], pi, true);\r\n                }\r\n                delete this._lastControlOver[pointerId];\r\n            }\r\n        });\r\n        mesh.enablePointerMoveEvents = supportPointerMove;\r\n        this._attachPickingToSceneRender(\r\n            scene,\r\n            () => {\r\n                const pointerId = this._defaultMousePointerId;\r\n                const pick = scene?.pick(scene.pointerX, scene.pointerY);\r\n                if (pick && pick.hit && pick.pickedMesh === mesh) {\r\n                    let uv = pick.getTextureCoordinates();\r\n                    if (uv) {\r\n                        uv = this._transformUvs(uv);\r\n                        const size = this.getSize();\r\n                        this._doPicking(uv.x * size.width, (this.applyYInversionOnUpdate ? 1.0 - uv.y : uv.y) * size.height, null, PointerEventTypes.POINTERMOVE, pointerId, 0);\r\n                    }\r\n                } else {\r\n                    if (this._lastControlOver[pointerId]) {\r\n                        this._lastControlOver[pointerId]._onPointerOut(this._lastControlOver[pointerId], null, true);\r\n                    }\r\n                    delete this._lastControlOver[pointerId];\r\n                }\r\n            },\r\n            true\r\n        );\r\n        this._attachToOnPointerOut(scene);\r\n        this._attachToOnBlur(scene);\r\n    }\r\n    /**\r\n     * Move the focus to a specific control\r\n     * @param control defines the control which will receive the focus\r\n     */\r\n    public moveFocusToControl(control: IFocusableControl): void {\r\n        this.focusedControl = control;\r\n        this._lastPickedControl = <any>control;\r\n        this._blockNextFocusCheck = true;\r\n    }\r\n    private _manageFocus(): void {\r\n        if (this._blockNextFocusCheck) {\r\n            this._blockNextFocusCheck = false;\r\n            this._lastPickedControl = <any>this._focusedControl;\r\n            return;\r\n        }\r\n        // Focus management\r\n        if (this._focusedControl) {\r\n            if (this._focusedControl !== <any>this._lastPickedControl) {\r\n                if (this._lastPickedControl.isFocusInvisible) {\r\n                    return;\r\n                }\r\n                this.focusedControl = null;\r\n            }\r\n        }\r\n    }\r\n    private _attachPickingToSceneRender(scene: Scene, pickFunction: () => void, forcePicking: boolean) {\r\n        this._sceneRenderObserver = scene.onBeforeRenderObservable.add(() => {\r\n            if (!this.checkPointerEveryFrame) {\r\n                return;\r\n            }\r\n            if (this._linkedControls.length > 0 || forcePicking) {\r\n                pickFunction();\r\n            }\r\n        });\r\n    }\r\n    private _attachToOnPointerOut(scene: Scene): void {\r\n        this._canvasPointerOutObserver = scene.getEngine().onCanvasPointerOutObservable.add((pointerEvent) => {\r\n            if (this._lastControlOver[pointerEvent.pointerId]) {\r\n                this._lastControlOver[pointerEvent.pointerId]._onPointerOut(this._lastControlOver[pointerEvent.pointerId], null);\r\n            }\r\n            delete this._lastControlOver[pointerEvent.pointerId];\r\n            if (this._lastControlDown[pointerEvent.pointerId] && this._lastControlDown[pointerEvent.pointerId] !== this._capturingControl[pointerEvent.pointerId]) {\r\n                this._lastControlDown[pointerEvent.pointerId]._forcePointerUp(pointerEvent.pointerId);\r\n                delete this._lastControlDown[pointerEvent.pointerId];\r\n            }\r\n        });\r\n    }\r\n    private _attachToOnBlur(scene: Scene): void {\r\n        this._canvasBlurObserver = scene.getEngine().onCanvasBlurObservable.add(() => {\r\n            Object.entries(this._lastControlDown).forEach(([, value]) => {\r\n                value._onCanvasBlur();\r\n            });\r\n            this.focusedControl = null;\r\n            this._lastControlDown = {};\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Serializes the entire GUI system\r\n     * @returns an object with the JSON serialized data\r\n     */\r\n    public serializeContent(): any {\r\n        const size = this.getSize();\r\n        const serializationObject = {\r\n            root: {},\r\n            width: size.width,\r\n            height: size.height,\r\n        };\r\n\r\n        this._rootContainer.serialize(serializationObject.root);\r\n\r\n        return serializationObject;\r\n    }\r\n\r\n    /**\r\n     * Recreate the content of the ADT from a JSON object\r\n     * @param serializedObject define the JSON serialized object to restore from\r\n     * @param scaleToSize defines whether to scale to texture to the saved size\r\n     */\r\n    public parseSerializedObject(serializedObject: any, scaleToSize?: boolean) {\r\n        this._rootContainer = Control.Parse(serializedObject.root, this) as Container;\r\n        if (scaleToSize) {\r\n            const width = serializedObject.width;\r\n            const height = serializedObject.height;\r\n            if (typeof width === \"number\" && typeof height === \"number\" && width >= 0 && height >= 0) {\r\n                this.scaleTo(width, height);\r\n            } else {\r\n                // scales the GUI to a default size if none was available in the serialized content\r\n                this.scaleTo(1920, 1080);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clones the ADT\r\n     * @param newName defines the name of the new ADT\r\n     * @returns the clone of the ADT\r\n     */\r\n    public clone(newName?: string): AdvancedDynamicTexture {\r\n        const scene = this.getScene();\r\n\r\n        if (!scene) {\r\n            return this;\r\n        }\r\n        const size = this.getSize();\r\n        const data = this.serializeContent();\r\n        const clone = new AdvancedDynamicTexture(newName ?? \"Clone of \" + this.name, size.width, size.height, scene, !this.noMipmap, this.samplingMode);\r\n        clone.parseSerializedObject(data);\r\n\r\n        return clone;\r\n    }\r\n\r\n    /**\r\n     * Recreate the content of the ADT from a JSON object\r\n     * @param serializedObject define the JSON serialized object to restore from\r\n     * @param scaleToSize defines whether to scale to texture to the saved size\r\n     * @deprecated Please use parseSerializedObject instead\r\n     */\r\n    public parseContent = this.parseSerializedObject;\r\n\r\n    /**\r\n     * Recreate the content of the ADT from a snippet saved by the GUI editor\r\n     * @param snippetId defines the snippet to load\r\n     * @param scaleToSize defines whether to scale to texture to the saved size\r\n     * @param appendToAdt if provided the snippet will be appended to the adt. Otherwise a fullscreen ADT will be created.\r\n     * @returns a promise that will resolve on success\r\n     */\r\n    public static async ParseFromSnippetAsync(snippetId: string, scaleToSize?: boolean, appendToAdt?: AdvancedDynamicTexture): Promise<AdvancedDynamicTexture> {\r\n        const adt = appendToAdt ?? AdvancedDynamicTexture.CreateFullscreenUI(\"ADT from snippet\");\r\n        if (snippetId === \"_BLANK\") {\r\n            return adt;\r\n        }\r\n\r\n        const serialized = await AdvancedDynamicTexture._LoadURLContentAsync(AdvancedDynamicTexture.SnippetUrl + \"/\" + snippetId.replace(/#/g, \"/\"), true);\r\n        adt.parseSerializedObject(serialized, scaleToSize);\r\n        return adt;\r\n    }\r\n\r\n    /**\r\n     * Recreate the content of the ADT from a snippet saved by the GUI editor\r\n     * @param snippetId defines the snippet to load\r\n     * @param scaleToSize defines whether to scale to texture to the saved size\r\n     * @returns a promise that will resolve on success\r\n     */\r\n    public parseFromSnippetAsync(snippetId: string, scaleToSize?: boolean): Promise<AdvancedDynamicTexture> {\r\n        return AdvancedDynamicTexture.ParseFromSnippetAsync(snippetId, scaleToSize, this);\r\n    }\r\n\r\n    /**\r\n     * Recreate the content of the ADT from a url json\r\n     * @param url defines the url to load\r\n     * @param scaleToSize defines whether to scale to texture to the saved size\r\n     * @param appendToAdt if provided the snippet will be appended to the adt. Otherwise a fullscreen ADT will be created.\r\n     * @returns a promise that will resolve on success\r\n     */\r\n    public static async ParseFromFileAsync(url: string, scaleToSize?: boolean, appendToAdt?: AdvancedDynamicTexture): Promise<AdvancedDynamicTexture> {\r\n        const adt = appendToAdt ?? AdvancedDynamicTexture.CreateFullscreenUI(\"ADT from URL\");\r\n        const serialized = await AdvancedDynamicTexture._LoadURLContentAsync(url);\r\n        adt.parseSerializedObject(serialized, scaleToSize);\r\n        return adt;\r\n    }\r\n\r\n    /**\r\n     * Recreate the content of the ADT from a url json\r\n     * @param url defines the url to load\r\n     * @param scaleToSize defines whether to scale to texture to the saved size\r\n     * @returns a promise that will resolve on success\r\n     */\r\n    public parseFromURLAsync(url: string, scaleToSize?: boolean): Promise<AdvancedDynamicTexture> {\r\n        return AdvancedDynamicTexture.ParseFromFileAsync(url, scaleToSize, this);\r\n    }\r\n\r\n    private static _LoadURLContentAsync(url: string, snippet: boolean = false): Promise<any> {\r\n        if (url === \"\") {\r\n            return Promise.reject(\"No URL provided\");\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n            const request = new WebRequest();\r\n            request.addEventListener(\"readystatechange\", () => {\r\n                if (request.readyState == 4) {\r\n                    if (request.status == 200) {\r\n                        let gui;\r\n                        if (snippet) {\r\n                            const payload = JSON.parse(JSON.parse(request.responseText).jsonPayload);\r\n                            gui = payload.encodedGui ? new TextDecoder(\"utf-8\").decode(DecodeBase64ToBinary(payload.encodedGui)) : payload.gui;\r\n                        } else {\r\n                            gui = request.responseText;\r\n                        }\r\n                        const serializationObject = JSON.parse(gui);\r\n                        resolve(serializationObject);\r\n                    } else {\r\n                        reject(\"Unable to load\");\r\n                    }\r\n                }\r\n            });\r\n            request.open(\"GET\", url);\r\n            request.send();\r\n        });\r\n    }\r\n\r\n    // Statics\r\n    /**\r\n     * Compares two rectangle based controls for pixel overlap\r\n     * @param control1 The first control to compare\r\n     * @param control2 The second control to compare\r\n     * @returns true if overlaps, otherwise false\r\n     */\r\n    private static _Overlaps(control1: Control, control2: Control) {\r\n        return !(\r\n            control1.centerX > control2.centerX + control2.widthInPixels ||\r\n            control1.centerX + control1.widthInPixels < control2.centerX ||\r\n            control1.centerY + control1.heightInPixels < control2.centerY ||\r\n            control1.centerY > control2.centerY + control2.heightInPixels\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Creates a new AdvancedDynamicTexture in projected mode (ie. attached to a mesh)\r\n     * @param mesh defines the mesh which will receive the texture\r\n     * @param width defines the texture width (1024 by default)\r\n     * @param height defines the texture height (1024 by default)\r\n     * @param supportPointerMove defines a boolean indicating if the texture must capture move events (true by default)\r\n     * @param onlyAlphaTesting defines a boolean indicating that alpha blending will not be used (only alpha testing) (false by default)\r\n     * @param invertY defines if the texture needs to be inverted on the y axis during loading (true by default)\r\n     * @param materialSetupCallback defines a custom way of creating and setting up the material on the mesh\r\n     * @returns a new AdvancedDynamicTexture\r\n     */\r\n    public static CreateForMesh(\r\n        mesh: AbstractMesh,\r\n        width = 1024,\r\n        height = 1024,\r\n        supportPointerMove = true,\r\n        onlyAlphaTesting = false,\r\n        invertY?: boolean,\r\n        materialSetupCallback: (mesh: AbstractMesh, uniqueId: string, texture: AdvancedDynamicTexture, onlyAlphaTesting: boolean) => void = this._CreateMaterial\r\n    ): AdvancedDynamicTexture {\r\n        // use a unique ID in name so serialization will work even if you create two ADTs for a single mesh\r\n        const uniqueId = RandomGUID();\r\n        const result = new AdvancedDynamicTexture(\r\n            `AdvancedDynamicTexture for ${mesh.name} [${uniqueId}]`,\r\n            width,\r\n            height,\r\n            mesh.getScene(),\r\n            true,\r\n            Texture.TRILINEAR_SAMPLINGMODE,\r\n            invertY\r\n        );\r\n\r\n        materialSetupCallback(mesh, uniqueId, result, onlyAlphaTesting);\r\n\r\n        result.attachToMesh(mesh, supportPointerMove);\r\n        return result;\r\n    }\r\n\r\n    private static _CreateMaterial(mesh: AbstractMesh, uniqueId: string, texture: AdvancedDynamicTexture, onlyAlphaTesting: boolean): void {\r\n        const internalClassType = GetClass(\"BABYLON.StandardMaterial\");\r\n        if (!internalClassType) {\r\n            throw \"StandardMaterial needs to be imported before as it contains a side-effect required by your code.\";\r\n        }\r\n\r\n        const material: StandardMaterial = new internalClassType(`AdvancedDynamicTextureMaterial for ${mesh.name} [${uniqueId}]`, mesh.getScene());\r\n        material.backFaceCulling = false;\r\n        material.diffuseColor = Color3.Black();\r\n        material.specularColor = Color3.Black();\r\n        if (onlyAlphaTesting) {\r\n            material.diffuseTexture = texture;\r\n            material.emissiveTexture = texture;\r\n            texture.hasAlpha = true;\r\n        } else {\r\n            material.emissiveTexture = texture;\r\n            material.opacityTexture = texture;\r\n        }\r\n        mesh.material = material;\r\n    }\r\n\r\n    /**\r\n     * Creates a new AdvancedDynamicTexture in projected mode (ie. attached to a mesh) BUT do not create a new material for the mesh. You will be responsible for connecting the texture\r\n     * @param mesh defines the mesh which will receive the texture\r\n     * @param width defines the texture width (1024 by default)\r\n     * @param height defines the texture height (1024 by default)\r\n     * @param supportPointerMove defines a boolean indicating if the texture must capture move events (true by default)\r\n     * @param invertY defines if the texture needs to be inverted on the y axis during loading (true by default)\r\n     * @returns a new AdvancedDynamicTexture\r\n     */\r\n    public static CreateForMeshTexture(mesh: AbstractMesh, width = 1024, height = 1024, supportPointerMove = true, invertY?: boolean): AdvancedDynamicTexture {\r\n        const result = new AdvancedDynamicTexture(mesh.name + \" AdvancedDynamicTexture\", width, height, mesh.getScene(), true, Texture.TRILINEAR_SAMPLINGMODE, invertY);\r\n        result.attachToMesh(mesh, supportPointerMove);\r\n        return result;\r\n    }\r\n    /**\r\n     * Creates a new AdvancedDynamicTexture in fullscreen mode.\r\n     * In this mode the texture will rely on a layer for its rendering.\r\n     * This allows it to be treated like any other layer.\r\n     * As such, if you have a multi camera setup, you can set the layerMask on the GUI as well.\r\n     * LayerMask is set through advancedTexture.layer.layerMask\r\n     * @param name defines name for the texture\r\n     * @param foreground defines a boolean indicating if the texture must be rendered in foreground (default is true)\r\n     * @param scene defines the hosting scene\r\n     * @param sampling defines the texture sampling mode (Texture.BILINEAR_SAMPLINGMODE by default)\r\n     * @param adaptiveScaling defines whether to automatically scale root to match hardwarescaling (false by default)\r\n     * @returns a new AdvancedDynamicTexture\r\n     */\r\n    public static CreateFullscreenUI(\r\n        name: string,\r\n        foreground: boolean = true,\r\n        scene: Nullable<Scene> = null,\r\n        sampling = Texture.BILINEAR_SAMPLINGMODE,\r\n        adaptiveScaling: boolean = false\r\n    ): AdvancedDynamicTexture {\r\n        const result = new AdvancedDynamicTexture(name, 0, 0, scene, false, sampling);\r\n        // Display\r\n        const resultScene = result.getScene();\r\n        const layer = new Layer(name + \"_layer\", null, resultScene, !foreground);\r\n        layer.texture = result;\r\n        result._layerToDispose = layer;\r\n        result._isFullscreen = true;\r\n\r\n        if (adaptiveScaling && resultScene) {\r\n            const newScale = 1 / resultScene.getEngine().getHardwareScalingLevel();\r\n            result._rootContainer.scaleX = newScale;\r\n            result._rootContainer.scaleY = newScale;\r\n        }\r\n\r\n        // Attach\r\n        result.attach();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Scales the texture\r\n     * @param ratio the scale factor to apply to both width and height\r\n     */\r\n    public scale(ratio: number): void {\r\n        super.scale(ratio);\r\n        this.markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Resizes the texture\r\n     * @param width the new width\r\n     * @param height the new height\r\n     */\r\n    public scaleTo(width: number, height: number): void {\r\n        super.scaleTo(width, height);\r\n        this.markAsDirty();\r\n    }\r\n\r\n    private _checkGuiIsReady() {\r\n        if (this.guiIsReady()) {\r\n            this.onGuiReadyObservable.notifyObservers(this);\r\n\r\n            this.onGuiReadyObservable.clear();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns true if all the GUI components are ready to render\r\n     */\r\n    public guiIsReady(): boolean {\r\n        return this._rootContainer.isReady();\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { PerfCounter } from \"core/Misc/perfCounter\";\r\nimport type { IDisposable } from \"core/scene\";\r\n\r\nimport type { AdvancedDynamicTexture } from \"./advancedDynamicTexture\";\r\n\r\n/**\r\n * This class can be used to get instrumentation data from a AdvancedDynamicTexture object\r\n */\r\nexport class AdvancedDynamicTextureInstrumentation implements IDisposable {\r\n    private _captureRenderTime = false;\r\n    private _renderTime = new PerfCounter();\r\n\r\n    private _captureLayoutTime = false;\r\n    private _layoutTime = new PerfCounter();\r\n\r\n    // Observers\r\n    private _onBeginRenderObserver: Nullable<Observer<AdvancedDynamicTexture>> = null;\r\n    private _onEndRenderObserver: Nullable<Observer<AdvancedDynamicTexture>> = null;\r\n    private _onBeginLayoutObserver: Nullable<Observer<AdvancedDynamicTexture>> = null;\r\n    private _onEndLayoutObserver: Nullable<Observer<AdvancedDynamicTexture>> = null;\r\n\r\n    // Properties\r\n\r\n    /**\r\n     * Gets the perf counter used to capture render time\r\n     */\r\n    public get renderTimeCounter(): PerfCounter {\r\n        return this._renderTime;\r\n    }\r\n\r\n    /**\r\n     * Gets the perf counter used to capture layout time\r\n     */\r\n    public get layoutTimeCounter(): PerfCounter {\r\n        return this._layoutTime;\r\n    }\r\n\r\n    /**\r\n     * Enable or disable the render time capture\r\n     */\r\n    public get captureRenderTime(): boolean {\r\n        return this._captureRenderTime;\r\n    }\r\n\r\n    public set captureRenderTime(value: boolean) {\r\n        if (value === this._captureRenderTime) {\r\n            return;\r\n        }\r\n\r\n        this._captureRenderTime = value;\r\n\r\n        if (value) {\r\n            this._onBeginRenderObserver = this.texture.onBeginRenderObservable.add(() => {\r\n                this._renderTime.beginMonitoring();\r\n            });\r\n\r\n            this._onEndRenderObserver = this.texture.onEndRenderObservable.add(() => {\r\n                this._renderTime.endMonitoring(true);\r\n            });\r\n        } else {\r\n            this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver);\r\n            this._onBeginRenderObserver = null;\r\n            this.texture.onEndRenderObservable.remove(this._onEndRenderObserver);\r\n            this._onEndRenderObserver = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Enable or disable the layout time capture\r\n     */\r\n    public get captureLayoutTime(): boolean {\r\n        return this._captureLayoutTime;\r\n    }\r\n\r\n    public set captureLayoutTime(value: boolean) {\r\n        if (value === this._captureLayoutTime) {\r\n            return;\r\n        }\r\n\r\n        this._captureLayoutTime = value;\r\n\r\n        if (value) {\r\n            this._onBeginLayoutObserver = this.texture.onBeginLayoutObservable.add(() => {\r\n                this._layoutTime.beginMonitoring();\r\n            });\r\n\r\n            this._onEndLayoutObserver = this.texture.onEndLayoutObservable.add(() => {\r\n                this._layoutTime.endMonitoring(true);\r\n            });\r\n        } else {\r\n            this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver);\r\n            this._onBeginLayoutObserver = null;\r\n            this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver);\r\n            this._onEndLayoutObserver = null;\r\n        }\r\n    }\r\n    /**\r\n     * Instantiates a new advanced dynamic texture instrumentation.\r\n     * This class can be used to get instrumentation data from an AdvancedDynamicTexture object\r\n     * @param texture Defines the AdvancedDynamicTexture to instrument\r\n     */\r\n    public constructor(\r\n        /**\r\n         * Define the instrumented AdvancedDynamicTexture.\r\n         */\r\n        public texture: AdvancedDynamicTexture\r\n    ) {}\r\n\r\n    /**\r\n     * Dispose and release associated resources.\r\n     */\r\n    public dispose() {\r\n        this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver);\r\n        this._onBeginRenderObserver = null;\r\n        this.texture.onEndRenderObservable.remove(this._onEndRenderObserver);\r\n        this._onEndRenderObserver = null;\r\n        this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver);\r\n        this._onBeginLayoutObserver = null;\r\n        this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver);\r\n        this._onEndLayoutObserver = null;\r\n\r\n        (<any>this.texture) = null;\r\n    }\r\n}\r\n","import { GetClass } from \"core/Misc/typeStore\";\r\nimport type { Nullable } from \"core/types\";\r\n\r\nconst XmlLoaderError = \"XmlLoader Exception : XML file is malformed or corrupted.\";\r\n\r\n/**\r\n * Class used to load GUI via XML.\r\n */\r\nexport class XmlLoader {\r\n    private _nodes: any = {};\r\n\r\n    private _nodeTypes: any = {\r\n        element: 1,\r\n        attribute: 2,\r\n        text: 3,\r\n    };\r\n\r\n    private _isLoaded: boolean = false;\r\n\r\n    private _objectAttributes: any = {\r\n        textHorizontalAlignment: 1,\r\n        textVerticalAlignment: 2,\r\n        horizontalAlignment: 3,\r\n        verticalAlignment: 4,\r\n        stretch: 5,\r\n    };\r\n\r\n    private _rootNode: any;\r\n\r\n    private _parentClass: any;\r\n\r\n    /**\r\n     * Create a new xml loader\r\n     * @param parentClass Sets the class context. Used when the loader is instanced inside a class and not in a global context\r\n     */\r\n    constructor(parentClass: any = null) {\r\n        if (parentClass) {\r\n            this._parentClass = parentClass;\r\n        }\r\n    }\r\n\r\n    private _getChainElement(attributeValue: any): any {\r\n        let element: any = window;\r\n\r\n        if (this._parentClass) {\r\n            element = this._parentClass;\r\n        }\r\n        let value = attributeValue;\r\n        value = value.split(\".\");\r\n\r\n        for (let i = 0; i < value.length; i++) {\r\n            element = element[value[i]];\r\n        }\r\n        return element;\r\n    }\r\n\r\n    private _getClassAttribute(attributeName: string): any {\r\n        const attribute = attributeName.split(\".\");\r\n        const className = GetClass(\"BABYLON.GUI.\" + attribute[0]);\r\n        return className[attribute[1]];\r\n    }\r\n\r\n    private _createGuiElement(node: any, parent: any, linkParent: boolean = true): void {\r\n        try {\r\n            const className = GetClass(\"BABYLON.GUI.\" + node.nodeName);\r\n            const guiNode = new className();\r\n\r\n            if (parent && linkParent) {\r\n                parent.addControl(guiNode);\r\n            }\r\n\r\n            for (let i = 0; i < node.attributes.length; i++) {\r\n                if (node.attributes[i].name.toLowerCase().includes(\"datasource\")) {\r\n                    continue;\r\n                }\r\n\r\n                if (node.attributes[i].name.toLowerCase().includes(\"observable\")) {\r\n                    const element = this._getChainElement(node.attributes[i].value);\r\n                    guiNode[node.attributes[i].name].add(element);\r\n\r\n                    continue;\r\n                } else if (node.attributes[i].name == \"linkWithMesh\") {\r\n                    if (this._parentClass) {\r\n                        guiNode.linkWithMesh(this._parentClass[node.attributes[i].value]);\r\n                    } else {\r\n                        guiNode.linkWithMesh(window[node.attributes[i].value]);\r\n                    }\r\n                } else if (node.attributes[i].value.startsWith(\"{{\") && node.attributes[i].value.endsWith(\"}}\")) {\r\n                    const element = this._getChainElement(node.attributes[i].value.substring(2, node.attributes[i].value.length - 2));\r\n                    guiNode[node.attributes[i].name] = element;\r\n                } else if (!this._objectAttributes[node.attributes[i].name]) {\r\n                    if (node.attributes[i].value == \"true\" || node.attributes[i].value == \"false\") {\r\n                        guiNode[node.attributes[i].name] = node.attributes[i].value == \"true\";\r\n                    } else {\r\n                        guiNode[node.attributes[i].name] = !isNaN(Number(node.attributes[i].value)) ? Number(node.attributes[i].value) : node.attributes[i].value;\r\n                    }\r\n                } else {\r\n                    guiNode[node.attributes[i].name] = this._getClassAttribute(node.attributes[i].value);\r\n                }\r\n            }\r\n\r\n            if (!node.attributes.getNamedItem(\"id\")) {\r\n                this._nodes[node.nodeName + Object.keys(this._nodes).length + \"_gen\"] = guiNode;\r\n                return guiNode;\r\n            }\r\n\r\n            let id = node.attributes.getNamedItem(\"id\").value;\r\n            if (id.startsWith(\"{{\") && id.endsWith(\"}}\")) {\r\n                id = this._getChainElement(id.substring(2, id.length - 2));\r\n            }\r\n\r\n            if (!this._nodes[id]) {\r\n                this._nodes[id] = guiNode;\r\n            } else {\r\n                throw \"XmlLoader Exception : Duplicate ID, every element should have an unique ID attribute\";\r\n            }\r\n            return guiNode;\r\n        } catch (exception) {\r\n            throw \"XmlLoader Exception : Error parsing Control \" + node.nodeName + \",\" + exception + \".\";\r\n        }\r\n    }\r\n\r\n    private _parseGrid(node: any, guiNode: any, parent: any): void {\r\n        let width;\r\n        let height;\r\n        let columns;\r\n        const rows = node.children;\r\n        let cells;\r\n        let isPixel = false;\r\n        let cellNode;\r\n        let rowNumber = -1;\r\n        let columnNumber = -1;\r\n        let totalColumnsNumber = 0;\r\n\r\n        for (let i = 0; i < rows.length; i++) {\r\n            if (rows[i].nodeType != this._nodeTypes.element) {\r\n                continue;\r\n            }\r\n            if (rows[i].nodeName != \"Row\") {\r\n                throw \"XmlLoader Exception : Expecting Row node, received \" + rows[i].nodeName;\r\n            }\r\n            rowNumber += 1;\r\n            columns = rows[i].children;\r\n\r\n            if (!rows[i].attributes.getNamedItem(\"height\")) {\r\n                throw \"XmlLoader Exception : Height must be defined for grid rows\";\r\n            }\r\n            height = Number(rows[i].attributes.getNamedItem(\"height\").nodeValue);\r\n            isPixel = rows[i].attributes.getNamedItem(\"isPixel\") ? JSON.parse(rows[i].attributes.getNamedItem(\"isPixel\").nodeValue) : false;\r\n            guiNode.addRowDefinition(height, isPixel);\r\n\r\n            for (let j = 0; j < columns.length; j++) {\r\n                if (columns[j].nodeType != this._nodeTypes.element) {\r\n                    continue;\r\n                }\r\n                if (columns[j].nodeName != \"Column\") {\r\n                    throw \"XmlLoader Exception : Expecting Column node, received \" + columns[j].nodeName;\r\n                }\r\n                columnNumber += 1;\r\n                if (rowNumber > 0 && columnNumber > totalColumnsNumber) {\r\n                    throw \"XmlLoader Exception : In the Grid element, the number of columns is defined in the first row, do not add more columns in the subsequent rows.\";\r\n                }\r\n\r\n                if (rowNumber == 0) {\r\n                    if (!columns[j].attributes.getNamedItem(\"width\")) {\r\n                        throw \"XmlLoader Exception : Width must be defined for all the grid columns in the first row\";\r\n                    }\r\n                    width = Number(columns[j].attributes.getNamedItem(\"width\").nodeValue);\r\n                    isPixel = columns[j].attributes.getNamedItem(\"isPixel\") ? JSON.parse(columns[j].attributes.getNamedItem(\"isPixel\").nodeValue) : false;\r\n                    guiNode.addColumnDefinition(width, isPixel);\r\n                }\r\n\r\n                cells = columns[j].children;\r\n\r\n                for (let k = 0; k < cells.length; k++) {\r\n                    if (cells[k].nodeType != this._nodeTypes.element) {\r\n                        continue;\r\n                    }\r\n                    cellNode = this._createGuiElement(cells[k], guiNode, false);\r\n                    guiNode.addControl(cellNode, rowNumber, columnNumber);\r\n                    if (cells[k].firstChild) {\r\n                        this._parseXml(cells[k].firstChild, cellNode);\r\n                    }\r\n                }\r\n            }\r\n            if (rowNumber == 0) {\r\n                totalColumnsNumber = columnNumber;\r\n            }\r\n            columnNumber = -1;\r\n        }\r\n\r\n        if (node.nextSibling) {\r\n            this._parseXml(node.nextSibling, parent);\r\n        }\r\n    }\r\n\r\n    private _parseElement(node: any, guiNode: any, parent: any): void {\r\n        if (node.firstChild) {\r\n            this._parseXml(node.firstChild, guiNode);\r\n        }\r\n\r\n        if (node.nextSibling) {\r\n            this._parseXml(node.nextSibling, parent);\r\n        }\r\n    }\r\n\r\n    private _prepareSourceElement(node: any, guiNode: any, variable: any, source: any, iterator: any): void {\r\n        if (this._parentClass) {\r\n            this._parentClass[variable] = source[iterator];\r\n        } else {\r\n            window[variable] = source[iterator];\r\n        }\r\n\r\n        if (node.firstChild) {\r\n            this._parseXml(node.firstChild, guiNode, true);\r\n        }\r\n    }\r\n\r\n    private _parseElementsFromSource(node: any, guiNode: any, parent: any): void {\r\n        const dataSource = node.attributes.getNamedItem(\"dataSource\").value;\r\n\r\n        if (!dataSource.includes(\" in \")) {\r\n            throw \"XmlLoader Exception : Malformed XML, Data Source must include an in\";\r\n        } else {\r\n            let isArray = true;\r\n            const splittedSource = dataSource.split(\" in \");\r\n            if (splittedSource.length < 2) {\r\n                throw \"XmlLoader Exception : Malformed XML, Data Source must have an iterator and a source\";\r\n            }\r\n            let source = splittedSource[1];\r\n            if (source.startsWith(\"{\") && source.endsWith(\"}\")) {\r\n                isArray = false;\r\n            }\r\n\r\n            if (!isArray || (source.startsWith(\"[\") && source.endsWith(\"]\"))) {\r\n                source = source.substring(1, source.length - 1);\r\n            }\r\n\r\n            if (this._parentClass) {\r\n                source = this._parentClass[source];\r\n            } else {\r\n                source = window[source];\r\n            }\r\n\r\n            if (isArray) {\r\n                for (let i = 0; i < source.length; i++) {\r\n                    this._prepareSourceElement(node, guiNode, splittedSource[0], source, i);\r\n                }\r\n            } else {\r\n                for (const i in source) {\r\n                    this._prepareSourceElement(node, guiNode, splittedSource[0], source, i);\r\n                }\r\n            }\r\n\r\n            if (node.nextSibling) {\r\n                this._parseXml(node.nextSibling, parent);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _parseXml(node: any, parent: any, generated: boolean = false): void {\r\n        if (node.nodeType != this._nodeTypes.element) {\r\n            if (node.nextSibling) {\r\n                this._parseXml(node.nextSibling, parent, generated);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (generated) {\r\n            node.setAttribute(\"id\", parent.id + (parent._children.length + 1));\r\n        }\r\n\r\n        const guiNode = this._createGuiElement(node, parent);\r\n\r\n        if (!this._rootNode) {\r\n            this._rootNode = guiNode;\r\n        }\r\n\r\n        if (node.nodeName == \"Grid\") {\r\n            this._parseGrid(node, guiNode, parent);\r\n        } else if (!node.attributes.getNamedItem(\"dataSource\")) {\r\n            this._parseElement(node, guiNode, parent);\r\n        } else {\r\n            this._parseElementsFromSource(node, guiNode, parent);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets if the loading has finished.\r\n     * @returns whether the loading has finished or not\r\n     */\r\n    public isLoaded(): boolean {\r\n        return this._isLoaded;\r\n    }\r\n\r\n    /**\r\n     * Gets a loaded node / control by id.\r\n     * @param id the Controls id set in the xml\r\n     * @returns element of type Control\r\n     */\r\n    public getNodeById(id: string): any {\r\n        return this._nodes[id];\r\n    }\r\n\r\n    /**\r\n     * Gets all loaded nodes / controls\r\n     * @returns Array of controls\r\n     */\r\n    public getNodes(): any {\r\n        return this._nodes;\r\n    }\r\n    /**\r\n     * Disposes the loaded layout\r\n     */\r\n    public dispose(): void {\r\n        if (this._rootNode) {\r\n            this._rootNode.dispose();\r\n            this._rootNode = null;\r\n            this._nodes = {};\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Initiates the xml layout loading\r\n     * @param xmlFile defines the xml layout to load\r\n     * @param rootNode defines the node / control to use as a parent for the loaded layout controls.\r\n     * @param onSuccess defines the callback called on layout load successfully.\r\n     * @param onError defines the callback called on layout load failure.\r\n     */\r\n    public loadLayout(xmlFile: any, rootNode: any, onSuccess: Nullable<() => void> = null, onError: Nullable<(error: string) => void> = null): void {\r\n        const xhttp = new XMLHttpRequest();\r\n        xhttp.onload = () => {\r\n            if (xhttp.readyState === 4 && xhttp.status === 200) {\r\n                if (!xhttp.responseXML) {\r\n                    if (onError) {\r\n                        onError(XmlLoaderError);\r\n                        return;\r\n                    } else {\r\n                        throw XmlLoaderError;\r\n                    }\r\n                }\r\n\r\n                const xmlDoc = xhttp.responseXML.documentElement;\r\n                this._parseXml(xmlDoc.firstChild, rootNode);\r\n                this._isLoaded = true;\r\n\r\n                if (onSuccess) {\r\n                    onSuccess();\r\n                }\r\n            }\r\n        };\r\n\r\n        xhttp.onerror = function () {\r\n            if (onError) {\r\n                onError(\"an error occurred during loading the layout\");\r\n            }\r\n        };\r\n\r\n        xhttp.open(\"GET\", xmlFile, true);\r\n        xhttp.send();\r\n    }\r\n    /**\r\n     * Initiates the xml layout loading asynchronously\r\n     * @param xmlFile defines the xml layout to load\r\n     * @param rootNode defines the node / control to use as a parent for the loaded layout controls.\r\n     * @returns Promise\r\n     */\r\n    public async loadLayoutAsync(xmlFile: any, rootNode: any): Promise<any> {\r\n        return new Promise((resolve: any, reject: any) => {\r\n            this.loadLayout(xmlFile, rootNode, resolve, reject);\r\n        });\r\n    }\r\n}\r\n","import { Vector3 } from \"core/Maths/math.vector\";\r\n\r\n/**\r\n * Class used to transport Vector3 information for pointer events\r\n */\r\nexport class Vector3WithInfo extends Vector3 {\r\n    /**\r\n     * Creates a new Vector3WithInfo\r\n     * @param source defines the vector3 data to transport\r\n     * @param buttonIndex defines the current mouse button index\r\n     */\r\n    public constructor(\r\n        source: Vector3,\r\n        /** defines the current mouse button index */\r\n        public buttonIndex: number = 0\r\n    ) {\r\n        super(source.x, source.y, source.z);\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { IBehaviorAware, Behavior } from \"core/Behaviors/behavior\";\r\nimport type { IDisposable, Scene } from \"core/scene\";\r\n\r\nimport type { GUI3DManager } from \"../gui3DManager\";\r\nimport { Vector3WithInfo } from \"../vector3WithInfo\";\r\nimport type { Container3D } from \"./container3D\";\r\n\r\nimport type { TouchButton3D } from \"./touchButton3D\";\r\n\r\n/**\r\n * Class used as base class for controls\r\n */\r\nexport class Control3D implements IDisposable, IBehaviorAware<Control3D> {\r\n    private _node: Nullable<TransformNode>;\r\n    private _downCount = 0;\r\n    private _enterCount = -1;\r\n    private _downPointerIds: { [id: number]: number } = {}; // Store number of pointer downs per ID, from near and far interactions\r\n\r\n    protected _isVisible = true;\r\n\r\n    /** @internal */\r\n    public _host: GUI3DManager;\r\n    /** @internal */\r\n    public _isScaledByManager = false;\r\n\r\n    /** Gets or sets the control position in world space */\r\n    public get position(): Vector3 {\r\n        if (!this._node) {\r\n            return Vector3.Zero();\r\n        }\r\n\r\n        return this._node.position;\r\n    }\r\n\r\n    public set position(value: Vector3) {\r\n        if (!this._node) {\r\n            return;\r\n        }\r\n\r\n        this._node.position = value;\r\n    }\r\n\r\n    /** Gets or sets the control scaling in world space */\r\n    public get scaling(): Vector3 {\r\n        if (!this._node) {\r\n            return new Vector3(1, 1, 1);\r\n        }\r\n\r\n        return this._node.scaling;\r\n    }\r\n\r\n    public set scaling(value: Vector3) {\r\n        if (!this._node) {\r\n            return;\r\n        }\r\n\r\n        this._isScaledByManager = false;\r\n        this._node.scaling = value;\r\n    }\r\n\r\n    /** Callback used to start pointer enter animation */\r\n    public pointerEnterAnimation: () => void;\r\n    /** Callback used to start pointer out animation */\r\n    public pointerOutAnimation: () => void;\r\n    /** Callback used to start pointer down animation */\r\n    public pointerDownAnimation: () => void;\r\n    /** Callback used to start pointer up animation */\r\n    public pointerUpAnimation: () => void;\r\n\r\n    /**\r\n     * An event triggered when the pointer moves over the control\r\n     */\r\n    public onPointerMoveObservable = new Observable<Vector3>();\r\n\r\n    /**\r\n     * An event triggered when the pointer moves out of the control\r\n     */\r\n    public onPointerOutObservable = new Observable<Control3D>();\r\n\r\n    /**\r\n     * An event triggered when the pointer taps the control\r\n     */\r\n    public onPointerDownObservable = new Observable<Vector3WithInfo>();\r\n\r\n    /**\r\n     * An event triggered when pointer is up\r\n     */\r\n    public onPointerUpObservable = new Observable<Vector3WithInfo>();\r\n\r\n    /**\r\n     * An event triggered when a control is clicked on (with a mouse)\r\n     */\r\n    public onPointerClickObservable = new Observable<Vector3WithInfo>();\r\n\r\n    /**\r\n     * An event triggered when pointer enters the control\r\n     */\r\n    public onPointerEnterObservable = new Observable<Control3D>();\r\n\r\n    /**\r\n     * Gets or sets the parent container\r\n     */\r\n    public parent: Nullable<Container3D>;\r\n\r\n    // Behaviors\r\n    private _behaviors = new Array<Behavior<Control3D>>();\r\n\r\n    /**\r\n     * Gets the list of attached behaviors\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/behaviors\r\n     */\r\n    public get behaviors(): Behavior<Control3D>[] {\r\n        return this._behaviors;\r\n    }\r\n\r\n    /**\r\n     * Attach a behavior to the control\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/behaviors\r\n     * @param behavior defines the behavior to attach\r\n     * @returns the current control\r\n     */\r\n    public addBehavior(behavior: Behavior<Control3D>): Control3D {\r\n        const index = this._behaviors.indexOf(behavior);\r\n\r\n        if (index !== -1) {\r\n            return this;\r\n        }\r\n\r\n        behavior.init();\r\n        const scene = this._host.scene;\r\n        if (scene.isLoading) {\r\n            // We defer the attach when the scene will be loaded\r\n            scene.onDataLoadedObservable.addOnce(() => {\r\n                behavior.attach(this);\r\n            });\r\n        } else {\r\n            behavior.attach(this);\r\n        }\r\n        this._behaviors.push(behavior);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Remove an attached behavior\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/behaviors\r\n     * @param behavior defines the behavior to attach\r\n     * @returns the current control\r\n     */\r\n    public removeBehavior(behavior: Behavior<Control3D>): Control3D {\r\n        const index = this._behaviors.indexOf(behavior);\r\n\r\n        if (index === -1) {\r\n            return this;\r\n        }\r\n\r\n        this._behaviors[index].detach();\r\n        this._behaviors.splice(index, 1);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets an attached behavior by name\r\n     * @param name defines the name of the behavior to look for\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/behaviors\r\n     * @returns null if behavior was not found else the requested behavior\r\n     */\r\n    public getBehaviorByName(name: string): Nullable<Behavior<Control3D>> {\r\n        for (const behavior of this._behaviors) {\r\n            if (behavior.name === name) {\r\n                return behavior;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating if the control is visible */\r\n    public get isVisible(): boolean {\r\n        return this._isVisible;\r\n    }\r\n\r\n    public set isVisible(value: boolean) {\r\n        if (this._isVisible === value) {\r\n            return;\r\n        }\r\n\r\n        this._isVisible = value;\r\n\r\n        const mesh = this.mesh;\r\n        if (mesh) {\r\n            mesh.setEnabled(value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new control\r\n     * @param name defines the control name\r\n     */\r\n    constructor(\r\n        /** Defines the control name */\r\n        public name?: string\r\n    ) {}\r\n\r\n    /**\r\n     * Gets a string representing the class name\r\n     */\r\n    public get typeName(): string {\r\n        return this._getTypeName();\r\n    }\r\n\r\n    /**\r\n     * Get the current class name of the control.\r\n     * @returns current class name\r\n     */\r\n    public getClassName(): string {\r\n        return this._getTypeName();\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Control3D\";\r\n    }\r\n\r\n    /**\r\n     * Gets the transform node used by this control\r\n     */\r\n    public get node(): Nullable<TransformNode> {\r\n        return this._node;\r\n    }\r\n\r\n    /**\r\n     * Gets the mesh used to render this control\r\n     */\r\n    public get mesh(): Nullable<AbstractMesh> {\r\n        if (this._node instanceof AbstractMesh) {\r\n            return this._node as AbstractMesh;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Link the control as child of the given node\r\n     * @param node defines the node to link to. Use null to unlink the control\r\n     * @returns the current control\r\n     */\r\n    public linkToTransformNode(node: Nullable<TransformNode>): Control3D {\r\n        if (this._node) {\r\n            this._node.parent = node;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @internal*\r\n     */\r\n    public _prepareNode(scene: Scene): void {\r\n        if (!this._node) {\r\n            this._node = this._createNode(scene);\r\n\r\n            if (!this.node) {\r\n                return;\r\n            }\r\n            this._injectGUI3DReservedDataStore(this.node).control = this; // Store the control on the reservedDataStore field in order to get it when picking\r\n\r\n            const mesh = this.mesh;\r\n            if (mesh) {\r\n                mesh.isPickable = true;\r\n\r\n                this._affectMaterial(mesh);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _injectGUI3DReservedDataStore(node: TransformNode): any {\r\n        node.reservedDataStore = node.reservedDataStore ?? {};\r\n        node.reservedDataStore.GUI3D = node.reservedDataStore.GUI3D ?? {};\r\n        return node.reservedDataStore.GUI3D;\r\n    }\r\n\r\n    /**\r\n     * Node creation.\r\n     * Can be overriden by children\r\n     * @param scene defines the scene where the node must be attached\r\n     * @returns the attached node or null if none. Must return a Mesh or AbstractMesh if there is an attached visible object\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    protected _createNode(scene: Scene): Nullable<TransformNode> {\r\n        // Do nothing by default\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Affect a material to the given mesh\r\n     * @param mesh defines the mesh which will represent the control\r\n     */\r\n    protected _affectMaterial(mesh: AbstractMesh) {\r\n        mesh.material = null;\r\n    }\r\n\r\n    private _isTouchButton3D(control: Control3D): control is TouchButton3D {\r\n        return (control as TouchButton3D)._generatePointerEventType !== undefined;\r\n    }\r\n\r\n    // Pointers\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerMove(target: Control3D, coordinates: Vector3): void {\r\n        this.onPointerMoveObservable.notifyObservers(coordinates, -1, target, this);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerEnter(target: Control3D): boolean {\r\n        if (this._enterCount === -1) {\r\n            // -1 is for touch input, we are now sure we are with a mouse or pencil\r\n            this._enterCount = 0;\r\n        }\r\n\r\n        this._enterCount++;\r\n\r\n        if (this._enterCount > 1) {\r\n            return false;\r\n        }\r\n\r\n        this.onPointerEnterObservable.notifyObservers(this, -1, target, this);\r\n\r\n        if (this.pointerEnterAnimation) {\r\n            this.pointerEnterAnimation();\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerOut(target: Control3D): void {\r\n        this._enterCount--;\r\n\r\n        if (this._enterCount > 0) {\r\n            return;\r\n        }\r\n\r\n        this._enterCount = 0;\r\n\r\n        this.onPointerOutObservable.notifyObservers(this, -1, target, this);\r\n\r\n        if (this.pointerOutAnimation) {\r\n            this.pointerOutAnimation();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerDown(target: Control3D, coordinates: Vector3, pointerId: number, buttonIndex: number): boolean {\r\n        this._downCount++;\r\n        this._downPointerIds[pointerId] = this._downPointerIds[pointerId] + 1 || 1;\r\n\r\n        if (this._downCount !== 1) {\r\n            return false;\r\n        }\r\n\r\n        this.onPointerDownObservable.notifyObservers(new Vector3WithInfo(coordinates, buttonIndex), -1, target, this);\r\n\r\n        if (this.pointerDownAnimation) {\r\n            this.pointerDownAnimation();\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onPointerUp(target: Control3D, coordinates: Vector3, pointerId: number, buttonIndex: number, notifyClick: boolean): void {\r\n        this._downCount--;\r\n        this._downPointerIds[pointerId]--;\r\n\r\n        if (this._downPointerIds[pointerId] <= 0) {\r\n            delete this._downPointerIds[pointerId];\r\n        }\r\n\r\n        if (this._downCount < 0) {\r\n            // Handle if forcePointerUp was called prior to this\r\n            this._downCount = 0;\r\n            return;\r\n        }\r\n\r\n        if (this._downCount == 0) {\r\n            if (notifyClick && (this._enterCount > 0 || this._enterCount === -1)) {\r\n                this.onPointerClickObservable.notifyObservers(new Vector3WithInfo(coordinates, buttonIndex), -1, target, this);\r\n            }\r\n            this.onPointerUpObservable.notifyObservers(new Vector3WithInfo(coordinates, buttonIndex), -1, target, this);\r\n\r\n            if (this.pointerUpAnimation) {\r\n                this.pointerUpAnimation();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public forcePointerUp(pointerId: Nullable<number> = null) {\r\n        if (pointerId !== null) {\r\n            this._onPointerUp(this, Vector3.Zero(), pointerId, 0, true);\r\n        } else {\r\n            for (const key in this._downPointerIds) {\r\n                this._onPointerUp(this, Vector3.Zero(), +key as number, 0, true);\r\n            }\r\n            if (this._downCount > 0) {\r\n                this._downCount = 1;\r\n                this._onPointerUp(this, Vector3.Zero(), 0, 0, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _processObservables(type: number, pickedPoint: Vector3, originMeshPosition: Nullable<Vector3>, pointerId: number, buttonIndex: number): boolean {\r\n        if (this._isTouchButton3D(this) && originMeshPosition) {\r\n            type = this._generatePointerEventType(type, originMeshPosition, this._downCount);\r\n        }\r\n\r\n        if (type === PointerEventTypes.POINTERMOVE) {\r\n            this._onPointerMove(this, pickedPoint);\r\n\r\n            const previousControlOver = this._host._lastControlOver[pointerId];\r\n            if (previousControlOver && previousControlOver !== this) {\r\n                previousControlOver._onPointerOut(this);\r\n            }\r\n\r\n            if (previousControlOver !== this) {\r\n                this._onPointerEnter(this);\r\n            }\r\n\r\n            this._host._lastControlOver[pointerId] = this;\r\n            return true;\r\n        }\r\n\r\n        if (type === PointerEventTypes.POINTERDOWN) {\r\n            this._onPointerDown(this, pickedPoint, pointerId, buttonIndex);\r\n            this._host._lastControlDown[pointerId] = this;\r\n            this._host._lastPickedControl = this;\r\n            return true;\r\n        }\r\n\r\n        if (type === PointerEventTypes.POINTERUP || type === PointerEventTypes.POINTERDOUBLETAP) {\r\n            if (this._host._lastControlDown[pointerId]) {\r\n                this._host._lastControlDown[pointerId]._onPointerUp(this, pickedPoint, pointerId, buttonIndex, true);\r\n            }\r\n            delete this._host._lastControlDown[pointerId];\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /** @internal */\r\n    public _disposeNode(): void {\r\n        if (this._node) {\r\n            this._node.dispose();\r\n            this._node = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        this.onPointerDownObservable.clear();\r\n        this.onPointerEnterObservable.clear();\r\n        this.onPointerMoveObservable.clear();\r\n        this.onPointerOutObservable.clear();\r\n        this.onPointerUpObservable.clear();\r\n        this.onPointerClickObservable.clear();\r\n\r\n        this._disposeNode();\r\n\r\n        // Behaviors\r\n        for (const behavior of this._behaviors) {\r\n            behavior.detach();\r\n        }\r\n    }\r\n}\r\n","import type { Control } from \"../../2D/controls/control\";\r\nimport { AdvancedDynamicTexture } from \"../../2D/advancedDynamicTexture\";\r\nimport type { Nullable } from \"core/types\";\r\nimport { Control3D } from \"./control3D\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\n\r\n/**\r\n * The base class for controls that display content\r\n */\r\nexport class ContentDisplay3D extends Control3D {\r\n    private _content: Control;\r\n    private _facadeTexture: Nullable<AdvancedDynamicTexture>;\r\n    protected _contentResolution = 512;\r\n    protected _contentScaleRatio = 2;\r\n    protected _contentScaleRatioY?: number;\r\n\r\n    /**\r\n     * Gets or sets the GUI 2D content used to display the button's facade\r\n     */\r\n    public get content(): Control {\r\n        return this._content;\r\n    }\r\n\r\n    public set content(value: Control) {\r\n        this._content = value;\r\n\r\n        if (!value || !this._host || !this._host.utilityLayer) {\r\n            return;\r\n        }\r\n\r\n        if (!this._facadeTexture) {\r\n            this._facadeTexture = new AdvancedDynamicTexture(\r\n                \"Facade\",\r\n                this._contentResolution,\r\n                this._contentResolution,\r\n                this._host.utilityLayer.utilityLayerScene,\r\n                true,\r\n                Texture.TRILINEAR_SAMPLINGMODE\r\n            );\r\n            this._setFacadeTextureScaling();\r\n            this._facadeTexture.premulAlpha = true;\r\n        } else {\r\n            this._facadeTexture.rootContainer.clearControls();\r\n        }\r\n\r\n        this._facadeTexture.addControl(value);\r\n\r\n        this._applyFacade(this._facadeTexture);\r\n    }\r\n\r\n    protected _setFacadeTextureScaling() {\r\n        if (this._facadeTexture) {\r\n            this._facadeTexture.rootContainer.scaleX = this._contentScaleRatio;\r\n            this._facadeTexture.rootContainer.scaleY = this._contentScaleRatioY ?? this._contentScaleRatio;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the texture resolution used to render content (512 by default)\r\n     */\r\n    public get contentResolution(): number {\r\n        return this._contentResolution;\r\n    }\r\n\r\n    public set contentResolution(value: number) {\r\n        if (this._contentResolution === value) {\r\n            return;\r\n        }\r\n\r\n        this._contentResolution = value;\r\n        this._resetContent();\r\n    }\r\n\r\n    protected _disposeFacadeTexture() {\r\n        if (this._facadeTexture) {\r\n            this._facadeTexture.dispose();\r\n            this._facadeTexture = null;\r\n        }\r\n    }\r\n\r\n    protected _resetContent() {\r\n        this._disposeFacadeTexture();\r\n        this.content = this._content;\r\n    }\r\n\r\n    /**\r\n     * Apply the facade texture (created from the content property).\r\n     * This function can be overloaded by child classes\r\n     * @param facadeTexture defines the AdvancedDynamicTexture to use\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    protected _applyFacade(facadeTexture: AdvancedDynamicTexture) {}\r\n}\r\n","import { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { ContentDisplay3D } from \"./contentDisplay3D\";\r\n\r\n/**\r\n * Class used as a root to all buttons\r\n */\r\nexport class AbstractButton3D extends ContentDisplay3D {\r\n    /**\r\n     * Creates a new button\r\n     * @param name defines the control name\r\n     */\r\n    constructor(name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"AbstractButton3D\";\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        return new TransformNode(\"button\" + this.name, scene);\r\n    }\r\n}\r\n","import { Vector4 } from \"core/Maths/math.vector\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport type { Material } from \"core/Materials/material\";\r\nimport { StandardMaterial } from \"core/Materials/standardMaterial\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport { AbstractButton3D } from \"./abstractButton3D\";\r\nimport type { AdvancedDynamicTexture } from \"../../2D/advancedDynamicTexture\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\n\r\n/**\r\n * Options used to create a button in 3D\r\n */\r\nexport interface IButton3DCreationOptions {\r\n    /**\r\n     * Width of the button. Default: 1\r\n     */\r\n    width?: number;\r\n\r\n    /**\r\n     * Height of the button. Default: 1\r\n     */\r\n    height?: number;\r\n\r\n    /**\r\n     * Depth of the button. Default: 0.08\r\n     */\r\n    depth?: number;\r\n}\r\n\r\n/**\r\n * Class used to create a button in 3D\r\n */\r\nexport class Button3D extends AbstractButton3D {\r\n    /** @internal */\r\n    protected _currentMaterial: Material;\r\n\r\n    protected _options: IButton3DCreationOptions;\r\n    protected _height: number;\r\n    protected _depth: number;\r\n\r\n    /**\r\n     * Creates a new button\r\n     * @param name defines the control name\r\n     */\r\n    constructor(name?: string, options?: IButton3DCreationOptions) {\r\n        super(name);\r\n\r\n        this._options = {\r\n            width: 1,\r\n            height: 1,\r\n            depth: 0.08,\r\n            ...options,\r\n        };\r\n\r\n        // Default animations\r\n\r\n        this.pointerEnterAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            (<StandardMaterial>this._currentMaterial).emissiveColor = Color3.Red();\r\n        };\r\n\r\n        this.pointerOutAnimation = () => {\r\n            (<StandardMaterial>this._currentMaterial).emissiveColor = Color3.Black();\r\n        };\r\n\r\n        this.pointerDownAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n\r\n            this.mesh.scaling.scaleInPlace(0.95);\r\n        };\r\n\r\n        this.pointerUpAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n\r\n            this.mesh.scaling.scaleInPlace(1.0 / 0.95);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Apply the facade texture (created from the content property).\r\n     * @param facadeTexture defines the AdvancedDynamicTexture to use\r\n     */\r\n    protected _applyFacade(facadeTexture: AdvancedDynamicTexture) {\r\n        (<any>this._currentMaterial).emissiveTexture = facadeTexture;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Button3D\";\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        const faceUV = new Array(6);\r\n\r\n        for (let i = 0; i < 6; i++) {\r\n            faceUV[i] = new Vector4(0, 0, 0, 0);\r\n        }\r\n        if (scene.useRightHandedSystem) {\r\n            // Flip the u on the texture\r\n            faceUV[0].copyFromFloats(1, 0, 0, 1);\r\n        } else {\r\n            faceUV[1].copyFromFloats(0, 0, 1, 1);\r\n        }\r\n\r\n        const mesh = CreateBox(\r\n            this.name + \"_rootMesh\",\r\n            {\r\n                width: this._options.width,\r\n                height: this._options.height,\r\n                depth: this._options.depth,\r\n                faceUV: faceUV,\r\n                wrap: true,\r\n            },\r\n            scene\r\n        );\r\n\r\n        this._contentScaleRatioY = (this._contentScaleRatio * this._options.width!) / this._options.height!;\r\n        this._setFacadeTextureScaling();\r\n\r\n        return mesh;\r\n    }\r\n\r\n    protected _affectMaterial(mesh: AbstractMesh) {\r\n        const material = new StandardMaterial(this.name + \"Material\", mesh.getScene());\r\n        material.specularColor = Color3.Black();\r\n\r\n        mesh.material = material;\r\n        this._currentMaterial = material;\r\n\r\n        this._resetContent();\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        this._disposeFacadeTexture();\r\n\r\n        if (this._currentMaterial) {\r\n            this._currentMaterial.dispose();\r\n        }\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport { Control3D } from \"./control3D\";\r\n\r\n/**\r\n * Class used to create containers for controls\r\n */\r\nexport class Container3D extends Control3D {\r\n    private _blockLayout = false;\r\n\r\n    /**\r\n     * Gets the list of child controls\r\n     */\r\n    protected _children = new Array<Control3D>();\r\n\r\n    /**\r\n     * Gets the list of child controls\r\n     */\r\n    public get children(): Array<Control3D> {\r\n        return this._children;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if the layout must be blocked (default is false).\r\n     * This is helpful to optimize layout operation when adding multiple children in a row\r\n     */\r\n    public get blockLayout(): boolean {\r\n        return this._blockLayout;\r\n    }\r\n\r\n    public set blockLayout(value: boolean) {\r\n        if (this._blockLayout === value) {\r\n            return;\r\n        }\r\n\r\n        this._blockLayout = value;\r\n\r\n        if (!this._blockLayout) {\r\n            this._arrangeChildren();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new container\r\n     * @param name defines the container name\r\n     */\r\n    constructor(name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    /**\r\n     * Force the container to update the layout. Please note that it will not take blockLayout property in account\r\n     * @returns the current container\r\n     */\r\n    public updateLayout(): Container3D {\r\n        this._arrangeChildren();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if the given control is in the children of this control\r\n     * @param control defines the control to check\r\n     * @returns true if the control is in the child list\r\n     */\r\n    public containsControl(control: Control3D): boolean {\r\n        return this._children.indexOf(control) !== -1;\r\n    }\r\n\r\n    /**\r\n     * Adds a control to the children of this control\r\n     * @param control defines the control to add\r\n     * @returns the current container\r\n     */\r\n    public addControl(control: Control3D): Container3D {\r\n        const index = this._children.indexOf(control);\r\n\r\n        if (index !== -1) {\r\n            return this;\r\n        }\r\n        control.parent = this;\r\n        control._host = this._host;\r\n\r\n        this._children.push(control);\r\n\r\n        if (this._host.utilityLayer) {\r\n            control._prepareNode(this._host.utilityLayer.utilityLayerScene);\r\n\r\n            if (control.node) {\r\n                control.node.parent = this.node;\r\n            }\r\n\r\n            if (!this.blockLayout) {\r\n                this._arrangeChildren();\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * This function will be called everytime a new control is added\r\n     */\r\n    protected _arrangeChildren() {}\r\n\r\n    protected _createNode(scene: Scene): Nullable<TransformNode> {\r\n        return new TransformNode(\"ContainerNode\", scene);\r\n    }\r\n\r\n    /**\r\n     * Removes a control from the children of this control\r\n     * @param control defines the control to remove\r\n     * @returns the current container\r\n     */\r\n    public removeControl(control: Control3D): Container3D {\r\n        const index = this._children.indexOf(control);\r\n\r\n        if (index !== -1) {\r\n            this._children.splice(index, 1);\r\n\r\n            control.parent = null;\r\n            control._disposeNode();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"Container3D\";\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        for (const control of this._children) {\r\n            control.dispose();\r\n        }\r\n\r\n        this._children.length = 0;\r\n\r\n        super.dispose();\r\n    }\r\n\r\n    /** Control rotation will remain unchanged  */\r\n    public static readonly UNSET_ORIENTATION = 0;\r\n\r\n    /** Control will rotate to make it look at sphere central axis */\r\n    public static readonly FACEORIGIN_ORIENTATION = 1;\r\n\r\n    /** Control will rotate to make it look back at sphere central axis */\r\n    public static readonly FACEORIGINREVERSED_ORIENTATION = 2;\r\n\r\n    /** Control will rotate to look at z axis (0, 0, 1) */\r\n    public static readonly FACEFORWARD_ORIENTATION = 3;\r\n\r\n    /** Control will rotate to look at negative z axis (0, 0, -1) */\r\n    public static readonly FACEFORWARDREVERSED_ORIENTATION = 4;\r\n}\r\n","import { Tools } from \"core/Misc/tools\";\r\nimport { Matrix, Vector3, TmpVectors } from \"core/Maths/math.vector\";\r\nimport type { int } from \"core/types\";\r\n\r\nimport { Container3D } from \"./container3D\";\r\nimport type { Control3D } from \"./control3D\";\r\n\r\n/**\r\n * Abstract class used to create a container panel deployed on the surface of a volume\r\n */\r\nexport abstract class VolumeBasedPanel extends Container3D {\r\n    private _columns = 10;\r\n    private _rows = 0;\r\n    private _rowThenColum = true;\r\n\r\n    private _orientation = Container3D.FACEORIGIN_ORIENTATION;\r\n\r\n    protected _cellWidth: number;\r\n    protected _cellHeight: number;\r\n\r\n    /**\r\n     * Gets or sets the distance between elements\r\n     */\r\n    public margin = 0;\r\n\r\n    /**\r\n     * Gets or sets the orientation to apply to all controls (BABYLON.Container3D.FaceOriginReversedOrientation by default)\r\n     * | Value | Type                                | Description |\r\n     * | ----- | ----------------------------------- | ----------- |\r\n     * | 0     | UNSET_ORIENTATION                   |  Control rotation will remain unchanged |\r\n     * | 1     | FACEORIGIN_ORIENTATION              |  Control will rotate to make it look at sphere central axis |\r\n     * | 2     | FACEORIGINREVERSED_ORIENTATION      |  Control will rotate to make it look back at sphere central axis |\r\n     * | 3     | FACEFORWARD_ORIENTATION             |  Control will rotate to look at z axis (0, 0, 1) |\r\n     * | 4     | FACEFORWARDREVERSED_ORIENTATION     |  Control will rotate to look at negative z axis (0, 0, -1) |\r\n     */\r\n    public get orientation(): number {\r\n        return this._orientation;\r\n    }\r\n\r\n    public set orientation(value: number) {\r\n        if (this._orientation === value) {\r\n            return;\r\n        }\r\n\r\n        this._orientation = value;\r\n\r\n        Tools.SetImmediate(() => {\r\n            this._arrangeChildren();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the number of columns requested (10 by default).\r\n     * The panel will automatically compute the number of rows based on number of child controls.\r\n     */\r\n    public get columns(): int {\r\n        return this._columns;\r\n    }\r\n\r\n    public set columns(value: int) {\r\n        if (this._columns === value) {\r\n            return;\r\n        }\r\n\r\n        this._columns = value;\r\n        this._rowThenColum = true;\r\n\r\n        Tools.SetImmediate(() => {\r\n            this._arrangeChildren();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets or sets a the number of rows requested.\r\n     * The panel will automatically compute the number of columns based on number of child controls.\r\n     */\r\n    public get rows(): int {\r\n        return this._rows;\r\n    }\r\n\r\n    public set rows(value: int) {\r\n        if (this._rows === value) {\r\n            return;\r\n        }\r\n\r\n        this._rows = value;\r\n        this._rowThenColum = false;\r\n\r\n        Tools.SetImmediate(() => {\r\n            this._arrangeChildren();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Creates new VolumeBasedPanel\r\n     * @param name\r\n     */\r\n    public constructor(name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected _arrangeChildren() {\r\n        this._cellWidth = 0;\r\n        this._cellHeight = 0;\r\n        let rows = 0;\r\n        let columns = 0;\r\n        let controlCount = 0;\r\n\r\n        const currentInverseWorld = Matrix.Invert(this.node!.computeWorldMatrix(true));\r\n\r\n        // Measure\r\n        for (const child of this._children) {\r\n            if (!child.mesh) {\r\n                continue;\r\n            }\r\n\r\n            controlCount++;\r\n            child.mesh.computeWorldMatrix(true);\r\n            //   child.mesh.getWorldMatrix().multiplyToRef(currentInverseWorld, Tmp.Matrix[0]);\r\n\r\n            const boundingBox = child.mesh.getHierarchyBoundingVectors();\r\n            const extendSize = TmpVectors.Vector3[0];\r\n            const diff = TmpVectors.Vector3[1];\r\n\r\n            boundingBox.max.subtractToRef(boundingBox.min, diff);\r\n\r\n            diff.scaleInPlace(0.5);\r\n\r\n            Vector3.TransformNormalToRef(diff, currentInverseWorld, extendSize);\r\n\r\n            this._cellWidth = Math.max(this._cellWidth, extendSize.x * 2);\r\n            this._cellHeight = Math.max(this._cellHeight, extendSize.y * 2);\r\n        }\r\n\r\n        this._cellWidth += this.margin * 2;\r\n        this._cellHeight += this.margin * 2;\r\n\r\n        // Arrange\r\n        if (this._rowThenColum) {\r\n            columns = this._columns;\r\n            rows = Math.ceil(controlCount / this._columns);\r\n        } else {\r\n            rows = this._rows;\r\n            columns = Math.ceil(controlCount / this._rows);\r\n        }\r\n\r\n        const startOffsetX = columns * 0.5 * this._cellWidth;\r\n        const startOffsetY = rows * 0.5 * this._cellHeight;\r\n        const nodeGrid = [];\r\n        let cellCounter = 0;\r\n\r\n        if (this._rowThenColum) {\r\n            for (let r = 0; r < rows; r++) {\r\n                for (let c = 0; c < columns; c++) {\r\n                    nodeGrid.push(new Vector3(c * this._cellWidth - startOffsetX + this._cellWidth / 2, r * this._cellHeight - startOffsetY + this._cellHeight / 2, 0));\r\n                    cellCounter++;\r\n                    if (cellCounter > controlCount) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            for (let c = 0; c < columns; c++) {\r\n                for (let r = 0; r < rows; r++) {\r\n                    nodeGrid.push(new Vector3(c * this._cellWidth - startOffsetX + this._cellWidth / 2, r * this._cellHeight - startOffsetY + this._cellHeight / 2, 0));\r\n                    cellCounter++;\r\n                    if (cellCounter > controlCount) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        cellCounter = 0;\r\n        for (const child of this._children) {\r\n            if (!child.mesh) {\r\n                continue;\r\n            }\r\n\r\n            this._mapGridNode(child, nodeGrid[cellCounter]);\r\n\r\n            cellCounter++;\r\n        }\r\n\r\n        this._finalProcessing();\r\n    }\r\n\r\n    /** Child classes must implement this function to provide correct control positioning */\r\n    protected abstract _mapGridNode(control: Control3D, nodePosition: Vector3): void;\r\n\r\n    /** Child classes can implement this function to provide additional processing */\r\n    protected _finalProcessing() {}\r\n}\r\n","import { Tools } from \"core/Misc/tools\";\r\nimport { Matrix, TmpVectors, Vector3 } from \"core/Maths/math.vector\";\r\nimport type { float } from \"core/types\";\r\n\r\nimport { VolumeBasedPanel } from \"./volumeBasedPanel\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { Container3D } from \"./container3D\";\r\nimport { Axis, Space } from \"core/Maths/math.axis\";\r\n\r\n/**\r\n * Class used to create a container panel deployed on the surface of a cylinder\r\n */\r\nexport class CylinderPanel extends VolumeBasedPanel {\r\n    private _radius = 5.0;\r\n\r\n    /**\r\n     * Gets or sets the radius of the cylinder where to project controls (5 by default)\r\n     */\r\n    public get radius(): float {\r\n        return this._radius;\r\n    }\r\n\r\n    public set radius(value: float) {\r\n        if (this._radius === value) {\r\n            return;\r\n        }\r\n\r\n        this._radius = value;\r\n\r\n        Tools.SetImmediate(() => {\r\n            this._arrangeChildren();\r\n        });\r\n    }\r\n\r\n    protected _mapGridNode(control: Control3D, nodePosition: Vector3) {\r\n        const mesh = control.mesh;\r\n\r\n        if (!mesh) {\r\n            return;\r\n        }\r\n        const newPos = this._cylindricalMapping(nodePosition);\r\n        control.position = newPos;\r\n\r\n        switch (this.orientation) {\r\n            case Container3D.FACEORIGIN_ORIENTATION:\r\n                mesh.lookAt(new Vector3(2 * newPos.x, newPos.y, 2 * newPos.z));\r\n                break;\r\n            case Container3D.FACEORIGINREVERSED_ORIENTATION:\r\n                mesh.lookAt(new Vector3(-newPos.x, newPos.y, -newPos.z));\r\n                break;\r\n            case Container3D.FACEFORWARD_ORIENTATION:\r\n                break;\r\n            case Container3D.FACEFORWARDREVERSED_ORIENTATION:\r\n                mesh.rotate(Axis.Y, Math.PI, Space.LOCAL);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private _cylindricalMapping(source: Vector3) {\r\n        const newPos = new Vector3(0, source.y, this._radius);\r\n\r\n        const yAngle = source.x / this._radius;\r\n\r\n        Matrix.RotationYawPitchRollToRef(yAngle, 0, 0, TmpVectors.Matrix[0]);\r\n\r\n        return Vector3.TransformNormal(newPos, TmpVectors.Matrix[0]);\r\n    }\r\n}\r\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"fluentVertexShader\";\nconst shader = `precision highp float;\rattribute vec3 position;\rattribute vec3 normal;\rattribute vec2 uv;\runiform mat4 world;\runiform mat4 viewProjection;\rvarying vec2 vUV;\r#ifdef BORDER\nvarying vec2 scaleInfo;\runiform float borderWidth;\runiform vec3 scaleFactor;\r#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\r#endif\nvoid main(void) {\rvUV=uv;\r#ifdef BORDER\nvec3 scale=scaleFactor;\rfloat minScale=min(min(scale.x,scale.y),scale.z);\rfloat maxScale=max(max(scale.x,scale.y),scale.z);\rfloat minOverMiddleScale=minScale/(scale.x+scale.y+scale.z-minScale-maxScale);\rfloat areaYZ=scale.y*scale.z;\rfloat areaXZ=scale.x*scale.z;\rfloat areaXY=scale.x*scale.y;\rfloat scaledBorderWidth=borderWidth; \rif (abs(normal.x)==1.0) \r{\rscale.x=scale.y;\rscale.y=scale.z;\rif (areaYZ>areaXZ && areaYZ>areaXY)\r{\rscaledBorderWidth*=minOverMiddleScale;\r}\r}\relse if (abs(normal.y)==1.0) \r{\rscale.x=scale.z;\rif (areaXZ>areaXY && areaXZ>areaYZ)\r{\rscaledBorderWidth*=minOverMiddleScale;\r}\r}\relse \r{\rif (areaXY>areaYZ && areaXY>areaXZ)\r{\rscaledBorderWidth*=minOverMiddleScale;\r}\r}\rfloat scaleRatio=min(scale.x,scale.y)/max(scale.x,scale.y);\rif (scale.x>scale.y)\r{\rscaleInfo.x=1.0-(scaledBorderWidth*scaleRatio);\rscaleInfo.y=1.0-scaledBorderWidth;\r}\relse\r{\rscaleInfo.x=1.0-scaledBorderWidth;\rscaleInfo.y=1.0-(scaledBorderWidth*scaleRatio);\r} \r#endif \nvec4 worldPos=world*vec4(position,1.0);\r#ifdef HOVERLIGHT\nworldPosition=worldPos.xyz;\r#endif\ngl_Position=viewProjection*worldPos;\r}\r`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const fluentVertexShader = { name, shader };\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport { serializeAsColor4, serializeAsVector3, serializeAsTexture, serialize, expandToProperty, serializeAsColor3, SerializationHelper } from \"core/Misc/decorators\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Vector3, TmpVectors } from \"core/Maths/math.vector\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { Color3, Color4 } from \"core/Maths/math.color\";\r\n\r\nimport \"./shaders/fluent.vertex\";\r\nimport \"./shaders/fluent.fragment\";\r\n\r\n/** @internal */\r\nexport class FluentMaterialDefines extends MaterialDefines {\r\n    public INNERGLOW = false;\r\n    public BORDER = false;\r\n    public HOVERLIGHT = false;\r\n    public TEXTURE = false;\r\n\r\n    constructor() {\r\n        super();\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\n/**\r\n * Class used to render controls with fluent design\r\n */\r\nexport class FluentMaterial extends PushMaterial {\r\n    /**\r\n     * Gets or sets inner glow intensity. A value of 0 means no glow (default is 0.5)\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public innerGlowColorIntensity = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the inner glow color (white by default)\r\n     */\r\n    @serializeAsColor3()\r\n    public innerGlowColor = new Color3(1.0, 1.0, 1.0);\r\n\r\n    /**\r\n     * Gets or sets the albedo color (Default is Color3(0.3, 0.35, 0.4))\r\n     */\r\n    @serializeAsColor3()\r\n    public albedoColor = new Color3(0.3, 0.35, 0.4);\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if borders must be rendered (default is false)\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public renderBorders = false;\r\n\r\n    /**\r\n     * Gets or sets border width (default is 0.5)\r\n     */\r\n    @serialize()\r\n    public borderWidth = 0.5;\r\n\r\n    /**\r\n     * Gets or sets a value indicating the smoothing value applied to border edges (0.02 by default)\r\n     */\r\n    @serialize()\r\n    public edgeSmoothingValue = 0.02;\r\n\r\n    /**\r\n     * Gets or sets the minimum value that can be applied to border width (default is 0.1)\r\n     */\r\n    @serialize()\r\n    public borderMinValue = 0.1;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if hover light must be rendered (default is false)\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public renderHoverLight = false;\r\n\r\n    /**\r\n     * Gets or sets the radius used to render the hover light (default is 0.01)\r\n     */\r\n    @serialize()\r\n    public hoverRadius = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the color used to render the hover light (default is Color4(0.3, 0.3, 0.3, 1.0))\r\n     */\r\n    @serializeAsColor4()\r\n    public hoverColor = new Color4(0.3, 0.3, 0.3, 1.0);\r\n\r\n    /**\r\n     * Gets or sets the hover light position in world space (default is Vector3.Zero())\r\n     */\r\n    @serializeAsVector3()\r\n    public hoverPosition = Vector3.Zero();\r\n\r\n    @serializeAsTexture(\"albedoTexture\")\r\n    private _albedoTexture: Nullable<BaseTexture>;\r\n\r\n    /** Gets or sets the texture to use for albedo color */\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesAndMiscDirty\")\r\n    public albedoTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Creates a new Fluent material\r\n     * @param name defines the name of the material\r\n     * @param scene defines the hosting scene\r\n     */\r\n    constructor(name: string, scene?: Scene) {\r\n        super(name, scene);\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return this.alpha !== 1.0;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new FluentMaterialDefines();\r\n        }\r\n\r\n        const scene = this.getScene();\r\n        const defines = <FluentMaterialDefines>subMesh.materialDefines;\r\n        if (!this.checkReadyOnEveryCall && subMesh.effect) {\r\n            if (defines._renderId === scene.getRenderId()) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (defines._areTexturesDirty) {\r\n            defines.INNERGLOW = this.innerGlowColorIntensity > 0;\r\n            defines.BORDER = this.renderBorders;\r\n            defines.HOVERLIGHT = this.renderHoverLight;\r\n\r\n            if (this._albedoTexture) {\r\n                if (!this._albedoTexture.isReadyOrNotBlocking()) {\r\n                    return false;\r\n                } else {\r\n                    defines.TEXTURE = true;\r\n                }\r\n            } else {\r\n                defines.TEXTURE = false;\r\n            }\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n            scene.resetCachedMaterial();\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n            attribs.push(VertexBuffer.NormalKind);\r\n            attribs.push(VertexBuffer.UVKind);\r\n\r\n            const shaderName = \"fluent\";\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"viewProjection\",\r\n                \"innerGlowColor\",\r\n                \"albedoColor\",\r\n                \"borderWidth\",\r\n                \"edgeSmoothingValue\",\r\n                \"scaleFactor\",\r\n                \"borderMinValue\",\r\n                \"hoverColor\",\r\n                \"hoverPosition\",\r\n                \"hoverRadius\",\r\n                \"textureMatrix\",\r\n            ];\r\n\r\n            const samplers = [\"albedoSampler\"];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            const join = defines.toString();\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: null,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines,\r\n                this._materialContext\r\n            );\r\n        }\r\n\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const scene = this.getScene();\r\n\r\n        const defines = <FluentMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", scene.getTransformMatrix());\r\n\r\n        if (this._mustRebind(scene, effect)) {\r\n            this._activeEffect.setColor4(\"albedoColor\", this.albedoColor, this.alpha);\r\n\r\n            if (defines.INNERGLOW) {\r\n                this._activeEffect.setColor4(\"innerGlowColor\", this.innerGlowColor, this.innerGlowColorIntensity);\r\n            }\r\n\r\n            if (defines.BORDER) {\r\n                this._activeEffect.setFloat(\"borderWidth\", this.borderWidth);\r\n                this._activeEffect.setFloat(\"edgeSmoothingValue\", this.edgeSmoothingValue);\r\n                this._activeEffect.setFloat(\"borderMinValue\", this.borderMinValue);\r\n\r\n                mesh.getBoundingInfo().boundingBox.extendSize.multiplyToRef(mesh.scaling, TmpVectors.Vector3[0]);\r\n                this._activeEffect.setVector3(\"scaleFactor\", TmpVectors.Vector3[0]);\r\n            }\r\n\r\n            if (defines.HOVERLIGHT) {\r\n                this._activeEffect.setDirectColor4(\"hoverColor\", this.hoverColor);\r\n                this._activeEffect.setFloat(\"hoverRadius\", this.hoverRadius);\r\n                this._activeEffect.setVector3(\"hoverPosition\", this.hoverPosition);\r\n            }\r\n\r\n            if (defines.TEXTURE && this._albedoTexture) {\r\n                this._activeEffect.setTexture(\"albedoSampler\", this._albedoTexture);\r\n                const matrix = this._albedoTexture.getTextureMatrix();\r\n                this._activeEffect.setMatrix(\"textureMatrix\", matrix);\r\n            }\r\n        }\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    public getActiveTextures(): BaseTexture[] {\r\n        const activeTextures = super.getActiveTextures();\r\n\r\n        return activeTextures;\r\n    }\r\n\r\n    public hasTexture(texture: BaseTexture): boolean {\r\n        if (super.hasTexture(texture)) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n    }\r\n\r\n    public clone(name: string): FluentMaterial {\r\n        return SerializationHelper.Clone(() => new FluentMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.customType = \"BABYLON.GUI.FluentMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"FluentMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): FluentMaterial {\r\n        return SerializationHelper.Parse(() => new FluentMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.FluentMaterial\", FluentMaterial);\r\n","import type { Scene } from \"core/scene\";\r\nimport type { Vector3 } from \"core/Maths/math.vector\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { VolumeBasedPanel } from \"./volumeBasedPanel\";\r\nimport { Mesh } from \"core/Meshes/mesh\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { FluentMaterial } from \"../materials/fluent/fluentMaterial\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Logger } from \"core/Misc/logger\";\r\nimport type { Container3D } from \"./container3D\";\r\nimport type { TouchHolographicButton } from \"./touchHolographicButton\";\r\n\r\n/**\r\n * Simple menu that can contain holographic buttons\r\n */\r\nexport class TouchHolographicMenu extends VolumeBasedPanel {\r\n    protected _backPlate: Mesh;\r\n    private _backPlateMaterial: FluentMaterial;\r\n    private _pickedPointObserver: Nullable<Observer<Nullable<Vector3>>>;\r\n\r\n    private _currentMin: Nullable<Vector3>;\r\n    private _currentMax: Nullable<Vector3>;\r\n\r\n    private _backPlateMargin = 1.25;\r\n\r\n    /**\r\n     * Scale for the buttons added to the menu\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    protected static MENU_BUTTON_SCALE: number = 1;\r\n\r\n    /**\r\n     * Gets or sets the margin size of the backplate in button size units.\r\n     * Setting this to 1, will make the backPlate margin the size of 1 button\r\n     */\r\n    public get backPlateMargin(): number {\r\n        return this._backPlateMargin;\r\n    }\r\n\r\n    public set backPlateMargin(value: number) {\r\n        this._backPlateMargin = value;\r\n\r\n        if (this._children.length >= 1) {\r\n            this.children.forEach((control) => {\r\n                this._updateCurrentMinMax(control.position);\r\n            });\r\n\r\n            this._updateMargins();\r\n        }\r\n    }\r\n\r\n    protected _createNode(scene: Scene): Nullable<TransformNode> {\r\n        const node = new Mesh(`menu_${this.name}`, scene);\r\n\r\n        this._backPlate = CreateBox(\"backPlate\" + this.name, { size: 1 }, scene);\r\n        this._backPlate.parent = node;\r\n\r\n        return node;\r\n    }\r\n\r\n    protected _affectMaterial(mesh: AbstractMesh) {\r\n        this._backPlateMaterial = new FluentMaterial(this.name + \"backPlateMaterial\", mesh.getScene());\r\n        this._backPlateMaterial.albedoColor = new Color3(0.08, 0.15, 0.55);\r\n        this._backPlateMaterial.renderBorders = true;\r\n        this._backPlateMaterial.renderHoverLight = true;\r\n\r\n        this._pickedPointObserver = this._host.onPickedPointChangedObservable.add((pickedPoint) => {\r\n            if (pickedPoint) {\r\n                this._backPlateMaterial.hoverPosition = pickedPoint;\r\n                this._backPlateMaterial.hoverColor.a = 1.0;\r\n            } else {\r\n                this._backPlateMaterial.hoverColor.a = 0;\r\n            }\r\n        });\r\n\r\n        this._backPlate.material = this._backPlateMaterial;\r\n    }\r\n\r\n    protected _mapGridNode(control: Control3D, nodePosition: Vector3) {\r\n        // Simple plane mapping for the menu\r\n        const mesh = control.mesh;\r\n\r\n        if (!mesh) {\r\n            return;\r\n        }\r\n\r\n        control.position = nodePosition.clone();\r\n\r\n        this._updateCurrentMinMax(nodePosition);\r\n    }\r\n\r\n    protected _finalProcessing() {\r\n        this._updateMargins();\r\n    }\r\n\r\n    private _updateCurrentMinMax(nodePosition: Vector3) {\r\n        if (!this._currentMin) {\r\n            this._currentMin = nodePosition.clone();\r\n            this._currentMax = nodePosition.clone();\r\n        }\r\n\r\n        this._currentMin.minimizeInPlace(nodePosition);\r\n        this._currentMax!.maximizeInPlace(nodePosition);\r\n    }\r\n\r\n    private _updateMargins() {\r\n        if (this._children.length > 0) {\r\n            this._currentMin!.addInPlaceFromFloats(-this._cellWidth / 2, -this._cellHeight / 2, 0);\r\n            this._currentMax!.addInPlaceFromFloats(this._cellWidth / 2, this._cellHeight / 2, 0);\r\n            const extendSize = this._currentMax!.subtract(this._currentMin!);\r\n\r\n            // Also add a % margin\r\n            this._backPlate.scaling.x = extendSize.x + this._cellWidth * this.backPlateMargin;\r\n            this._backPlate.scaling.y = extendSize.y + this._cellHeight * this.backPlateMargin;\r\n            this._backPlate.scaling.z = 0.001;\r\n\r\n            for (let i = 0; i < this._children.length; i++) {\r\n                this._children[i].position.subtractInPlace(this._currentMin!).subtractInPlace(extendSize.scale(0.5));\r\n                this._children[i].position.z -= 0.01;\r\n            }\r\n        }\r\n\r\n        this._currentMin = null;\r\n        this._currentMax = null;\r\n    }\r\n\r\n    /**\r\n     * Creates a holographic menu GUI 3D control\r\n     * @param name name of the menu\r\n     */\r\n    constructor(name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    /**\r\n     * Adds a button to the menu.\r\n     * Please note that the back material of the button will be set to transparent as it is attached to the menu.\r\n     *\r\n     * @param button Button to add\r\n     * @returns This menu\r\n     */\r\n    public addButton(button: TouchHolographicButton): TouchHolographicMenu {\r\n        // Block updating the layout until the button is resized (which has to happen after node creation)\r\n        const wasLayoutBlocked = this.blockLayout;\r\n        if (!wasLayoutBlocked) {\r\n            this.blockLayout = true;\r\n        }\r\n\r\n        super.addControl(button);\r\n\r\n        button.isBackplateVisible = false;\r\n        button.scaling.scaleInPlace(TouchHolographicMenu.MENU_BUTTON_SCALE);\r\n\r\n        // Unblocking the layout triggers the pending layout update that uses the size of the buttons to determine the size of the backing mesh\r\n        if (!wasLayoutBlocked) {\r\n            this.blockLayout = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * This method should not be used directly. It is inherited from `Container3D`.\r\n     * Please use `addButton` instead.\r\n     * @param _control\r\n     * @returns\r\n     */\r\n    public addControl(_control: Control3D): Container3D {\r\n        Logger.Warn(\"TouchHolographicMenu can only contain buttons. Please use the method `addButton` instead.\");\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Disposes the menu\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver);\r\n    }\r\n}\r\n","import type { Scene } from \"core/scene\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport { TouchHolographicMenu } from \"./touchHolographicMenu\";\r\nimport { HandConstraintBehavior } from \"core/Behaviors/Meshes/handConstraintBehavior\";\r\nimport type { WebXRExperienceHelper } from \"core/XR/webXRExperienceHelper\";\r\n\r\n/**\r\n * Hand menu that displays buttons and floats around the hand.\r\n * @since 5.0.0\r\n */\r\nexport class HandMenu extends TouchHolographicMenu {\r\n    private _handConstraintBehavior: HandConstraintBehavior;\r\n\r\n    /**\r\n     * The hand constraint behavior setting the transformation of this node\r\n     */\r\n    public get handConstraintBehavior() {\r\n        return this._handConstraintBehavior;\r\n    }\r\n\r\n    protected _createNode(scene: Scene): Nullable<TransformNode> {\r\n        const node = super._createNode(scene)! as Mesh;\r\n\r\n        this._handConstraintBehavior.attach(node);\r\n\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     * Creates a hand menu GUI 3D control\r\n     * @param xr the WebXRExperienceHelper used to link this control to the enabled WebXRHandTracking feature\r\n     * @param name name of the hand menu\r\n     */\r\n    constructor(xr: WebXRExperienceHelper, name?: string) {\r\n        super(name);\r\n\r\n        this._handConstraintBehavior = new HandConstraintBehavior();\r\n        this._handConstraintBehavior.linkToXRExperience(xr);\r\n        this.backPlateMargin = 0.15;\r\n        this.rows = 3;\r\n    }\r\n\r\n    /**\r\n     * Disposes the hand menu\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        this._handConstraintBehavior.detach();\r\n    }\r\n}\r\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"fluentBackplatePixelShader\";\nconst shader = `uniform vec3 cameraPosition;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\rvarying vec4 vExtra2;\rvarying vec4 vExtra3;\runiform float _Radius_;\runiform float _Line_Width_;\runiform bool _Absolute_Sizes_;\runiform float _Filter_Width_;\runiform vec4 _Base_Color_;\runiform vec4 _Line_Color_;\runiform float _Radius_Top_Left_;\runiform float _Radius_Top_Right_;\runiform float _Radius_Bottom_Left_;\runiform float _Radius_Bottom_Right_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform float _Rate_;\runiform vec4 _Highlight_Color_;\runiform float _Highlight_Width_;\runiform vec4 _Highlight_Transform_;\runiform float _Highlight_;\runiform float _Iridescence_Intensity_;\runiform float _Iridescence_Edge_Intensity_;\runiform float _Angle_;\runiform float _Fade_Out_;\runiform bool _Reflected_;\runiform float _Frequency_;\runiform float _Vertical_Offset_;\runiform sampler2D _Iridescent_Map_;\runiform bool _Use_Global_Left_Index_;\runiform bool _Use_Global_Right_Index_;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\rvoid Round_Rect_Fragment_B31(\rfloat Radius,\rfloat Line_Width,\rvec4 Line_Color,\rfloat Filter_Width,\rvec2 UV,\rfloat Line_Visibility,\rvec4 Rect_Parms,\rvec4 Fill_Color,\rout vec4 Color)\r{\rfloat d=length(max(abs(UV)-Rect_Parms.xy,0.0));\rfloat dx=max(fwidth(d)*Filter_Width,0.00001);\rfloat g=min(Rect_Parms.z,Rect_Parms.w);\rfloat dgrad=max(fwidth(g)*Filter_Width,0.00001);\rfloat Inside_Rect=clamp(g/dgrad,0.0,1.0);\rfloat inner=clamp((d+dx*0.5-max(Radius-Line_Width,d-dx*0.5))/dx,0.0,1.0);\rColor=clamp(mix(Fill_Color,Line_Color,inner),0.0,1.0)*Inside_Rect;\r}\rvoid Blob_Fragment_B71(\rsampler2D Blob_Texture,\rvec4 Blob_Info1,\rvec4 Blob_Info2,\rout vec4 Blob_Color)\r{\rfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\rfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\rvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\rBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\r}\rvoid Line_Fragment_B48(\rvec4 Base_Color,\rvec4 Highlight_Color,\rfloat Highlight_Width,\rvec3 Line_Vertex,\rfloat Highlight,\rout vec4 Line_Color)\r{\rfloat k2=1.0-clamp(abs(Line_Vertex.y/Highlight_Width),0.0,1.0);\rLine_Color=mix(Base_Color,Highlight_Color,Highlight*k2);\r}\rvoid Scale_RGB_B54(\rvec4 Color,\rfloat Scalar,\rout vec4 Result)\r{\rResult=vec4(Scalar,Scalar,Scalar,1)*Color;\r}\rvoid Conditional_Float_B38(\rbool Which,\rfloat If_True,\rfloat If_False,\rout float Result)\r{\rResult=Which ? If_True : If_False;\r}\rvoid main()\r{\rfloat R_Q72;\rfloat G_Q72;\rfloat B_Q72;\rfloat A_Q72;\rR_Q72=vColor.r; G_Q72=vColor.g; B_Q72=vColor.b; A_Q72=vColor.a;\rvec4 Blob_Color_Q71;\r#if BLOB_ENABLE\nfloat k1=dot(vExtra2.xy,vExtra2.xy);\rfloat k2=dot(vExtra3.xy,vExtra3.xy);\rvec3 closer=k1<k2 ? vec3(k1,vExtra2.z,vExtra2.w) : vec3(k2,vExtra3.z,vExtra3.w);\rBlob_Color_Q71=closer.z*texture(_Blob_Texture_,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\r#else\nBlob_Color_Q71=vec4(0,0,0,0);\r#endif\nvec4 Line_Color_Q48;\rLine_Fragment_B48(_Line_Color_,_Highlight_Color_,_Highlight_Width_,vTangent,_Highlight_,Line_Color_Q48);\rfloat X_Q67;\rfloat Y_Q67;\rX_Q67=vUV.x;\rY_Q67=vUV.y;\rvec3 Incident_Q66=normalize(vPosition-cameraPosition);\rvec3 Reflected_Q60=reflect(Incident_Q66,vBinormal);\rfloat Product_Q63=Y_Q67*_Vertical_Offset_;\rfloat Dot_Q68=dot(Incident_Q66, Reflected_Q60);\rfloat Dot_Q57=dot(vNormal, Incident_Q66);\rfloat Result_Q38;\rConditional_Float_B38(_Reflected_,Dot_Q68,Dot_Q57,Result_Q38);\rfloat Product_Q64=Result_Q38*_Frequency_;\rfloat Sum_Q69=Product_Q64+1.0;\rfloat Product_Q70=Sum_Q69*0.5;\rfloat Sum_Q62=Product_Q63+Product_Q70;\rfloat FractF_Q59=fract(Sum_Q62);\rvec2 Vec2_Q65=vec2(FractF_Q59,0.5);\rvec4 Color_Q58;\r#if IRIDESCENT_MAP_ENABLE\nColor_Q58=texture(_Iridescent_Map_,Vec2_Q65);\r#else\nColor_Q58=vec4(0,0,0,0);\r#endif\nvec4 Result_Q54;\rScale_RGB_B54(Color_Q58,_Iridescence_Edge_Intensity_,Result_Q54);\rvec4 Result_Q55;\rScale_RGB_B54(Color_Q58,_Iridescence_Intensity_,Result_Q55);\rvec4 Base_And_Iridescent_Q53;\rBase_And_Iridescent_Q53=Line_Color_Q48+vec4(Result_Q54.rgb,0.0);\rvec4 Base_And_Iridescent_Q56;\rBase_And_Iridescent_Q56=_Base_Color_+vec4(Result_Q55.rgb,0.0);\rvec4 Result_Q52=Base_And_Iridescent_Q53; Result_Q52.a=1.0;\rvec4 Result_Q35=Blob_Color_Q71+(1.0-Blob_Color_Q71.a)*Base_And_Iridescent_Q56;\rvec4 Color_Q31;\rRound_Rect_Fragment_B31(R_Q72,G_Q72,Result_Q52,_Filter_Width_,vUV,1.0,vExtra1,Result_Q35,Color_Q31);\rvec4 Result_Q47=_Fade_Out_*Color_Q31;\rvec4 Out_Color=Result_Q47;\rfloat Clip_Threshold=0.001;\rbool To_sRGB=false;\rgl_FragColor=Out_Color;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const fluentBackplatePixelShader = { name, shader };\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"fluentBackplateVertexShader\";\nconst shader = `uniform mat4 world;\runiform mat4 viewProjection;\runiform vec3 cameraPosition;\rattribute vec3 position;\rattribute vec3 normal;\r#ifdef TANGENT\nattribute vec3 tangent;\r#else\nconst vec3 tangent=vec3(0.);\r#endif\nuniform float _Radius_;\runiform float _Line_Width_;\runiform bool _Absolute_Sizes_;\runiform float _Filter_Width_;\runiform vec4 _Base_Color_;\runiform vec4 _Line_Color_;\runiform float _Radius_Top_Left_;\runiform float _Radius_Top_Right_;\runiform float _Radius_Bottom_Left_;\runiform float _Radius_Bottom_Right_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform float _Rate_;\runiform vec4 _Highlight_Color_;\runiform float _Highlight_Width_;\runiform vec4 _Highlight_Transform_;\runiform float _Highlight_;\runiform float _Iridescence_Intensity_;\runiform float _Iridescence_Edge_Intensity_;\runiform float _Angle_;\runiform float _Fade_Out_;\runiform bool _Reflected_;\runiform float _Frequency_;\runiform float _Vertical_Offset_;\runiform sampler2D _Iridescent_Map_;\runiform bool _Use_Global_Left_Index_;\runiform bool _Use_Global_Right_Index_;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\rvarying vec4 vExtra2;\rvarying vec4 vExtra3;\rvoid Object_To_World_Pos_B115(\rvec3 Pos_Object,\rout vec3 Pos_World)\r{\rPos_World=(world*vec4(Pos_Object,1.0)).xyz;\r}\rvoid PickDir_B140(\rfloat Degrees,\rvec3 DirX,\rvec3 DirY,\rout vec3 Dir)\r{\rfloat a=Degrees*3.14159/180.0;\rDir=cos(a)*DirX+sin(a)*DirY;\r}\rvoid Round_Rect_Vertex_B139(\rvec2 UV,\rfloat Radius,\rfloat Margin,\rfloat Anisotropy,\rfloat Gradient1,\rfloat Gradient2,\rout vec2 Rect_UV,\rout vec4 Rect_Parms,\rout vec2 Scale_XY,\rout vec2 Line_UV)\r{\rScale_XY=vec2(Anisotropy,1.0);\rLine_UV=(UV-vec2(0.5,0.5));\rRect_UV=Line_UV*Scale_XY;\rRect_Parms.xy=Scale_XY*0.5-vec2(Radius,Radius)-vec2(Margin,Margin);\rRect_Parms.z=Gradient1; \rRect_Parms.w=Gradient2;\r}\rvoid Line_Vertex_B135(\rvec2 Scale_XY,\rvec2 UV,\rfloat Time,\rfloat Rate,\rvec4 Highlight_Transform,\rout vec3 Line_Vertex)\r{\rfloat angle2=(Rate*Time)*2.0*3.1416;\rfloat sinAngle2=sin(angle2);\rfloat cosAngle2=cos(angle2);\rvec2 xformUV=UV*Highlight_Transform.xy+Highlight_Transform.zw;\rLine_Vertex.x=0.0;\rLine_Vertex.y=cosAngle2*xformUV.x-sinAngle2*xformUV.y;\rLine_Vertex.z=0.0; \r}\rvoid Blob_Vertex_B180(\rvec3 Position,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rvec3 Blob_Position,\rfloat Intensity,\rfloat Blob_Near_Size,\rfloat Blob_Far_Size,\rfloat Blob_Near_Distance,\rfloat Blob_Far_Distance,\rfloat Blob_Fade_Length,\rfloat Blob_Pulse,\rfloat Blob_Fade,\rout vec4 Blob_Info)\r{\rvec3 blob=Blob_Position;\rvec3 delta=blob-Position;\rfloat dist=dot(Normal,delta);\rfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\rfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\rfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\rvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\rfloat Fade=fadeValue*Intensity*Blob_Fade;\rfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\rBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\r}\rvoid Move_Verts_B129(\rfloat Anisotropy,\rvec3 P,\rfloat Radius,\rout vec3 New_P,\rout vec2 New_UV,\rout float Radial_Gradient,\rout vec3 Radial_Dir)\r{\rvec2 UV=P.xy*2.0+0.5;\rvec2 center=clamp(UV,0.0,1.0);\rvec2 delta=UV-center;\rvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\rNew_UV=center+r2*(UV-2.0*center+0.5);\rNew_P=vec3(New_UV-0.5,P.z);\rRadial_Gradient=1.0-length(delta)*2.0;\rRadial_Dir=vec3(delta*r2,0.0);\r}\rvoid Object_To_World_Dir_B132(\rvec3 Dir_Object,\rout vec3 Binormal_World,\rout vec3 Binormal_World_N,\rout float Binormal_Length)\r{\rBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\rBinormal_Length=length(Binormal_World);\rBinormal_World_N=Binormal_World/Binormal_Length;\r}\rvoid RelativeOrAbsoluteDetail_B147(\rfloat Nominal_Radius,\rfloat Nominal_LineWidth,\rbool Absolute_Measurements,\rfloat Height,\rout float Radius,\rout float Line_Width)\r{\rfloat scale=Absolute_Measurements ? 1.0/Height : 1.0;\rRadius=Nominal_Radius*scale;\rLine_Width=Nominal_LineWidth*scale;\r}\rvoid Edge_AA_Vertex_B130(\rvec3 Position_World,\rvec3 Position_Object,\rvec3 Normal_Object,\rvec3 Eye,\rfloat Radial_Gradient,\rvec3 Radial_Dir,\rvec3 Tangent,\rout float Gradient1,\rout float Gradient2)\r{\rvec3 I=(Eye-Position_World);\rvec3 T=(world* vec4(Tangent,0.0)).xyz;\rfloat g=(dot(T,I)<0.0) ? 0.0 : 1.0;\rif (Normal_Object.z==0.0) { \rGradient1=Position_Object.z>0.0 ? g : 1.0;\rGradient2=Position_Object.z>0.0 ? 1.0 : g;\r} else {\rGradient1=g+(1.0-g)*(Radial_Gradient);\rGradient2=1.0;\r}\r}\rvoid Pick_Radius_B144(\rfloat Radius,\rfloat Radius_Top_Left,\rfloat Radius_Top_Right,\rfloat Radius_Bottom_Left,\rfloat Radius_Bottom_Right,\rvec3 Position,\rout float Result)\r{\rbool whichY=Position.y>0.0;\rResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\rResult*=Radius;\r}\rvoid main()\r{\rvec3 Nrm_World_Q128;\rNrm_World_Q128=normalize((world*vec4(normal,0.0)).xyz);\rvec3 Tangent_World_Q131;\rvec3 Tangent_World_N_Q131;\rfloat Tangent_Length_Q131;\rTangent_World_Q131=(world*vec4(vec3(1,0,0),0.0)).xyz;\rTangent_Length_Q131=length(Tangent_World_Q131);\rTangent_World_N_Q131=Tangent_World_Q131/Tangent_Length_Q131;\rvec3 Binormal_World_Q132;\rvec3 Binormal_World_N_Q132;\rfloat Binormal_Length_Q132;\rObject_To_World_Dir_B132(vec3(0,1,0),Binormal_World_Q132,Binormal_World_N_Q132,Binormal_Length_Q132);\rfloat Anisotropy_Q133=Tangent_Length_Q131/Binormal_Length_Q132;\rvec3 Result_Q177;\rResult_Q177=mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(_Use_Global_Left_Index_));\rvec3 Result_Q178;\rResult_Q178=mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(_Use_Global_Right_Index_));\rfloat Result_Q144;\rPick_Radius_B144(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q144);\rvec3 Dir_Q140;\rPickDir_B140(_Angle_,Tangent_World_N_Q131,Binormal_World_N_Q132,Dir_Q140);\rfloat Radius_Q147;\rfloat Line_Width_Q147;\rRelativeOrAbsoluteDetail_B147(Result_Q144,_Line_Width_,_Absolute_Sizes_,Binormal_Length_Q132,Radius_Q147,Line_Width_Q147);\rvec4 Out_Color_Q145=vec4(Radius_Q147,Line_Width_Q147,0,1);\rvec3 New_P_Q129;\rvec2 New_UV_Q129;\rfloat Radial_Gradient_Q129;\rvec3 Radial_Dir_Q129;\rMove_Verts_B129(Anisotropy_Q133,position,Radius_Q147,New_P_Q129,New_UV_Q129,Radial_Gradient_Q129,Radial_Dir_Q129);\rvec3 Pos_World_Q115;\rObject_To_World_Pos_B115(New_P_Q129,Pos_World_Q115);\rvec4 Blob_Info_Q180;\r#if BLOB_ENABLE\nBlob_Vertex_B180(Pos_World_Q115,Nrm_World_Q128,Tangent_World_N_Q131,Binormal_World_N_Q132,Result_Q177,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q180);\r#else\nBlob_Info_Q180=vec4(0,0,0,0);\r#endif\nvec4 Blob_Info_Q181;\r#if BLOB_ENABLE_2\nBlob_Vertex_B180(Pos_World_Q115,Nrm_World_Q128,Tangent_World_N_Q131,Binormal_World_N_Q132,Result_Q178,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q181);\r#else\nBlob_Info_Q181=vec4(0,0,0,0);\r#endif\nfloat Gradient1_Q130;\rfloat Gradient2_Q130;\r#if SMOOTH_EDGES\nEdge_AA_Vertex_B130(Pos_World_Q115,position,normal,cameraPosition,Radial_Gradient_Q129,Radial_Dir_Q129,tangent,Gradient1_Q130,Gradient2_Q130);\r#else\nGradient1_Q130=1.0;\rGradient2_Q130=1.0;\r#endif\nvec2 Rect_UV_Q139;\rvec4 Rect_Parms_Q139;\rvec2 Scale_XY_Q139;\rvec2 Line_UV_Q139;\rRound_Rect_Vertex_B139(New_UV_Q129,Radius_Q147,0.0,Anisotropy_Q133,Gradient1_Q130,Gradient2_Q130,Rect_UV_Q139,Rect_Parms_Q139,Scale_XY_Q139,Line_UV_Q139);\rvec3 Line_Vertex_Q135;\rLine_Vertex_B135(Scale_XY_Q139,Line_UV_Q139,0.0,_Rate_,_Highlight_Transform_,Line_Vertex_Q135);\rvec3 Position=Pos_World_Q115;\rvec3 Normal=Dir_Q140;\rvec2 UV=Rect_UV_Q139;\rvec3 Tangent=Line_Vertex_Q135;\rvec3 Binormal=Nrm_World_Q128;\rvec4 Color=Out_Color_Q145;\rvec4 Extra1=Rect_Parms_Q139;\rvec4 Extra2=Blob_Info_Q180;\rvec4 Extra3=Blob_Info_Q181;\rgl_Position=viewProjection*vec4(Position,1);\rvPosition=Position;\rvNormal=Normal;\rvUV=UV;\rvTangent=Tangent;\rvBinormal=Binormal;\rvColor=Color;\rvExtra1=Extra1;\rvExtra2=Extra2;\rvExtra3=Extra3;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const fluentBackplateVertexShader = { name, shader };\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport { SerializationHelper, serialize, serializeAsVector3 } from \"core/Misc/decorators\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Vector3, Vector4 } from \"core/Maths/math.vector\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { Color4 } from \"core/Maths/math.color\";\r\nimport { EffectFallbacks } from \"core/Materials/effectFallbacks\";\r\nimport { Constants } from \"core/Engines/constants\";\r\n\r\nimport \"./shaders/fluentBackplate.fragment\";\r\nimport \"./shaders/fluentBackplate.vertex\";\r\n\r\n/** @internal */\r\nclass FluentBackplateMaterialDefines extends MaterialDefines {\r\n    public BLOB_ENABLE = true;\r\n    public BLOB_ENABLE_2 = true;\r\n    public SMOOTH_EDGES = true;\r\n    public IRIDESCENT_MAP_ENABLE = true;\r\n\r\n    constructor() {\r\n        super();\r\n        this._needNormals = true;\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\n/**\r\n * Class used to render square buttons with fluent design\r\n */\r\nexport class FluentBackplateMaterial extends PushMaterial {\r\n    /**\r\n     * URL pointing to the texture used to define the coloring for the fluent blob effect.\r\n     */\r\n    public static BLOB_TEXTURE_URL = \"https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-backplate-blob.png\";\r\n\r\n    /**\r\n     * URL pointing to the texture used to define iridescent map.\r\n     */\r\n    public static IM_TEXTURE_URL = \"https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-backplate-iridescence.png\";\r\n\r\n    private _blobTexture: Texture;\r\n    private _iridescentMap: Texture;\r\n\r\n    /**\r\n     * Gets or sets the corner radius on the backplate. Best to keep this value between 0.01 and 0.5. Default is 0.03.\r\n     */\r\n    @serialize()\r\n    public radius = 0.03;\r\n\r\n    /**\r\n     * Gets or sets the line width of the backplate.\r\n     */\r\n    @serialize()\r\n    public lineWidth = 0.01;\r\n\r\n    /**\r\n     * Gets or sets whether to use absolute sizes when calculating effects on the backplate.\r\n     * Since desktop and VR/AR have different relative sizes, it's usually best to keep this false.\r\n     */\r\n    @serialize()\r\n    public absoluteSizes = false;\r\n\r\n    /** @internal */\r\n    public _filterWidth = 1;\r\n\r\n    /**\r\n     * Gets or sets the base color of the backplate.\r\n     */\r\n    @serialize()\r\n    public baseColor = new Color4(0.0392157, 0.0666667, 0.207843, 1);\r\n\r\n    /**\r\n     * Gets or sets the line color of the backplate.\r\n     */\r\n    @serialize()\r\n    public lineColor = new Color4(0.14902, 0.133333, 0.384314, 1);\r\n\r\n    /**\r\n     * Gets or sets the intensity of the fluent hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobIntensity = 0.98;\r\n\r\n    /**\r\n     * Gets or sets the far size of the fluent hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobFarSize = 0.04;\r\n\r\n    /**\r\n     * Gets or sets the distance considered \"near\" to the backplate, which controls the size of the fluent hover glow effect (see blobNearSize).\r\n     */\r\n    @serialize()\r\n    public blobNearDistance = 0;\r\n\r\n    /**\r\n     * Gets or sets the distance considered \"far\" from the backplate, which controls the size of the fluent hover glow effect (see blobFarSize).\r\n     */\r\n    @serialize()\r\n    public blobFarDistance = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the length of the fluent hover glow effect fade.\r\n     */\r\n    @serialize()\r\n    public blobFadeLength = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the size of the fluent hover glow effect when the left pointer is considered \"near\" to the backplate (see blobNearDistance).\r\n     */\r\n    @serialize()\r\n    public blobNearSize = 0.22;\r\n\r\n    /**\r\n     * Gets or sets the progress of the fluent hover glow effect selection animation corresponding to the left pointer (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public blobPulse = 0;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the fluent hover glow effect corresponding to the left pointer (0.0 - 1.0). Default is 0.\r\n     */\r\n    @serialize()\r\n    public blobFade = 0;\r\n\r\n    /**\r\n     * Gets or sets the size of the fluent hover glow effect when the right pointer is considered \"near\" to the backplate (see blobNearDistance).\r\n     */\r\n    @serialize()\r\n    public blobNearSize2 = 0.22;\r\n\r\n    /**\r\n     * Gets or sets the progress of the fluent hover glow effect selection animation corresponding to the right pointer (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public blobPulse2 = 0;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the fluent hover glow effect corresponding to the right pointer (0.0 - 1.0). Default is 0.\r\n     */\r\n    @serialize()\r\n    public blobFade2 = 0;\r\n\r\n    /** @internal */\r\n    public _rate = 0.135;\r\n\r\n    /**\r\n     * Gets or sets the color of the highlights on the backplate line.\r\n     */\r\n    @serialize()\r\n    public highlightColor = new Color4(0.98, 0.98, 0.98, 1);\r\n\r\n    /**\r\n     * Gets or sets the width of the highlights on the backplate line.\r\n     */\r\n    @serialize()\r\n    public highlightWidth = 0.25;\r\n\r\n    /** @internal */\r\n    public _highlightTransform = new Vector4(1, 1, 0, 0);\r\n\r\n    /** @internal */\r\n    public _highlight = 1;\r\n\r\n    /**\r\n     * Gets or sets the intensity of the iridescence effect.\r\n     */\r\n    @serialize()\r\n    public iridescenceIntensity = 0;\r\n\r\n    /**\r\n     * Gets or sets the intensity of the iridescence effect on the backplate edges.\r\n     */\r\n    @serialize()\r\n    public iridescenceEdgeIntensity = 1;\r\n\r\n    /** @internal */\r\n    public _angle = -45;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the backplate (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public fadeOut = 1;\r\n\r\n    /** @internal */\r\n    public _reflected = true;\r\n\r\n    /** @internal */\r\n    public _frequency = 1;\r\n\r\n    /** @internal */\r\n    public _verticalOffset = 0;\r\n\r\n    /**\r\n     * Gets or sets the world-space position of the tip of the left index finger.\r\n     */\r\n    @serializeAsVector3()\r\n    public globalLeftIndexTipPosition = Vector3.Zero();\r\n    private _globalLeftIndexTipPosition4 = Vector4.Zero();\r\n\r\n    /**\r\n     * Gets or sets the world-space position of the tip of the right index finger.\r\n     */\r\n    @serializeAsVector3()\r\n    public globalRightIndexTipPosition = Vector3.Zero();\r\n    private _globalRightIndexTipPosition4 = Vector4.Zero();\r\n\r\n    constructor(name: string, scene?: Scene) {\r\n        super(name, scene);\r\n        this.alphaMode = Constants.ALPHA_DISABLE;\r\n        this.backFaceCulling = false;\r\n\r\n        this._blobTexture = new Texture(FluentBackplateMaterial.BLOB_TEXTURE_URL, this.getScene(), true, false, Texture.NEAREST_SAMPLINGMODE);\r\n        this._iridescentMap = new Texture(FluentBackplateMaterial.IM_TEXTURE_URL, this.getScene(), true, false, Texture.NEAREST_SAMPLINGMODE);\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new FluentBackplateMaterialDefines();\r\n        }\r\n\r\n        const defines = <FluentBackplateMaterialDefines>subMesh.materialDefines;\r\n        const scene = this.getScene();\r\n\r\n        if (this._isReadyForSubMesh(subMesh)) {\r\n            return true;\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n\r\n        // Attribs\r\n        MaterialHelper.PrepareDefinesForAttributes(mesh, defines, false, false);\r\n\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n\r\n            scene.resetCachedMaterial();\r\n\r\n            // Fallbacks\r\n            const fallbacks = new EffectFallbacks();\r\n            if (defines.FOG) {\r\n                fallbacks.addFallback(1, \"FOG\");\r\n            }\r\n\r\n            MaterialHelper.HandleFallbacksForShadows(defines, fallbacks);\r\n\r\n            defines.IMAGEPROCESSINGPOSTPROCESS = scene.imageProcessingConfiguration.applyByPostProcess;\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n\r\n            if (defines.NORMAL) {\r\n                attribs.push(VertexBuffer.NormalKind);\r\n            }\r\n\r\n            if (defines.UV1) {\r\n                attribs.push(VertexBuffer.UVKind);\r\n            }\r\n\r\n            if (defines.UV2) {\r\n                attribs.push(VertexBuffer.UV2Kind);\r\n            }\r\n\r\n            if (defines.VERTEXCOLOR) {\r\n                attribs.push(VertexBuffer.ColorKind);\r\n            }\r\n\r\n            if (defines.TANGENT) {\r\n                attribs.push(VertexBuffer.TangentKind);\r\n            }\r\n\r\n            MaterialHelper.PrepareAttributesForInstances(attribs, defines);\r\n\r\n            // Legacy browser patch\r\n            const shaderName = \"fluentBackplate\";\r\n            const join = defines.toString();\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"viewProjection\",\r\n                \"cameraPosition\",\r\n                \"_Radius_\",\r\n                \"_Line_Width_\",\r\n                \"_Absolute_Sizes_\",\r\n                \"_Filter_Width_\",\r\n                \"_Base_Color_\",\r\n                \"_Line_Color_\",\r\n                \"_Radius_Top_Left_\",\r\n                \"_Radius_Top_Right_\",\r\n                \"_Radius_Bottom_Left_\",\r\n                \"_Radius_Bottom_Right_\",\r\n                \"_Blob_Position_\",\r\n                \"_Blob_Intensity_\",\r\n                \"_Blob_Near_Size_\",\r\n                \"_Blob_Far_Size_\",\r\n                \"_Blob_Near_Distance_\",\r\n                \"_Blob_Far_Distance_\",\r\n                \"_Blob_Fade_Length_\",\r\n                \"_Blob_Pulse_\",\r\n                \"_Blob_Fade_\",\r\n                \"_Blob_Texture_\",\r\n                \"_Blob_Position_2_\",\r\n                \"_Blob_Near_Size_2_\",\r\n                \"_Blob_Pulse_2_\",\r\n                \"_Blob_Fade_2_\",\r\n                \"_Rate_\",\r\n                \"_Highlight_Color_\",\r\n                \"_Highlight_Width_\",\r\n                \"_Highlight_Transform_\",\r\n                \"_Highlight_\",\r\n                \"_Iridescence_Intensity_\",\r\n                \"_Iridescence_Edge_Intensity_\",\r\n                \"_Angle_\",\r\n                \"_Fade_Out_\",\r\n                \"_Reflected_\",\r\n                \"_Frequency_\",\r\n                \"_Vertical_Offset_\",\r\n                \"_Iridescent_Map_\",\r\n                \"_Use_Global_Left_Index_\",\r\n                \"_Use_Global_Right_Index_\",\r\n                \"Global_Left_Index_Tip_Position\",\r\n                \"Global_Right_Index_Tip_Position\",\r\n            ];\r\n            const samplers: string[] = [\"_Blob_Texture_\", \"_Iridescent_Map_\"];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: fallbacks,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines,\r\n                this._materialContext\r\n            );\r\n        }\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const defines = <FluentBackplateMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", this.getScene().getTransformMatrix());\r\n        this._activeEffect.setVector3(\"cameraPosition\", this.getScene().activeCamera?.position ?? Vector3.ZeroReadOnly);\r\n\r\n        // \"Round Rect\"\r\n        this._activeEffect.setFloat(\"_Radius_\", this.radius);\r\n        this._activeEffect.setFloat(\"_Line_Width_\", this.lineWidth);\r\n        this._activeEffect.setFloat(\"_Absolute_Sizes_\", this.absoluteSizes ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Filter_Width_\", this._filterWidth);\r\n        this._activeEffect.setDirectColor4(\"_Base_Color_\", this.baseColor);\r\n        this._activeEffect.setDirectColor4(\"_Line_Color_\", this.lineColor);\r\n\r\n        // \"Radii Multipliers\"\r\n        this._activeEffect.setFloat(\"_Radius_Top_Left_\", 1);\r\n        this._activeEffect.setFloat(\"_Radius_Top_Right_\", 1.0);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Left_\", 1.0);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Right_\", 1.0);\r\n\r\n        // \"Blob\"\r\n        //define BLOB_ENABLE true;\r\n        this._activeEffect.setFloat(\"_Blob_Intensity_\", this.blobIntensity);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_\", this.blobNearSize);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Size_\", this.blobFarSize);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Distance_\", this.blobNearDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Distance_\", this.blobFarDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_Length_\", this.blobFadeLength);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_\", this.blobPulse);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_\", this.blobFade);\r\n\r\n        // \"Blob Texture\"\r\n        this._activeEffect.setTexture(\"_Blob_Texture_\", this._blobTexture);\r\n\r\n        // \"Blob 2\"\r\n        //define BLOB_ENABLE_2 true;\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_2_\", this.blobNearSize2);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_2_\", this.blobPulse2);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_2_\", this.blobFade2);\r\n\r\n        // \"Line Highlight\"\r\n        this._activeEffect.setFloat(\"_Rate_\", this._rate);\r\n        this._activeEffect.setDirectColor4(\"_Highlight_Color_\", this.highlightColor);\r\n        this._activeEffect.setFloat(\"_Highlight_Width_\", this.highlightWidth);\r\n        this._activeEffect.setVector4(\"_Highlight_Transform_\", this._highlightTransform);\r\n        this._activeEffect.setFloat(\"_Highlight_\", this._highlight);\r\n\r\n        // \"Iridescence\"\r\n        this._activeEffect.setFloat(\"_Iridescence_Intensity_\", this.iridescenceIntensity);\r\n        this._activeEffect.setFloat(\"_Iridescence_Edge_Intensity_\", this.iridescenceEdgeIntensity);\r\n        this._activeEffect.setFloat(\"_Angle_\", this._angle);\r\n\r\n        // \"Fade\"\r\n        this._activeEffect.setFloat(\"_Fade_Out_\", this.fadeOut);\r\n\r\n        // \"Antialiasing\"\r\n        //define SMOOTH_EDGES true;\r\n\r\n        // \"ChooseAngle\"\r\n        this._activeEffect.setFloat(\"_Reflected_\", this._reflected ? 1.0 : 0.0);\r\n\r\n        // \"Multiply\"\r\n        this._activeEffect.setFloat(\"_Frequency_\", this._frequency);\r\n        this._activeEffect.setFloat(\"_Vertical_Offset_\", this._verticalOffset);\r\n\r\n        // \"Color Texture\"\r\n        //define IRIDESCENT_MAP_ENABLE true;\r\n        this._activeEffect.setTexture(\"_Iridescent_Map_\", this._iridescentMap);\r\n\r\n        // \"Global\"\r\n        this._activeEffect.setFloat(\"_Use_Global_Left_Index_\", 1.0);\r\n        this._activeEffect.setFloat(\"_Use_Global_Right_Index_\", 1.0);\r\n\r\n        this._globalLeftIndexTipPosition4.set(this.globalLeftIndexTipPosition.x, this.globalLeftIndexTipPosition.y, this.globalLeftIndexTipPosition.z, 1.0);\r\n        this._activeEffect.setVector4(\"Global_Left_Index_Tip_Position\", this._globalLeftIndexTipPosition4);\r\n\r\n        this._globalRightIndexTipPosition4.set(this.globalRightIndexTipPosition.x, this.globalRightIndexTipPosition.y, this.globalRightIndexTipPosition.z, 1.0);\r\n        this._activeEffect.setVector4(\"Global_Right_Index_Tip_Position\", this._globalRightIndexTipPosition4);\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    /**\r\n     * Get the list of animatables in the material.\r\n     * @returns the list of animatables object used in the material\r\n     */\r\n    public getAnimatables(): IAnimatable[] {\r\n        return [];\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n\r\n        this._blobTexture.dispose();\r\n        this._iridescentMap.dispose();\r\n    }\r\n\r\n    public clone(name: string): FluentBackplateMaterial {\r\n        return SerializationHelper.Clone(() => new FluentBackplateMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.customType = \"BABYLON.FluentBackplateMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"FluentBackplateMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): FluentBackplateMaterial {\r\n        return SerializationHelper.Parse(() => new FluentBackplateMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.FluentBackplateMaterial\", FluentBackplateMaterial);\r\n","import type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { FluentBackplateMaterial } from \"../materials/fluentBackplate/fluentBackplateMaterial\";\r\nimport { Control3D } from \"./control3D\";\r\nimport { SceneLoader } from \"core/Loading/sceneLoader\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\n\r\n/**\r\n * Class used to create a holographic backplate in 3D\r\n * @since 5.0.0\r\n */\r\nexport class HolographicBackplate extends Control3D {\r\n    /**\r\n     * Base Url for the button model.\r\n     */\r\n    public static MODEL_BASE_URL: string = \"https://assets.babylonjs.com/meshes/MRTK/\";\r\n    /**\r\n     * File name for the button model.\r\n     */\r\n    public static MODEL_FILENAME: string = \"mrtk-fluent-backplate.glb\";\r\n\r\n    private _model: AbstractMesh;\r\n    private _material: FluentBackplateMaterial;\r\n\r\n    /**\r\n     * Rendering ground id of the backplate mesh.\r\n     */\r\n    public set renderingGroupId(id: number) {\r\n        this._model.renderingGroupId = id;\r\n    }\r\n    public get renderingGroupId(): number {\r\n        return this._model.renderingGroupId;\r\n    }\r\n\r\n    /**\r\n     * Gets the material used by the backplate\r\n     */\r\n    public get material(): FluentBackplateMaterial {\r\n        return this._material;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this backplate shares its material with other HolographicBackplates\r\n     */\r\n    public get shareMaterials(): boolean {\r\n        return this._shareMaterials;\r\n    }\r\n\r\n    /**\r\n     * Creates a new holographic backplate\r\n     * @param name defines the control name\r\n     * @param _shareMaterials\r\n     */\r\n    constructor(name?: string, private _shareMaterials = true) {\r\n        super(name);\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"HolographicBackplate\";\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        const collisionMesh = CreateBox(\r\n            (this.name ?? \"HolographicBackplate\") + \"_CollisionMesh\",\r\n            {\r\n                width: 1.0,\r\n                height: 1.0,\r\n                depth: 1.0,\r\n            },\r\n            scene\r\n        );\r\n        collisionMesh.isPickable = true;\r\n        collisionMesh.visibility = 0;\r\n\r\n        SceneLoader.ImportMeshAsync(undefined, HolographicBackplate.MODEL_BASE_URL, HolographicBackplate.MODEL_FILENAME, scene).then((result) => {\r\n            const importedModel = result.meshes[1];\r\n            importedModel.name = `${this.name}_frontPlate`;\r\n            importedModel.isPickable = false;\r\n            importedModel.parent = collisionMesh;\r\n            if (this._material) {\r\n                importedModel.material = this._material;\r\n            }\r\n            this._model = importedModel;\r\n        });\r\n\r\n        return collisionMesh;\r\n    }\r\n\r\n    private _createMaterial(mesh: Mesh) {\r\n        this._material = new FluentBackplateMaterial(this.name + \" Material\", mesh.getScene());\r\n    }\r\n\r\n    protected _affectMaterial(mesh: Mesh) {\r\n        // Back\r\n        if (this._shareMaterials) {\r\n            if (!this._host._touchSharedMaterials[\"fluentBackplateMaterial\"]) {\r\n                this._createMaterial(mesh);\r\n                this._host._touchSharedMaterials[\"fluentBackplateMaterial\"] = this._material;\r\n            } else {\r\n                this._material = this._host._touchSharedMaterials[\"fluentBackplateMaterial\"] as FluentBackplateMaterial;\r\n            }\r\n        } else {\r\n            this._createMaterial(mesh);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose(); // will dispose main mesh ie. back plate\r\n\r\n        if (!this.shareMaterials) {\r\n            this._material.dispose();\r\n        }\r\n\r\n        this._model.dispose();\r\n    }\r\n}\r\n","import { Button3D } from \"./button3D\";\r\n\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport { StandardMaterial } from \"core/Materials/standardMaterial\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport { Mesh } from \"core/Meshes/mesh\";\r\nimport { CreatePlane } from \"core/Meshes/Builders/planeBuilder\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport { FadeInOutBehavior } from \"core/Behaviors/Meshes/fadeInOutBehavior\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport { FluentMaterial } from \"../materials/fluent/fluentMaterial\";\r\nimport { StackPanel } from \"../../2D/controls/stackPanel\";\r\nimport { Image } from \"../../2D/controls/image\";\r\nimport { TextBlock } from \"../../2D/controls/textBlock\";\r\nimport { AdvancedDynamicTexture } from \"../../2D/advancedDynamicTexture\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\nimport { DomManagement } from \"core/Misc/domManagement\";\r\n\r\n/**\r\n * Class used to create a holographic button in 3D\r\n */\r\nexport class HolographicButton extends Button3D {\r\n    private _backPlate: Mesh;\r\n    private _textPlate: Mesh;\r\n    private _frontPlate: Mesh;\r\n    private _text: string;\r\n    private _imageUrl: string;\r\n    private _shareMaterials = true;\r\n    private _frontMaterial: FluentMaterial;\r\n    private _backMaterial: FluentMaterial;\r\n    private _plateMaterial: StandardMaterial;\r\n    private _pickedPointObserver: Nullable<Observer<Nullable<Vector3>>>;\r\n\r\n    // Tooltip\r\n    private _tooltipFade: Nullable<FadeInOutBehavior>;\r\n    private _tooltipTextBlock: Nullable<TextBlock>;\r\n    private _tooltipTexture: Nullable<AdvancedDynamicTexture>;\r\n    private _tooltipMesh: Nullable<Mesh>;\r\n    private _tooltipHoverObserver: Nullable<Observer<Control3D>>;\r\n    private _tooltipOutObserver: Nullable<Observer<Control3D>>;\r\n\r\n    private _disposeTooltip() {\r\n        this._tooltipFade = null;\r\n        if (this._tooltipTextBlock) {\r\n            this._tooltipTextBlock.dispose();\r\n        }\r\n        if (this._tooltipTexture) {\r\n            this._tooltipTexture.dispose();\r\n        }\r\n        if (this._tooltipMesh) {\r\n            this._tooltipMesh.dispose();\r\n        }\r\n        this.onPointerEnterObservable.remove(this._tooltipHoverObserver);\r\n        this.onPointerOutObservable.remove(this._tooltipOutObserver);\r\n    }\r\n\r\n    /**\r\n     * Rendering ground id of all the mesh in the button\r\n     */\r\n    public set renderingGroupId(id: number) {\r\n        this._backPlate.renderingGroupId = id;\r\n        this._textPlate.renderingGroupId = id;\r\n        this._frontPlate.renderingGroupId = id;\r\n\r\n        if (this._tooltipMesh) {\r\n            this._tooltipMesh.renderingGroupId = id;\r\n        }\r\n    }\r\n    public get renderingGroupId(): number {\r\n        return this._backPlate.renderingGroupId;\r\n    }\r\n\r\n    /**\r\n     * Text to be displayed on the tooltip shown when hovering on the button. When set to null tooltip is disabled. (Default: null)\r\n     */\r\n    public set tooltipText(text: Nullable<string>) {\r\n        if (!text) {\r\n            this._disposeTooltip();\r\n            return;\r\n        }\r\n        if (!this._tooltipFade) {\r\n            const rightHandedScene = this._backPlate._scene.useRightHandedSystem;\r\n            // Create tooltip with mesh and text\r\n            this._tooltipMesh = CreatePlane(\"\", { size: 1 }, this._backPlate._scene);\r\n            const tooltipBackground = CreatePlane(\"\", { size: 1, sideOrientation: Mesh.DOUBLESIDE }, this._backPlate._scene);\r\n            const mat = new StandardMaterial(\"\", this._backPlate._scene);\r\n            mat.diffuseColor = Color3.FromHexString(\"#212121\");\r\n            tooltipBackground.material = mat;\r\n            tooltipBackground.isPickable = false;\r\n            this._tooltipMesh.addChild(tooltipBackground);\r\n            tooltipBackground.position = Vector3.Forward(rightHandedScene).scale(0.05);\r\n            this._tooltipMesh.scaling.y = 1 / 3;\r\n            this._tooltipMesh.position = Vector3.Up().scale(0.7).add(Vector3.Forward(rightHandedScene).scale(-0.15));\r\n            this._tooltipMesh.isPickable = false;\r\n            this._tooltipMesh.parent = this._backPlate;\r\n\r\n            // Create text texture for the tooltip\r\n            this._tooltipTexture = AdvancedDynamicTexture.CreateForMesh(this._tooltipMesh);\r\n            this._tooltipTextBlock = new TextBlock();\r\n            this._tooltipTextBlock.scaleY = 3;\r\n            this._tooltipTextBlock.color = \"white\";\r\n            this._tooltipTextBlock.fontSize = 130;\r\n            this._tooltipTexture.addControl(this._tooltipTextBlock);\r\n\r\n            // Add hover action to tooltip\r\n            this._tooltipFade = new FadeInOutBehavior();\r\n            this._tooltipFade.delay = 500;\r\n            this._tooltipMesh.addBehavior(this._tooltipFade);\r\n            this._tooltipHoverObserver = this.onPointerEnterObservable.add(() => {\r\n                if (this._tooltipFade) {\r\n                    this._tooltipFade.fadeIn(true);\r\n                }\r\n            });\r\n            this._tooltipOutObserver = this.onPointerOutObservable.add(() => {\r\n                if (this._tooltipFade) {\r\n                    this._tooltipFade.fadeIn(false);\r\n                }\r\n            });\r\n        }\r\n        if (this._tooltipTextBlock) {\r\n            this._tooltipTextBlock.text = text;\r\n        }\r\n    }\r\n\r\n    public get tooltipText() {\r\n        if (this._tooltipTextBlock) {\r\n            return this._tooltipTextBlock.text;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text for the button\r\n     */\r\n    public get text(): string {\r\n        return this._text;\r\n    }\r\n\r\n    public set text(value: string) {\r\n        if (this._text === value) {\r\n            return;\r\n        }\r\n\r\n        this._text = value;\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image url for the button\r\n     */\r\n    public get imageUrl(): string {\r\n        return this._imageUrl;\r\n    }\r\n\r\n    public set imageUrl(value: string) {\r\n        if (this._imageUrl === value) {\r\n            return;\r\n        }\r\n\r\n        this._imageUrl = value;\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Gets the back material used by this button\r\n     */\r\n    public get backMaterial(): FluentMaterial {\r\n        return this._backMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the front material used by this button\r\n     */\r\n    public get frontMaterial(): FluentMaterial {\r\n        return this._frontMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the plate material used by this button\r\n     */\r\n    public get plateMaterial(): StandardMaterial {\r\n        return this._plateMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this button shares its material with other HolographicButtons\r\n     */\r\n    public get shareMaterials(): boolean {\r\n        return this._shareMaterials;\r\n    }\r\n\r\n    /**\r\n     * Creates a new button\r\n     * @param name defines the control name\r\n     * @param shareMaterials\r\n     */\r\n    constructor(name?: string, shareMaterials = true) {\r\n        super(name);\r\n\r\n        this._shareMaterials = shareMaterials;\r\n\r\n        // Default animations\r\n        this.pointerEnterAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this._frontPlate.setEnabled(true);\r\n        };\r\n\r\n        this.pointerOutAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this._frontPlate.setEnabled(false);\r\n        };\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"HolographicButton\";\r\n    }\r\n\r\n    private _rebuildContent(): void {\r\n        this._disposeFacadeTexture();\r\n\r\n        const panel = new StackPanel();\r\n        panel.isVertical = true;\r\n\r\n        if (DomManagement.IsDocumentAvailable() && !!document.createElement) {\r\n            if (this._imageUrl) {\r\n                const image = new Image();\r\n                image.source = this._imageUrl;\r\n                image.paddingTop = \"40px\";\r\n                image.height = \"180px\";\r\n                image.width = \"100px\";\r\n                image.paddingBottom = \"40px\";\r\n                panel.addControl(image);\r\n            }\r\n        }\r\n\r\n        if (this._text) {\r\n            const text = new TextBlock();\r\n            text.text = this._text;\r\n            text.color = \"white\";\r\n            text.height = \"30px\";\r\n            text.fontSize = 24;\r\n            panel.addControl(text);\r\n        }\r\n\r\n        if (this._frontPlate) {\r\n            this.content = panel;\r\n        }\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        this._backPlate = CreateBox(\r\n            this.name + \"BackMesh\",\r\n            {\r\n                width: 1.0,\r\n                height: 1.0,\r\n                depth: 0.08,\r\n            },\r\n            scene\r\n        );\r\n\r\n        this._frontPlate = CreateBox(\r\n            this.name + \"FrontMesh\",\r\n            {\r\n                width: 1.0,\r\n                height: 1.0,\r\n                depth: 0.08,\r\n            },\r\n            scene\r\n        );\r\n\r\n        this._frontPlate.parent = this._backPlate;\r\n        this._frontPlate.position = Vector3.Forward(scene.useRightHandedSystem).scale(-0.08);\r\n        this._frontPlate.isPickable = false;\r\n        this._frontPlate.setEnabled(false);\r\n\r\n        this._textPlate = <Mesh>super._createNode(scene);\r\n        this._textPlate.parent = this._backPlate;\r\n        this._textPlate.position = Vector3.Forward(scene.useRightHandedSystem).scale(-0.08);\r\n        this._textPlate.isPickable = false;\r\n\r\n        return this._backPlate;\r\n    }\r\n\r\n    protected _applyFacade(facadeTexture: AdvancedDynamicTexture) {\r\n        this._plateMaterial.emissiveTexture = facadeTexture;\r\n        this._plateMaterial.opacityTexture = facadeTexture;\r\n    }\r\n\r\n    private _createBackMaterial(mesh: Mesh) {\r\n        this._backMaterial = new FluentMaterial(this.name + \"Back Material\", mesh.getScene());\r\n        this._backMaterial.renderHoverLight = true;\r\n        this._pickedPointObserver = this._host.onPickedPointChangedObservable.add((pickedPoint) => {\r\n            if (pickedPoint) {\r\n                this._backMaterial.hoverPosition = pickedPoint;\r\n                this._backMaterial.hoverColor.a = 1.0;\r\n            } else {\r\n                this._backMaterial.hoverColor.a = 0;\r\n            }\r\n        });\r\n    }\r\n\r\n    private _createFrontMaterial(mesh: Mesh) {\r\n        this._frontMaterial = new FluentMaterial(this.name + \"Front Material\", mesh.getScene());\r\n        this._frontMaterial.innerGlowColorIntensity = 0; // No inner glow\r\n        this._frontMaterial.alpha = 0.5; // Additive\r\n        this._frontMaterial.renderBorders = true;\r\n    }\r\n\r\n    private _createPlateMaterial(mesh: Mesh) {\r\n        this._plateMaterial = new StandardMaterial(this.name + \"Plate Material\", mesh.getScene());\r\n        this._plateMaterial.specularColor = Color3.Black();\r\n    }\r\n\r\n    protected _affectMaterial(mesh: Mesh) {\r\n        // Back\r\n        if (this._shareMaterials) {\r\n            if (!this._host._sharedMaterials[\"backFluentMaterial\"]) {\r\n                this._createBackMaterial(mesh);\r\n                this._host._sharedMaterials[\"backFluentMaterial\"] = this._backMaterial;\r\n            } else {\r\n                this._backMaterial = this._host._sharedMaterials[\"backFluentMaterial\"] as FluentMaterial;\r\n            }\r\n\r\n            // Front\r\n            if (!this._host._sharedMaterials[\"frontFluentMaterial\"]) {\r\n                this._createFrontMaterial(mesh);\r\n                this._host._sharedMaterials[\"frontFluentMaterial\"] = this._frontMaterial;\r\n            } else {\r\n                this._frontMaterial = this._host._sharedMaterials[\"frontFluentMaterial\"] as FluentMaterial;\r\n            }\r\n        } else {\r\n            this._createBackMaterial(mesh);\r\n            this._createFrontMaterial(mesh);\r\n        }\r\n\r\n        this._createPlateMaterial(mesh);\r\n        this._backPlate.material = this._backMaterial;\r\n        this._frontPlate.material = this._frontMaterial;\r\n        this._textPlate.material = this._plateMaterial;\r\n\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose(); // will dispose main mesh ie. back plate\r\n\r\n        this._disposeTooltip();\r\n\r\n        if (!this.shareMaterials) {\r\n            this._backMaterial.dispose();\r\n            this._frontMaterial.dispose();\r\n            this._plateMaterial.dispose();\r\n\r\n            if (this._pickedPointObserver) {\r\n                this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver);\r\n                this._pickedPointObserver = null;\r\n            }\r\n        }\r\n    }\r\n}\r\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"fluentButtonPixelShader\";\nconst shader = `uniform vec3 cameraPosition;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\runiform float _Edge_Width_;\runiform vec4 _Edge_Color_;\runiform bool _Relative_Width_;\runiform float _Proximity_Max_Intensity_;\runiform float _Proximity_Far_Distance_;\runiform float _Proximity_Near_Radius_;\runiform float _Proximity_Anisotropy_;\runiform float _Selection_Fuzz_;\runiform float _Selected_;\runiform float _Selection_Fade_;\runiform float _Selection_Fade_Size_;\runiform float _Selected_Distance_;\runiform float _Selected_Fade_Length_;\runiform bool _Blob_Enable_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Inner_Fade_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform bool _Blob_Enable_2_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Inner_Fade_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform vec3 _Active_Face_Dir_;\runiform vec3 _Active_Face_Up_;\runiform bool Enable_Fade;\runiform float _Fade_Width_;\runiform bool _Smooth_Active_Face_;\runiform bool _Show_Frame_;\runiform bool _Use_Blob_Texture_;\runiform bool Use_Global_Left_Index;\runiform bool Use_Global_Right_Index;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\runiform vec4 Global_Left_Thumb_Tip_Position;\runiform vec4 Global_Right_Thumb_Tip_Position;\runiform float Global_Left_Index_Tip_Proximity;\runiform float Global_Right_Index_Tip_Proximity;\rvoid Holo_Edge_Fragment_B35(\rvec4 Edges,\rfloat Edge_Width,\rout float NotEdge)\r{\rvec2 c=vec2(min(Edges.r,Edges.g),min(Edges.b,Edges.a));\rvec2 df=fwidth(c)*Edge_Width;\rvec2 g=clamp(c/df,0.0,1.0);\rNotEdge=g.x*g.y;\r}\rvoid Blob_Fragment_B39(\rvec2 UV,\rvec3 Blob_Info,\rsampler2D Blob_Texture,\rout vec4 Blob_Color)\r{\rfloat k=dot(UV,UV);\rBlob_Color=Blob_Info.y*texture(Blob_Texture,vec2(vec2(sqrt(k),Blob_Info.x).x,1.0-vec2(sqrt(k),Blob_Info.x).y))*(1.0-clamp(k,0.0,1.0));\r}\rvec2 FilterStep(vec2 Edge,vec2 X)\r{\rvec2 dX=max(fwidth(X),vec2(0.00001,0.00001));\rreturn clamp( (X+dX-max(Edge,X-dX))/(dX*2.0),0.0,1.0);\r}\rvoid Wireframe_Fragment_B59(\rvec3 Widths,\rvec2 UV,\rfloat Proximity,\rvec4 Edge_Color,\rout vec4 Wireframe)\r{\rvec2 c=min(UV,vec2(1.0,1.0)-UV);\rvec2 g=FilterStep(Widths.xy*0.5,c); \rWireframe=(1.0-min(g.x,g.y))*Proximity*Edge_Color;\r}\rvoid Proximity_B53(\rvec3 Proximity_Center,\rvec3 Proximity_Center_2,\rfloat Proximity_Max_Intensity,\rfloat Proximity_Near_Radius,\rvec3 Position,\rvec3 Show_Selection,\rvec4 Extra1,\rfloat Dist_To_Face,\rfloat Intensity,\rout float Proximity)\r{\rvec2 delta1=Extra1.xy;\rvec2 delta2=Extra1.zw;\rfloat d2=sqrt(min(dot(delta1,delta1),dot(delta2,delta2))+Dist_To_Face*Dist_To_Face);\rProximity=Intensity*Proximity_Max_Intensity*(1.0-clamp(d2/Proximity_Near_Radius,0.0,1.0))*(1.0-Show_Selection.x)+Show_Selection.x;\r}\rvoid To_XYZ_B46(\rvec3 Vec3,\rout float X,\rout float Y,\rout float Z)\r{\rX=Vec3.x;\rY=Vec3.y;\rZ=Vec3.z;\r}\rvoid main()\r{\rfloat NotEdge_Q35;\r#if ENABLE_FADE\nHolo_Edge_Fragment_B35(vColor,_Fade_Width_,NotEdge_Q35);\r#else\nNotEdge_Q35=1.0;\r#endif\nvec4 Blob_Color_Q39;\rfloat k=dot(vUV,vUV);\rvec2 blobTextureCoord=vec2(vec2(sqrt(k),vTangent.x).x,1.0-vec2(sqrt(k),vTangent.x).y);\rvec4 blobColor=mix(vec4(1.0,1.0,1.0,1.0)*step(1.0-vTangent.x,clamp(sqrt(k)+0.1,0.0,1.0)),texture(_Blob_Texture_,blobTextureCoord),float(_Use_Blob_Texture_));\rBlob_Color_Q39=vTangent.y*blobColor*(1.0-clamp(k,0.0,1.0));\rfloat Is_Quad_Q24;\rIs_Quad_Q24=vNormal.z;\rvec3 Blob_Position_Q41= mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(Use_Global_Left_Index));\rvec3 Blob_Position_Q42= mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(Use_Global_Right_Index));\rfloat X_Q46;\rfloat Y_Q46;\rfloat Z_Q46;\rTo_XYZ_B46(vBinormal,X_Q46,Y_Q46,Z_Q46);\rfloat Proximity_Q53;\rProximity_B53(Blob_Position_Q41,Blob_Position_Q42,_Proximity_Max_Intensity_,_Proximity_Near_Radius_,vPosition,vBinormal,vExtra1,Y_Q46,Z_Q46,Proximity_Q53);\rvec4 Wireframe_Q59;\rWireframe_Fragment_B59(vNormal,vUV,Proximity_Q53,_Edge_Color_,Wireframe_Q59);\rvec4 Wire_Or_Blob_Q23=mix(Wireframe_Q59,Blob_Color_Q39,Is_Quad_Q24);\rvec4 Result_Q22;\rResult_Q22=mix(Wire_Or_Blob_Q23,vec4(0.3,0.3,0.3,0.3),float(_Show_Frame_));\rvec4 Final_Color_Q37=NotEdge_Q35*Result_Q22;\rvec4 Out_Color=Final_Color_Q37;\rfloat Clip_Threshold=0.0;\rbool To_sRGB=false;\rgl_FragColor=Out_Color;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const fluentButtonPixelShader = { name, shader };\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"fluentButtonVertexShader\";\nconst shader = `uniform mat4 world;\runiform mat4 viewProjection;\runiform vec3 cameraPosition;\rattribute vec3 position;\rattribute vec3 normal;\rattribute vec2 uv;\rattribute vec3 tangent;\rattribute vec4 color;\runiform float _Edge_Width_;\runiform vec4 _Edge_Color_;\runiform float _Proximity_Max_Intensity_;\runiform float _Proximity_Far_Distance_;\runiform float _Proximity_Near_Radius_;\runiform float _Proximity_Anisotropy_;\runiform float _Selection_Fuzz_;\runiform float _Selected_;\runiform float _Selection_Fade_;\runiform float _Selection_Fade_Size_;\runiform float _Selected_Distance_;\runiform float _Selected_Fade_Length_;\runiform bool _Blob_Enable_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Inner_Fade_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform bool _Blob_Enable_2_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Inner_Fade_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform vec3 _Active_Face_Dir_;\runiform vec3 _Active_Face_Up_;\runiform bool _Enable_Fade_;\runiform float _Fade_Width_;\runiform bool _Smooth_Active_Face_;\runiform bool _Show_Frame_;\runiform bool Use_Global_Left_Index;\runiform bool Use_Global_Right_Index;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\runiform vec4 Global_Left_Thumb_Tip_Position;\runiform vec4 Global_Right_Thumb_Tip_Position;\runiform float Global_Left_Index_Tip_Proximity;\runiform float Global_Right_Index_Tip_Proximity;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\rvoid Blob_Vertex_B47(\rvec3 Position,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rvec3 Blob_Position,\rfloat Intensity,\rfloat Blob_Near_Size,\rfloat Blob_Far_Size,\rfloat Blob_Near_Distance,\rfloat Blob_Far_Distance,\rvec4 Vx_Color,\rvec2 UV,\rvec3 Face_Center,\rvec2 Face_Size,\rvec2 In_UV,\rfloat Blob_Fade_Length,\rfloat Selection_Fade,\rfloat Selection_Fade_Size,\rfloat Inner_Fade,\rvec3 Active_Face_Center,\rfloat Blob_Pulse,\rfloat Blob_Fade,\rfloat Blob_Enabled,\rout vec3 Out_Position,\rout vec2 Out_UV,\rout vec3 Blob_Info)\r{\rfloat blobSize,fadeIn;\rvec3 Hit_Position;\rBlob_Info=vec3(0.0,0.0,0.0);\rfloat Hit_Distance=dot(Blob_Position-Face_Center,Normal);\rHit_Position=Blob_Position-Hit_Distance*Normal;\rfloat absD=abs(Hit_Distance);\rfloat lerpVal=clamp((absD-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\rfadeIn=1.0-clamp((absD-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\rfloat innerFade=1.0-clamp(-Hit_Distance/Inner_Fade,0.0,1.0);\rfloat farClip=clamp(1.0-step(Blob_Far_Distance+Blob_Fade_Length,absD),0.0,1.0);\rfloat size=mix(Blob_Near_Size,Blob_Far_Size,lerpVal)*farClip;\rblobSize=mix(size,Selection_Fade_Size,Selection_Fade)*innerFade*Blob_Enabled;\rBlob_Info.x=lerpVal*0.5+0.5;\rBlob_Info.y=fadeIn*Intensity*(1.0-Selection_Fade)*Blob_Fade;\rBlob_Info.x*=(1.0-Blob_Pulse);\rvec3 delta=Hit_Position-Face_Center;\rvec2 blobCenterXY=vec2(dot(delta,Tangent),dot(delta,Bitangent));\rvec2 quadUVin=2.0*UV-1.0; \rvec2 blobXY=blobCenterXY+quadUVin*blobSize;\rvec2 blobClipped=clamp(blobXY,-Face_Size*0.5,Face_Size*0.5);\rvec2 blobUV=(blobClipped-blobCenterXY)/max(blobSize,0.0001)*2.0;\rvec3 blobCorner=Face_Center+blobClipped.x*Tangent+blobClipped.y*Bitangent;\rOut_Position=mix(Position,blobCorner,Vx_Color.rrr);\rOut_UV=mix(In_UV,blobUV,Vx_Color.rr);\r}\rvec2 ProjectProximity(\rvec3 blobPosition,\rvec3 position,\rvec3 center,\rvec3 dir,\rvec3 xdir,\rvec3 ydir,\rout float vdistance\r)\r{\rvec3 delta=blobPosition-position;\rvec2 xy=vec2(dot(delta,xdir),dot(delta,ydir));\rvdistance=abs(dot(delta,dir));\rreturn xy;\r}\rvoid Proximity_Vertex_B66(\rvec3 Blob_Position,\rvec3 Blob_Position_2,\rvec3 Active_Face_Center,\rvec3 Active_Face_Dir,\rvec3 Position,\rfloat Proximity_Far_Distance,\rfloat Relative_Scale,\rfloat Proximity_Anisotropy,\rvec3 Up,\rout vec4 Extra1,\rout float Distance_To_Face,\rout float Intensity)\r{\rvec3 Active_Face_Dir_X=normalize(cross(Active_Face_Dir,Up));\rvec3 Active_Face_Dir_Y=cross(Active_Face_Dir,Active_Face_Dir_X);\rfloat distz1,distz2;\rExtra1.xy=ProjectProximity(Blob_Position,Position,Active_Face_Center,Active_Face_Dir,Active_Face_Dir_X*Proximity_Anisotropy,Active_Face_Dir_Y,distz1)/Relative_Scale;\rExtra1.zw=ProjectProximity(Blob_Position_2,Position,Active_Face_Center,Active_Face_Dir,Active_Face_Dir_X*Proximity_Anisotropy,Active_Face_Dir_Y,distz2)/Relative_Scale;\rDistance_To_Face=dot(Active_Face_Dir,Position-Active_Face_Center);\rIntensity=1.0-clamp(min(distz1,distz2)/Proximity_Far_Distance,0.0,1.0);\r}\rvoid Holo_Edge_Vertex_B44(\rvec3 Incident,\rvec3 Normal,\rvec2 UV,\rvec3 Tangent,\rvec3 Bitangent,\rbool Smooth_Active_Face,\rfloat Active,\rout vec4 Holo_Edges)\r{\rfloat NdotI=dot(Incident,Normal);\rvec2 flip=(UV-vec2(0.5,0.5));\rfloat udot=dot(Incident,Tangent)*flip.x*NdotI;\rfloat uval=1.0-float(udot>0.0);\rfloat vdot=-dot(Incident,Bitangent)*flip.y*NdotI;\rfloat vval=1.0-float(vdot>0.0);\rfloat Smooth_And_Active=step(1.0,float(Smooth_Active_Face && Active>0.0));\ruval=mix(uval,max(1.0,uval),Smooth_And_Active); \rvval=mix(vval,max(1.0,vval),Smooth_And_Active);\rHolo_Edges=vec4(1.0,1.0,1.0,1.0)-vec4(uval*UV.x,uval*(1.0-UV.x),vval*UV.y,vval*(1.0-UV.y));\r}\rvoid Object_To_World_Pos_B13(\rvec3 Pos_Object,\rout vec3 Pos_World)\r{\rPos_World=(world*vec4(Pos_Object,1.0)).xyz;\r}\rvoid Choose_Blob_B38(\rvec4 Vx_Color,\rvec3 Position1,\rvec3 Position2,\rbool Blob_Enable_1,\rbool Blob_Enable_2,\rfloat Near_Size_1,\rfloat Near_Size_2,\rfloat Blob_Inner_Fade_1,\rfloat Blob_Inner_Fade_2,\rfloat Blob_Pulse_1,\rfloat Blob_Pulse_2,\rfloat Blob_Fade_1,\rfloat Blob_Fade_2,\rout vec3 Position,\rout float Near_Size,\rout float Inner_Fade,\rout float Blob_Enable,\rout float Fade,\rout float Pulse)\r{\rPosition=Position1*(1.0-Vx_Color.g)+Vx_Color.g*Position2;\rfloat b1=float(Blob_Enable_1);\rfloat b2=float(Blob_Enable_2);\rBlob_Enable=b1+(b2-b1)*Vx_Color.g;\rPulse=Blob_Pulse_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Pulse_2;\rFade=Blob_Fade_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Fade_2;\rNear_Size=Near_Size_1*(1.0-Vx_Color.g)+Vx_Color.g*Near_Size_2;\rInner_Fade=Blob_Inner_Fade_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Inner_Fade_2;\r}\rvoid Wireframe_Vertex_B51(\rvec3 Position,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rfloat Edge_Width,\rvec2 Face_Size,\rout vec3 Wire_Vx_Pos,\rout vec2 UV,\rout vec2 Widths)\r{\rWidths.xy=Edge_Width/Face_Size;\rfloat x=dot(Position,Tangent);\rfloat y=dot(Position,Bitangent);\rfloat dx=0.5-abs(x);\rfloat newx=(0.5-dx*Widths.x*2.0)*sign(x);\rfloat dy=0.5-abs(y);\rfloat newy=(0.5-dy*Widths.y*2.0)*sign(y);\rWire_Vx_Pos=Normal*0.5+newx*Tangent+newy*Bitangent;\rUV.x=dot(Wire_Vx_Pos,Tangent)+0.5;\rUV.y=dot(Wire_Vx_Pos,Bitangent)+0.5;\r}\rvec2 ramp2(vec2 start,vec2 end,vec2 x)\r{\rreturn clamp((x-start)/(end-start),vec2(0.0,0.0),vec2(1.0,1.0));\r}\rfloat computeSelection(\rvec3 blobPosition,\rvec3 normal,\rvec3 tangent,\rvec3 bitangent,\rvec3 faceCenter,\rvec2 faceSize,\rfloat selectionFuzz,\rfloat farDistance,\rfloat fadeLength\r)\r{\rvec3 delta=blobPosition-faceCenter;\rfloat absD=abs(dot(delta,normal));\rfloat fadeIn=1.0-clamp((absD-farDistance)/fadeLength,0.0,1.0);\rvec2 blobCenterXY=vec2(dot(delta,tangent),dot(delta,bitangent));\rvec2 innerFace=faceSize*(1.0-selectionFuzz)*0.5;\rvec2 selectPulse=ramp2(-faceSize*0.5,-innerFace,blobCenterXY)-ramp2(innerFace,faceSize*0.5,blobCenterXY);\rreturn selectPulse.x*selectPulse.y*fadeIn;\r}\rvoid Selection_Vertex_B48(\rvec3 Blob_Position,\rvec3 Blob_Position_2,\rvec3 Face_Center,\rvec2 Face_Size,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rfloat Selection_Fuzz,\rfloat Selected,\rfloat Far_Distance,\rfloat Fade_Length,\rvec3 Active_Face_Dir,\rout float Show_Selection)\r{\rfloat select1=computeSelection(Blob_Position,Normal,Tangent,Bitangent,Face_Center,Face_Size,Selection_Fuzz,Far_Distance,Fade_Length);\rfloat select2=computeSelection(Blob_Position_2,Normal,Tangent,Bitangent,Face_Center,Face_Size,Selection_Fuzz,Far_Distance,Fade_Length);\rfloat Active=max(0.0,dot(Active_Face_Dir,Normal));\rShow_Selection=mix(max(select1,select2),1.0,Selected)*Active;\r}\rvoid Proximity_Visibility_B54(\rfloat Selection,\rvec3 Proximity_Center,\rvec3 Proximity_Center_2,\rfloat Input_Width,\rfloat Proximity_Far_Distance,\rfloat Proximity_Radius,\rvec3 Active_Face_Center,\rvec3 Active_Face_Dir,\rout float Width)\r{\rvec3 boxEdges=(world*vec4(vec3(0.5,0.5,0.5),0.0)).xyz;\rfloat boxMaxSize=length(boxEdges);\rfloat d1=dot(Proximity_Center-Active_Face_Center,Active_Face_Dir);\rvec3 blob1=Proximity_Center-d1*Active_Face_Dir;\rfloat d2=dot(Proximity_Center_2-Active_Face_Center,Active_Face_Dir);\rvec3 blob2=Proximity_Center_2-d2*Active_Face_Dir;\rvec3 delta1=blob1-Active_Face_Center;\rvec3 delta2=blob2-Active_Face_Center;\rfloat dist1=dot(delta1,delta1);\rfloat dist2=dot(delta2,delta2);\rfloat nearestProxDist=sqrt(min(dist1,dist2));\rWidth=Input_Width*(1.0-step(boxMaxSize+Proximity_Radius,nearestProxDist))*(1.0-step(Proximity_Far_Distance,min(d1,d2))*(1.0-step(0.0001,Selection)));\r}\rvoid Object_To_World_Dir_B67(\rvec3 Dir_Object,\rout vec3 Dir_World)\r{\rDir_World=(world*vec4(Dir_Object,0.0)).xyz;\r}\rvoid main()\r{\rvec3 Active_Face_Center_Q49;\rActive_Face_Center_Q49=(world*vec4(_Active_Face_Dir_*0.5,1.0)).xyz;\rvec3 Blob_Position_Q41= mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(Use_Global_Left_Index));\rvec3 Blob_Position_Q42= mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(Use_Global_Right_Index));\rvec3 Active_Face_Dir_Q64=normalize((world*vec4(_Active_Face_Dir_,0.0)).xyz);\rfloat Relative_Scale_Q57;\r#if RELATIVE_WIDTH\nRelative_Scale_Q57=length((world*vec4(vec3(0,1,0),0.0)).xyz);\r#else\nRelative_Scale_Q57=1.0;\r#endif\nvec3 Tangent_World_Q30;\rTangent_World_Q30=(world*vec4(tangent,0.0)).xyz;\rvec3 Binormal_World_Q31;\rBinormal_World_Q31=(world*vec4((cross(normal,tangent)),0.0)).xyz;\rvec3 Normal_World_Q60;\rNormal_World_Q60=(world*vec4(normal,0.0)).xyz;\rvec3 Result_Q18=0.5*normal;\rvec3 Dir_World_Q67;\rObject_To_World_Dir_B67(_Active_Face_Up_,Dir_World_Q67);\rfloat Product_Q56=_Edge_Width_*Relative_Scale_Q57;\rvec3 Normal_World_N_Q29=normalize(Normal_World_Q60);\rvec3 Tangent_World_N_Q28=normalize(Tangent_World_Q30);\rvec3 Binormal_World_N_Q32=normalize(Binormal_World_Q31);\rvec3 Position_Q38;\rfloat Near_Size_Q38;\rfloat Inner_Fade_Q38;\rfloat Blob_Enable_Q38;\rfloat Fade_Q38;\rfloat Pulse_Q38;\rChoose_Blob_B38(color,Blob_Position_Q41,Blob_Position_Q42,_Blob_Enable_,_Blob_Enable_2_,_Blob_Near_Size_,_Blob_Near_Size_2_,_Blob_Inner_Fade_,_Blob_Inner_Fade_2_,_Blob_Pulse_,_Blob_Pulse_2_,_Blob_Fade_,_Blob_Fade_2_,Position_Q38,Near_Size_Q38,Inner_Fade_Q38,Blob_Enable_Q38,Fade_Q38,Pulse_Q38);\rvec3 Face_Center_Q33;\rFace_Center_Q33=(world*vec4(Result_Q18,1.0)).xyz;\rvec2 Face_Size_Q50=vec2(length(Tangent_World_Q30),length(Binormal_World_Q31));\rfloat Show_Selection_Q48;\rSelection_Vertex_B48(Blob_Position_Q41,Blob_Position_Q42,Face_Center_Q33,Face_Size_Q50,Normal_World_N_Q29,Tangent_World_N_Q28,Binormal_World_N_Q32,_Selection_Fuzz_,_Selected_,_Selected_Distance_,_Selected_Fade_Length_,Active_Face_Dir_Q64,Show_Selection_Q48);\rvec3 Normalized_Q72=normalize(Dir_World_Q67);\rfloat Active_Q34=max(0.0,dot(Active_Face_Dir_Q64,Normal_World_N_Q29));\rfloat Width_Q54;\rProximity_Visibility_B54(Show_Selection_Q48,Blob_Position_Q41,Blob_Position_Q42,Product_Q56,_Proximity_Far_Distance_,_Proximity_Near_Radius_,Active_Face_Center_Q49,Active_Face_Dir_Q64,Width_Q54);\rvec3 Wire_Vx_Pos_Q51;\rvec2 UV_Q51;\rvec2 Widths_Q51;\rWireframe_Vertex_B51(position,normal,tangent,(cross(normal,tangent)),Width_Q54,Face_Size_Q50,Wire_Vx_Pos_Q51,UV_Q51,Widths_Q51);\rvec3 Vec3_Q27=vec3(Widths_Q51.x,Widths_Q51.y,color.r);\rvec3 Pos_World_Q13;\rObject_To_World_Pos_B13(Wire_Vx_Pos_Q51,Pos_World_Q13);\rvec3 Incident_Q36=normalize(Pos_World_Q13-cameraPosition);\rvec3 Out_Position_Q47;\rvec2 Out_UV_Q47;\rvec3 Blob_Info_Q47;\rBlob_Vertex_B47(Pos_World_Q13,Normal_World_N_Q29,Tangent_World_N_Q28,Binormal_World_N_Q32,Position_Q38,_Blob_Intensity_,Near_Size_Q38,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,color,uv,Face_Center_Q33,Face_Size_Q50,UV_Q51,_Blob_Fade_Length_,_Selection_Fade_,_Selection_Fade_Size_,Inner_Fade_Q38,Active_Face_Center_Q49,Pulse_Q38,Fade_Q38,Blob_Enable_Q38,Out_Position_Q47,Out_UV_Q47,Blob_Info_Q47);\rvec4 Extra1_Q66;\rfloat Distance_To_Face_Q66;\rfloat Intensity_Q66;\rProximity_Vertex_B66(Blob_Position_Q41,Blob_Position_Q42,Active_Face_Center_Q49,Active_Face_Dir_Q64,Pos_World_Q13,_Proximity_Far_Distance_,Relative_Scale_Q57,_Proximity_Anisotropy_,Normalized_Q72,Extra1_Q66,Distance_To_Face_Q66,Intensity_Q66);\rvec4 Holo_Edges_Q44;\rHolo_Edge_Vertex_B44(Incident_Q36,Normal_World_N_Q29,uv,Tangent_World_Q30,Binormal_World_Q31,_Smooth_Active_Face_,Active_Q34,Holo_Edges_Q44);\rvec3 Vec3_Q19=vec3(Show_Selection_Q48,Distance_To_Face_Q66,Intensity_Q66);\rvec3 Position=Out_Position_Q47;\rvec2 UV=Out_UV_Q47;\rvec3 Tangent=Blob_Info_Q47;\rvec3 Binormal=Vec3_Q19;\rvec3 Normal=Vec3_Q27;\rvec4 Extra1=Extra1_Q66;\rvec4 Color=Holo_Edges_Q44;\rgl_Position=viewProjection*vec4(Position,1);\rvPosition=Position;\rvNormal=Normal;\rvUV=UV;\rvTangent=Tangent;\rvBinormal=Binormal;\rvColor=Color;\rvExtra1=Extra1;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const fluentButtonVertexShader = { name, shader };\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport { serializeAsColor4, serializeAsVector3, serialize, SerializationHelper } from \"core/Misc/decorators\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Vector3, Vector4 } from \"core/Maths/math.vector\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { Color3, Color4 } from \"core/Maths/math.color\";\r\nimport { EffectFallbacks } from \"core/Materials/effectFallbacks\";\r\nimport { Constants } from \"core/Engines/constants\";\r\n\r\nimport \"./shaders/fluentButton.fragment\";\r\nimport \"./shaders/fluentButton.vertex\";\r\n\r\n/** @internal */\r\nclass FluentButtonMaterialDefines extends MaterialDefines {\r\n    public RELATIVE_WIDTH = true;\r\n    public ENABLE_FADE = true;\r\n\r\n    constructor() {\r\n        super();\r\n        this._needNormals = true;\r\n        this._needUVs = true;\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\n/**\r\n * Class used to render square buttons with fluent design\r\n * @since 5.0.0\r\n */\r\nexport class FluentButtonMaterial extends PushMaterial {\r\n    /**\r\n     * URL pointing to the texture used to define the coloring for the fluent blob effect.\r\n     */\r\n    public static BLOB_TEXTURE_URL = \"https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-button-blob.png\";\r\n\r\n    /**\r\n     * Gets or sets the width of the glowing edge, relative to the scale of the button.\r\n     * (Default is 4% of the height).\r\n     */\r\n    @serialize()\r\n    public edgeWidth = 0.04;\r\n\r\n    /**\r\n     * Gets or sets the color of the glowing edge.\r\n     */\r\n    @serializeAsColor4()\r\n    public edgeColor = new Color4(0.592157, 0.592157, 0.592157, 1.0);\r\n\r\n    /**\r\n     * Gets or sets the maximum intensity of the proximity light.\r\n     */\r\n    @serialize()\r\n    public proximityMaxIntensity = 0.45;\r\n\r\n    /**\r\n     * Gets or sets the maximum distance for the proximity light (Default is 16mm).\r\n     */\r\n    @serialize()\r\n    public proximityFarDistance = 0.16;\r\n\r\n    /**\r\n     * Gets or sets the radius of the proximity light when near to the surface.\r\n     */\r\n    @serialize()\r\n    public proximityNearRadius = 1.5;\r\n\r\n    /**\r\n     * Gets or sets the anisotropy of the proximity light.\r\n     */\r\n    @serialize()\r\n    public proximityAnisotropy = 1;\r\n\r\n    /**\r\n     * Gets or sets the amount of fuzzing in the selection focus.\r\n     */\r\n    @serialize()\r\n    public selectionFuzz = 0.5;\r\n\r\n    /**\r\n     * Gets or sets an override value to display the button as selected.\r\n     */\r\n    @serialize()\r\n    public selected = 0;\r\n\r\n    /**\r\n     * Gets or sets a value to manually fade the blob size.\r\n     */\r\n    @serialize()\r\n    public selectionFade = 0;\r\n\r\n    /**\r\n     * Gets or sets a value to manually shrink the blob size as it fades (see selectionFade).\r\n     */\r\n    @serialize()\r\n    public selectionFadeSize = 0.3;\r\n\r\n    /**\r\n     * Gets or sets the distance from the button the cursor should be for the button\r\n     * to appear selected (Default is 8cm).\r\n     */\r\n    @serialize()\r\n    public selectedDistance = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the fall-off distance for the selection fade (Default is 8cm).\r\n     */\r\n    @serialize()\r\n    public selectedFadeLength = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the intensity of the luminous blob (Ranges 0-1, default is 0.5).\r\n     */\r\n    @serialize()\r\n    public blobIntensity = 0.5;\r\n\r\n    /**\r\n     * The size of the blob when the pointer is at the blobFarDistance (Default is 5cm).\r\n     */\r\n    @serialize()\r\n    public blobFarSize = 0.05;\r\n\r\n    /**\r\n     * The distance at which the pointer is considered near. See [left|right]BlobNearSize. (Default is 0cm).\r\n     */\r\n    @serialize()\r\n    public blobNearDistance = 0;\r\n\r\n    /**\r\n     * The distance at which the pointer is considered far. See [left|right]BlobFarSize. (Default is 8cm).\r\n     */\r\n    @serialize()\r\n    public blobFarDistance = 0.08;\r\n\r\n    /**\r\n     * The distance over which the blob intensity fades from full to none (Default is 8cm).\r\n     */\r\n    @serialize()\r\n    public blobFadeLength = 0.08;\r\n\r\n    /**\r\n     * Gets or sets whether the blob corresponding to the left index finger is enabled.\r\n     */\r\n    @serialize()\r\n    public leftBlobEnable = true;\r\n\r\n    /**\r\n     * Gets or sets the size of the left blob when the left pointer is considered near. See blobNearDistance. (Default is 2.5cm).\r\n     */\r\n    @serialize()\r\n    public leftBlobNearSize = 0.025;\r\n\r\n    /**\r\n     * Gets or sets the progress of the pulse animation on the left blob (Ranges 0-1).\r\n     */\r\n    @serialize()\r\n    public leftBlobPulse = 0;\r\n\r\n    /**\r\n     * Gets or sets the fade factor on the left blob.\r\n     */\r\n    @serialize()\r\n    public leftBlobFade = 1;\r\n\r\n    /**\r\n     * Gets or sets the inner fade on the left blob;\r\n     */\r\n    @serialize()\r\n    public leftBlobInnerFade = 0.01;\r\n\r\n    /**\r\n     * Gets or sets whether the blob corresponding to the right index finger is enabled.\r\n     */\r\n    @serialize()\r\n    public rightBlobEnable = true;\r\n\r\n    /**\r\n     * Gets or sets the size of the right blob when the right pointer is considered near. See blobNearDistance. (Default is 2.5cm).\r\n     */\r\n    @serialize()\r\n    public rightBlobNearSize = 0.025;\r\n\r\n    /**\r\n     * Gets or sets the progress of the pulse animation on the right blob (Ranges 0-1).\r\n     */\r\n    @serialize()\r\n    public rightBlobPulse = 0;\r\n\r\n    /**\r\n     * Gets or sets the fade factor on the right blob.\r\n     */\r\n    @serialize()\r\n    public rightBlobFade = 1;\r\n\r\n    /**\r\n     * Gets or sets the inner fade on the right blob;\r\n     */\r\n    @serialize()\r\n    public rightBlobInnerFade = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the direction of the active face before the world transform is applied.\r\n     * This should almost always be set to -z.\r\n     */\r\n    @serializeAsVector3()\r\n    public activeFaceDir = new Vector3(0, 0, -1);\r\n\r\n    /**\r\n     * Gets or sets the button's up direction before the world transform is applied.\r\n     * This should almost always be set to +y.\r\n     */\r\n    @serializeAsVector3()\r\n    public activeFaceUp = new Vector3(0, 1, 0);\r\n\r\n    /**\r\n     * Gets or sets whether the edge fade effect is enabled.\r\n     */\r\n    @serialize()\r\n    public enableFade = true;\r\n\r\n    /**\r\n     * Gets or sets a value corresponding to the width of the edge fade effect (Default 1.5).\r\n     */\r\n    @serialize()\r\n    public fadeWidth = 1.5;\r\n\r\n    /**\r\n     * Gets or sets whether the active face is smoothly interpolated.\r\n     */\r\n    @serialize()\r\n    public smoothActiveFace = true;\r\n\r\n    /**\r\n     * Gets or sets whether the frame of the fluent button model is visible.\r\n     * This is usually only enabled for debugging purposes.\r\n     */\r\n    @serialize()\r\n    public showFrame = false;\r\n\r\n    /**\r\n     * Gets or sets whether the blob color texture is used for the proximity\r\n     * light effect. This is usually only disabled for debugging purposes.\r\n     */\r\n    @serialize()\r\n    public useBlobTexture = true;\r\n\r\n    /**\r\n     * Gets or sets the world-space position of the tip of the left index finger.\r\n     */\r\n    @serializeAsVector3()\r\n    public globalLeftIndexTipPosition = Vector3.Zero();\r\n\r\n    /**\r\n     * Gets or sets the world-space position of the tip of the right index finger.\r\n     */\r\n    @serializeAsVector3()\r\n    public globalRightIndexTipPosition = Vector3.Zero();\r\n\r\n    private _blobTexture: Texture;\r\n\r\n    constructor(name: string, scene?: Scene) {\r\n        super(name, scene);\r\n        this.alphaMode = Constants.ALPHA_ADD;\r\n        this.disableDepthWrite = true;\r\n        this.backFaceCulling = false;\r\n\r\n        this._blobTexture = new Texture(FluentButtonMaterial.BLOB_TEXTURE_URL, this.getScene(), true, false, Texture.NEAREST_SAMPLINGMODE);\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    // Methods\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new FluentButtonMaterialDefines();\r\n        }\r\n\r\n        const defines = <FluentButtonMaterialDefines>subMesh.materialDefines;\r\n        const scene = this.getScene();\r\n\r\n        if (this._isReadyForSubMesh(subMesh)) {\r\n            return true;\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n\r\n        // Attribs\r\n        MaterialHelper.PrepareDefinesForAttributes(mesh, defines, true, false);\r\n\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n\r\n            scene.resetCachedMaterial();\r\n\r\n            // Fallbacks\r\n            const fallbacks = new EffectFallbacks();\r\n            if (defines.FOG) {\r\n                fallbacks.addFallback(1, \"FOG\");\r\n            }\r\n\r\n            MaterialHelper.HandleFallbacksForShadows(defines, fallbacks);\r\n\r\n            defines.IMAGEPROCESSINGPOSTPROCESS = scene.imageProcessingConfiguration.applyByPostProcess;\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n\r\n            if (defines.NORMAL) {\r\n                attribs.push(VertexBuffer.NormalKind);\r\n            }\r\n\r\n            if (defines.UV1) {\r\n                attribs.push(VertexBuffer.UVKind);\r\n            }\r\n\r\n            if (defines.UV2) {\r\n                attribs.push(VertexBuffer.UV2Kind);\r\n            }\r\n\r\n            if (defines.VERTEXCOLOR) {\r\n                attribs.push(VertexBuffer.ColorKind);\r\n            }\r\n\r\n            if (defines.TANGENT) {\r\n                attribs.push(VertexBuffer.TangentKind);\r\n            }\r\n\r\n            MaterialHelper.PrepareAttributesForInstances(attribs, defines);\r\n\r\n            // Legacy browser patch\r\n            const shaderName = \"fluentButton\";\r\n            const join = defines.toString();\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"viewProjection\",\r\n                \"cameraPosition\",\r\n\r\n                \"_Edge_Width_\",\r\n                \"_Edge_Color_\",\r\n                \"_Relative_Width_\",\r\n                \"_Proximity_Max_Intensity_\",\r\n                \"_Proximity_Far_Distance_\",\r\n                \"_Proximity_Near_Radius_\",\r\n                \"_Proximity_Anisotropy_\",\r\n                \"_Selection_Fuzz_\",\r\n                \"_Selected_\",\r\n                \"_Selection_Fade_\",\r\n                \"_Selection_Fade_Size_\",\r\n                \"_Selected_Distance_\",\r\n                \"_Selected_Fade_Length_\",\r\n                \"_Blob_Enable_\",\r\n                \"_Blob_Position_\",\r\n                \"_Blob_Intensity_\",\r\n                \"_Blob_Near_Size_\",\r\n                \"_Blob_Far_Size_\",\r\n                \"_Blob_Near_Distance_\",\r\n                \"_Blob_Far_Distance_\",\r\n                \"_Blob_Fade_Length_\",\r\n                \"_Blob_Inner_Fade_\",\r\n                \"_Blob_Pulse_\",\r\n                \"_Blob_Fade_\",\r\n                \"_Blob_Texture_\",\r\n                \"_Blob_Enable_2_\",\r\n                \"_Blob_Position_2_\",\r\n                \"_Blob_Near_Size_2_\",\r\n                \"_Blob_Inner_Fade_2_\",\r\n                \"_Blob_Pulse_2_\",\r\n                \"_Blob_Fade_2_\",\r\n                \"_Active_Face_Dir_\",\r\n                \"_Active_Face_Up_\",\r\n                \"_Enable_Fade_\",\r\n                \"_Fade_Width_\",\r\n                \"_Smooth_Active_Face_\",\r\n                \"_Show_Frame_\",\r\n                \"_Use_Blob_Texture_\",\r\n\r\n                \"Use_Global_Left_Index\",\r\n                \"Use_Global_Right_Index\",\r\n                \"Global_Left_Index_Tip_Position\",\r\n                \"Global_Right_Index_Tip_Position\",\r\n                \"Global_Left_Thumb_Tip_Position\",\r\n                \"Global_Right_Thumb_Tip_Position\",\r\n                \"Global_Left_Index_Tip_Proximity\",\r\n                \"Global_Right_Index_Tip_Proximity\",\r\n            ];\r\n            const samplers: string[] = [\"_Blob_Texture_\"];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: fallbacks,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines,\r\n                this._materialContext\r\n            );\r\n        }\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const scene = this.getScene();\r\n\r\n        const defines = <FluentButtonMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", scene.getTransformMatrix());\r\n        this._activeEffect.setVector3(\"cameraPosition\", scene.activeCamera!.position);\r\n\r\n        // \"Blob Texture\"\r\n        this._activeEffect.setTexture(\"_Blob_Texture_\", this._blobTexture);\r\n\r\n        // \"Wireframe\"\r\n        this._activeEffect.setFloat(\"_Edge_Width_\", this.edgeWidth);\r\n        this._activeEffect.setColor4(\"_Edge_Color_\", new Color3(this.edgeColor.r, this.edgeColor.g, this.edgeColor.b), this.edgeColor.a);\r\n        //define _Relative_Width_ true;\r\n\r\n        // \"Proximity\"\r\n        this._activeEffect.setFloat(\"_Proximity_Max_Intensity_\", this.proximityMaxIntensity);\r\n        this._activeEffect.setFloat(\"_Proximity_Far_Distance_\", this.proximityFarDistance);\r\n        this._activeEffect.setFloat(\"_Proximity_Near_Radius_\", this.proximityNearRadius);\r\n        this._activeEffect.setFloat(\"_Proximity_Anisotropy_\", this.proximityAnisotropy);\r\n\r\n        // \"Selection\"\r\n        this._activeEffect.setFloat(\"_Selection_Fuzz_\", this.selectionFuzz);\r\n        this._activeEffect.setFloat(\"_Selected_\", this.selected);\r\n        this._activeEffect.setFloat(\"_Selection_Fade_\", this.selectionFade);\r\n        this._activeEffect.setFloat(\"_Selection_Fade_Size_\", this.selectionFadeSize);\r\n        this._activeEffect.setFloat(\"_Selected_Distance_\", this.selectedDistance);\r\n        this._activeEffect.setFloat(\"_Selected_Fade_Length_\", this.selectedFadeLength);\r\n\r\n        // \"Blob\"\r\n        this._activeEffect.setFloat(\"_Blob_Enable_\", this.leftBlobEnable ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Blob_Intensity_\", this.blobIntensity);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_\", this.leftBlobNearSize);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Size_\", this.blobFarSize);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Distance_\", this.blobNearDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Distance_\", this.blobFarDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_Length_\", this.blobFadeLength);\r\n        this._activeEffect.setFloat(\"_Blob_Inner_Fade_\", this.leftBlobInnerFade);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_\", this.leftBlobPulse);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_\", this.leftBlobFade);\r\n\r\n        // \"Blob 2\"\r\n        this._activeEffect.setFloat(\"_Blob_Enable_2_\", this.rightBlobEnable ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_2_\", this.rightBlobNearSize);\r\n        this._activeEffect.setFloat(\"_Blob_Inner_Fade_2_\", this.rightBlobInnerFade);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_2_\", this.rightBlobPulse);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_2_\", this.rightBlobFade);\r\n\r\n        // \"Active Face\"\r\n        this._activeEffect.setVector3(\"_Active_Face_Dir_\", this.activeFaceDir);\r\n        this._activeEffect.setVector3(\"_Active_Face_Up_\", this.activeFaceUp);\r\n\r\n        // \"Hololens Edge Fade\"\r\n        //define _Enable_Fade_ true;\r\n        this._activeEffect.setFloat(\"_Fade_Width_\", this.fadeWidth);\r\n        this._activeEffect.setFloat(\"_Smooth_Active_Face_\", this.smoothActiveFace ? 1.0 : 0.0);\r\n\r\n        // \"Debug\"\r\n        this._activeEffect.setFloat(\"_Show_Frame_\", this.showFrame ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Use_Blob_Texture_\", this.useBlobTexture ? 1.0 : 0.0);\r\n\r\n        // Global inputs\r\n        this._activeEffect.setFloat(\"Use_Global_Left_Index\", 1.0);\r\n        this._activeEffect.setFloat(\"Use_Global_Right_Index\", 1.0);\r\n\r\n        this._activeEffect.setVector4(\r\n            \"Global_Left_Index_Tip_Position\",\r\n            new Vector4(this.globalLeftIndexTipPosition.x, this.globalLeftIndexTipPosition.y, this.globalLeftIndexTipPosition.z, 1.0)\r\n        );\r\n        this._activeEffect.setVector4(\r\n            \"Global_Right_Index_Tip_Position\",\r\n            new Vector4(this.globalRightIndexTipPosition.x, this.globalRightIndexTipPosition.y, this.globalRightIndexTipPosition.z, 1.0)\r\n        );\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    /**\r\n     * Get the list of animatables in the material.\r\n     * @returns the list of animatables object used in the material\r\n     */\r\n    public getAnimatables(): IAnimatable[] {\r\n        return [];\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n    }\r\n\r\n    public clone(name: string): FluentButtonMaterial {\r\n        return SerializationHelper.Clone(() => new FluentButtonMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.customType = \"BABYLON.FluentButtonMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"FluentButtonMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): FluentButtonMaterial {\r\n        return SerializationHelper.Parse(() => new FluentButtonMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.FluentButtonMaterial\", FluentButtonMaterial);\r\n","// Assumptions: absolute position of button mesh is inside the mesh\r\n\r\nimport { Vector3, TmpVectors } from \"core/Maths/math.vector\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport { Observable } from \"core/Misc/observable\";\r\n\r\nimport { Button3D } from \"./button3D\";\r\n\r\n/**\r\n * Class used to create a touchable button in 3D\r\n */\r\nexport class TouchButton3D extends Button3D {\r\n    private _collisionMesh: Mesh;\r\n\r\n    // 'front' direction. If Vector3.Zero, there is no front and all directions of interaction are accepted\r\n    private _collidableFrontDirection: Vector3;\r\n    private _isNearPressed = false;\r\n    private _interactionSurfaceHeight = 0;\r\n\r\n    private _isToggleButton = false;\r\n    private _toggleState = false;\r\n    private _toggleButtonCallback = () => {\r\n        this._onToggle(!this._toggleState);\r\n    };\r\n\r\n    /**\r\n     * An event triggered when the button is toggled. Only fired if 'isToggleButton' is true\r\n     */\r\n    public onToggleObservable = new Observable<boolean>();\r\n\r\n    /**\r\n     * Creates a new touchable button\r\n     * @param name defines the control name\r\n     * @param collisionMesh mesh to track collisions with\r\n     */\r\n    constructor(name?: string, collisionMesh?: Mesh) {\r\n        super(name);\r\n\r\n        this.collidableFrontDirection = Vector3.Zero();\r\n\r\n        if (collisionMesh) {\r\n            this.collisionMesh = collisionMesh;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Whether the current interaction is caused by near interaction or not\r\n     */\r\n    public get isActiveNearInteraction() {\r\n        return this._isNearPressed;\r\n    }\r\n\r\n    /**\r\n     * Sets the front-facing direction of the button. Pass in Vector3.Zero to allow interactions from any direction\r\n     * @param frontWorldDir the forward direction of the button\r\n     */\r\n    public set collidableFrontDirection(frontWorldDir: Vector3) {\r\n        this._collidableFrontDirection = frontWorldDir.normalize();\r\n\r\n        if (this._collisionMesh) {\r\n            const invert = TmpVectors.Matrix[0];\r\n\r\n            invert.copyFrom(this._collisionMesh.getWorldMatrix());\r\n            invert.invert();\r\n            Vector3.TransformNormalToRef(this._collidableFrontDirection, invert, this._collidableFrontDirection);\r\n            this._collidableFrontDirection.normalize();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the front-facing direction of the button, or Vector3.Zero if there is no 'front'\r\n     */\r\n    public get collidableFrontDirection() {\r\n        if (this._collisionMesh) {\r\n            // Update the front direction to reflect any rotations of the collision mesh\r\n            const transformedDirection = TmpVectors.Vector3[0];\r\n            Vector3.TransformNormalToRef(this._collidableFrontDirection, this._collisionMesh.getWorldMatrix(), transformedDirection);\r\n\r\n            return transformedDirection.normalize();\r\n        }\r\n\r\n        return this._collidableFrontDirection;\r\n    }\r\n\r\n    /**\r\n     * Sets the mesh used for testing input collision\r\n     * @param collisionMesh the new collision mesh for the button\r\n     */\r\n    public set collisionMesh(collisionMesh: Mesh) {\r\n        // Remove the GUI3DManager's data from the previous collision mesh's reserved data store, and reset interactability\r\n        if (this._collisionMesh) {\r\n            this._collisionMesh.isNearPickable = false;\r\n            if (this._collisionMesh.reservedDataStore?.GUI3D) {\r\n                this._collisionMesh.reservedDataStore.GUI3D = {};\r\n            }\r\n\r\n            this._collisionMesh.getChildMeshes().forEach((mesh) => {\r\n                mesh.isNearPickable = false;\r\n                if (mesh.reservedDataStore?.GUI3D) {\r\n                    mesh.reservedDataStore.GUI3D = {};\r\n                }\r\n            });\r\n        }\r\n\r\n        this._collisionMesh = collisionMesh;\r\n        this._injectGUI3DReservedDataStore(this._collisionMesh).control = this;\r\n        this._collisionMesh.isNearPickable = true;\r\n\r\n        this._collisionMesh.getChildMeshes().forEach((mesh) => {\r\n            this._injectGUI3DReservedDataStore(mesh).control = this;\r\n            mesh.isNearPickable = true;\r\n        });\r\n        this.collidableFrontDirection = collisionMesh.forward;\r\n    }\r\n\r\n    /**\r\n     * Setter for if this TouchButton3D should be treated as a toggle button\r\n     * @param value If this TouchHolographicButton should act like a toggle button\r\n     */\r\n    public set isToggleButton(value: boolean) {\r\n        if (value === this._isToggleButton) {\r\n            return;\r\n        }\r\n\r\n        this._isToggleButton = value;\r\n\r\n        if (value) {\r\n            this.onPointerUpObservable.add(this._toggleButtonCallback);\r\n        } else {\r\n            this.onPointerUpObservable.removeCallback(this._toggleButtonCallback);\r\n\r\n            // Safety check, reset the button if it's toggled on but no longer a toggle button\r\n            if (this._toggleState) {\r\n                this._onToggle(false);\r\n            }\r\n        }\r\n    }\r\n    public get isToggleButton() {\r\n        return this._isToggleButton;\r\n    }\r\n\r\n    /**\r\n     * A public entrypoint to set the toggle state of the TouchHolographicButton. Only works if 'isToggleButton' is true\r\n     * @param newState The new state to set the TouchHolographicButton's toggle state to\r\n     */\r\n    public set isToggled(newState: boolean) {\r\n        if (this._isToggleButton && this._toggleState !== newState) {\r\n            this._onToggle(newState);\r\n        }\r\n    }\r\n    public get isToggled() {\r\n        return this._toggleState;\r\n    }\r\n\r\n    protected _onToggle(newState: boolean) {\r\n        this._toggleState = newState;\r\n        this.onToggleObservable.notifyObservers(newState);\r\n    }\r\n\r\n    // Returns true if the collidable is in front of the button, or if the button has no front direction\r\n    private _isInteractionInFrontOfButton(collidablePos: Vector3) {\r\n        return this._getInteractionHeight(collidablePos, this._collisionMesh.getAbsolutePosition()) > 0;\r\n    }\r\n\r\n    /**\r\n     * Get the height of the touchPoint from the collidable part of the button\r\n     * @param touchPoint the point to compare to the button, in absolute position\r\n     * @returns the depth of the touch point into the front of the button\r\n     */\r\n    public getPressDepth(touchPoint: Vector3) {\r\n        if (!this._isNearPressed) {\r\n            return 0;\r\n        }\r\n        const interactionHeight = this._getInteractionHeight(touchPoint, this._collisionMesh.getAbsolutePosition());\r\n        return this._interactionSurfaceHeight - interactionHeight;\r\n    }\r\n\r\n    // Returns true if the collidable is in front of the button, or if the button has no front direction\r\n    protected _getInteractionHeight(interactionPos: Vector3, basePos: Vector3) {\r\n        const frontDir = this.collidableFrontDirection;\r\n        if (frontDir.length() === 0) {\r\n            // The button has no front, just return the distance to the base\r\n            return Vector3.Distance(interactionPos, basePos);\r\n        }\r\n        const d = Vector3.Dot(basePos, frontDir);\r\n        const abc = Vector3.Dot(interactionPos, frontDir);\r\n\r\n        return abc - d;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _generatePointerEventType(providedType: number, nearMeshPosition: Vector3, activeInteractionCount: number): number {\r\n        if (providedType === PointerEventTypes.POINTERDOWN || providedType === PointerEventTypes.POINTERMOVE) {\r\n            if (!this._isInteractionInFrontOfButton(nearMeshPosition)) {\r\n                // Near interaction mesh is behind the button, don't send a pointer down\r\n                return PointerEventTypes.POINTERMOVE;\r\n            } else {\r\n                this._isNearPressed = true;\r\n                this._interactionSurfaceHeight = this._getInteractionHeight(nearMeshPosition, this._collisionMesh.getAbsolutePosition());\r\n            }\r\n        }\r\n        if (providedType === PointerEventTypes.POINTERUP) {\r\n            if (activeInteractionCount == 0) {\r\n                // We get the release for the down we swallowed earlier, swallow as well\r\n                return PointerEventTypes.POINTERMOVE;\r\n            } else {\r\n                this._isNearPressed = false;\r\n            }\r\n        }\r\n\r\n        return providedType;\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"TouchButton3D\";\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        return super._createNode(scene);\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        // Clean up toggle observables\r\n        this.onPointerUpObservable.removeCallback(this._toggleButtonCallback);\r\n        this.onToggleObservable.clear();\r\n\r\n        if (this._collisionMesh) {\r\n            this._collisionMesh.dispose();\r\n        }\r\n    }\r\n}\r\n","import type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport { StandardMaterial } from \"core/Materials/standardMaterial\";\r\nimport { TransformNode } from \"core/Meshes/transformNode\";\r\nimport { Mesh } from \"core/Meshes/mesh\";\r\nimport { CreatePlane } from \"core/Meshes/Builders/planeBuilder\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport { FadeInOutBehavior } from \"core/Behaviors/Meshes/fadeInOutBehavior\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { FluentMaterial } from \"../materials/fluent/fluentMaterial\";\r\nimport { FluentButtonMaterial } from \"../materials/fluentButton/fluentButtonMaterial\";\r\nimport { StackPanel } from \"../../2D/controls/stackPanel\";\r\nimport { Image } from \"../../2D/controls/image\";\r\nimport { TextBlock } from \"../../2D/controls/textBlock\";\r\nimport { AdvancedDynamicTexture } from \"../../2D/advancedDynamicTexture\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\nimport { TouchButton3D } from \"./touchButton3D\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { SceneLoader } from \"core/Loading/sceneLoader\";\r\nimport { DomManagement } from \"core/Misc/domManagement\";\r\nimport { Scalar } from \"core/Maths/math.scalar\";\r\n\r\n/**\r\n * Class used to create a holographic button in 3D\r\n * @since 5.0.0\r\n */\r\nexport class TouchHolographicButton extends TouchButton3D {\r\n    /**\r\n     * Base Url for the button model.\r\n     */\r\n    public static MODEL_BASE_URL: string = \"https://assets.babylonjs.com/meshes/MRTK/\";\r\n    /**\r\n     * File name for the button model.\r\n     */\r\n    public static MODEL_FILENAME: string = \"mrtk-fluent-button.glb\";\r\n\r\n    private _backPlate: Mesh;\r\n    private _textPlate: Mesh;\r\n    private _frontPlate: AbstractMesh;\r\n    private _text: string;\r\n    private _imageUrl: string;\r\n    private _shareMaterials = true;\r\n    private _isBackplateVisible = true;\r\n    private _frontMaterial: FluentButtonMaterial;\r\n    private _backMaterial: FluentMaterial;\r\n    private _plateMaterial: StandardMaterial;\r\n    private _pickedPointObserver: Nullable<Observer<Nullable<Vector3>>>;\r\n    private _pointerHoverObserver: Nullable<Observer<Vector3>>;\r\n    private _frontPlateDepth = 0.5;\r\n    private _backPlateDepth = 0.04;\r\n    private _backplateColor = new Color3(0.08, 0.15, 0.55);\r\n    private _backplateToggledColor = new Color3(0.25, 0.4, 0.95);\r\n\r\n    // Tooltip\r\n    private _tooltipFade: Nullable<FadeInOutBehavior>;\r\n    private _tooltipTextBlock: Nullable<TextBlock>;\r\n    private _tooltipTexture: Nullable<AdvancedDynamicTexture>;\r\n    private _tooltipMesh: Nullable<Mesh>;\r\n    private _tooltipHoverObserver: Nullable<Observer<Control3D>>;\r\n    private _tooltipOutObserver: Nullable<Observer<Control3D>>;\r\n\r\n    private _disposeTooltip() {\r\n        this._tooltipFade = null;\r\n        if (this._tooltipTextBlock) {\r\n            this._tooltipTextBlock.dispose();\r\n        }\r\n        if (this._tooltipTexture) {\r\n            this._tooltipTexture.dispose();\r\n        }\r\n        if (this._tooltipMesh) {\r\n            this._tooltipMesh.dispose();\r\n        }\r\n        this.onPointerEnterObservable.remove(this._tooltipHoverObserver);\r\n        this.onPointerOutObservable.remove(this._tooltipOutObserver);\r\n    }\r\n\r\n    /**\r\n     * Rendering ground id of all the mesh in the button\r\n     */\r\n    public set renderingGroupId(id: number) {\r\n        this._backPlate.renderingGroupId = id;\r\n        this._textPlate.renderingGroupId = id;\r\n        this._frontPlate.renderingGroupId = id;\r\n\r\n        if (this._tooltipMesh) {\r\n            this._tooltipMesh.renderingGroupId = id;\r\n        }\r\n    }\r\n    public get renderingGroupId(): number {\r\n        return this._backPlate.renderingGroupId;\r\n    }\r\n\r\n    /**\r\n     * Gets the mesh used to render this control\r\n     */\r\n    public get mesh(): Nullable<AbstractMesh> {\r\n        return this._backPlate as AbstractMesh;\r\n    }\r\n\r\n    /**\r\n     * Text to be displayed on the tooltip shown when hovering on the button. When set to null tooltip is disabled. (Default: null)\r\n     */\r\n    public set tooltipText(text: Nullable<string>) {\r\n        if (!text) {\r\n            this._disposeTooltip();\r\n            return;\r\n        }\r\n        if (!this._tooltipFade) {\r\n            const rightHandedScene = this._backPlate._scene.useRightHandedSystem;\r\n            // Create tooltip with mesh and text\r\n            this._tooltipMesh = CreatePlane(\"\", { size: 1 }, this._backPlate._scene);\r\n            const tooltipBackground = CreatePlane(\"\", { size: 1, sideOrientation: Mesh.DOUBLESIDE }, this._backPlate._scene);\r\n            const mat = new StandardMaterial(\"\", this._backPlate._scene);\r\n            mat.diffuseColor = Color3.FromHexString(\"#212121\");\r\n            tooltipBackground.material = mat;\r\n            tooltipBackground.isPickable = false;\r\n            this._tooltipMesh.addChild(tooltipBackground);\r\n            tooltipBackground.position = Vector3.Forward(rightHandedScene).scale(0.05);\r\n            this._tooltipMesh.scaling.y = 1 / 3;\r\n            this._tooltipMesh.position = Vector3.Up().scale(0.7).add(Vector3.Forward(rightHandedScene).scale(-0.15));\r\n            this._tooltipMesh.isPickable = false;\r\n            this._tooltipMesh.parent = this._backPlate;\r\n\r\n            // Create text texture for the tooltip\r\n            this._tooltipTexture = AdvancedDynamicTexture.CreateForMesh(this._tooltipMesh);\r\n            this._tooltipTextBlock = new TextBlock();\r\n            this._tooltipTextBlock.scaleY = 3;\r\n            this._tooltipTextBlock.color = \"white\";\r\n            this._tooltipTextBlock.fontSize = 130;\r\n            this._tooltipTexture.addControl(this._tooltipTextBlock);\r\n\r\n            // Add hover action to tooltip\r\n            this._tooltipFade = new FadeInOutBehavior();\r\n            this._tooltipFade.delay = 500;\r\n            this._tooltipMesh.addBehavior(this._tooltipFade);\r\n            this._tooltipHoverObserver = this.onPointerEnterObservable.add(() => {\r\n                if (this._tooltipFade) {\r\n                    this._tooltipFade.fadeIn(true);\r\n                }\r\n            });\r\n            this._tooltipOutObserver = this.onPointerOutObservable.add(() => {\r\n                if (this._tooltipFade) {\r\n                    this._tooltipFade.fadeIn(false);\r\n                }\r\n            });\r\n        }\r\n        if (this._tooltipTextBlock) {\r\n            this._tooltipTextBlock.text = text;\r\n        }\r\n    }\r\n\r\n    public get tooltipText() {\r\n        if (this._tooltipTextBlock) {\r\n            return this._tooltipTextBlock.text;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text for the button\r\n     */\r\n    public get text(): string {\r\n        return this._text;\r\n    }\r\n\r\n    public set text(value: string) {\r\n        if (this._text === value) {\r\n            return;\r\n        }\r\n\r\n        this._text = value;\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image url for the button\r\n     */\r\n    public get imageUrl(): string {\r\n        return this._imageUrl;\r\n    }\r\n\r\n    public set imageUrl(value: string) {\r\n        if (this._imageUrl === value) {\r\n            return;\r\n        }\r\n\r\n        this._imageUrl = value;\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Gets the back material used by this button\r\n     */\r\n    public get backMaterial(): FluentMaterial {\r\n        return this._backMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the front material used by this button\r\n     */\r\n    public get frontMaterial(): FluentButtonMaterial {\r\n        return this._frontMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the plate material used by this button\r\n     */\r\n    public get plateMaterial(): StandardMaterial {\r\n        return this._plateMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this button shares its material with other HolographicButtons\r\n     */\r\n    public get shareMaterials(): boolean {\r\n        return this._shareMaterials;\r\n    }\r\n\r\n    /**\r\n     * Sets whether the backplate is visible or hidden. Hiding the backplate is not recommended without some sort of replacement\r\n     */\r\n    public set isBackplateVisible(isVisible: boolean) {\r\n        if (this.mesh && !!this._backMaterial) {\r\n            if (isVisible && !this._isBackplateVisible) {\r\n                this._backPlate.visibility = 1;\r\n            } else if (!isVisible && this._isBackplateVisible) {\r\n                this._backPlate.visibility = 0;\r\n            }\r\n        }\r\n\r\n        this._isBackplateVisible = isVisible;\r\n    }\r\n\r\n    /**\r\n     * Creates a new button\r\n     * @param name defines the control name\r\n     * @param shareMaterials\r\n     */\r\n    constructor(name?: string, shareMaterials = true) {\r\n        super(name);\r\n\r\n        this._shareMaterials = shareMaterials;\r\n\r\n        this.pointerEnterAnimation = () => {\r\n            this._frontMaterial.leftBlobEnable = true;\r\n            this._frontMaterial.rightBlobEnable = true;\r\n        };\r\n\r\n        this.pointerOutAnimation = () => {\r\n            this._frontMaterial.leftBlobEnable = false;\r\n            this._frontMaterial.rightBlobEnable = false;\r\n        };\r\n\r\n        this.pointerDownAnimation = () => {\r\n            if (this._frontPlate && !this.isActiveNearInteraction) {\r\n                this._frontPlate.scaling.z = this._frontPlateDepth * 0.2;\r\n                this._frontPlate.position = Vector3.Forward(this._frontPlate._scene.useRightHandedSystem).scale((this._frontPlateDepth - 0.2 * this._frontPlateDepth) / 2);\r\n                this._textPlate.position = Vector3.Forward(this._textPlate._scene.useRightHandedSystem).scale(-(this._backPlateDepth + 0.2 * this._frontPlateDepth) / 2);\r\n            }\r\n        };\r\n        this.pointerUpAnimation = () => {\r\n            if (this._frontPlate) {\r\n                this._frontPlate.scaling.z = this._frontPlateDepth;\r\n                this._frontPlate.position = Vector3.Forward(this._frontPlate._scene.useRightHandedSystem).scale((this._frontPlateDepth - this._frontPlateDepth) / 2);\r\n                this._textPlate.position = Vector3.Forward(this._textPlate._scene.useRightHandedSystem).scale(-(this._backPlateDepth + this._frontPlateDepth) / 2);\r\n            }\r\n        };\r\n\r\n        this.onPointerMoveObservable.add((position) => {\r\n            if (this._frontPlate && this.isActiveNearInteraction) {\r\n                const scale = Vector3.Zero();\r\n                if (this._backPlate.getWorldMatrix().decompose(scale, undefined, undefined)) {\r\n                    let interactionHeight = this._getInteractionHeight(position, this._backPlate.getAbsolutePosition()) / scale.z;\r\n                    interactionHeight = Scalar.Clamp(interactionHeight - this._backPlateDepth / 2, 0.2 * this._frontPlateDepth, this._frontPlateDepth);\r\n\r\n                    this._frontPlate.scaling.z = interactionHeight;\r\n                    this._frontPlate.position = Vector3.Forward(this._frontPlate._scene.useRightHandedSystem).scale((this._frontPlateDepth - interactionHeight) / 2);\r\n                    this._textPlate.position = Vector3.Forward(this._textPlate._scene.useRightHandedSystem).scale(-(this._backPlateDepth + interactionHeight) / 2);\r\n                }\r\n            }\r\n        });\r\n\r\n        this._pointerHoverObserver = this.onPointerMoveObservable.add((hoverPosition: Vector3) => {\r\n            this._frontMaterial.globalLeftIndexTipPosition = hoverPosition;\r\n        });\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"TouchHolographicButton\";\r\n    }\r\n\r\n    private _rebuildContent(): void {\r\n        this._disposeFacadeTexture();\r\n\r\n        const panel = new StackPanel();\r\n        panel.isVertical = true;\r\n\r\n        if (DomManagement.IsDocumentAvailable() && !!document.createElement) {\r\n            if (this._imageUrl) {\r\n                const image = new Image();\r\n                image.source = this._imageUrl;\r\n                image.paddingTop = \"40px\";\r\n                image.height = \"180px\";\r\n                image.width = \"100px\";\r\n                image.paddingBottom = \"40px\";\r\n                panel.addControl(image);\r\n            }\r\n        }\r\n\r\n        if (this._text) {\r\n            const text = new TextBlock();\r\n            text.text = this._text;\r\n            text.color = \"white\";\r\n            text.height = \"30px\";\r\n            text.fontSize = 24;\r\n            panel.addControl(text);\r\n        }\r\n\r\n        this.content = panel;\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        this.name = this.name ?? \"TouchHolographicButton\";\r\n        const collisionMesh = CreateBox(\r\n            `${this.name}_collisionMesh`,\r\n            {\r\n                width: 1.0,\r\n                height: 1.0,\r\n                depth: this._frontPlateDepth,\r\n            },\r\n            scene\r\n        );\r\n        collisionMesh.isPickable = true;\r\n        collisionMesh.isNearPickable = true;\r\n        collisionMesh.visibility = 0;\r\n        collisionMesh.position = Vector3.Forward(scene.useRightHandedSystem).scale(-this._frontPlateDepth / 2);\r\n\r\n        SceneLoader.ImportMeshAsync(undefined, TouchHolographicButton.MODEL_BASE_URL, TouchHolographicButton.MODEL_FILENAME, scene).then((result) => {\r\n            const alphaMesh = CreateBox(\r\n                \"${this.name}_alphaMesh\",\r\n                {\r\n                    width: 1.0,\r\n                    height: 1.0,\r\n                    depth: 1.0,\r\n                },\r\n                scene\r\n            );\r\n            alphaMesh.isPickable = false;\r\n            alphaMesh.material = new StandardMaterial(\"${this.name}_alphaMesh_material\", scene);\r\n            alphaMesh.material.alpha = 0.15;\r\n\r\n            const importedFrontPlate = result.meshes[1];\r\n            importedFrontPlate.name = `${this.name}_frontPlate`;\r\n            importedFrontPlate.isPickable = false;\r\n            importedFrontPlate.scaling.z = this._frontPlateDepth;\r\n            alphaMesh.parent = importedFrontPlate;\r\n            importedFrontPlate.parent = collisionMesh;\r\n            if (this._frontMaterial) {\r\n                importedFrontPlate.material = this._frontMaterial;\r\n            }\r\n            this._frontPlate = importedFrontPlate;\r\n        });\r\n\r\n        this._backPlate = CreateBox(\r\n            `${this.name}_backPlate`,\r\n            {\r\n                width: 1.0,\r\n                height: 1.0,\r\n                depth: this._backPlateDepth,\r\n            },\r\n            scene\r\n        );\r\n\r\n        this._backPlate.position = Vector3.Forward(scene.useRightHandedSystem).scale(this._backPlateDepth / 2);\r\n        this._backPlate.isPickable = false;\r\n\r\n        this._textPlate = <Mesh>super._createNode(scene);\r\n        this._textPlate.name = `${this.name}_textPlate`;\r\n        this._textPlate.isPickable = false;\r\n        this._textPlate.position = Vector3.Forward(scene.useRightHandedSystem).scale(-this._frontPlateDepth / 2);\r\n\r\n        this._backPlate.addChild(collisionMesh);\r\n        this._backPlate.addChild(this._textPlate);\r\n\r\n        const tn = new TransformNode(`{this.name}_root`, scene);\r\n        this._backPlate.setParent(tn);\r\n\r\n        this.collisionMesh = collisionMesh;\r\n        this.collidableFrontDirection = this._backPlate.forward.negate(); // Mesh is facing the wrong way\r\n\r\n        return tn;\r\n    }\r\n\r\n    protected _applyFacade(facadeTexture: AdvancedDynamicTexture) {\r\n        this._plateMaterial.emissiveTexture = facadeTexture;\r\n        this._plateMaterial.opacityTexture = facadeTexture;\r\n        this._plateMaterial.diffuseColor = new Color3(0.4, 0.4, 0.4);\r\n    }\r\n\r\n    private _createBackMaterial(mesh: Mesh) {\r\n        this._backMaterial = new FluentMaterial(this.name + \"backPlateMaterial\", mesh.getScene());\r\n        this._backMaterial.albedoColor = this._backplateColor;\r\n        this._backMaterial.renderBorders = true;\r\n        this._backMaterial.renderHoverLight = false;\r\n    }\r\n\r\n    private _createFrontMaterial(mesh: Mesh) {\r\n        this._frontMaterial = new FluentButtonMaterial(this.name + \"Front Material\", mesh.getScene());\r\n    }\r\n\r\n    private _createPlateMaterial(mesh: Mesh) {\r\n        this._plateMaterial = new StandardMaterial(this.name + \"Plate Material\", mesh.getScene());\r\n        this._plateMaterial.specularColor = Color3.Black();\r\n    }\r\n\r\n    protected _onToggle(newState: boolean) {\r\n        if (this._backMaterial) {\r\n            if (newState) {\r\n                this._backMaterial.albedoColor = this._backplateToggledColor;\r\n            } else {\r\n                this._backMaterial.albedoColor = this._backplateColor;\r\n            }\r\n        }\r\n\r\n        super._onToggle(newState);\r\n    }\r\n\r\n    protected _affectMaterial(mesh: Mesh) {\r\n        if (this._shareMaterials) {\r\n            // Back\r\n            if (!this._host._touchSharedMaterials[\"backFluentMaterial\"]) {\r\n                this._createBackMaterial(mesh);\r\n                this._host._touchSharedMaterials[\"backFluentMaterial\"] = this._backMaterial;\r\n            } else {\r\n                this._backMaterial = this._host._touchSharedMaterials[\"backFluentMaterial\"] as FluentMaterial;\r\n            }\r\n\r\n            // Front\r\n            if (!this._host._touchSharedMaterials[\"frontFluentMaterial\"]) {\r\n                this._createFrontMaterial(mesh);\r\n                this._host._touchSharedMaterials[\"frontFluentMaterial\"] = this._frontMaterial;\r\n            } else {\r\n                this._frontMaterial = this._host._touchSharedMaterials[\"frontFluentMaterial\"] as FluentButtonMaterial;\r\n            }\r\n        } else {\r\n            this._createBackMaterial(mesh);\r\n            this._createFrontMaterial(mesh);\r\n        }\r\n\r\n        this._createPlateMaterial(mesh);\r\n        this._backPlate.material = this._backMaterial;\r\n        this._textPlate.material = this._plateMaterial;\r\n\r\n        if (!this._isBackplateVisible) {\r\n            this._backPlate.visibility = 0;\r\n        }\r\n        if (this._frontPlate) {\r\n            this._frontPlate.material = this._frontMaterial;\r\n        }\r\n\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose(); // will dispose main mesh ie. back plate\r\n\r\n        this._disposeTooltip();\r\n        this.onPointerMoveObservable.remove(this._pointerHoverObserver);\r\n\r\n        if (!this.shareMaterials) {\r\n            this._backMaterial.dispose();\r\n            this._frontMaterial.dispose();\r\n            this._plateMaterial.dispose();\r\n\r\n            if (this._pickedPointObserver) {\r\n                this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver);\r\n                this._pickedPointObserver = null;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import type { Behavior } from \"core/Behaviors/behavior\";\r\nimport { FollowBehavior } from \"core/Behaviors/Meshes/followBehavior\";\r\nimport { SixDofDragBehavior } from \"core/Behaviors/Meshes/sixDofDragBehavior\";\r\nimport type { Scene } from \"core/scene\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport type { Nullable } from \"core/types\";\r\nimport { SurfaceMagnetismBehavior } from \"core/Behaviors/Meshes/surfaceMagnetismBehavior\";\r\nimport type { Vector3 } from \"core/Maths/math.vector\";\r\nimport type { PickingInfo } from \"core/Collisions/pickingInfo\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\n\r\n/**\r\n * Default behavior for 3D UI elements.\r\n * Handles a FollowBehavior, SixDofBehavior and SurfaceMagnetismBehavior\r\n * @since 5.0.0\r\n */\r\nexport class DefaultBehavior implements Behavior<Mesh> {\r\n    private _scene: Scene;\r\n    private _followBehavior: FollowBehavior;\r\n    private _sixDofDragBehavior: SixDofDragBehavior;\r\n    private _surfaceMagnetismBehavior: SurfaceMagnetismBehavior;\r\n    private _onBeforeRenderObserver: Nullable<Observer<Scene>>;\r\n    private _onDragObserver: Nullable<Observer<{ delta: Vector3; position: Vector3; pickInfo: PickingInfo }>>;\r\n\r\n    /**\r\n     * Instantiates the default behavior\r\n     */\r\n    constructor() {\r\n        this._followBehavior = new FollowBehavior();\r\n        this._sixDofDragBehavior = new SixDofDragBehavior();\r\n        this._surfaceMagnetismBehavior = new SurfaceMagnetismBehavior();\r\n    }\r\n\r\n    /**\r\n     * Attached node of this behavior\r\n     */\r\n    public attachedNode: Nullable<Mesh>;\r\n\r\n    /**\r\n     *  The name of the behavior\r\n     */\r\n    public get name(): string {\r\n        return \"Default\";\r\n    }\r\n\r\n    /**\r\n     *  The follow behavior\r\n     */\r\n    public get followBehavior(): FollowBehavior {\r\n        return this._followBehavior;\r\n    }\r\n\r\n    /**\r\n     *  The six DoF drag behavior\r\n     */\r\n    public get sixDofDragBehavior(): SixDofDragBehavior {\r\n        return this._sixDofDragBehavior;\r\n    }\r\n\r\n    /**\r\n     * The surface magnetism behavior\r\n     */\r\n    public get surfaceMagnetismBehavior(): SurfaceMagnetismBehavior {\r\n        return this._surfaceMagnetismBehavior;\r\n    }\r\n\r\n    /**\r\n     * Enables the follow behavior\r\n     */\r\n    public followBehaviorEnabled: boolean = false;\r\n\r\n    /**\r\n     * Enables the six DoF drag behavior\r\n     */\r\n    public sixDofDragBehaviorEnabled: boolean = true;\r\n\r\n    /**\r\n     * Enables the surface magnetism behavior\r\n     */\r\n    public surfaceMagnetismBehaviorEnabled: boolean = true;\r\n\r\n    /**\r\n     *  Initializes the behavior\r\n     */\r\n    public init() {}\r\n\r\n    /**\r\n     * Attaches the default behavior\r\n     * @param ownerMesh The top level mesh\r\n     * @param draggablesMeshes Descendant meshes that can be used for dragging the owner mesh\r\n     * @param sceneUnderstandingMeshes Meshes from the scene understanding that will be used for surface magnetism\r\n     */\r\n    public attach(ownerMesh: Mesh, draggablesMeshes?: Mesh[], sceneUnderstandingMeshes?: AbstractMesh[]): void {\r\n        this._scene = ownerMesh.getScene();\r\n        this.attachedNode = ownerMesh;\r\n\r\n        this._addObservables();\r\n        // Since our observables are bound before the child behaviors', ours are called first\r\n        this._followBehavior.attach(ownerMesh);\r\n        this._sixDofDragBehavior.attach(ownerMesh);\r\n        this._sixDofDragBehavior.draggableMeshes = draggablesMeshes || null;\r\n        this._sixDofDragBehavior.faceCameraOnDragStart = true;\r\n        this._surfaceMagnetismBehavior.attach(ownerMesh, this._scene);\r\n        if (sceneUnderstandingMeshes) {\r\n            this._surfaceMagnetismBehavior.meshes = sceneUnderstandingMeshes;\r\n        }\r\n\r\n        // We disable this behavior because we will handle pose changing event manually with sixDofDragBehavior\r\n        this._surfaceMagnetismBehavior.enabled = false;\r\n    }\r\n\r\n    /**\r\n     *  Detaches the behavior from the mesh\r\n     */\r\n    public detach(): void {\r\n        this.attachedNode = null;\r\n        this._removeObservables();\r\n        this._followBehavior.detach();\r\n        this._sixDofDragBehavior.detach();\r\n        this._surfaceMagnetismBehavior.detach();\r\n    }\r\n\r\n    private _addObservables() {\r\n        this._onBeforeRenderObserver = this._scene.onBeforeRenderObservable.add(() => {\r\n            this._followBehavior._enabled = !this._sixDofDragBehavior.isMoving && this.followBehaviorEnabled;\r\n        });\r\n        this._onDragObserver = this._sixDofDragBehavior.onDragObservable.add((event: { pickInfo: PickingInfo }) => {\r\n            this._sixDofDragBehavior.disableMovement = this._surfaceMagnetismBehavior.findAndUpdateTarget(event.pickInfo);\r\n        });\r\n    }\r\n\r\n    private _removeObservables() {\r\n        this._scene.onBeforeRenderObservable.remove(this._onBeforeRenderObserver);\r\n        this._sixDofDragBehavior.onDragObservable.remove(this._onDragObserver);\r\n    }\r\n}\r\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"handleVertexShader\";\nconst shader = `precision highp float;\rattribute vec3 position;\runiform vec3 positionOffset;\runiform mat4 worldViewProjection;\runiform float scale;\rvoid main(void) {\rvec4 vPos=vec4((vec3(position)+positionOffset)*scale,1.0);\rgl_Position=worldViewProjection*vPos;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const handleVertexShader = { name, shader };\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"handlePixelShader\";\nconst shader = `uniform vec3 color;\rvoid main(void) {\rgl_FragColor=vec4(color,1.0);\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const handlePixelShader = { name, shader };\n","import { ShaderMaterial } from \"core/Materials/shaderMaterial\";\r\nimport type { Scene } from \"core/scene\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Color3, TmpColors } from \"core/Maths/math.color\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\n\r\nimport \"./shaders/handle.vertex\";\r\nimport \"./shaders/handle.fragment\";\r\n\r\n/**\r\n * Class used to render gizmo handles with fluent design\r\n */\r\nexport class HandleMaterial extends ShaderMaterial {\r\n    private _hover: boolean = false;\r\n    private _drag: boolean = false;\r\n    private _onBeforeRender: Nullable<Observer<Scene>>;\r\n    private _color: Color3 = new Color3();\r\n    private _scale: number = 1;\r\n    private _targetColor: Color3;\r\n    private _targetScale: number;\r\n    private _lastTick = -1;\r\n\r\n    /**\r\n     * Is the material indicating hovering state\r\n     */\r\n    public get hover(): boolean {\r\n        return this._hover;\r\n    }\r\n\r\n    public set hover(b: boolean) {\r\n        this._hover = b;\r\n\r\n        this._updateInterpolationTarget();\r\n    }\r\n\r\n    /**\r\n     * Is the material indicating drag state\r\n     */\r\n    public get drag(): boolean {\r\n        return this._drag;\r\n    }\r\n\r\n    public set drag(b: boolean) {\r\n        this._drag = b;\r\n\r\n        this._updateInterpolationTarget();\r\n    }\r\n\r\n    /**\r\n     * Length of animation\r\n     */\r\n    public animationLength: number = 100;\r\n\r\n    /**\r\n     * Color of the handle when hovered\r\n     */\r\n    public hoverColor: Color3 = new Color3(0, 0.467, 0.84);\r\n\r\n    /**\r\n     * Color of the handle when idle\r\n     */\r\n    public baseColor: Color3 = new Color3(1, 1, 1);\r\n\r\n    /**\r\n     * Scale of the handle when hovered\r\n     */\r\n    public hoverScale: number = 0.75;\r\n\r\n    /**\r\n     * Scale of the handle when idle\r\n     */\r\n    public baseScale: number = 0.35;\r\n\r\n    /**\r\n     * Scale of the handle when dragged\r\n     */\r\n    public dragScale: number = 0.55;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _positionOffset: Vector3 = Vector3.Zero();\r\n\r\n    /**\r\n     * Creates a handle material\r\n     * @param name Name of the material\r\n     * @param scene Scene\r\n     */\r\n    constructor(name: string, scene: Scene) {\r\n        super(name, scene, \"handle\", {\r\n            attributes: [\"position\"],\r\n            uniforms: [\"worldViewProjection\", \"color\", \"scale\", \"positionOffset\"],\r\n            needAlphaBlending: false,\r\n            needAlphaTesting: false,\r\n        });\r\n\r\n        this._updateInterpolationTarget();\r\n\r\n        // Register callback for scene after render\r\n        this._lastTick = Date.now();\r\n        this._onBeforeRender = this.getScene().onBeforeRenderObservable.add(() => {\r\n            const tick = Date.now();\r\n            const delta = tick - this._lastTick;\r\n\r\n            const scaleDiff = this._targetScale - this._scale;\r\n            const colorDiff = TmpColors.Color3[0].copyFrom(this._targetColor).subtractToRef(this._color, TmpColors.Color3[0]);\r\n\r\n            this._scale = this._scale + (scaleDiff * delta) / this.animationLength;\r\n            colorDiff.scaleToRef(delta / this.animationLength, colorDiff);\r\n            this._color.addToRef(colorDiff, this._color);\r\n\r\n            this.setColor3(\"color\", this._color);\r\n            this.setFloat(\"scale\", this._scale);\r\n            this.setVector3(\"positionOffset\", this._positionOffset);\r\n\r\n            this._lastTick = tick;\r\n        });\r\n    }\r\n\r\n    private _updateInterpolationTarget() {\r\n        if (this.drag) {\r\n            this._targetColor = this.hoverColor;\r\n            this._targetScale = this.dragScale;\r\n        } else if (this.hover) {\r\n            this._targetColor = this.hoverColor;\r\n            this._targetScale = this.hoverScale;\r\n        } else {\r\n            this._targetColor = this.baseColor;\r\n            this._targetScale = this.baseScale;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disposes the handle material\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n        this.getScene().onBeforeRenderObservable.remove(this._onBeforeRender);\r\n    }\r\n}\r\n","import type { Scene } from \"core/scene\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport { TransformNode } from \"core/Meshes/transformNode\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport { HandleMaterial } from \"../materials/handle/handleMaterial\";\r\nimport type { SlateGizmo } from \"./slateGizmo\";\r\nimport { BaseSixDofDragBehavior } from \"core/Behaviors/Meshes/baseSixDofDragBehavior\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\n\r\n/**\r\n * State of the handle regarding user interaction\r\n */\r\nexport enum HandleState {\r\n    /**\r\n     * Handle is idle\r\n     */\r\n    IDLE = 0,\r\n    /**\r\n     * Handle is hovered\r\n     */\r\n    HOVER = 1,\r\n    /**\r\n     * Handle is dragged\r\n     */\r\n    DRAG = 2,\r\n}\r\n\r\n/**\r\n * Base class for SlateGizmo handles\r\n */\r\nexport abstract class GizmoHandle {\r\n    protected _scene: Scene;\r\n    protected _state: HandleState = HandleState.IDLE;\r\n    protected _materials: HandleMaterial[] = [];\r\n\r\n    private _dragStartObserver: Nullable<Observer<any>>;\r\n    private _draggingObserver: Nullable<Observer<any>>;\r\n    private _dragEndObserver: Nullable<Observer<any>>;\r\n    /**\r\n     * @internal\r\n     */\r\n    public _dragBehavior: BaseSixDofDragBehavior;\r\n\r\n    /**\r\n     * The current state of the handle\r\n     */\r\n    public get state(): HandleState {\r\n        return this._state;\r\n    }\r\n\r\n    private _gizmo: SlateGizmo;\r\n\r\n    /**\r\n     * Returns the gizmo carrying this handle\r\n     */\r\n    public get gizmo() {\r\n        return this._gizmo;\r\n    }\r\n\r\n    /**\r\n     * Sets hover state\r\n     */\r\n    public set hover(value: boolean) {\r\n        if (value) {\r\n            this._state |= HandleState.HOVER;\r\n        } else {\r\n            this._state &= ~HandleState.HOVER;\r\n        }\r\n\r\n        this._updateMaterial();\r\n    }\r\n    /**\r\n     * Sets drag state\r\n     */\r\n    public set drag(value: boolean) {\r\n        if (value) {\r\n            this._state |= HandleState.DRAG;\r\n        } else {\r\n            this._state &= ~HandleState.DRAG;\r\n        }\r\n\r\n        this._updateMaterial();\r\n    }\r\n\r\n    /**\r\n     * Node of this handle\r\n     */\r\n    public node: TransformNode;\r\n\r\n    /**\r\n     * Creates a handle for a SlateGizmo\r\n     * @param gizmo associated SlateGizmo\r\n     * @param scene scene\r\n     */\r\n    constructor(gizmo: SlateGizmo, scene: Scene) {\r\n        this._scene = scene;\r\n        this._gizmo = gizmo;\r\n\r\n        this.node = this.createNode();\r\n        this.node.reservedDataStore = {\r\n            handle: this,\r\n        };\r\n    }\r\n\r\n    protected _createMaterial(positionOffset?: Vector3) {\r\n        const mat = new HandleMaterial(\"handle\", this._scene);\r\n        if (positionOffset) {\r\n            mat._positionOffset = positionOffset;\r\n        }\r\n        return mat;\r\n    }\r\n\r\n    private _updateMaterial() {\r\n        const state = this._state;\r\n        for (const mat of this._materials) {\r\n            mat.hover = false;\r\n            mat.drag = false;\r\n        }\r\n\r\n        if (state & HandleState.DRAG) {\r\n            for (const mat of this._materials) {\r\n                mat.drag = true;\r\n            }\r\n        } else if (state & HandleState.HOVER) {\r\n            for (const mat of this._materials) {\r\n                mat.hover = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Binds callbacks from dragging interaction\r\n     * @param dragStartFn Function to call on drag start\r\n     * @param dragFn Function to call on drag\r\n     * @param dragEndFn Function to call on drag end\r\n     */\r\n    public setDragBehavior(dragStartFn: (event: { position: Vector3 }) => void, dragFn: (event: { position: Vector3 }) => void, dragEndFn: () => void) {\r\n        const dragBehavior = new BaseSixDofDragBehavior();\r\n\r\n        this._dragBehavior = dragBehavior;\r\n\r\n        this._dragStartObserver = dragBehavior.onDragStartObservable.add(dragStartFn);\r\n        this._draggingObserver = dragBehavior.onDragObservable.add(dragFn);\r\n        this._dragEndObserver = dragBehavior.onDragEndObservable.add(dragEndFn);\r\n\r\n        this._dragBehavior.attach(this.node);\r\n    }\r\n\r\n    /**\r\n     * Creates the meshes and parent node of the handle\r\n     * Should be overridden by child classes\r\n     * @returns created node\r\n     */\r\n    public abstract createNode(): TransformNode;\r\n\r\n    /**\r\n     * Disposes the handle\r\n     */\r\n    public dispose() {\r\n        this._dragBehavior.onDragStartObservable.remove(this._dragStartObserver);\r\n        this._dragBehavior.onDragObservable.remove(this._draggingObserver);\r\n        this._dragBehavior.onDragEndObservable.remove(this._dragEndObserver);\r\n\r\n        this._dragBehavior.detach();\r\n\r\n        for (const material of this._materials) {\r\n            material.dispose();\r\n        }\r\n        this.node.dispose();\r\n    }\r\n}\r\n\r\n/**\r\n * Side handle class that rotates the slate\r\n */\r\nexport class SideHandle extends GizmoHandle {\r\n    /**\r\n     * Creates the meshes and parent node of the handle\r\n     * @returns created node\r\n     */\r\n    public createNode() {\r\n        // Create a simple vertical rectangle\r\n        const verticalBox = CreateBox(\"sideVert\", { width: 1, height: 10, depth: 0.1 }, this._scene);\r\n        const sideNode = new TransformNode(\"side\", this._scene);\r\n        verticalBox.parent = sideNode;\r\n\r\n        const mat = this._createMaterial();\r\n        verticalBox.material = mat;\r\n        verticalBox.isNearGrabbable = true;\r\n        this._materials.push(mat);\r\n\r\n        return sideNode;\r\n    }\r\n}\r\n\r\n/**\r\n * Corner handle that resizes the slate\r\n */\r\nexport class CornerHandle extends GizmoHandle {\r\n    /**\r\n     * Creates the meshes and parent node of the handle\r\n     * @returns created node\r\n     */\r\n    public createNode() {\r\n        // Create 2 boxes making a bottom left corner\r\n        const horizontalBox = CreateBox(\"angleHor\", { width: 3, height: 1, depth: 0.1 }, this._scene);\r\n        const verticalBox = CreateBox(\"angleVert\", { width: 1, height: 3, depth: 0.1 }, this._scene);\r\n\r\n        const angleNode = new TransformNode(\"angle\", this._scene);\r\n        horizontalBox.parent = angleNode;\r\n        verticalBox.parent = angleNode;\r\n\r\n        horizontalBox.material = this._createMaterial(new Vector3(1, 0, 0));\r\n        verticalBox.material = this._createMaterial(new Vector3(0, 1, 0));\r\n        verticalBox.isNearGrabbable = true;\r\n        horizontalBox.isNearGrabbable = true;\r\n\r\n        this._materials.push(horizontalBox.material as HandleMaterial);\r\n        this._materials.push(verticalBox.material as HandleMaterial);\r\n        return angleNode;\r\n    }\r\n}\r\n","import { Gizmo } from \"core/Gizmos/gizmo\";\r\nimport { Epsilon } from \"core/Maths/math.constants\";\r\nimport { Matrix, Quaternion, TmpVectors, Vector3 } from \"core/Maths/math.vector\";\r\nimport type { Scene } from \"core/scene\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { PivotTools } from \"core/Misc/pivotTools\";\r\nimport type { UtilityLayerRenderer } from \"core/Rendering/utilityLayerRenderer\";\r\nimport type { Nullable } from \"core/types\";\r\n\r\nimport type { HolographicSlate } from \"../controls/holographicSlate\";\r\nimport type { GizmoHandle } from \"./gizmoHandle\";\r\nimport { CornerHandle, SideHandle } from \"./gizmoHandle\";\r\n\r\n// Mask contains the influence of the drag offset vectors on dimensions or origin of the slate\r\n// Mask vector is multiplied to the offset vector\r\ntype HandleMasks = {\r\n    dimensions: Vector3;\r\n    origin: Vector3;\r\n};\r\n\r\n/**\r\n * Gizmo to resize 2D slates\r\n */\r\nexport class SlateGizmo extends Gizmo {\r\n    private _boundingDimensions = new Vector3(0, 0, 0);\r\n    private _pickedPointObserver: Nullable<Observer<Nullable<AbstractMesh>>>;\r\n    private _renderObserver: Nullable<Observer<Scene>> = null;\r\n\r\n    private _tmpQuaternion = new Quaternion();\r\n    private _tmpVector = new Vector3(0, 0, 0);\r\n\r\n    // Ordered bl, br, tr, tl\r\n    private _corners: CornerHandle[] = [];\r\n    // Ordered left, bottom, right, top\r\n    private _sides: SideHandle[] = [];\r\n    private _handlesParent: TransformNode;\r\n    private _handleHovered: Nullable<GizmoHandle>;\r\n    private _handleDragged: Nullable<GizmoHandle>;\r\n\r\n    private _boundingBoxGizmo = {\r\n        min: new Vector3(),\r\n        max: new Vector3(),\r\n    };\r\n\r\n    /**\r\n     * Value we use to offset handles from mesh\r\n     */\r\n    private _margin = 0.35;\r\n    private _handleSize = 0.075;\r\n    private _attachedSlate: Nullable<HolographicSlate> = null;\r\n    private _existingSlateScale = new Vector3();\r\n    /**\r\n     * If set, the handles will increase in size based on the distance away from the camera to have a consistent screen size (Default: true)\r\n     */\r\n    public fixedScreenSize = false;\r\n    /**\r\n     * The distance away from the object which the draggable meshes should appear world sized when fixedScreenSize is set to true (default: 10)\r\n     */\r\n    public fixedScreenSizeDistanceFactor = 10;\r\n\r\n    /**\r\n     * The slate attached to this gizmo\r\n     */\r\n    public set attachedSlate(control: Nullable<HolographicSlate>) {\r\n        if (control) {\r\n            this.attachedMesh = control.mesh;\r\n            this.updateBoundingBox();\r\n\r\n            this._pickedPointObserver = control._host.onPickingObservable.add((pickedMesh) => {\r\n                if (this._handleHovered && (!pickedMesh || pickedMesh.parent !== this._handleHovered.node)) {\r\n                    this._handleHovered.hover = false;\r\n                    this._handleHovered = null;\r\n                }\r\n\r\n                if (pickedMesh && pickedMesh.parent && pickedMesh.parent.reservedDataStore && pickedMesh.parent.reservedDataStore.handle) {\r\n                    const handle = pickedMesh.parent.reservedDataStore.handle as GizmoHandle;\r\n                    if (handle.gizmo === this) {\r\n                        this._handleHovered = handle;\r\n                        this._handleHovered.hover = true;\r\n                    }\r\n                }\r\n            });\r\n        } else if (this._attachedSlate) {\r\n            this._attachedSlate._host.onPickingObservable.remove(this._pickedPointObserver);\r\n        }\r\n        this._attachedSlate = control;\r\n    }\r\n\r\n    public get attachedSlate(): Nullable<HolographicSlate> {\r\n        return this._attachedSlate;\r\n    }\r\n\r\n    constructor(utilityLayer?: UtilityLayerRenderer) {\r\n        super(utilityLayer);\r\n\r\n        this._createNode();\r\n        this.updateScale = false;\r\n\r\n        this._renderObserver = this.gizmoLayer.originalScene.onBeforeRenderObservable.add(() => {\r\n            // Only update the bounding box if scaling has changed\r\n            if (this.attachedMesh && !this._existingSlateScale.equals(this.attachedMesh.scaling)) {\r\n                this.updateBoundingBox();\r\n            }\r\n        });\r\n    }\r\n\r\n    private _createNode() {\r\n        this._handlesParent = new TransformNode(\"handlesParent\", this.gizmoLayer.utilityLayerScene);\r\n        this._handlesParent.rotationQuaternion = Quaternion.Identity();\r\n\r\n        const masksCorners = [\r\n            {\r\n                dimensions: new Vector3(-1, -1, 0),\r\n                origin: new Vector3(1, 0, 0),\r\n            },\r\n            {\r\n                dimensions: new Vector3(1, -1, 0),\r\n                origin: new Vector3(0, 0, 0),\r\n            },\r\n            {\r\n                dimensions: new Vector3(1, 1, 0),\r\n                origin: new Vector3(0, 1, 0),\r\n            },\r\n            {\r\n                dimensions: new Vector3(-1, 1, 0),\r\n                origin: new Vector3(1, 1, 0),\r\n            },\r\n        ];\r\n\r\n        for (let i = 0; i < 4; i++) {\r\n            const corner = new CornerHandle(this, this.gizmoLayer.utilityLayerScene);\r\n            this._corners.push(corner);\r\n            corner.node.rotation.z = (Math.PI / 2) * i;\r\n\r\n            corner.node.parent = this._handlesParent;\r\n            this._assignDragBehaviorCorners(\r\n                corner,\r\n                (originStart: Vector3, dimensionsStart: Vector3, offset: Vector3, masks: HandleMasks) => this._moveHandle(originStart, dimensionsStart, offset, masks, true),\r\n                masksCorners[i]\r\n            );\r\n        }\r\n\r\n        for (let i = 0; i < 4; i++) {\r\n            const side = new SideHandle(this, this.gizmoLayer.utilityLayerScene);\r\n            this._sides.push(side);\r\n            side.node.rotation.z = (Math.PI / 2) * i;\r\n            side.node.parent = this._handlesParent;\r\n            this._assignDragBehaviorSides(side, i % 2 === 0 ? new Vector3(0, 1, 0) : new Vector3(1, 0, 0));\r\n        }\r\n\r\n        this._handlesParent.parent = this._rootMesh;\r\n    }\r\n\r\n    private _keepAspectRatio(vector: Vector3, aspectRatio: number, invertDiagonal: boolean = false) {\r\n        const axis = TmpVectors.Vector3[0];\r\n        axis.copyFromFloats(aspectRatio, 1, 0).normalize();\r\n        if (invertDiagonal) {\r\n            axis.y *= -1;\r\n        }\r\n        const dot = Vector3.Dot(vector, axis);\r\n        vector.copyFrom(axis).scaleInPlace(dot);\r\n    }\r\n\r\n    private _clampDimensions(vector: Vector3, dimensions: Vector3, mask: Vector3, keepAspectRatio: boolean = false) {\r\n        const impact = TmpVectors.Vector3[0];\r\n        impact.copyFrom(vector).multiplyInPlace(mask);\r\n\r\n        const clampedDimensions = TmpVectors.Vector3[1];\r\n        clampedDimensions.copyFromFloats(\r\n            Math.max(this._attachedSlate!.minDimensions.x, impact.x + dimensions.x),\r\n            Math.max(this._attachedSlate!.minDimensions.y, impact.y + dimensions.y),\r\n            0\r\n        );\r\n\r\n        if (keepAspectRatio) {\r\n            // Extra logic to ensure the ratio is maintained when the vector has been clamped\r\n            const ratio = dimensions.x / dimensions.y;\r\n            clampedDimensions.x = Math.max(clampedDimensions.x, clampedDimensions.y * ratio);\r\n            clampedDimensions.y = Math.max(clampedDimensions.y, clampedDimensions.x / ratio);\r\n        }\r\n\r\n        // Calculating the real impact of vector on clamped dimensions\r\n        impact.copyFrom(clampedDimensions).subtractInPlace(dimensions);\r\n\r\n        vector.x = Math.sign(vector.x) * Math.abs(impact.x);\r\n        vector.y = Math.sign(vector.y) * Math.abs(impact.y);\r\n    }\r\n\r\n    private _moveHandle(originStart: Vector3, dimensionsStart: Vector3, offset: Vector3, masks: HandleMasks, isCorner: boolean) {\r\n        if (!this._attachedSlate) {\r\n            return;\r\n        }\r\n\r\n        if (isCorner) {\r\n            const aspectRatio = dimensionsStart.x / dimensionsStart.y;\r\n            this._keepAspectRatio(offset, aspectRatio, masks.dimensions.x * masks.dimensions.y < 0);\r\n        }\r\n        this._clampDimensions(offset, dimensionsStart, masks.dimensions, isCorner);\r\n\r\n        const offsetOriginMasked = TmpVectors.Vector3[0];\r\n        const offsetDimensionsMasked = TmpVectors.Vector3[1];\r\n        offsetOriginMasked.copyFrom(offset).multiplyInPlace(masks.origin);\r\n        offsetDimensionsMasked.copyFrom(offset).multiplyInPlace(masks.dimensions);\r\n\r\n        this._attachedSlate.origin.copyFrom(originStart).addInPlace(offsetOriginMasked);\r\n        this._attachedSlate.dimensions.set(dimensionsStart.x + offsetDimensionsMasked.x, dimensionsStart.y + offsetDimensionsMasked.y);\r\n    }\r\n\r\n    private _assignDragBehaviorCorners(\r\n        handle: GizmoHandle,\r\n        moveFn: (originStart: Vector3, dimensionsStart: Vector3, offset: Vector3, masks: HandleMasks) => void,\r\n        masks: HandleMasks\r\n    ) {\r\n        const dimensionsStart = new Vector3();\r\n        const originStart = new Vector3();\r\n        const dragOrigin = new Vector3();\r\n        const toObjectFrame = new Matrix();\r\n        const dragPlaneNormal = new Vector3();\r\n\r\n        const projectToRef = (position: Vector3, normal: Vector3, origin: Vector3, ref: Vector3) => {\r\n            // Projects on the plane with its normal and origin\r\n            position.subtractToRef(origin, TmpVectors.Vector3[0]);\r\n            const dot = Vector3.Dot(TmpVectors.Vector3[0], normal);\r\n            TmpVectors.Vector3[1].copyFrom(normal).scaleInPlace(dot);\r\n            TmpVectors.Vector3[0].subtractInPlace(TmpVectors.Vector3[1]);\r\n            TmpVectors.Vector3[0].addToRef(origin, ref);\r\n        };\r\n\r\n        const dragStart = (event: { position: Vector3 }) => {\r\n            if (this.attachedSlate && this.attachedMesh) {\r\n                dimensionsStart.set(this.attachedSlate.dimensions.x, this.attachedSlate.dimensions.y, Epsilon);\r\n                originStart.copyFrom(this.attachedSlate.origin);\r\n                dragOrigin.copyFrom(event.position);\r\n                toObjectFrame.copyFrom(this.attachedMesh.computeWorldMatrix(true));\r\n                toObjectFrame.invert();\r\n                this.attachedSlate._followButton.isToggled = false;\r\n                Vector3.TransformNormalToRef(Vector3.Forward(), this.attachedMesh.getWorldMatrix(), dragPlaneNormal);\r\n                dragPlaneNormal.normalize();\r\n\r\n                if (this._handleHovered) {\r\n                    this._handleDragged = this._handleHovered;\r\n                    this._handleDragged.drag = true;\r\n                }\r\n            }\r\n        };\r\n\r\n        const dragging = (event: { position: Vector3 }) => {\r\n            if (this.attachedSlate && this.attachedMesh) {\r\n                projectToRef(event.position, dragPlaneNormal, dragOrigin, this._tmpVector);\r\n                this._tmpVector.subtractInPlace(dragOrigin);\r\n                Vector3.TransformNormalToRef(this._tmpVector, toObjectFrame, this._tmpVector);\r\n\r\n                moveFn(originStart, dimensionsStart, this._tmpVector, masks);\r\n                this.attachedSlate._positionElements();\r\n                this.updateBoundingBox();\r\n            }\r\n        };\r\n\r\n        const dragEnd = () => {\r\n            if (this.attachedSlate && this.attachedNode) {\r\n                this.attachedSlate._updatePivot();\r\n\r\n                if (this._handleDragged) {\r\n                    this._handleDragged.drag = false;\r\n                    this._handleDragged = null;\r\n                }\r\n            }\r\n        };\r\n\r\n        handle.setDragBehavior(dragStart, dragging, dragEnd);\r\n    }\r\n\r\n    private _assignDragBehaviorSides(handle: GizmoHandle, dragPlaneNormal: Vector3) {\r\n        const quaternionOrigin = new Quaternion();\r\n        const dragOrigin = new Vector3();\r\n        const directionOrigin = new Vector3();\r\n        const worldPivot = new Vector3();\r\n        const worldPlaneNormal = new Vector3();\r\n\r\n        const dragStart = (event: { position: Vector3 }) => {\r\n            if (this.attachedSlate && this.attachedMesh) {\r\n                quaternionOrigin.copyFrom(this.attachedMesh.rotationQuaternion!);\r\n                dragOrigin.copyFrom(event.position);\r\n                worldPivot.copyFrom(this.attachedMesh.getAbsolutePivotPoint());\r\n                directionOrigin.copyFrom(dragOrigin).subtractInPlace(worldPivot).normalize();\r\n                this.attachedSlate._followButton.isToggled = false;\r\n                Vector3.TransformNormalToRef(dragPlaneNormal, this.attachedMesh.getWorldMatrix(), worldPlaneNormal);\r\n                worldPlaneNormal.normalize();\r\n\r\n                if (this._handleHovered) {\r\n                    this._handleDragged = this._handleHovered;\r\n                    this._handleDragged.drag = true;\r\n                }\r\n            }\r\n        };\r\n\r\n        const dragging = (event: { position: Vector3 }) => {\r\n            if (this.attachedSlate && this.attachedMesh) {\r\n                this._tmpVector.copyFrom(event.position);\r\n                this._tmpVector.subtractInPlace(worldPivot);\r\n                this._tmpVector.normalize();\r\n\r\n                const angle = -Vector3.GetAngleBetweenVectorsOnPlane(this._tmpVector, directionOrigin, worldPlaneNormal);\r\n                Quaternion.RotationAxisToRef(dragPlaneNormal, angle, this._tmpQuaternion);\r\n                quaternionOrigin.multiplyToRef(this._tmpQuaternion, this.attachedMesh.rotationQuaternion!);\r\n            }\r\n        };\r\n\r\n        const dragEnd = () => {\r\n            if (this.attachedSlate && this.attachedNode) {\r\n                this.attachedSlate._updatePivot();\r\n\r\n                if (this._handleDragged) {\r\n                    this._handleDragged.drag = false;\r\n                    this._handleDragged = null;\r\n                }\r\n            }\r\n        };\r\n\r\n        handle.setDragBehavior(dragStart, dragging, dragEnd);\r\n    }\r\n\r\n    protected _attachedNodeChanged(value: Nullable<AbstractMesh>) {\r\n        if (value) {\r\n            this.updateBoundingBox();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Updates the bounding box information for the gizmo\r\n     */\r\n    public updateBoundingBox() {\r\n        if (this.attachedMesh) {\r\n            PivotTools._RemoveAndStorePivotPoint(this.attachedMesh);\r\n\r\n            // Store original parent\r\n            const originalParent = this.attachedMesh.parent;\r\n            this.attachedMesh.setParent(null);\r\n\r\n            this._update();\r\n\r\n            // Rotate based on axis\r\n            if (!this.attachedMesh.rotationQuaternion) {\r\n                this.attachedMesh.rotationQuaternion = Quaternion.RotationYawPitchRoll(this.attachedMesh.rotation.y, this.attachedMesh.rotation.x, this.attachedMesh.rotation.z);\r\n            }\r\n\r\n            // Store original position and reset mesh to origin before computing the bounding box\r\n            this._tmpQuaternion.copyFrom(this.attachedMesh.rotationQuaternion);\r\n            this._tmpVector.copyFrom(this.attachedMesh.position);\r\n            this.attachedMesh.rotationQuaternion.set(0, 0, 0, 1);\r\n            this.attachedMesh.position.set(0, 0, 0);\r\n\r\n            // Update bounding dimensions/positions\r\n            const boundingMinMax = this.attachedMesh.getHierarchyBoundingVectors();\r\n            boundingMinMax.max.subtractToRef(boundingMinMax.min, this._boundingDimensions);\r\n            this._boundingBoxGizmo.min = boundingMinMax.min;\r\n            this._boundingBoxGizmo.max = boundingMinMax.max;\r\n\r\n            // Update handles of the gizmo\r\n            this._updateHandlesPosition();\r\n            this._updateHandlesScaling();\r\n\r\n            // Restore position/rotation values\r\n            this.attachedMesh.rotationQuaternion.copyFrom(this._tmpQuaternion);\r\n            this.attachedMesh.position.copyFrom(this._tmpVector);\r\n\r\n            PivotTools._RestorePivotPoint(this.attachedMesh);\r\n\r\n            // Restore original parent\r\n            this.attachedMesh.setParent(originalParent);\r\n            this.attachedMesh.computeWorldMatrix(true);\r\n\r\n            this._existingSlateScale.copyFrom(this.attachedMesh.scaling);\r\n        }\r\n    }\r\n\r\n    private _updateHandlesPosition() {\r\n        const min = this._boundingBoxGizmo.min.clone();\r\n        const max = this._boundingBoxGizmo.max.clone();\r\n\r\n        const handleScaling = this._corners[0].node.scaling.length();\r\n        min.x -= this._margin * handleScaling;\r\n        min.y -= this._margin * handleScaling;\r\n        max.x += this._margin * handleScaling;\r\n        max.y += this._margin * handleScaling;\r\n\r\n        const center = min.add(max).scaleInPlace(0.5);\r\n\r\n        this._corners[0].node.position.copyFromFloats(min.x, min.y, 0);\r\n        this._corners[1].node.position.copyFromFloats(max.x, min.y, 0);\r\n        this._corners[2].node.position.copyFromFloats(max.x, max.y, 0);\r\n        this._corners[3].node.position.copyFromFloats(min.x, max.y, 0);\r\n\r\n        this._sides[0].node.position.copyFromFloats(min.x, center.y, 0);\r\n        this._sides[1].node.position.copyFromFloats(center.x, min.y, 0);\r\n        this._sides[2].node.position.copyFromFloats(max.x, center.y, 0);\r\n        this._sides[3].node.position.copyFromFloats(center.x, max.y, 0);\r\n    }\r\n\r\n    private _updateHandlesScaling() {\r\n        if (this._attachedSlate && this._attachedSlate.mesh) {\r\n            const scaledWidth = this._attachedSlate.mesh.scaling.x * this._attachedSlate.dimensions.x;\r\n            const scaledHeight = this._attachedSlate.mesh.scaling.y * this._attachedSlate.dimensions.y;\r\n            const scale = Math.min(scaledWidth, scaledHeight) * this._handleSize;\r\n            for (let index = 0; index < this._corners.length; index++) {\r\n                this._corners[index].node.scaling.setAll(scale);\r\n            }\r\n            for (let index = 0; index < this._sides.length; index++) {\r\n                this._sides[index].node.scaling.setAll(scale);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _update() {\r\n        super._update();\r\n\r\n        if (!this.gizmoLayer.utilityLayerScene.activeCamera) {\r\n            return;\r\n        }\r\n\r\n        if (this._attachedSlate && this._attachedSlate.mesh) {\r\n            if (this.fixedScreenSize) {\r\n                this._attachedSlate.mesh.absolutePosition.subtractToRef(this.gizmoLayer.utilityLayerScene.activeCamera.position, this._tmpVector);\r\n                const distanceFromCamera = (this._handleSize * this._tmpVector.length()) / this.fixedScreenSizeDistanceFactor;\r\n                for (let i = 0; i < this._corners.length; i++) {\r\n                    this._corners[i].node.scaling.set(distanceFromCamera, distanceFromCamera, distanceFromCamera);\r\n                }\r\n                for (let i = 0; i < this._sides.length; i++) {\r\n                    this._sides[i].node.scaling.set(distanceFromCamera, distanceFromCamera, distanceFromCamera);\r\n                }\r\n            }\r\n            this._updateHandlesPosition();\r\n        }\r\n    }\r\n\r\n    public dispose() {\r\n        this.gizmoLayer.originalScene.onBeforeRenderObservable.remove(this._renderObserver);\r\n\r\n        // Will dispose rootMesh and all descendants\r\n        super.dispose();\r\n\r\n        for (const corner of this._corners) {\r\n            corner.dispose();\r\n        }\r\n\r\n        for (const side of this._sides) {\r\n            side.dispose();\r\n        }\r\n    }\r\n}\r\n","import { ContentDisplay3D } from \"./contentDisplay3D\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { TouchHolographicButton } from \"./touchHolographicButton\";\r\nimport { AdvancedDynamicTexture } from \"../../2D/advancedDynamicTexture\";\r\nimport { Control } from \"../../2D/controls/control\";\r\nimport { TextBlock, TextWrapping } from \"../../2D/controls/textBlock\";\r\nimport { DefaultBehavior } from \"../behaviors/defaultBehavior\";\r\nimport { SlateGizmo } from \"../gizmos/slateGizmo\";\r\nimport { FluentMaterial } from \"../materials/fluent/fluentMaterial\";\r\nimport { FluentBackplateMaterial } from \"../materials/fluentBackplate/fluentBackplateMaterial\";\r\nimport { PointerDragBehavior } from \"core/Behaviors/Meshes/pointerDragBehavior\";\r\nimport type { Texture } from \"core/Materials/Textures/texture\";\r\nimport { Vector4 } from \"core/Maths/math\";\r\nimport { Epsilon } from \"core/Maths/math.constants\";\r\nimport { Scalar } from \"core/Maths/math.scalar\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Quaternion, Vector2, Vector3 } from \"core/Maths/math.vector\";\r\nimport { Viewport } from \"core/Maths/math.viewport\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport { CreatePlane } from \"core/Meshes/Builders/planeBuilder\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport { Mesh } from \"core/Meshes/mesh\";\r\nimport { VertexData } from \"core/Meshes/mesh.vertexData\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport type { Scene } from \"core/scene\";\r\nimport type { Nullable } from \"core/types\";\r\n\r\n/**\r\n * Class used to create a holographic slate\r\n * @since 5.0.0\r\n */\r\nexport class HolographicSlate extends ContentDisplay3D {\r\n    /**\r\n     * Base Url for the assets.\r\n     */\r\n    public static ASSETS_BASE_URL: string = \"https://assets.babylonjs.com/meshes/MRTK/\";\r\n    /**\r\n     * File name for the close icon.\r\n     */\r\n    public static CLOSE_ICON_FILENAME: string = \"IconClose.png\";\r\n    /**\r\n     * File name for the close icon.\r\n     */\r\n    public static FOLLOW_ICON_FILENAME: string = \"IconFollowMe.png\";\r\n\r\n    private static _DEFAULT_TEXT_RESOLUTION_Y = 102.4;\r\n\r\n    /**\r\n     * Margin between title bar and contentplate\r\n     */\r\n    public titleBarMargin = 0.005;\r\n\r\n    /**\r\n     * Origin in local coordinates (top left corner)\r\n     */\r\n    public origin = new Vector3(0, 0, 0);\r\n\r\n    private _dimensions = new Vector2(21.875, 12.5);\r\n    private _titleBarHeight = 0.625;\r\n\r\n    private _titleBarMaterial: FluentBackplateMaterial;\r\n    private _backMaterial: FluentBackplateMaterial;\r\n    private _contentMaterial: FluentMaterial;\r\n    private _pickedPointObserver: Nullable<Observer<Nullable<Vector3>>>;\r\n    private _positionChangedObserver: Nullable<Observer<{ position: Vector3 }>>;\r\n\r\n    private _titleText = \"\";\r\n    private _titleTextComponent: TextBlock;\r\n\r\n    private _contentViewport: Viewport;\r\n    private _contentDragBehavior: PointerDragBehavior;\r\n\r\n    private _defaultBehavior: DefaultBehavior;\r\n    /**\r\n     * Regroups all mesh behaviors for the slate\r\n     */\r\n    public get defaultBehavior(): DefaultBehavior {\r\n        return this._defaultBehavior;\r\n    }\r\n\r\n    /** @internal */\r\n    public _gizmo: SlateGizmo;\r\n\r\n    protected _titleBar: Mesh;\r\n    protected _titleBarTitle: Mesh;\r\n    protected _contentPlate: Mesh;\r\n    protected _backPlate: Mesh;\r\n    /** @internal */\r\n    public _followButton: TouchHolographicButton;\r\n    protected _closeButton: TouchHolographicButton;\r\n    protected _contentScaleRatio = 1;\r\n\r\n    /**\r\n     * 2D dimensions of the slate\r\n     */\r\n    public get dimensions() {\r\n        return this._dimensions;\r\n    }\r\n    public set dimensions(value) {\r\n        //clamp, respecting ratios\r\n        let scale = 1.0;\r\n        if (value.x < this.minDimensions.x || value.y < this.minDimensions.y) {\r\n            const newRatio = value.x / value.y;\r\n            const minRatio = this.minDimensions.x / this.minDimensions.y;\r\n            if (minRatio > newRatio) {\r\n                // We just need to make sure the x-val is greater than the min\r\n                scale = this.minDimensions.x / value.x;\r\n            } else {\r\n                // We just need to make sure the y-val is greater than the min\r\n                scale = this.minDimensions.y / value.y;\r\n            }\r\n        }\r\n\r\n        this._dimensions.copyFrom(value).scaleInPlace(scale);\r\n        this._updatePivot();\r\n        this._positionElements();\r\n    }\r\n\r\n    /**\r\n     * Minimum dimensions of the slate\r\n     */\r\n    public minDimensions = new Vector2(15.625, 6.25);\r\n\r\n    /**\r\n     * Default dimensions of the slate\r\n     */\r\n    public readonly defaultDimensions = this._dimensions.clone();\r\n\r\n    /**\r\n     * Height of the title bar component\r\n     */\r\n    public get titleBarHeight() {\r\n        return this._titleBarHeight;\r\n    }\r\n    public set titleBarHeight(value) {\r\n        this._titleBarHeight = value;\r\n    }\r\n\r\n    /**\r\n     * Rendering ground id of all the meshes\r\n     */\r\n    public set renderingGroupId(id: number) {\r\n        this._titleBar.renderingGroupId = id;\r\n        this._titleBarTitle.renderingGroupId = id;\r\n        this._contentPlate.renderingGroupId = id;\r\n        this._backPlate.renderingGroupId = id;\r\n    }\r\n    public get renderingGroupId(): number {\r\n        return this._titleBar.renderingGroupId;\r\n    }\r\n\r\n    /**\r\n     * The title text displayed at the top of the slate\r\n     */\r\n    public set title(title: string) {\r\n        this._titleText = title;\r\n        if (this._titleTextComponent) {\r\n            this._titleTextComponent.text = title;\r\n        }\r\n    }\r\n    public get title() {\r\n        return this._titleText;\r\n    }\r\n\r\n    /**\r\n     * Creates a new slate\r\n     * @param name defines the control name\r\n     */\r\n    constructor(name?: string) {\r\n        super(name);\r\n\r\n        this._followButton = new TouchHolographicButton(\"followButton\" + this.name);\r\n        this._followButton.isToggleButton = true;\r\n        this._closeButton = new TouchHolographicButton(\"closeButton\" + this.name);\r\n\r\n        this._contentViewport = new Viewport(0, 0, 1, 1);\r\n        this._contentDragBehavior = new PointerDragBehavior({\r\n            dragPlaneNormal: new Vector3(0, 0, -1),\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Apply the facade texture (created from the content property).\r\n     * This function can be overloaded by child classes\r\n     * @param facadeTexture defines the AdvancedDynamicTexture to use\r\n     */\r\n    protected _applyFacade(facadeTexture: AdvancedDynamicTexture) {\r\n        this._contentMaterial.albedoTexture = facadeTexture;\r\n        this._resetContentPositionAndZoom();\r\n        this._applyContentViewport();\r\n\r\n        facadeTexture.attachToMesh(this._contentPlate, true);\r\n    }\r\n\r\n    private _addControl(control: Control3D): void {\r\n        control._host = this._host;\r\n        if (this._host.utilityLayer) {\r\n            control._prepareNode(this._host.utilityLayer.utilityLayerScene);\r\n        }\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"HolographicSlate\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _positionElements() {\r\n        const followButton = this._followButton;\r\n        const closeButton = this._closeButton;\r\n        const titleBar = this._titleBar;\r\n        const titleBarTitle = this._titleBarTitle;\r\n        const contentPlate = this._contentPlate;\r\n        const backPlate = this._backPlate;\r\n\r\n        if (followButton && closeButton && titleBar) {\r\n            closeButton.scaling.setAll(this.titleBarHeight);\r\n            followButton.scaling.setAll(this.titleBarHeight);\r\n            closeButton.position.copyFromFloats(this.dimensions.x - this.titleBarHeight / 2, -this.titleBarHeight / 2, 0).addInPlace(this.origin);\r\n            followButton.position.copyFromFloats(this.dimensions.x - (3 * this.titleBarHeight) / 2, -this.titleBarHeight / 2, 0).addInPlace(this.origin);\r\n\r\n            const contentPlateHeight = this.dimensions.y - this.titleBarHeight - this.titleBarMargin;\r\n            const rightHandScene = contentPlate.getScene().useRightHandedSystem;\r\n\r\n            titleBar.scaling.set(this.dimensions.x, this.titleBarHeight, Epsilon);\r\n            titleBarTitle.scaling.set(this.dimensions.x - 2 * this.titleBarHeight, this.titleBarHeight, Epsilon);\r\n            contentPlate.scaling.copyFromFloats(this.dimensions.x, contentPlateHeight, Epsilon);\r\n            backPlate.scaling.copyFromFloats(this.dimensions.x, contentPlateHeight, Epsilon);\r\n\r\n            titleBar.position.copyFromFloats(this.dimensions.x / 2, -(this.titleBarHeight / 2), 0).addInPlace(this.origin);\r\n            titleBarTitle.position\r\n                .copyFromFloats(this.dimensions.x / 2 - this.titleBarHeight, -(this.titleBarHeight / 2), rightHandScene ? Epsilon : -Epsilon)\r\n                .addInPlace(this.origin);\r\n            contentPlate.position.copyFromFloats(this.dimensions.x / 2, -(this.titleBarHeight + this.titleBarMargin + contentPlateHeight / 2), 0).addInPlace(this.origin);\r\n            backPlate.position\r\n                .copyFromFloats(this.dimensions.x / 2, -(this.titleBarHeight + this.titleBarMargin + contentPlateHeight / 2), rightHandScene ? -Epsilon : Epsilon)\r\n                .addInPlace(this.origin);\r\n\r\n            // Update the title's AdvancedDynamicTexture scale to avoid visual stretching\r\n            this._titleTextComponent.host.scaleTo(\r\n                (HolographicSlate._DEFAULT_TEXT_RESOLUTION_Y * titleBarTitle.scaling.x) / titleBarTitle.scaling.y,\r\n                HolographicSlate._DEFAULT_TEXT_RESOLUTION_Y\r\n            );\r\n\r\n            const aspectRatio = this.dimensions.x / contentPlateHeight;\r\n            this._contentViewport.width = this._contentScaleRatio;\r\n            this._contentViewport.height = this._contentScaleRatio / aspectRatio;\r\n\r\n            this._applyContentViewport();\r\n            if (this._gizmo) {\r\n                this._gizmo.updateBoundingBox();\r\n            }\r\n        }\r\n    }\r\n\r\n    private _applyContentViewport() {\r\n        if (this._contentPlate?.material && (this._contentPlate.material as FluentMaterial).albedoTexture) {\r\n            const tex = (this._contentPlate.material as FluentMaterial).albedoTexture as Texture;\r\n            tex.uScale = this._contentScaleRatio;\r\n            tex.vScale = (this._contentScaleRatio / this._contentViewport.width) * this._contentViewport.height;\r\n            tex.uOffset = this._contentViewport.x;\r\n            tex.vOffset = this._contentViewport.y;\r\n        }\r\n    }\r\n\r\n    private _resetContentPositionAndZoom() {\r\n        this._contentViewport.x = 0;\r\n        this._contentViewport.y = 1 - this._contentViewport.height / this._contentViewport.width;\r\n        this._contentScaleRatio = 1;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _updatePivot() {\r\n        if (!this.mesh) {\r\n            return;\r\n        }\r\n\r\n        // Update pivot point so it is at the center of geometry\r\n        // As origin is topleft corner in 2D, dimensions are calculated towards bottom right corner, thus y axis is downwards\r\n        const center = new Vector3(this.dimensions.x * 0.5, -this.dimensions.y * 0.5, Epsilon);\r\n        center.addInPlace(this.origin);\r\n        center.z = 0;\r\n\r\n        const origin = new Vector3(0, 0, 0);\r\n        Vector3.TransformCoordinatesToRef(origin, this.mesh.computeWorldMatrix(true), origin);\r\n        this.mesh.setPivotPoint(center);\r\n        const origin2 = new Vector3(0, 0, 0);\r\n        Vector3.TransformCoordinatesToRef(origin2, this.mesh.computeWorldMatrix(true), origin2);\r\n        this.mesh.position.addInPlace(origin).subtractInPlace(origin2);\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        const node = new Mesh(\"slate_\" + this.name, scene);\r\n\r\n        this._titleBar = CreateBox(\"titleBar_\" + this.name, { size: 1 }, scene);\r\n        this._titleBarTitle = CreatePlane(\"titleText_\" + this.name, { size: 1 }, scene);\r\n        this._titleBarTitle.parent = node;\r\n        this._titleBarTitle.isPickable = false;\r\n\r\n        const adt = AdvancedDynamicTexture.CreateForMesh(this._titleBarTitle);\r\n        this._titleTextComponent = new TextBlock(\"titleText_\" + this.name, this._titleText);\r\n        this._titleTextComponent.textWrapping = TextWrapping.Ellipsis;\r\n        this._titleTextComponent.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n        this._titleTextComponent.color = \"white\";\r\n        this._titleTextComponent.fontSize = HolographicSlate._DEFAULT_TEXT_RESOLUTION_Y / 2;\r\n        this._titleTextComponent.paddingLeft = HolographicSlate._DEFAULT_TEXT_RESOLUTION_Y / 4;\r\n        adt.addControl(this._titleTextComponent);\r\n\r\n        if (scene.useRightHandedSystem) {\r\n            const faceUV = new Vector4(0, 0, 1, 1);\r\n            this._contentPlate = CreatePlane(\"contentPlate_\" + this.name, { size: 1, sideOrientation: VertexData.BACKSIDE, frontUVs: faceUV }, scene);\r\n            this._backPlate = CreatePlane(\"backPlate_\" + this.name, { size: 1, sideOrientation: VertexData.FRONTSIDE }, scene);\r\n        } else {\r\n            const faceUV = new Vector4(0, 0, 1, 1);\r\n            this._contentPlate = CreatePlane(\"contentPlate_\" + this.name, { size: 1, sideOrientation: VertexData.FRONTSIDE, frontUVs: faceUV }, scene);\r\n            this._backPlate = CreatePlane(\"backPlate_\" + this.name, { size: 1, sideOrientation: VertexData.BACKSIDE }, scene);\r\n        }\r\n\r\n        this._titleBar.parent = node;\r\n        this._titleBar.isNearGrabbable = true;\r\n        this._contentPlate.parent = node;\r\n        this._backPlate.parent = node;\r\n        this._attachContentPlateBehavior();\r\n\r\n        this._addControl(this._followButton);\r\n        this._addControl(this._closeButton);\r\n\r\n        const followButton = this._followButton;\r\n        const closeButton = this._closeButton;\r\n\r\n        followButton.node!.parent = node;\r\n        closeButton.node!.parent = node;\r\n\r\n        this._positionElements();\r\n\r\n        this._followButton.imageUrl = HolographicSlate.ASSETS_BASE_URL + HolographicSlate.FOLLOW_ICON_FILENAME;\r\n        this._closeButton.imageUrl = HolographicSlate.ASSETS_BASE_URL + HolographicSlate.CLOSE_ICON_FILENAME;\r\n\r\n        this._followButton.isBackplateVisible = false;\r\n        this._closeButton.isBackplateVisible = false;\r\n\r\n        this._followButton.onToggleObservable.add((isToggled) => {\r\n            this._defaultBehavior.followBehaviorEnabled = isToggled;\r\n            if (this._defaultBehavior.followBehaviorEnabled) {\r\n                this._defaultBehavior.followBehavior.recenter();\r\n            }\r\n        });\r\n\r\n        this._closeButton.onPointerClickObservable.add(() => {\r\n            this.dispose();\r\n        });\r\n\r\n        node.rotationQuaternion = Quaternion.Identity();\r\n        node.isVisible = false;\r\n\r\n        return node;\r\n    }\r\n\r\n    private _attachContentPlateBehavior() {\r\n        this._contentDragBehavior.attach(this._contentPlate);\r\n        this._contentDragBehavior.moveAttached = false;\r\n        this._contentDragBehavior.useObjectOrientationForDragging = true;\r\n        this._contentDragBehavior.updateDragPlane = false;\r\n\r\n        const origin = new Vector3();\r\n        const worldDimensions = new Vector3();\r\n        const upWorld = new Vector3();\r\n        const rightWorld = new Vector3();\r\n        const projectedOffset = new Vector2();\r\n        let startViewport: Viewport;\r\n        let worldMatrix: Matrix;\r\n\r\n        this._contentDragBehavior.onDragStartObservable.add((event) => {\r\n            if (!this.node) {\r\n                return;\r\n            }\r\n            startViewport = this._contentViewport.clone();\r\n            worldMatrix = this.node.computeWorldMatrix(true);\r\n\r\n            origin.copyFrom(event.dragPlanePoint);\r\n            worldDimensions.set(this.dimensions.x, this.dimensions.y, Epsilon);\r\n            worldDimensions.y -= this.titleBarHeight + this.titleBarMargin;\r\n            Vector3.TransformNormalToRef(worldDimensions, worldMatrix, worldDimensions);\r\n            upWorld.copyFromFloats(0, 1, 0);\r\n            Vector3.TransformNormalToRef(upWorld, worldMatrix, upWorld);\r\n            rightWorld.copyFromFloats(1, 0, 0);\r\n            Vector3.TransformNormalToRef(rightWorld, worldMatrix, rightWorld);\r\n            upWorld.normalize();\r\n            upWorld.scaleInPlace(1 / Vector3.Dot(upWorld, worldDimensions));\r\n            rightWorld.normalize();\r\n            rightWorld.scaleInPlace(1 / Vector3.Dot(rightWorld, worldDimensions));\r\n        });\r\n\r\n        const offset = new Vector3();\r\n        this._contentDragBehavior.onDragObservable.add((event) => {\r\n            offset.copyFrom(event.dragPlanePoint);\r\n            offset.subtractInPlace(origin);\r\n            projectedOffset.copyFromFloats(Vector3.Dot(offset, rightWorld), Vector3.Dot(offset, upWorld));\r\n\r\n            // By default, content takes full width available and height is cropped to keep aspect ratio\r\n            this._contentViewport.x = Scalar.Clamp(startViewport.x - offset.x, 0, 1 - this._contentViewport.width * this._contentScaleRatio);\r\n            this._contentViewport.y = Scalar.Clamp(startViewport.y - offset.y, 0, 1 - this._contentViewport.height * this._contentScaleRatio);\r\n            this._applyContentViewport();\r\n        });\r\n    }\r\n\r\n    protected _affectMaterial(mesh: AbstractMesh) {\r\n        // TODO share materials\r\n        this._titleBarMaterial = new FluentBackplateMaterial(`${this.name} plateMaterial`, mesh.getScene());\r\n\r\n        this._contentMaterial = new FluentMaterial(`${this.name} contentMaterial`, mesh.getScene());\r\n        this._contentMaterial.renderBorders = true;\r\n\r\n        this._backMaterial = new FluentBackplateMaterial(`${this.name} backPlate`, mesh.getScene());\r\n        this._backMaterial.lineWidth = Epsilon;\r\n        this._backMaterial.radius = 0.005;\r\n        this._backMaterial.backFaceCulling = true;\r\n\r\n        this._titleBar.material = this._titleBarMaterial;\r\n        this._contentPlate.material = this._contentMaterial;\r\n        this._backPlate.material = this._backMaterial;\r\n\r\n        this._resetContent();\r\n        this._applyContentViewport();\r\n    }\r\n\r\n    /**\r\n     * @internal*\r\n     */\r\n    public _prepareNode(scene: Scene): void {\r\n        super._prepareNode(scene);\r\n        this._gizmo = new SlateGizmo(this._host.utilityLayer!);\r\n        this._gizmo.attachedSlate = this;\r\n        this._defaultBehavior = new DefaultBehavior();\r\n        this._defaultBehavior.attach(this.node as Mesh, [this._titleBar]);\r\n        this._defaultBehavior.sixDofDragBehavior.onDragStartObservable.add(() => {\r\n            this._followButton.isToggled = false;\r\n        });\r\n\r\n        this._positionChangedObserver = this._defaultBehavior.sixDofDragBehavior.onPositionChangedObservable.add(() => {\r\n            this._gizmo.updateBoundingBox();\r\n        });\r\n\r\n        this._updatePivot();\r\n        this.resetDefaultAspectAndPose(false);\r\n    }\r\n\r\n    /**\r\n     * Resets the aspect and pose of the slate so it is right in front of the active camera, facing towards it.\r\n     * @param resetAspect Should the slate's dimensions/aspect ratio be reset as well\r\n     */\r\n    public resetDefaultAspectAndPose(resetAspect: boolean = true) {\r\n        if (!this._host || !this._host.utilityLayer || !this.node) {\r\n            return;\r\n        }\r\n        const scene = this._host.utilityLayer.utilityLayerScene;\r\n        const camera = scene.activeCamera;\r\n        if (camera) {\r\n            const worldMatrix = camera.getWorldMatrix();\r\n            const backward = Vector3.TransformNormal(Vector3.Backward(scene.useRightHandedSystem), worldMatrix);\r\n            this.origin.setAll(0);\r\n            this._gizmo.updateBoundingBox();\r\n            const pivot = this.node.getAbsolutePivotPoint();\r\n            this.node.position.copyFrom(camera.position).subtractInPlace(backward).subtractInPlace(pivot);\r\n            this.node.rotationQuaternion = Quaternion.FromLookDirectionLH(backward, new Vector3(0, 1, 0));\r\n\r\n            if (resetAspect) {\r\n                this.dimensions = this.defaultDimensions;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n        this._titleBarMaterial.dispose();\r\n        this._contentMaterial.dispose();\r\n\r\n        this._titleBar.dispose();\r\n        this._titleBarTitle.dispose();\r\n        this._contentPlate.dispose();\r\n        this._backPlate.dispose();\r\n\r\n        this._followButton.dispose();\r\n        this._closeButton.dispose();\r\n\r\n        this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver);\r\n        this._defaultBehavior.sixDofDragBehavior.onPositionChangedObservable.remove(this._positionChangedObserver);\r\n\r\n        this._defaultBehavior.detach();\r\n        this._gizmo.dispose();\r\n        this._contentDragBehavior.detach();\r\n    }\r\n}\r\n","import type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Scene } from \"core/scene\";\r\n\r\nimport { Button3D } from \"./button3D\";\r\n\r\n/**\r\n * Class used to create an interactable object. It's a 3D button using a mesh coming from the current scene\r\n */\r\nexport class MeshButton3D extends Button3D {\r\n    /** @internal */\r\n    protected _currentMesh: Mesh;\r\n\r\n    /**\r\n     * Creates a new 3D button based on a mesh\r\n     * @param mesh mesh to become a 3D button\r\n     * @param name defines the control name\r\n     */\r\n    constructor(mesh: Mesh, name?: string) {\r\n        super(name);\r\n        this._currentMesh = mesh;\r\n\r\n        /**\r\n         * Provides a default behavior on hover/out & up/down\r\n         * Override those function to create your own desired behavior specific to your mesh\r\n         */\r\n        this.pointerEnterAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(1.1);\r\n        };\r\n\r\n        this.pointerOutAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(1.0 / 1.1);\r\n        };\r\n\r\n        this.pointerDownAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(0.95);\r\n        };\r\n\r\n        this.pointerUpAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(1.0 / 0.95);\r\n        };\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"MeshButton3D\";\r\n    }\r\n\r\n    // Mesh association\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        this._currentMesh.getChildMeshes().forEach((mesh) => {\r\n            this._injectGUI3DReservedDataStore(mesh).control = this;\r\n        });\r\n        return this._currentMesh;\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    protected _affectMaterial(mesh: AbstractMesh) {}\r\n}\r\n","import type { Scene } from \"core/scene\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport { TouchHolographicButton } from \"./touchHolographicButton\";\r\nimport { DefaultBehavior } from \"../behaviors/defaultBehavior\";\r\nimport { TouchHolographicMenu } from \"./touchHolographicMenu\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport type { Vector3 } from \"core/Maths/math.vector\";\r\nimport type { PickingInfo } from \"core/Collisions/pickingInfo\";\r\n\r\n/**\r\n * NearMenu that displays buttons and follows the camera\r\n * @since 5.0.0\r\n */\r\nexport class NearMenu extends TouchHolographicMenu {\r\n    /**\r\n     * Base Url for the assets.\r\n     */\r\n    private static _ASSETS_BASE_URL: string = \"https://assets.babylonjs.com/meshes/MRTK/\";\r\n    /**\r\n     * File name for the close icon.\r\n     */\r\n    private static _PIN_ICON_FILENAME: string = \"IconPin.png\";\r\n\r\n    private _pinButton: TouchHolographicButton;\r\n    private _dragObserver: Nullable<\r\n        Observer<{\r\n            delta: Vector3;\r\n            position: Vector3;\r\n            pickInfo: PickingInfo;\r\n        }>\r\n    >;\r\n\r\n    private _defaultBehavior: DefaultBehavior;\r\n    /**\r\n     * Regroups all mesh behaviors for the near menu\r\n     */\r\n    public get defaultBehavior(): DefaultBehavior {\r\n        return this._defaultBehavior;\r\n    }\r\n\r\n    private _isPinned: boolean = false;\r\n    /**\r\n     * Indicates if the near menu is world-pinned\r\n     */\r\n    public get isPinned(): boolean {\r\n        return this._isPinned;\r\n    }\r\n\r\n    public set isPinned(value: boolean) {\r\n        // Tell the pin button to toggle if this was called manually, for clean state control\r\n        if (this._pinButton.isToggled !== value) {\r\n            this._pinButton.isToggled = value;\r\n            return;\r\n        }\r\n\r\n        this._isPinned = value;\r\n\r\n        if (value) {\r\n            this._defaultBehavior.followBehaviorEnabled = false;\r\n        } else {\r\n            this._defaultBehavior.followBehaviorEnabled = true;\r\n        }\r\n    }\r\n\r\n    private _createPinButton(parent: TransformNode) {\r\n        const control = new TouchHolographicButton(\"pin\" + this.name, false);\r\n        control.imageUrl = NearMenu._ASSETS_BASE_URL + NearMenu._PIN_ICON_FILENAME;\r\n        control.parent = this;\r\n        control._host = this._host;\r\n        control.isToggleButton = true;\r\n        control.onToggleObservable.add((newState) => {\r\n            this.isPinned = newState;\r\n        });\r\n\r\n        if (this._host.utilityLayer) {\r\n            control._prepareNode(this._host.utilityLayer.utilityLayerScene);\r\n            control.scaling.scaleInPlace(TouchHolographicMenu.MENU_BUTTON_SCALE);\r\n\r\n            if (control.node) {\r\n                control.node.parent = parent;\r\n            }\r\n        }\r\n\r\n        return control;\r\n    }\r\n\r\n    protected _createNode(scene: Scene): Nullable<TransformNode> {\r\n        const node = super._createNode(scene)! as Mesh;\r\n\r\n        this._pinButton = this._createPinButton(node);\r\n        this.isPinned = false;\r\n\r\n        this._defaultBehavior.attach(node, [this._backPlate]);\r\n        this._defaultBehavior.followBehavior.ignoreCameraPitchAndRoll = true;\r\n        this._defaultBehavior.followBehavior.pitchOffset = -15;\r\n        this._defaultBehavior.followBehavior.minimumDistance = 0.3;\r\n        this._defaultBehavior.followBehavior.defaultDistance = 0.4;\r\n        this._defaultBehavior.followBehavior.maximumDistance = 0.6;\r\n\r\n        this._backPlate.isNearGrabbable = true;\r\n        node.isVisible = false;\r\n\r\n        return node;\r\n    }\r\n\r\n    protected _finalProcessing() {\r\n        super._finalProcessing();\r\n\r\n        this._pinButton.position.copyFromFloats((this._backPlate.scaling.x + TouchHolographicMenu.MENU_BUTTON_SCALE) / 2, this._backPlate.scaling.y / 2, 0);\r\n    }\r\n\r\n    /**\r\n     * Creates a near menu GUI 3D control\r\n     * @param name name of the near menu\r\n     */\r\n    constructor(name?: string) {\r\n        super(name);\r\n\r\n        this._defaultBehavior = new DefaultBehavior();\r\n        this._dragObserver = this._defaultBehavior.sixDofDragBehavior.onDragObservable.add(() => {\r\n            this.isPinned = true;\r\n        });\r\n\r\n        this.backPlateMargin = 1;\r\n    }\r\n\r\n    /**\r\n     * Disposes the near menu\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n\r\n        this._defaultBehavior.sixDofDragBehavior.onDragObservable.remove(this._dragObserver);\r\n        this._defaultBehavior.detach();\r\n    }\r\n}\r\n","import { TmpVectors, Vector3 } from \"core/Maths/math.vector\";\r\n\r\nimport { Container3D } from \"./container3D\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { VolumeBasedPanel } from \"./volumeBasedPanel\";\r\n\r\n/**\r\n * Class used to create a container panel deployed on the surface of a plane\r\n */\r\nexport class PlanePanel extends VolumeBasedPanel {\r\n    protected _mapGridNode(control: Control3D, nodePosition: Vector3) {\r\n        const mesh = control.mesh;\r\n\r\n        if (!mesh) {\r\n            return;\r\n        }\r\n\r\n        control.position = nodePosition.clone();\r\n        const target = TmpVectors.Vector3[0];\r\n\r\n        target.copyFrom(nodePosition);\r\n\r\n        switch (this.orientation) {\r\n            case Container3D.FACEORIGIN_ORIENTATION:\r\n            case Container3D.FACEFORWARD_ORIENTATION:\r\n                target.addInPlace(new Vector3(0, 0, 1));\r\n                mesh.lookAt(target);\r\n                break;\r\n            case Container3D.FACEFORWARDREVERSED_ORIENTATION:\r\n            case Container3D.FACEORIGINREVERSED_ORIENTATION:\r\n                target.addInPlace(new Vector3(0, 0, -1));\r\n                mesh.lookAt(target);\r\n                break;\r\n        }\r\n    }\r\n}\r\n","import { Tools } from \"core/Misc/tools\";\r\nimport { TmpVectors, Vector3 } from \"core/Maths/math.vector\";\r\nimport type { float } from \"core/types\";\r\n\r\nimport { VolumeBasedPanel } from \"./volumeBasedPanel\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { Container3D } from \"./container3D\";\r\n\r\n/**\r\n * Class used to create a container panel where items get randomized planar mapping\r\n */\r\nexport class ScatterPanel extends VolumeBasedPanel {\r\n    private _iteration = 100.0;\r\n\r\n    /**\r\n     * Gets or sets the number of iteration to use to scatter the controls (100 by default)\r\n     */\r\n    public get iteration(): float {\r\n        return this._iteration;\r\n    }\r\n\r\n    public set iteration(value: float) {\r\n        if (this._iteration === value) {\r\n            return;\r\n        }\r\n\r\n        this._iteration = value;\r\n\r\n        Tools.SetImmediate(() => {\r\n            this._arrangeChildren();\r\n        });\r\n    }\r\n\r\n    protected _mapGridNode(control: Control3D, nodePosition: Vector3) {\r\n        const mesh = control.mesh;\r\n        const newPos = this._scatterMapping(nodePosition);\r\n\r\n        if (!mesh) {\r\n            return;\r\n        }\r\n\r\n        switch (this.orientation) {\r\n            case Container3D.FACEORIGIN_ORIENTATION:\r\n            case Container3D.FACEFORWARD_ORIENTATION:\r\n                mesh.lookAt(new Vector3(0, 0, 1));\r\n                break;\r\n            case Container3D.FACEFORWARDREVERSED_ORIENTATION:\r\n            case Container3D.FACEORIGINREVERSED_ORIENTATION:\r\n                mesh.lookAt(new Vector3(0, 0, -1));\r\n                break;\r\n        }\r\n\r\n        control.position = newPos;\r\n    }\r\n\r\n    private _scatterMapping(source: Vector3): Vector3 {\r\n        source.x = (1.0 - Math.random() * 2.0) * this._cellWidth;\r\n        source.y = (1.0 - Math.random() * 2.0) * this._cellHeight;\r\n\r\n        return source;\r\n    }\r\n\r\n    protected _finalProcessing() {\r\n        const meshes = [];\r\n        for (const child of this._children) {\r\n            if (!child.mesh) {\r\n                continue;\r\n            }\r\n\r\n            meshes.push(child.mesh);\r\n        }\r\n\r\n        for (let count = 0; count < this._iteration; count++) {\r\n            meshes.sort((a, b) => {\r\n                const distance1 = a.position.lengthSquared();\r\n                const distance2 = b.position.lengthSquared();\r\n\r\n                if (distance1 < distance2) {\r\n                    return 1;\r\n                } else if (distance1 > distance2) {\r\n                    return -1;\r\n                }\r\n\r\n                return 0;\r\n            });\r\n\r\n            const radiusPaddingSquared = Math.pow(this.margin, 2.0);\r\n            const cellSize = Math.max(this._cellWidth, this._cellHeight);\r\n            const difference2D = TmpVectors.Vector2[0];\r\n            const difference = TmpVectors.Vector3[0];\r\n\r\n            for (let i = 0; i < meshes.length - 1; i++) {\r\n                for (let j = i + 1; j < meshes.length; j++) {\r\n                    if (i != j) {\r\n                        meshes[j].position.subtractToRef(meshes[i].position, difference);\r\n\r\n                        // Ignore Z axis\r\n                        difference2D.x = difference.x;\r\n                        difference2D.y = difference.y;\r\n                        const combinedRadius = cellSize;\r\n                        let distance = difference2D.lengthSquared() - radiusPaddingSquared;\r\n                        const minSeparation = Math.min(distance, radiusPaddingSquared);\r\n                        distance -= minSeparation;\r\n\r\n                        if (distance < Math.pow(combinedRadius, 2.0)) {\r\n                            difference2D.normalize();\r\n                            difference.scaleInPlace((combinedRadius - Math.sqrt(distance)) * 0.5);\r\n                            meshes[j].position.addInPlace(difference);\r\n                            meshes[i].position.subtractInPlace(difference);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"mrdlSliderBarPixelShader\";\nconst shader = `uniform vec3 cameraPosition;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\rvarying vec4 vExtra2;\rvarying vec4 vExtra3;\runiform float _Radius_;\runiform float _Bevel_Front_;\runiform float _Bevel_Front_Stretch_;\runiform float _Bevel_Back_;\runiform float _Bevel_Back_Stretch_;\runiform float _Radius_Top_Left_;\runiform float _Radius_Top_Right_;\runiform float _Radius_Bottom_Left_;\runiform float _Radius_Bottom_Right_;\runiform bool _Bulge_Enabled_;\runiform float _Bulge_Height_;\runiform float _Bulge_Radius_;\runiform float _Sun_Intensity_;\runiform float _Sun_Theta_;\runiform float _Sun_Phi_;\runiform float _Indirect_Diffuse_;\runiform vec4 _Albedo_;\runiform float _Specular_;\runiform float _Shininess_;\runiform float _Sharpness_;\runiform float _Subsurface_;\runiform vec4 _Left_Color_;\runiform vec4 _Right_Color_;\runiform float _Reflection_;\runiform float _Front_Reflect_;\runiform float _Edge_Reflect_;\runiform float _Power_;\runiform vec4 _Sky_Color_;\runiform vec4 _Horizon_Color_;\runiform vec4 _Ground_Color_;\runiform float _Horizon_Power_;\runiform sampler2D _Reflection_Map_;\runiform sampler2D _Indirect_Environment_;\runiform float _Width_;\runiform float _Fuzz_;\runiform float _Min_Fuzz_;\runiform float _Clip_Fade_;\runiform float _Hue_Shift_;\runiform float _Saturation_Shift_;\runiform float _Value_Shift_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform vec3 _Left_Index_Pos_;\runiform vec3 _Right_Index_Pos_;\runiform vec3 _Left_Index_Middle_Pos_;\runiform vec3 _Right_Index_Middle_Pos_;\runiform sampler2D _Decal_;\runiform vec2 _Decal_Scale_XY_;\runiform bool _Decal_Front_Only_;\runiform float _Rim_Intensity_;\runiform sampler2D _Rim_Texture_;\runiform float _Rim_Hue_Shift_;\runiform float _Rim_Saturation_Shift_;\runiform float _Rim_Value_Shift_;\runiform float _Iridescence_Intensity_;\runiform sampler2D _Iridescence_Texture_;\runiform bool Use_Global_Left_Index;\runiform bool Use_Global_Right_Index;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\runiform vec4 Global_Left_Thumb_Tip_Position;\runiform vec4 Global_Right_Thumb_Tip_Position;\runiform vec4 Global_Left_Index_Middle_Position;\runiform vec4 Global_Right_Index_Middle_Position;\runiform float Global_Left_Index_Tip_Proximity;\runiform float Global_Right_Index_Tip_Proximity;\rvoid Blob_Fragment_B30(\rsampler2D Blob_Texture,\rvec4 Blob_Info1,\rvec4 Blob_Info2,\rout vec4 Blob_Color)\r{\rfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\rfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\rvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\rBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\r}\rvoid FastLinearTosRGB_B42(\rvec4 Linear,\rout vec4 sRGB)\r{\rsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\rsRGB.a=Linear.a;\r}\rvoid Scale_RGB_B59(\rvec4 Color,\rfloat Scalar,\rout vec4 Result)\r{\rResult=vec4(Scalar,Scalar,Scalar,1)*Color;\r}\rvoid Fragment_Main_B121(\rfloat Sun_Intensity,\rfloat Sun_Theta,\rfloat Sun_Phi,\rvec3 Normal,\rvec4 Albedo,\rfloat Fresnel_Reflect,\rfloat Shininess,\rvec3 Incident,\rvec4 Horizon_Color,\rvec4 Sky_Color,\rvec4 Ground_Color,\rfloat Indirect_Diffuse,\rfloat Specular,\rfloat Horizon_Power,\rfloat Reflection,\rvec4 Reflection_Sample,\rvec4 Indirect_Sample,\rfloat Sharpness,\rfloat SSS,\rfloat Subsurface,\rvec4 Translucence,\rvec4 Rim_Light,\rvec4 Iridescence,\rout vec4 Result)\r{\rfloat theta=Sun_Theta*2.0*3.14159;\rfloat phi=Sun_Phi*3.14159;\rvec3 lightDir= vec3(cos(phi)*cos(theta),sin(phi),cos(phi)*sin(theta));\rfloat NdotL=max(dot(lightDir,Normal),0.0);\rvec3 R=reflect(Incident,Normal);\rfloat RdotL=max(0.0,dot(R,lightDir));\rfloat specular=pow(RdotL,Shininess);\rspecular=mix(specular,smoothstep(0.495*Sharpness,1.0-0.495*Sharpness,specular),Sharpness);\rvec4 gi=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\rResult=((Sun_Intensity*NdotL+Indirect_Sample*Indirect_Diffuse+Translucence)*(1.0+SSS*Subsurface))*Albedo*(1.0-Fresnel_Reflect)+(Sun_Intensity*specular*Specular+Fresnel_Reflect*Reflection*Reflection_Sample)+Fresnel_Reflect*Rim_Light+Iridescence;\r}\rvoid Bulge_B79(\rbool Enabled,\rvec3 Normal,\rvec3 Tangent,\rfloat Bulge_Height,\rvec4 UV,\rfloat Bulge_Radius,\rvec3 ButtonN,\rout vec3 New_Normal)\r{\rvec2 xy=clamp(UV.xy*2.0,vec2(-1,-1),vec2(1,1));\rvec3 B=(cross(Normal,Tangent));\rfloat k=-clamp(1.0-length(xy)/Bulge_Radius,0.0,1.0)*Bulge_Height;\rk=sin(k*3.14159*0.5);\rk*=smoothstep(0.9998,0.9999,abs(dot(ButtonN,Normal)));\rNew_Normal=Normal*sqrt(1.0-k*k)+(xy.x*Tangent+xy.y*B)*k;\rNew_Normal=Enabled ? New_Normal : Normal;\r}\rvoid SSS_B77(\rvec3 ButtonN,\rvec3 Normal,\rvec3 Incident,\rout float Result)\r{\rfloat NdotI=abs(dot(Normal,Incident));\rfloat BdotI=abs(dot(ButtonN,Incident));\rResult=(abs(NdotI-BdotI)); \r}\rvoid FingerOcclusion_B67(\rfloat Width,\rfloat DistToCenter,\rfloat Fuzz,\rfloat Min_Fuzz,\rvec3 Position,\rvec3 Forward,\rvec3 Nearest,\rfloat Fade_Out,\rout float NotInShadow)\r{\rfloat d=dot((Nearest-Position),Forward);\rfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\rNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\r}\rvoid FingerOcclusion_B68(\rfloat Width,\rfloat DistToCenter,\rfloat Fuzz,\rfloat Min_Fuzz,\rvec3 Position,\rvec3 Forward,\rvec3 Nearest,\rfloat Fade_Out,\rout float NotInShadow)\r{\rfloat d=dot((Nearest-Position),Forward);\rfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\rNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\r}\rvoid Scale_Color_B91(\rvec4 Color,\rfloat Scalar,\rout vec4 Result)\r{\rResult=Scalar*Color;\r}\rvoid From_HSV_B73(\rfloat Hue,\rfloat Saturation,\rfloat Value,\rfloat Alpha,\rout vec4 Color)\r{\rvec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);\rvec3 p=abs(fract(vec3(Hue,Hue,Hue)+K.xyz)*6.0-K.www);\rColor.rgb=Value*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),Saturation);\rColor.a=Alpha;\r}\rvoid Fast_Fresnel_B122(\rfloat Front_Reflect,\rfloat Edge_Reflect,\rfloat Power,\rvec3 Normal,\rvec3 Incident,\rout float Transmit,\rout float Reflect)\r{\rfloat d=max(-dot(Incident,Normal),0.0);\rReflect=Front_Reflect+(Edge_Reflect-Front_Reflect)*pow(.01-d,Power);\rTransmit=1.0-Reflect;\r}\rvoid Mapped_Environment_B51(\rsampler2D Reflected_Environment,\rsampler2D Indirect_Environment,\rvec3 Dir,\rout vec4 Reflected_Color,\rout vec4 Indirect_Diffuse)\r{\rReflected_Color=texture(Reflected_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\rIndirect_Diffuse=texture(Indirect_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\r}\rvec4 SampleEnv_Bid50(vec3 D,vec4 S,vec4 H,vec4 G,float exponent)\r{\rfloat k=pow(abs(D.y),exponent);\rvec4 C;\rif (D.y>0.0) {\rC=mix(H,S,k);\r} else {\rC=mix(H,G,k); \r}\rreturn C;\r}\rvoid Sky_Environment_B50(\rvec3 Normal,\rvec3 Reflected,\rvec4 Sky_Color,\rvec4 Horizon_Color,\rvec4 Ground_Color,\rfloat Horizon_Power,\rout vec4 Reflected_Color,\rout vec4 Indirect_Color)\r{\rReflected_Color=SampleEnv_Bid50(Reflected,Sky_Color,Horizon_Color,Ground_Color,Horizon_Power);\rIndirect_Color=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\r}\rvoid Min_Segment_Distance_B65(\rvec3 P0,\rvec3 P1,\rvec3 Q0,\rvec3 Q1,\rout vec3 NearP,\rout vec3 NearQ,\rout float Distance)\r{\rvec3 u=P1-P0;\rvec3 v=Q1-Q0;\rvec3 w=P0-Q0;\rfloat a=dot(u,u);\rfloat b=dot(u,v);\rfloat c=dot(v,v);\rfloat d=dot(u,w);\rfloat e=dot(v,w);\rfloat D=a*c-b*b;\rfloat sD=D;\rfloat tD=D;\rfloat sc,sN,tc,tN;\rif (D<0.00001) {\rsN=0.0;\rsD=1.0;\rtN=e;\rtD=c;\r} else {\rsN=(b*e-c*d);\rtN=(a*e-b*d);\rif (sN<0.0) {\rsN=0.0;\rtN=e;\rtD=c;\r} else if (sN>sD) {\rsN=sD;\rtN=e+b;\rtD=c;\r}\r}\rif (tN<0.0) {\rtN=0.0;\rif (-d<0.0) {\rsN=0.0;\r} else if (-d>a) {\rsN=sD;\r} else {\rsN=-d;\rsD=a;\r}\r} else if (tN>tD) {\rtN=tD;\rif ((-d+b)<0.0) {\rsN=0.0;\r} else if ((-d+b)>a) {\rsN=sD;\r} else {\rsN=(-d+b);\rsD=a;\r}\r}\rsc=abs(sN)<0.000001 ? 0.0 : sN/sD;\rtc=abs(tN)<0.000001 ? 0.0 : tN/tD;\rNearP=P0+sc*u;\rNearQ=Q0+tc*v;\rDistance=distance(NearP,NearQ);\r}\rvoid To_XYZ_B74(\rvec3 Vec3,\rout float X,\rout float Y,\rout float Z)\r{\rX=Vec3.x;\rY=Vec3.y;\rZ=Vec3.z;\r}\rvoid Finger_Positions_B64(\rvec3 Left_Index_Pos,\rvec3 Right_Index_Pos,\rvec3 Left_Index_Middle_Pos,\rvec3 Right_Index_Middle_Pos,\rout vec3 Left_Index,\rout vec3 Right_Index,\rout vec3 Left_Index_Middle,\rout vec3 Right_Index_Middle)\r{\rLeft_Index= (Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Left_Index_Pos);\rRight_Index= (Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Right_Index_Pos);\rLeft_Index_Middle= (Use_Global_Left_Index ? Global_Left_Index_Middle_Position.xyz : Left_Index_Middle_Pos);\rRight_Index_Middle= (Use_Global_Right_Index ? Global_Right_Index_Middle_Position.xyz : Right_Index_Middle_Pos);\r}\rvoid VaryHSV_B108(\rvec3 HSV_In,\rfloat Hue_Shift,\rfloat Saturation_Shift,\rfloat Value_Shift,\rout vec3 HSV_Out)\r{\rHSV_Out=vec3(fract(HSV_In.x+Hue_Shift),clamp(HSV_In.y+Saturation_Shift,0.0,1.0),clamp(HSV_In.z+Value_Shift,0.0,1.0));\r}\rvoid Remap_Range_B114(\rfloat In_Min,\rfloat In_Max,\rfloat Out_Min,\rfloat Out_Max,\rfloat In,\rout float Out)\r{\rOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\r}\rvoid To_HSV_B75(\rvec4 Color,\rout float Hue,\rout float Saturation,\rout float Value,\rout float Alpha,\rout vec3 HSV)\r{\rvec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);\rvec4 p=Color.g<Color.b ? vec4(Color.bg,K.wz) : vec4(Color.gb,K.xy);\rvec4 q=Color.r<p.x ? vec4(p.xyw,Color.r) : vec4(Color.r,p.yzx);\rfloat d=q.x-min(q.w,q.y);\rfloat e=1.0e-10;\rHue=abs(q.z+(q.w-q.y)/(6.0*d+e));\rSaturation=d/(q.x+e);\rValue=q.x;\rAlpha=Color.a;\rHSV=vec3(Hue,Saturation,Value);\r}\rvoid Code_B110(\rfloat X,\rout float Result)\r{\rResult=(acos(X)/3.14159-0.5)*2.0;\r}\rvoid Rim_Light_B132(\rvec3 Front,\rvec3 Normal,\rvec3 Incident,\rfloat Rim_Intensity,\rsampler2D Texture,\rout vec4 Result)\r{\rvec3 R=reflect(Incident,Normal);\rfloat RdotF=dot(R,Front);\rfloat RdotL=sqrt(1.0-RdotF*RdotF);\rvec2 UV=vec2(R.y*0.5+0.5,0.5);\rvec4 Color=texture(Texture,UV);\rResult=Color;\r}\rvoid main()\r{\rvec4 Blob_Color_Q30;\r#if BLOB_ENABLE\nBlob_Fragment_B30(_Blob_Texture_,vExtra2,vExtra3,Blob_Color_Q30);\r#else\nBlob_Color_Q30=vec4(0,0,0,0);\r#endif\nvec3 Incident_Q39=normalize(vPosition-cameraPosition);\rvec3 Normalized_Q38=normalize(vNormal);\rvec3 Normalized_Q71=normalize(vTangent);\rvec4 Color_Q83;\r#if DECAL_ENABLE\nColor_Q83=texture(_Decal_,vUV);\r#else\nColor_Q83=vec4(0,0,0,0);\r#endif\nfloat X_Q90;\rfloat Y_Q90;\rfloat Z_Q90;\rfloat W_Q90;\rX_Q90=vExtra1.x;\rY_Q90=vExtra1.y;\rZ_Q90=vExtra1.z;\rW_Q90=vExtra1.w;\rvec4 Linear_Q43;\rLinear_Q43.rgb=clamp(_Sky_Color_.rgb*_Sky_Color_.rgb,0.0,1.0);\rLinear_Q43.a=_Sky_Color_.a;\rvec4 Linear_Q44;\rLinear_Q44.rgb=clamp(_Horizon_Color_.rgb*_Horizon_Color_.rgb,0.0,1.0);\rLinear_Q44.a=_Horizon_Color_.a;\rvec4 Linear_Q45;\rLinear_Q45.rgb=clamp(_Ground_Color_.rgb*_Ground_Color_.rgb,0.0,1.0);\rLinear_Q45.a=_Ground_Color_.a;\rvec3 Left_Index_Q64;\rvec3 Right_Index_Q64;\rvec3 Left_Index_Middle_Q64;\rvec3 Right_Index_Middle_Q64;\rFinger_Positions_B64(_Left_Index_Pos_,_Right_Index_Pos_,_Left_Index_Middle_Pos_,_Right_Index_Middle_Pos_,Left_Index_Q64,Right_Index_Q64,Left_Index_Middle_Q64,Right_Index_Middle_Q64);\rvec4 Linear_Q46;\rLinear_Q46.rgb=clamp(_Albedo_.rgb*_Albedo_.rgb,0.0,1.0);\rLinear_Q46.a=_Albedo_.a;\rvec3 Normalized_Q107=normalize(vBinormal);\rvec3 Incident_Q70=normalize(vPosition-cameraPosition);\rvec3 New_Normal_Q79;\rBulge_B79(_Bulge_Enabled_,Normalized_Q38,Normalized_Q71,_Bulge_Height_,vColor,_Bulge_Radius_,vBinormal,New_Normal_Q79);\rfloat Result_Q77;\rSSS_B77(vBinormal,New_Normal_Q79,Incident_Q39,Result_Q77);\rvec4 Result_Q91;\rScale_Color_B91(Color_Q83,X_Q90,Result_Q91);\rfloat Transmit_Q122;\rfloat Reflect_Q122;\rFast_Fresnel_B122(_Front_Reflect_,_Edge_Reflect_,_Power_,New_Normal_Q79,Incident_Q39,Transmit_Q122,Reflect_Q122);\rfloat Product_Q125=Y_Q90*Y_Q90;\rvec3 NearP_Q65;\rvec3 NearQ_Q65;\rfloat Distance_Q65;\rMin_Segment_Distance_B65(Left_Index_Q64,Left_Index_Middle_Q64,vPosition,cameraPosition,NearP_Q65,NearQ_Q65,Distance_Q65);\rvec3 NearP_Q63;\rvec3 NearQ_Q63;\rfloat Distance_Q63;\rMin_Segment_Distance_B65(Right_Index_Q64,Right_Index_Middle_Q64,vPosition,cameraPosition,NearP_Q63,NearQ_Q63,Distance_Q63);\rvec3 Reflected_Q47=reflect(Incident_Q39,New_Normal_Q79);\rvec4 Product_Q103=Linear_Q46*vec4(1,1,1,1);\rvec4 Result_Q132;\rRim_Light_B132(Normalized_Q107,Normalized_Q38,Incident_Q70,_Rim_Intensity_,_Rim_Texture_,Result_Q132);\rfloat Dot_Q72=dot(Incident_Q70, Normalized_Q71);\rfloat MaxAB_Q123=max(Reflect_Q122,Product_Q125);\rfloat NotInShadow_Q67;\r#if OCCLUSION_ENABLED\nFingerOcclusion_B67(_Width_,Distance_Q65,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q65,_Clip_Fade_,NotInShadow_Q67);\r#else\nNotInShadow_Q67=1.0;\r#endif\nfloat NotInShadow_Q68;\r#if OCCLUSION_ENABLED\nFingerOcclusion_B68(_Width_,Distance_Q63,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q63,_Clip_Fade_,NotInShadow_Q68);\r#else\nNotInShadow_Q68=1.0;\r#endif\nvec4 Reflected_Color_Q51;\rvec4 Indirect_Diffuse_Q51;\r#if ENV_ENABLE\nMapped_Environment_B51(_Reflection_Map_,_Indirect_Environment_,Reflected_Q47,Reflected_Color_Q51,Indirect_Diffuse_Q51);\r#else\nReflected_Color_Q51=vec4(0,0,0,1);\rIndirect_Diffuse_Q51=vec4(0,0,0,1);\r#endif\nvec4 Reflected_Color_Q50;\rvec4 Indirect_Color_Q50;\r#if SKY_ENABLED\nSky_Environment_B50(New_Normal_Q79,Reflected_Q47,Linear_Q43,Linear_Q44,Linear_Q45,_Horizon_Power_,Reflected_Color_Q50,Indirect_Color_Q50);\r#else\nReflected_Color_Q50=vec4(0,0,0,1);\rIndirect_Color_Q50=vec4(0,0,0,1);\r#endif\nfloat Hue_Q75;\rfloat Saturation_Q75;\rfloat Value_Q75;\rfloat Alpha_Q75;\rvec3 HSV_Q75;\rTo_HSV_B75(Product_Q103,Hue_Q75,Saturation_Q75,Value_Q75,Alpha_Q75,HSV_Q75);\rfloat Hue_Q127;\rfloat Saturation_Q127;\rfloat Value_Q127;\rfloat Alpha_Q127;\rvec3 HSV_Q127;\rTo_HSV_B75(Result_Q132,Hue_Q127,Saturation_Q127,Value_Q127,Alpha_Q127,HSV_Q127);\rfloat Result_Q110;\rCode_B110(Dot_Q72,Result_Q110);\rfloat AbsA_Q76=abs(Result_Q110);\rfloat MinAB_Q58=min(NotInShadow_Q67,NotInShadow_Q68);\rvec4 Sum_Q48=Reflected_Color_Q51+Reflected_Color_Q50;\rvec4 Sum_Q49=Indirect_Diffuse_Q51+Indirect_Color_Q50;\rvec3 HSV_Out_Q126;\rVaryHSV_B108(HSV_Q127,_Rim_Hue_Shift_,_Rim_Saturation_Shift_,_Rim_Value_Shift_,HSV_Out_Q126);\rfloat Out_Q114;\rRemap_Range_B114(-1.0,1.0,0.0,1.0,Result_Q110,Out_Q114);\rfloat Product_Q106;\rProduct_Q106=AbsA_Q76*_Hue_Shift_;\rfloat X_Q128;\rfloat Y_Q128;\rfloat Z_Q128;\rTo_XYZ_B74(HSV_Out_Q126,X_Q128,Y_Q128,Z_Q128);\rvec2 Vec2_Q112=vec2(Out_Q114,0.5);\rvec3 HSV_Out_Q108;\rVaryHSV_B108(HSV_Q75,Product_Q106,_Saturation_Shift_,_Value_Shift_,HSV_Out_Q108);\rvec4 Color_Q129;\rFrom_HSV_B73(X_Q128,Y_Q128,Z_Q128,0.0,Color_Q129);\rvec4 Color_Q111;\r#if IRIDESCENCE_ENABLED\nColor_Q111=texture(_Iridescence_Texture_,Vec2_Q112);\r#else\nColor_Q111=vec4(0,0,0,0);\r#endif\nfloat X_Q74;\rfloat Y_Q74;\rfloat Z_Q74;\rTo_XYZ_B74(HSV_Out_Q108,X_Q74,Y_Q74,Z_Q74);\rvec4 Result_Q131=_Rim_Intensity_*Color_Q129;\rvec4 Result_Q113=_Iridescence_Intensity_*Color_Q111;\rvec4 Color_Q73;\rFrom_HSV_B73(X_Q74,Y_Q74,Z_Q74,0.0,Color_Q73);\rvec4 Result_Q84=Result_Q91+(1.0-Result_Q91.a)*Color_Q73;\rvec4 Result_Q121;\rFragment_Main_B121(_Sun_Intensity_,_Sun_Theta_,_Sun_Phi_,New_Normal_Q79,Result_Q84,MaxAB_Q123,_Shininess_,Incident_Q39,_Horizon_Color_,_Sky_Color_,_Ground_Color_,_Indirect_Diffuse_,_Specular_,_Horizon_Power_,_Reflection_,Sum_Q48,Sum_Q49,_Sharpness_,Result_Q77,_Subsurface_,vec4(0,0,0,0),Result_Q131,Result_Q113,Result_Q121);\rvec4 Result_Q59;\rScale_RGB_B59(Result_Q121,MinAB_Q58,Result_Q59);\rvec4 sRGB_Q42;\rFastLinearTosRGB_B42(Result_Q59,sRGB_Q42);\rvec4 Result_Q31=Blob_Color_Q30+(1.0-Blob_Color_Q30.a)*sRGB_Q42;\rvec4 Result_Q40=Result_Q31; Result_Q40.a=1.0;\rvec4 Out_Color=Result_Q40;\rfloat Clip_Threshold=0.001;\rbool To_sRGB=false;\rgl_FragColor=Out_Color;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const mrdlSliderBarPixelShader = { name, shader };\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"mrdlSliderBarVertexShader\";\nconst shader = `uniform mat4 world;\runiform mat4 viewProjection;\runiform vec3 cameraPosition;\rattribute vec3 position;\rattribute vec3 normal;\rattribute vec2 uv;\r#ifdef TANGENT\nattribute vec3 tangent;\r#else\nconst vec3 tangent=vec3(0.);\r#endif\nuniform float _Radius_;\runiform float _Bevel_Front_;\runiform float _Bevel_Front_Stretch_;\runiform float _Bevel_Back_;\runiform float _Bevel_Back_Stretch_;\runiform float _Radius_Top_Left_;\runiform float _Radius_Top_Right_;\runiform float _Radius_Bottom_Left_;\runiform float _Radius_Bottom_Right_;\runiform bool _Bulge_Enabled_;\runiform float _Bulge_Height_;\runiform float _Bulge_Radius_;\runiform float _Sun_Intensity_;\runiform float _Sun_Theta_;\runiform float _Sun_Phi_;\runiform float _Indirect_Diffuse_;\runiform vec4 _Albedo_;\runiform float _Specular_;\runiform float _Shininess_;\runiform float _Sharpness_;\runiform float _Subsurface_;\runiform vec4 _Left_Color_;\runiform vec4 _Right_Color_;\runiform float _Reflection_;\runiform float _Front_Reflect_;\runiform float _Edge_Reflect_;\runiform float _Power_;\runiform vec4 _Sky_Color_;\runiform vec4 _Horizon_Color_;\runiform vec4 _Ground_Color_;\runiform float _Horizon_Power_;\runiform sampler2D _Reflection_Map_;\runiform sampler2D _Indirect_Environment_;\runiform float _Width_;\runiform float _Fuzz_;\runiform float _Min_Fuzz_;\runiform float _Clip_Fade_;\runiform float _Hue_Shift_;\runiform float _Saturation_Shift_;\runiform float _Value_Shift_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform vec3 _Left_Index_Pos_;\runiform vec3 _Right_Index_Pos_;\runiform vec3 _Left_Index_Middle_Pos_;\runiform vec3 _Right_Index_Middle_Pos_;\runiform sampler2D _Decal_;\runiform vec2 _Decal_Scale_XY_;\runiform bool _Decal_Front_Only_;\runiform float _Rim_Intensity_;\runiform sampler2D _Rim_Texture_;\runiform float _Rim_Hue_Shift_;\runiform float _Rim_Saturation_Shift_;\runiform float _Rim_Value_Shift_;\runiform float _Iridescence_Intensity_;\runiform sampler2D _Iridescence_Texture_;\runiform bool Use_Global_Left_Index;\runiform bool Use_Global_Right_Index;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\runiform vec4 Global_Left_Thumb_Tip_Position;\runiform vec4 Global_Right_Thumb_Tip_Position;\runiform float Global_Left_Index_Tip_Proximity;\runiform float Global_Right_Index_Tip_Proximity;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\rvarying vec4 vExtra2;\rvarying vec4 vExtra3;\rvoid Object_To_World_Pos_B12(\rvec3 Pos_Object,\rout vec3 Pos_World)\r{\rPos_World=(world*vec4(Pos_Object,1.0)).xyz;\r}\rvoid Object_To_World_Normal_B32(\rvec3 Nrm_Object,\rout vec3 Nrm_World)\r{\rNrm_World=(vec4(Nrm_Object,0.0)).xyz;\r}\rvoid Blob_Vertex_B23(\rvec3 Position,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rvec3 Blob_Position,\rfloat Intensity,\rfloat Blob_Near_Size,\rfloat Blob_Far_Size,\rfloat Blob_Near_Distance,\rfloat Blob_Far_Distance,\rfloat Blob_Fade_Length,\rfloat Blob_Pulse,\rfloat Blob_Fade,\rout vec4 Blob_Info)\r{\rvec3 blob= (Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Blob_Position);\rvec3 delta=blob-Position;\rfloat dist=dot(Normal,delta);\rfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\rfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\rfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\rvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\rfloat Fade=fadeValue*Intensity*Blob_Fade;\rfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\rBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\r}\rvoid Blob_Vertex_B24(\rvec3 Position,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rvec3 Blob_Position,\rfloat Intensity,\rfloat Blob_Near_Size,\rfloat Blob_Far_Size,\rfloat Blob_Near_Distance,\rfloat Blob_Far_Distance,\rfloat Blob_Fade_Length,\rfloat Blob_Pulse,\rfloat Blob_Fade,\rout vec4 Blob_Info)\r{\rvec3 blob= (Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Blob_Position);\rvec3 delta=blob-Position;\rfloat dist=dot(Normal,delta);\rfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\rfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\rfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\rvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\rfloat Fade=fadeValue*Intensity*Blob_Fade;\rfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\rBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\r}\rvoid Move_Verts_B130(\rfloat Anisotropy,\rvec3 P,\rfloat Radius,\rfloat Bevel,\rvec3 Normal_Object,\rfloat ScaleZ,\rfloat Stretch,\rout vec3 New_P,\rout vec2 New_UV,\rout float Radial_Gradient,\rout vec3 Radial_Dir,\rout vec3 New_Normal)\r{\rvec2 UV=P.xy*2.0+0.5;\rvec2 center=clamp(UV,0.0,1.0);\rvec2 delta=UV-center;\rfloat deltad=(length(delta)*2.0);\rfloat f=(Bevel+(Radius-Bevel)*Stretch)/Radius;\rfloat innerd=clamp(deltad*2.0,0.0,1.0);\rfloat outerd=clamp(deltad*2.0-1.0,0.0,1.0);\rfloat bevelAngle=outerd*3.14159*0.5;\rfloat sinb=sin(bevelAngle);\rfloat cosb=cos(bevelAngle);\rfloat beveld=(1.0-f)*innerd+f*sinb;\rfloat br=outerd;\rvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\rfloat dir=P.z<0.0001 ? 1.0 : -1.0;\rNew_UV=center+r2*((0.5-center)+normalize(delta+vec2(0.0,0.000001))*beveld*0.5);\rNew_P=vec3(New_UV-0.5,P.z+dir*(1.0-cosb)*Bevel*ScaleZ);\rRadial_Gradient=clamp((deltad-0.5)*2.0,0.0,1.0);\rRadial_Dir=vec3(delta*r2,0.0);\rvec3 beveledNormal=cosb*Normal_Object+sinb*vec3(delta.x,delta.y,0.0);\rNew_Normal=Normal_Object.z==0.0 ? Normal_Object : beveledNormal;\r}\rvoid Object_To_World_Dir_B60(\rvec3 Dir_Object,\rout vec3 Normal_World,\rout vec3 Normal_World_N,\rout float Normal_Length)\r{\rNormal_World=(world*vec4(Dir_Object,0.0)).xyz;\rNormal_Length=length(Normal_World);\rNormal_World_N=Normal_World/Normal_Length;\r}\rvoid To_XYZ_B78(\rvec3 Vec3,\rout float X,\rout float Y,\rout float Z)\r{\rX=Vec3.x;\rY=Vec3.y;\rZ=Vec3.z;\r}\rvoid Conditional_Float_B93(\rbool Which,\rfloat If_True,\rfloat If_False,\rout float Result)\r{\rResult=Which ? If_True : If_False;\r}\rvoid Object_To_World_Dir_B28(\rvec3 Dir_Object,\rout vec3 Binormal_World,\rout vec3 Binormal_World_N,\rout float Binormal_Length)\r{\rBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\rBinormal_Length=length(Binormal_World);\rBinormal_World_N=Binormal_World/Binormal_Length;\r}\rvoid Pick_Radius_B69(\rfloat Radius,\rfloat Radius_Top_Left,\rfloat Radius_Top_Right,\rfloat Radius_Bottom_Left,\rfloat Radius_Bottom_Right,\rvec3 Position,\rout float Result)\r{\rbool whichY=Position.y>0.0;\rResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\rResult*=Radius;\r}\rvoid Conditional_Float_B36(\rbool Which,\rfloat If_True,\rfloat If_False,\rout float Result)\r{\rResult=Which ? If_True : If_False;\r}\rvoid Greater_Than_B37(\rfloat Left,\rfloat Right,\rout bool Not_Greater_Than,\rout bool Greater_Than)\r{\rGreater_Than=Left>Right;\rNot_Greater_Than=!Greater_Than;\r}\rvoid Remap_Range_B105(\rfloat In_Min,\rfloat In_Max,\rfloat Out_Min,\rfloat Out_Max,\rfloat In,\rout float Out)\r{\rOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\r}\rvoid main()\r{\rvec2 XY_Q85;\rXY_Q85=(uv-vec2(0.5,0.5))*_Decal_Scale_XY_+vec2(0.5,0.5);\rvec3 Tangent_World_Q27;\rvec3 Tangent_World_N_Q27;\rfloat Tangent_Length_Q27;\rTangent_World_Q27=(world*vec4(vec3(1,0,0),0.0)).xyz;\rTangent_Length_Q27=length(Tangent_World_Q27);\rTangent_World_N_Q27=Tangent_World_Q27/Tangent_Length_Q27;\rvec3 Normal_World_Q60;\rvec3 Normal_World_N_Q60;\rfloat Normal_Length_Q60;\rObject_To_World_Dir_B60(vec3(0,0,1),Normal_World_Q60,Normal_World_N_Q60,Normal_Length_Q60);\rfloat X_Q78;\rfloat Y_Q78;\rfloat Z_Q78;\rTo_XYZ_B78(position,X_Q78,Y_Q78,Z_Q78);\rvec3 Nrm_World_Q26;\rNrm_World_Q26=normalize((world*vec4(normal,0.0)).xyz);\rvec3 Binormal_World_Q28;\rvec3 Binormal_World_N_Q28;\rfloat Binormal_Length_Q28;\rObject_To_World_Dir_B28(vec3(0,1,0),Binormal_World_Q28,Binormal_World_N_Q28,Binormal_Length_Q28);\rfloat Anisotropy_Q29=Tangent_Length_Q27/Binormal_Length_Q28;\rfloat Result_Q69;\rPick_Radius_B69(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q69);\rfloat Anisotropy_Q53=Binormal_Length_Q28/Normal_Length_Q60;\rbool Not_Greater_Than_Q37;\rbool Greater_Than_Q37;\rGreater_Than_B37(Z_Q78,0.0,Not_Greater_Than_Q37,Greater_Than_Q37);\rvec4 Linear_Q101;\rLinear_Q101.rgb=clamp(_Left_Color_.rgb*_Left_Color_.rgb,0.0,1.0);\rLinear_Q101.a=_Left_Color_.a;\rvec4 Linear_Q102;\rLinear_Q102.rgb=clamp(_Right_Color_.rgb*_Right_Color_.rgb,0.0,1.0);\rLinear_Q102.a=_Right_Color_.a;\rvec3 Difference_Q61=vec3(0,0,0)-Normal_World_N_Q60;\rvec4 Out_Color_Q34=vec4(X_Q78,Y_Q78,Z_Q78,1);\rfloat Result_Q36;\rConditional_Float_B36(Greater_Than_Q37,_Bevel_Back_,_Bevel_Front_,Result_Q36);\rfloat Result_Q94;\rConditional_Float_B36(Greater_Than_Q37,_Bevel_Back_Stretch_,_Bevel_Front_Stretch_,Result_Q94);\rvec3 New_P_Q130;\rvec2 New_UV_Q130;\rfloat Radial_Gradient_Q130;\rvec3 Radial_Dir_Q130;\rvec3 New_Normal_Q130;\rMove_Verts_B130(Anisotropy_Q29,position,Result_Q69,Result_Q36,normal,Anisotropy_Q53,Result_Q94,New_P_Q130,New_UV_Q130,Radial_Gradient_Q130,Radial_Dir_Q130,New_Normal_Q130);\rfloat X_Q98;\rfloat Y_Q98;\rX_Q98=New_UV_Q130.x;\rY_Q98=New_UV_Q130.y;\rvec3 Pos_World_Q12;\rObject_To_World_Pos_B12(New_P_Q130,Pos_World_Q12);\rvec3 Nrm_World_Q32;\rObject_To_World_Normal_B32(New_Normal_Q130,Nrm_World_Q32);\rvec4 Blob_Info_Q23;\r#if BLOB_ENABLE\nBlob_Vertex_B23(Pos_World_Q12,Nrm_World_Q26,Tangent_World_N_Q27,Binormal_World_N_Q28,_Blob_Position_,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q23);\r#else\nBlob_Info_Q23=vec4(0,0,0,0);\r#endif\nvec4 Blob_Info_Q24;\r#if BLOB_ENABLE_2\nBlob_Vertex_B24(Pos_World_Q12,Nrm_World_Q26,Tangent_World_N_Q27,Binormal_World_N_Q28,_Blob_Position_2_,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q24);\r#else\nBlob_Info_Q24=vec4(0,0,0,0);\r#endif\nfloat Out_Q105;\rRemap_Range_B105(0.0,1.0,0.0,1.0,X_Q98,Out_Q105);\rfloat X_Q86;\rfloat Y_Q86;\rfloat Z_Q86;\rTo_XYZ_B78(Nrm_World_Q32,X_Q86,Y_Q86,Z_Q86);\rvec4 Color_At_T_Q97=mix(Linear_Q101,Linear_Q102,Out_Q105);\rfloat Minus_F_Q87=-Z_Q86;\rfloat R_Q99;\rfloat G_Q99;\rfloat B_Q99;\rfloat A_Q99;\rR_Q99=Color_At_T_Q97.r; G_Q99=Color_At_T_Q97.g; B_Q99=Color_At_T_Q97.b; A_Q99=Color_At_T_Q97.a;\rfloat ClampF_Q88=clamp(0.0,Minus_F_Q87,1.0);\rfloat Result_Q93;\rConditional_Float_B93(_Decal_Front_Only_,ClampF_Q88,1.0,Result_Q93);\rvec4 Vec4_Q89=vec4(Result_Q93,Radial_Gradient_Q130,G_Q99,B_Q99);\rvec3 Position=Pos_World_Q12;\rvec3 Normal=Nrm_World_Q32;\rvec2 UV=XY_Q85;\rvec3 Tangent=Tangent_World_N_Q27;\rvec3 Binormal=Difference_Q61;\rvec4 Color=Out_Color_Q34;\rvec4 Extra1=Vec4_Q89;\rvec4 Extra2=Blob_Info_Q23;\rvec4 Extra3=Blob_Info_Q24;\rgl_Position=viewProjection*vec4(Position,1);\rvPosition=Position;\rvNormal=Normal;\rvUV=UV;\rvTangent=Tangent;\rvBinormal=Binormal;\rvColor=Color;\rvExtra1=Extra1;\rvExtra2=Extra2;\rvExtra3=Extra3;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const mrdlSliderBarVertexShader = { name, shader };\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport { SerializationHelper, serialize } from \"core/Misc/decorators\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Vector2, Vector3, Vector4 } from \"core/Maths/math.vector\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { Color4 } from \"core/Maths/math.color\";\r\nimport { EffectFallbacks } from \"core/Materials/effectFallbacks\";\r\nimport { Constants } from \"core/Engines/constants\";\r\n\r\nimport \"./shaders/mrdlSliderBar.fragment\";\r\nimport \"./shaders/mrdlSliderBar.vertex\";\r\n\r\n/** @internal */\r\nclass MRDLSliderBarMaterialDefines extends MaterialDefines {\r\n    /*\r\n        \"SKY_ENABLED\", \"BLOB_ENABLE_2\", \"IRIDESCENCE_ENABLED\"\r\n    */\r\n    public SKY_ENABLED = true;\r\n    public BLOB_ENABLE_2 = true;\r\n    public IRIDESCENCE_ENABLED = true;\r\n\r\n    constructor() {\r\n        super();\r\n        this._needNormals = true;\r\n        this._needUVs = true;\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\n/**\r\n * Class used to render Slider Bar material with MRDL\r\n */\r\nexport class MRDLSliderBarMaterial extends PushMaterial {\r\n    /**\r\n     * URL pointing to the texture used to define the coloring for the Iridescent Map effect.\r\n     */\r\n    public static BLUE_GRADIENT_TEXTURE_URL = \"https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-blue-gradient.png\";\r\n    private _blueGradientTexture: Texture;\r\n    private _decalTexture: Texture;\r\n    private _reflectionMapTexture: Texture;\r\n    private _indirectEnvTexture: Texture;\r\n\r\n    /**\r\n     * Gets or sets the corner Radius on the slider bar.\r\n     */\r\n    @serialize()\r\n    public radius = 0.6;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Front on the slider bar.\r\n     */\r\n    @serialize()\r\n    public bevelFront = 0.6;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Front Stretch on the slider bar.\r\n     */\r\n    @serialize()\r\n    public bevelFrontStretch = 0.077;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Back on the slider bar.\r\n     */\r\n    @serialize()\r\n    public bevelBack = 0;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Back Stretch on the slider bar.\r\n     */\r\n    @serialize()\r\n    public bevelBackStretch = 0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusTopLeft = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusTopRight = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusBottomLeft = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusBottomRight = 1.0;\r\n\r\n    /**\r\n     * Gets or sets whether Bulge is enabled.\r\n     * Default is false.\r\n     */\r\n    @serialize()\r\n    public bulgeEnabled = false;\r\n\r\n    /**\r\n     * Gets or sets the Bulge Height.\r\n     */\r\n    @serialize()\r\n    public bulgeHeight = -0.323;\r\n\r\n    /**\r\n     * Gets or sets the Bulge Radius.\r\n     */\r\n    @serialize()\r\n    public bulgeRadius = 0.73;\r\n\r\n    /**\r\n     * Gets or sets the Sun Intensity.\r\n     */\r\n    @serialize()\r\n    public sunIntensity = 1.102;\r\n\r\n    /**\r\n     * Gets or sets the Sun Theta.\r\n     */\r\n    @serialize()\r\n    public sunTheta = 0.76;\r\n\r\n    /**\r\n     * Gets or sets the Sun Phi.\r\n     */\r\n    @serialize()\r\n    public sunPhi = 0.526;\r\n\r\n    /**\r\n     * Gets or sets the Indirect Diffuse.\r\n     */\r\n    @serialize()\r\n    public indirectDiffuse = 0.658;\r\n\r\n    /**\r\n     * Gets or sets the base albedo.\r\n     */\r\n    @serialize()\r\n    public albedo = new Color4(0.0117647, 0.505882, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the Specular value.\r\n     */\r\n    @serialize()\r\n    public specular = 0;\r\n\r\n    /**\r\n     * Gets or sets the Shininess value.\r\n     */\r\n    @serialize()\r\n    public shininess = 10;\r\n\r\n    /**\r\n     * Gets or sets the Sharpness value.\r\n     */\r\n    @serialize()\r\n    public sharpness = 0;\r\n\r\n    /**\r\n     * Gets or sets the Subsurface value.\r\n     */\r\n    @serialize()\r\n    public subsurface = 0;\r\n\r\n    /**\r\n     * Gets or sets the left gradient color.\r\n     */\r\n    @serialize()\r\n    public leftGradientColor = new Color4(0.0117647, 0.505882, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the right gradient color.\r\n     */\r\n    @serialize()\r\n    public rightGradientColor = new Color4(0.0117647, 0.505882, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the reflection value.\r\n     */\r\n    @serialize()\r\n    public reflection = 0.749;\r\n\r\n    /**\r\n     * Gets or sets the front reflect value.\r\n     */\r\n    @serialize()\r\n    public frontReflect = 0;\r\n\r\n    /**\r\n     * Gets or sets the edge reflect value.\r\n     */\r\n    @serialize()\r\n    public edgeReflect = 0.09;\r\n\r\n    /**\r\n     * Gets or sets the power value.\r\n     */\r\n    @serialize()\r\n    public power = 8.13;\r\n\r\n    /**\r\n     * Gets or sets the sky color.\r\n     */\r\n    @serialize()\r\n    public skyColor = new Color4(0.0117647, 0.964706, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the horizon color.\r\n     */\r\n    @serialize()\r\n    public horizonColor = new Color4(0.0117647, 0.333333, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the ground color.\r\n     */\r\n    @serialize()\r\n    public groundColor = new Color4(0, 0.254902, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the horizon power value.\r\n     */\r\n    @serialize()\r\n    public horizonPower = 1;\r\n\r\n    /**\r\n     * Gets or sets the finger occlusion width value.\r\n     */\r\n    @serialize()\r\n    public width = 0.02;\r\n\r\n    /**\r\n     * Gets or sets the finger occlusion fuzz value.\r\n     */\r\n    @serialize()\r\n    public fuzz = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the minimum finger occlusion fuzz value.\r\n     */\r\n    @serialize()\r\n    public minFuzz = 0.001;\r\n\r\n    /**\r\n     * Gets or sets the finger occlusion clip fade value.\r\n     */\r\n    @serialize()\r\n    public clipFade = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the hue shift value.\r\n     */\r\n    @serialize()\r\n    public hueShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the saturation shift value.\r\n     */\r\n    @serialize()\r\n    public saturationShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the value shift.\r\n     */\r\n    @serialize()\r\n    public valueShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the position of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobPosition = new Vector3(0, 0, 0.1);\r\n\r\n    /**\r\n     * Gets or sets the intensity of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobIntensity = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the near size of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobNearSize = 0.01;\r\n    /**\r\n     * Gets or sets the far size of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobFarSize = 0.03;\r\n\r\n    /**\r\n     * Gets or sets the distance considered \"near\" to the mesh, which controls the size of the hover glow effect (see blobNearSize).\r\n     */\r\n    @serialize()\r\n    public blobNearDistance = 0;\r\n\r\n    /**\r\n     * Gets or sets the distance considered \"far\" from the mesh, which controls the size of the hover glow effect (see blobFarSize).\r\n     */\r\n    @serialize()\r\n    public blobFarDistance = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the length of the hover glow effect fade.\r\n     */\r\n    @serialize()\r\n    public blobFadeLength = 0.576;\r\n\r\n    /**\r\n     * Gets or sets the progress of the hover glow effect selection animation corresponding to the left pointer (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public blobPulse = 0;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the hover glow effect corresponding to the left pointer (0.0 - 1.0). Default is 0.\r\n     */\r\n    @serialize()\r\n    public blobFade = 1;\r\n\r\n    /**\r\n     * Gets or sets the position of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobPosition2 = new Vector3(0.2, 0, 0.1);\r\n\r\n    /**\r\n     * Gets or sets the size of the hover glow effect when the right pointer is considered \"near\" to the mesh (see blobNearDistance).\r\n     */\r\n    @serialize()\r\n    public blobNearSize2 = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the progress of the hover glow effect selection animation corresponding to the right pointer (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public blobPulse2 = 0;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the hover glow effect corresponding to the right pointer (0.0 - 1.0). Default is 1.\r\n     */\r\n    @serialize()\r\n    public blobFade2 = 1;\r\n\r\n    /**\r\n     * Gets or sets the texture of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobTexture = new Texture(\"\", this.getScene());\r\n\r\n    /**\r\n     * Gets or sets the finger position for left index.\r\n     */\r\n    @serialize()\r\n    public leftIndexPosition = new Vector3(0, 0, 1);\r\n\r\n    /**\r\n     * Gets or sets the finger position for right index.\r\n     */\r\n    @serialize()\r\n    public rightIndexPosition = new Vector3(-1, -1, -1);\r\n\r\n    /**\r\n     * Gets or sets the finger position for left index middle position.\r\n     */\r\n    @serialize()\r\n    public leftIndexMiddlePosition = new Vector3(0, 0, 0);\r\n\r\n    /**\r\n     * Gets or sets the finger position for right index middle position.\r\n     */\r\n    @serialize()\r\n    public rightIndexMiddlePosition = new Vector3(0, 0, 0);\r\n\r\n    /**\r\n     * Gets or sets the Decal Scle for XY.\r\n     */\r\n    @serialize()\r\n    public decalScaleXY = new Vector2(1.5, 1.5);\r\n\r\n    /**\r\n     * Gets or sets decalFrontOnly\r\n     * Default is true\r\n     */\r\n    @serialize()\r\n    public decalFrontOnly = true;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light intensity.\r\n     */\r\n    @serialize()\r\n    public rimIntensity = 0.287;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light hue shift value.\r\n     */\r\n    @serialize()\r\n    public rimHueShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light saturation shift value.\r\n     */\r\n    @serialize()\r\n    public rimSaturationShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light value shift.\r\n     */\r\n    @serialize()\r\n    public rimValueShift = -1;\r\n\r\n    /**\r\n     * Gets or sets the intensity of the iridescence effect.\r\n     */\r\n    @serialize()\r\n    public iridescenceIntensity = 0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public useGlobalLeftIndex = 1.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public useGlobalRightIndex = 1.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftIndexTipProximity = 0.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalRightIndexTipProximity = 0.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftIndexTipPosition = new Vector4(0.5, 0.0, -0.55, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globaRightIndexTipPosition = new Vector4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftThumbTipPosition = new Vector4(0.5, 0.0, -0.55, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalRightThumbTipPosition = new Vector4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftIndexMiddlePosition = new Vector4(0.5, 0.0, -0.55, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalRightIndexMiddlePosition = new Vector4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    constructor(name: string, scene?: Scene) {\r\n        super(name, scene);\r\n        this.alphaMode = Constants.ALPHA_DISABLE;\r\n        this.backFaceCulling = false;\r\n        this._blueGradientTexture = new Texture(MRDLSliderBarMaterial.BLUE_GRADIENT_TEXTURE_URL, this.getScene(), true, false, Texture.NEAREST_SAMPLINGMODE);\r\n        this._decalTexture = new Texture(\"\", this.getScene());\r\n        this._reflectionMapTexture = new Texture(\"\", this.getScene());\r\n        this._indirectEnvTexture = new Texture(\"\", this.getScene());\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    // Methods\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new MRDLSliderBarMaterialDefines();\r\n        }\r\n\r\n        const defines = <MRDLSliderBarMaterialDefines>subMesh.materialDefines;\r\n        const scene = this.getScene();\r\n\r\n        if (this._isReadyForSubMesh(subMesh)) {\r\n            return true;\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n\r\n        // Attribs\r\n        MaterialHelper.PrepareDefinesForAttributes(mesh, defines, false, false);\r\n\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n\r\n            scene.resetCachedMaterial();\r\n\r\n            // Fallbacks\r\n            const fallbacks = new EffectFallbacks();\r\n            if (defines.FOG) {\r\n                fallbacks.addFallback(1, \"FOG\");\r\n            }\r\n\r\n            MaterialHelper.HandleFallbacksForShadows(defines, fallbacks);\r\n\r\n            defines.IMAGEPROCESSINGPOSTPROCESS = scene.imageProcessingConfiguration.applyByPostProcess;\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n\r\n            if (defines.NORMAL) {\r\n                attribs.push(VertexBuffer.NormalKind);\r\n            }\r\n\r\n            if (defines.UV1) {\r\n                attribs.push(VertexBuffer.UVKind);\r\n            }\r\n\r\n            if (defines.UV2) {\r\n                attribs.push(VertexBuffer.UV2Kind);\r\n            }\r\n\r\n            if (defines.VERTEXCOLOR) {\r\n                attribs.push(VertexBuffer.ColorKind);\r\n            }\r\n\r\n            if (defines.TANGENT) {\r\n                attribs.push(VertexBuffer.TangentKind);\r\n            }\r\n\r\n            MaterialHelper.PrepareAttributesForInstances(attribs, defines);\r\n\r\n            // Legacy browser patch\r\n            const shaderName = \"mrdlSliderBar\";\r\n            const join = defines.toString();\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"viewProjection\",\r\n                \"cameraPosition\",\r\n                \"_Radius_\",\r\n                \"_Bevel_Front_\",\r\n                \"_Bevel_Front_Stretch_\",\r\n                \"_Bevel_Back_\",\r\n                \"_Bevel_Back_Stretch_\",\r\n                \"_Radius_Top_Left_\",\r\n                \"_Radius_Top_Right_\",\r\n                \"_Radius_Bottom_Left_\",\r\n                \"_Radius_Bottom_Right_\",\r\n                \"_Bulge_Enabled_\",\r\n                \"_Bulge_Height_\",\r\n                \"_Bulge_Radius_\",\r\n                \"_Sun_Intensity_\",\r\n                \"_Sun_Theta_\",\r\n                \"_Sun_Phi_\",\r\n                \"_Indirect_Diffuse_\",\r\n                \"_Albedo_\",\r\n                \"_Specular_\",\r\n                \"_Shininess_\",\r\n                \"_Sharpness_\",\r\n                \"_Subsurface_\",\r\n                \"_Left_Color_\",\r\n                \"_Right_Color_\",\r\n                \"_Reflection_\",\r\n                \"_Front_Reflect_\",\r\n                \"_Edge_Reflect_\",\r\n                \"_Power_\",\r\n                \"_Sky_Color_\",\r\n                \"_Horizon_Color_\",\r\n                \"_Ground_Color_\",\r\n                \"_Horizon_Power_\",\r\n                \"_Reflection_Map_\",\r\n                \"_Indirect_Environment_\",\r\n                \"_Width_\",\r\n                \"_Fuzz_\",\r\n                \"_Min_Fuzz_\",\r\n                \"_Clip_Fade_\",\r\n                \"_Hue_Shift_\",\r\n                \"_Saturation_Shift_\",\r\n                \"_Value_Shift_\",\r\n                \"_Blob_Position_\",\r\n                \"_Blob_Intensity_\",\r\n                \"_Blob_Near_Size_\",\r\n                \"_Blob_Far_Size_\",\r\n                \"_Blob_Near_Distance_\",\r\n                \"_Blob_Far_Distance_\",\r\n                \"_Blob_Fade_Length_\",\r\n                \"_Blob_Pulse_\",\r\n                \"_Blob_Fade_\",\r\n                \"_Blob_Texture_\",\r\n                \"_Blob_Position_2_\",\r\n                \"_Blob_Near_Size_2_\",\r\n                \"_Blob_Pulse_2_\",\r\n                \"_Blob_Fade_2_\",\r\n                \"_Left_Index_Pos_\",\r\n                \"_Right_Index_Pos_\",\r\n                \"_Left_Index_Middle_Pos_\",\r\n                \"_Right_Index_Middle_Pos_\",\r\n                \"_Decal_\",\r\n                \"_Decal_Scale_XY_\",\r\n                \"_Decal_Front_Only_\",\r\n                \"_Rim_Intensity_\",\r\n                \"_Rim_Texture_\",\r\n                \"_Rim_Hue_Shift_\",\r\n                \"_Rim_Saturation_Shift_\",\r\n                \"_Rim_Value_Shift_\",\r\n                \"_Iridescence_Intensity_\",\r\n                \"_Iridescence_Texture_\",\r\n                \"Use_Global_Left_Index\",\r\n                \"Use_Global_Right_Index\",\r\n                \"Global_Left_Index_Tip_Position\",\r\n                \"Global_Right_Index_Tip_Position\",\r\n                \"Global_Left_Thumb_Tip_Position\",\r\n                \"Global_Right_Thumb_Tip_Position\",\r\n                \"Global_Left_Index_Middle_Position;\",\r\n                \"Global_Right_Index_Middle_Position\",\r\n                \"Global_Left_Index_Tip_Proximity\",\r\n                \"Global_Right_Index_Tip_Proximity\",\r\n            ];\r\n            const samplers: string[] = [\"_Rim_Texture_\", \"_Iridescence_Texture_\"];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: fallbacks,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines,\r\n                this._materialContext\r\n            );\r\n        }\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const defines = <MRDLSliderBarMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", this.getScene().getTransformMatrix());\r\n        this._activeEffect.setVector3(\"cameraPosition\", this.getScene().activeCamera!.position);\r\n\r\n        // \"Round Rect\"\r\n        this._activeEffect.setFloat(\"_Radius_\", this.radius);\r\n        this._activeEffect.setFloat(\"_Bevel_Front_\", this.bevelFront);\r\n        this._activeEffect.setFloat(\"_Bevel_Front_Stretch_\", this.bevelFrontStretch);\r\n        this._activeEffect.setFloat(\"_Bevel_Back_\", this.bevelBack);\r\n        this._activeEffect.setFloat(\"_Bevel_Back_Stretch_\", this.bevelBackStretch);\r\n\r\n        // \"Radii Multipliers\"\r\n        this._activeEffect.setFloat(\"_Radius_Top_Left_\", this.radiusTopLeft);\r\n        this._activeEffect.setFloat(\"_Radius_Top_Right_\", this.radiusTopRight);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Left_\", this.radiusBottomLeft);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Right_\", this.radiusBottomRight);\r\n\r\n        // \"Bulge\"\r\n        this._activeEffect.setFloat(\"_Bulge_Enabled_\", this.bulgeEnabled ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Bulge_Height_\", this.bulgeHeight);\r\n        this._activeEffect.setFloat(\"_Bulge_Radius_\", this.bulgeRadius);\r\n\r\n        // \"Sun\"\r\n        this._activeEffect.setFloat(\"_Sun_Intensity_\", this.sunIntensity);\r\n        this._activeEffect.setFloat(\"_Sun_Theta_\", this.sunTheta);\r\n        this._activeEffect.setFloat(\"_Sun_Phi_\", this.sunPhi);\r\n        this._activeEffect.setFloat(\"_Indirect_Diffuse_\", this.indirectDiffuse);\r\n\r\n        // \"Diffuse And Specular\"\r\n        this._activeEffect.setDirectColor4(\"_Albedo_\", this.albedo);\r\n        this._activeEffect.setFloat(\"_Specular_\", this.specular);\r\n        this._activeEffect.setFloat(\"_Shininess_\", this.shininess);\r\n        this._activeEffect.setFloat(\"_Sharpness_\", this.sharpness);\r\n        this._activeEffect.setFloat(\"_Subsurface_\", this.subsurface);\r\n\r\n        // \"Gradient\"\r\n        this._activeEffect.setDirectColor4(\"_Left_Color_\", this.leftGradientColor);\r\n        this._activeEffect.setDirectColor4(\"_Right_Color_\", this.rightGradientColor);\r\n\r\n        // \"Reflection\"\r\n        this._activeEffect.setFloat(\"_Reflection_\", this.reflection);\r\n        this._activeEffect.setFloat(\"_Front_Reflect_\", this.frontReflect);\r\n        this._activeEffect.setFloat(\"_Edge_Reflect_\", this.edgeReflect);\r\n        this._activeEffect.setFloat(\"_Power_\", this.power);\r\n\r\n        // \"Sky Environment\"\r\n        //define SKY_ENABLED true;\r\n        this._activeEffect.setDirectColor4(\"_Sky_Color_\", this.skyColor);\r\n        this._activeEffect.setDirectColor4(\"_Horizon_Color_\", this.horizonColor);\r\n        this._activeEffect.setDirectColor4(\"_Ground_Color_\", this.groundColor);\r\n        this._activeEffect.setFloat(\"_Horizon_Power_\", this.horizonPower);\r\n\r\n        // \"Mapped Environment\"\r\n        //define ENV_ENABLE false;\r\n        this._activeEffect.setTexture(\"_Reflection_Map_\", this._reflectionMapTexture);\r\n        this._activeEffect.setTexture(\"_Indirect_Environment_\", this._indirectEnvTexture);\r\n\r\n        // \"FingerOcclusion\"\r\n        //define OCCLUSION_ENABLED false;\r\n        this._activeEffect.setFloat(\"_Width_\", this.width);\r\n        this._activeEffect.setFloat(\"_Fuzz_\", this.fuzz);\r\n        this._activeEffect.setFloat(\"_Min_Fuzz_\", this.minFuzz);\r\n        this._activeEffect.setFloat(\"_Clip_Fade_\", this.clipFade);\r\n\r\n        // \"View Based Color Shift\"\r\n        this._activeEffect.setFloat(\"_Hue_Shift_\", this.hueShift);\r\n        this._activeEffect.setFloat(\"_Saturation_Shift_\", this.saturationShift);\r\n        this._activeEffect.setFloat(\"_Value_Shift_\", this.valueShift);\r\n\r\n        // \"Blob\"\r\n        //define BLOB_ENABLE false;\r\n        this._activeEffect.setVector3(\"_Blob_Position_\", this.blobPosition);\r\n        this._activeEffect.setFloat(\"_Blob_Intensity_\", this.blobIntensity);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_\", this.blobNearSize);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Size_\", this.blobFarSize);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Distance_\", this.blobNearDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Distance_\", this.blobFarDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_Length_\", this.blobFadeLength);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_\", this.blobPulse);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_\", this.blobFade);\r\n\r\n        // \"Blob Texture\"\r\n        this._activeEffect.setTexture(\"_Blob_Texture_\", this.blobTexture);\r\n\r\n        // \"Blob 2\"\r\n        //define BLOB_ENABLE_2 true;\r\n        this._activeEffect.setVector3(\"_Blob_Position_2_\", this.blobPosition2);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_2_\", this.blobNearSize2);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_2_\", this.blobPulse2);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_2_\", this.blobFade2);\r\n\r\n        // \"Finger Positions\"\r\n        this._activeEffect.setVector3(\"_Left_Index_Pos_\", this.leftIndexPosition);\r\n        this._activeEffect.setVector3(\"_Right_Index_Pos_\", this.rightIndexPosition);\r\n        this._activeEffect.setVector3(\"_Left_Index_Middle_Pos_\", this.leftIndexMiddlePosition);\r\n        this._activeEffect.setVector3(\"_Right_Index_Middle_Pos_\", this.rightIndexMiddlePosition);\r\n\r\n        // \"Decal Texture\"\r\n        //define DECAL_ENABLE false;\r\n        this._activeEffect.setTexture(\"_Decal_\", this._decalTexture);\r\n        this._activeEffect.setVector2(\"_Decal_Scale_XY_\", this.decalScaleXY);\r\n        this._activeEffect.setFloat(\"_Decal_Front_Only_\", this.decalFrontOnly ? 1.0 : 0.0);\r\n\r\n        // \"Rim Light\"\r\n        this._activeEffect.setFloat(\"_Rim_Intensity_\", this.rimIntensity);\r\n        this._activeEffect.setTexture(\"_Rim_Texture_\", this._blueGradientTexture);\r\n        this._activeEffect.setFloat(\"_Rim_Hue_Shift_\", this.rimHueShift);\r\n        this._activeEffect.setFloat(\"_Rim_Saturation_Shift_\", this.rimSaturationShift);\r\n        this._activeEffect.setFloat(\"_Rim_Value_Shift_\", this.rimValueShift);\r\n\r\n        // \"Iridescence\"\r\n        //define IRIDESCENCE_ENABLED true;\r\n        this._activeEffect.setFloat(\"_Iridescence_Intensity_\", this.iridescenceIntensity);\r\n        this._activeEffect.setTexture(\"_Iridescence_Texture_\", this._blueGradientTexture);\r\n\r\n        // Global inputs\r\n        this._activeEffect.setFloat(\"Use_Global_Left_Index\", this.useGlobalLeftIndex);\r\n        this._activeEffect.setFloat(\"Use_Global_Right_Index\", this.useGlobalRightIndex);\r\n\r\n        this._activeEffect.setVector4(\"Global_Left_Index_Tip_Position\", this.globalLeftIndexTipPosition);\r\n        this._activeEffect.setVector4(\"Global_Right_Index_Tip_Position\", this.globaRightIndexTipPosition);\r\n\r\n        this._activeEffect.setVector4(\"Global_Left_Thumb_Tip_Position\", this.globalLeftThumbTipPosition);\r\n        this._activeEffect.setVector4(\"Global_Right_Thumb_Tip_Position\", this.globalRightThumbTipPosition);\r\n\r\n        this._activeEffect.setVector4(\"Global_Left_Index_Middle_Position\", this.globalLeftIndexMiddlePosition);\r\n        this._activeEffect.setVector4(\"Global_Right_Index_Middle_Position\", this.globalRightIndexMiddlePosition);\r\n\r\n        this._activeEffect.setFloat(\"Global_Left_Index_Tip_Proximity\", this.globalLeftIndexTipProximity);\r\n        this._activeEffect.setFloat(\"Global_Right_Index_Tip_Proximity\", this.globalRightIndexTipProximity);\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    /**\r\n     * Get the list of animatables in the material.\r\n     * @returns the list of animatables object used in the material\r\n     */\r\n    public getAnimatables(): IAnimatable[] {\r\n        return [];\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n        this._reflectionMapTexture.dispose();\r\n        this._indirectEnvTexture.dispose();\r\n        this._blueGradientTexture.dispose();\r\n        this._decalTexture.dispose();\r\n    }\r\n\r\n    public clone(name: string): MRDLSliderBarMaterial {\r\n        return SerializationHelper.Clone(() => new MRDLSliderBarMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.customType = \"BABYLON.MRDLSliderBarMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"MRDLSliderBarMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): MRDLSliderBarMaterial {\r\n        return SerializationHelper.Parse(() => new MRDLSliderBarMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.MRDLSliderBarMaterial\", MRDLSliderBarMaterial);\r\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"mrdlSliderThumbPixelShader\";\nconst shader = `uniform vec3 cameraPosition;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\rvarying vec4 vExtra2;\rvarying vec4 vExtra3;\runiform float _Radius_;\runiform float _Bevel_Front_;\runiform float _Bevel_Front_Stretch_;\runiform float _Bevel_Back_;\runiform float _Bevel_Back_Stretch_;\runiform float _Radius_Top_Left_;\runiform float _Radius_Top_Right_;\runiform float _Radius_Bottom_Left_;\runiform float _Radius_Bottom_Right_;\runiform bool _Bulge_Enabled_;\runiform float _Bulge_Height_;\runiform float _Bulge_Radius_;\runiform float _Sun_Intensity_;\runiform float _Sun_Theta_;\runiform float _Sun_Phi_;\runiform float _Indirect_Diffuse_;\runiform vec4 _Albedo_;\runiform float _Specular_;\runiform float _Shininess_;\runiform float _Sharpness_;\runiform float _Subsurface_;\runiform vec4 _Left_Color_;\runiform vec4 _Right_Color_;\runiform float _Reflection_;\runiform float _Front_Reflect_;\runiform float _Edge_Reflect_;\runiform float _Power_;\runiform vec4 _Sky_Color_;\runiform vec4 _Horizon_Color_;\runiform vec4 _Ground_Color_;\runiform float _Horizon_Power_;\runiform sampler2D _Reflection_Map_;\runiform sampler2D _Indirect_Environment_;\runiform float _Width_;\runiform float _Fuzz_;\runiform float _Min_Fuzz_;\runiform float _Clip_Fade_;\runiform float _Hue_Shift_;\runiform float _Saturation_Shift_;\runiform float _Value_Shift_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform vec3 _Left_Index_Pos_;\runiform vec3 _Right_Index_Pos_;\runiform vec3 _Left_Index_Middle_Pos_;\runiform vec3 _Right_Index_Middle_Pos_;\runiform sampler2D _Decal_;\runiform vec2 _Decal_Scale_XY_;\runiform bool _Decal_Front_Only_;\runiform float _Rim_Intensity_;\runiform sampler2D _Rim_Texture_;\runiform float _Rim_Hue_Shift_;\runiform float _Rim_Saturation_Shift_;\runiform float _Rim_Value_Shift_;\runiform float _Iridescence_Intensity_;\runiform sampler2D _Iridescence_Texture_;\runiform bool Use_Global_Left_Index;\runiform bool Use_Global_Right_Index;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\runiform vec4 Global_Left_Thumb_Tip_Position;\runiform vec4 Global_Right_Thumb_Tip_Position;\runiform vec4 Global_Left_Index_Middle_Position;\runiform vec4 Global_Right_Index_Middle_Position;\runiform float Global_Left_Index_Tip_Proximity;\runiform float Global_Right_Index_Tip_Proximity;\rvoid Blob_Fragment_B180(\rsampler2D Blob_Texture,\rvec4 Blob_Info1,\rvec4 Blob_Info2,\rout vec4 Blob_Color)\r{\rfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\rfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\rvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\rBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\r}\rvoid FastLinearTosRGB_B192(\rvec4 Linear,\rout vec4 sRGB)\r{\rsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\rsRGB.a=Linear.a;\r}\rvoid Scale_RGB_B209(\rvec4 Color,\rfloat Scalar,\rout vec4 Result)\r{\rResult=vec4(Scalar,Scalar,Scalar,1)*Color;\r}\rvoid Fragment_Main_B271(\rfloat Sun_Intensity,\rfloat Sun_Theta,\rfloat Sun_Phi,\rvec3 Normal,\rvec4 Albedo,\rfloat Fresnel_Reflect,\rfloat Shininess,\rvec3 Incident,\rvec4 Horizon_Color,\rvec4 Sky_Color,\rvec4 Ground_Color,\rfloat Indirect_Diffuse,\rfloat Specular,\rfloat Horizon_Power,\rfloat Reflection,\rvec4 Reflection_Sample,\rvec4 Indirect_Sample,\rfloat Sharpness,\rfloat SSS,\rfloat Subsurface,\rvec4 Translucence,\rvec4 Rim_Light,\rvec4 Iridescence,\rout vec4 Result)\r{\rfloat theta=Sun_Theta*2.0*3.14159;\rfloat phi=Sun_Phi*3.14159;\rvec3 lightDir= vec3(cos(phi)*cos(theta),sin(phi),cos(phi)*sin(theta));\rfloat NdotL=max(dot(lightDir,Normal),0.0);\rvec3 R=reflect(Incident,Normal);\rfloat RdotL=max(0.0,dot(R,lightDir));\rfloat specular=pow(RdotL,Shininess);\rspecular=mix(specular,smoothstep(0.495*Sharpness,1.0-0.495*Sharpness,specular),Sharpness);\rvec4 gi=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\rResult=((Sun_Intensity*NdotL+Indirect_Sample*Indirect_Diffuse+Translucence)*(1.0+SSS*Subsurface))*Albedo*(1.0-Fresnel_Reflect)+(Sun_Intensity*specular*Specular+Fresnel_Reflect*Reflection*Reflection_Sample)+Fresnel_Reflect*Rim_Light+Iridescence;\r}\rvoid Bulge_B229(\rbool Enabled,\rvec3 Normal,\rvec3 Tangent,\rfloat Bulge_Height,\rvec4 UV,\rfloat Bulge_Radius,\rvec3 ButtonN,\rout vec3 New_Normal)\r{\rvec2 xy=clamp(UV.xy*2.0,vec2(-1,-1),vec2(1,1));\rvec3 B=(cross(Normal,Tangent));\rfloat k=-clamp(1.0-length(xy)/Bulge_Radius,0.0,1.0)*Bulge_Height;\rk=sin(k*3.14159*0.5);\rk*=smoothstep(0.9998,0.9999,abs(dot(ButtonN,Normal)));\rNew_Normal=Normal*sqrt(1.0-k*k)+(xy.x*Tangent+xy.y*B)*k;\rNew_Normal=Enabled ? New_Normal : Normal;\r}\rvoid SSS_B227(\rvec3 ButtonN,\rvec3 Normal,\rvec3 Incident,\rout float Result)\r{\rfloat NdotI=abs(dot(Normal,Incident));\rfloat BdotI=abs(dot(ButtonN,Incident));\rResult=(abs(NdotI-BdotI)); \r}\rvoid FingerOcclusion_B217(\rfloat Width,\rfloat DistToCenter,\rfloat Fuzz,\rfloat Min_Fuzz,\rvec3 Position,\rvec3 Forward,\rvec3 Nearest,\rfloat Fade_Out,\rout float NotInShadow)\r{\rfloat d=dot((Nearest-Position),Forward);\rfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\rNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\r}\rvoid FingerOcclusion_B218(\rfloat Width,\rfloat DistToCenter,\rfloat Fuzz,\rfloat Min_Fuzz,\rvec3 Position,\rvec3 Forward,\rvec3 Nearest,\rfloat Fade_Out,\rout float NotInShadow)\r{\rfloat d=dot((Nearest-Position),Forward);\rfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\rNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\r}\rvoid Scale_Color_B241(\rvec4 Color,\rfloat Scalar,\rout vec4 Result)\r{\rResult=Scalar*Color;\r}\rvoid From_HSV_B223(\rfloat Hue,\rfloat Saturation,\rfloat Value,\rfloat Alpha,\rout vec4 Color)\r{\rvec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);\rvec3 p=abs(fract(vec3(Hue,Hue,Hue)+K.xyz)*6.0-K.www);\rColor.rgb=Value*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),Saturation);\rColor.a=Alpha;\r}\rvoid Fast_Fresnel_B272(\rfloat Front_Reflect,\rfloat Edge_Reflect,\rfloat Power,\rvec3 Normal,\rvec3 Incident,\rout float Transmit,\rout float Reflect)\r{\rfloat d=max(-dot(Incident,Normal),0.0);\rReflect=Front_Reflect+(Edge_Reflect-Front_Reflect)*pow(1.0-d,Power);\rTransmit=1.0-Reflect;\r}\rvoid Mapped_Environment_B201(\rsampler2D Reflected_Environment,\rsampler2D Indirect_Environment,\rvec3 Dir,\rout vec4 Reflected_Color,\rout vec4 Indirect_Diffuse)\r{\rReflected_Color=texture(Reflected_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\rIndirect_Diffuse=texture(Indirect_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\r}\rvec4 SampleEnv_Bid200(vec3 D,vec4 S,vec4 H,vec4 G,float exponent)\r{\rfloat k=pow(abs(D.y),exponent);\rvec4 C;\rif (D.y>0.0) {\rC=mix(H,S,k);\r} else {\rC=mix(H,G,k); \r}\rreturn C;\r}\rvoid Sky_Environment_B200(\rvec3 Normal,\rvec3 Reflected,\rvec4 Sky_Color,\rvec4 Horizon_Color,\rvec4 Ground_Color,\rfloat Horizon_Power,\rout vec4 Reflected_Color,\rout vec4 Indirect_Color)\r{\rReflected_Color=SampleEnv_Bid200(Reflected,Sky_Color,Horizon_Color,Ground_Color,Horizon_Power);\rIndirect_Color=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\r}\rvoid Min_Segment_Distance_B215(\rvec3 P0,\rvec3 P1,\rvec3 Q0,\rvec3 Q1,\rout vec3 NearP,\rout vec3 NearQ,\rout float Distance)\r{\rvec3 u=P1-P0;\rvec3 v=Q1-Q0;\rvec3 w=P0-Q0;\rfloat a=dot(u,u);\rfloat b=dot(u,v);\rfloat c=dot(v,v);\rfloat d=dot(u,w);\rfloat e=dot(v,w);\rfloat D=a*c-b*b;\rfloat sD=D;\rfloat tD=D;\rfloat sc,sN,tc,tN;\rif (D<0.00001) {\rsN=0.0;\rsD=1.0;\rtN=e;\rtD=c;\r} else {\rsN=(b*e-c*d);\rtN=(a*e-b*d);\rif (sN<0.0) {\rsN=0.0;\rtN=e;\rtD=c;\r} else if (sN>sD) {\rsN=sD;\rtN=e+b;\rtD=c;\r}\r}\rif (tN<0.0) {\rtN=0.0;\rif (-d<0.0) {\rsN=0.0;\r} else if (-d>a) {\rsN=sD;\r} else {\rsN=-d;\rsD=a;\r}\r} else if (tN>tD) {\rtN=tD;\rif ((-d+b)<0.0) {\rsN=0.0;\r} else if ((-d+b)>a) {\rsN=sD;\r} else {\rsN=(-d+b);\rsD=a;\r}\r}\rsc=abs(sN)<0.000001 ? 0.0 : sN/sD;\rtc=abs(tN)<0.000001 ? 0.0 : tN/tD;\rNearP=P0+sc*u;\rNearQ=Q0+tc*v;\rDistance=distance(NearP,NearQ);\r}\rvoid To_XYZ_B224(\rvec3 Vec3,\rout float X,\rout float Y,\rout float Z)\r{\rX=Vec3.x;\rY=Vec3.y;\rZ=Vec3.z;\r}\rvoid Finger_Positions_B214(\rvec3 Left_Index_Pos,\rvec3 Right_Index_Pos,\rvec3 Left_Index_Middle_Pos,\rvec3 Right_Index_Middle_Pos,\rout vec3 Left_Index,\rout vec3 Right_Index,\rout vec3 Left_Index_Middle,\rout vec3 Right_Index_Middle)\r{\rLeft_Index= (Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Left_Index_Pos);\rRight_Index= (Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Right_Index_Pos);\rLeft_Index_Middle= (Use_Global_Left_Index ? Global_Left_Index_Middle_Position.xyz : Left_Index_Middle_Pos);\rRight_Index_Middle= (Use_Global_Right_Index ? Global_Right_Index_Middle_Position.xyz : Right_Index_Middle_Pos);\r}\rvoid VaryHSV_B258(\rvec3 HSV_In,\rfloat Hue_Shift,\rfloat Saturation_Shift,\rfloat Value_Shift,\rout vec3 HSV_Out)\r{\rHSV_Out=vec3(fract(HSV_In.x+Hue_Shift),clamp(HSV_In.y+Saturation_Shift,0.0,1.0),clamp(HSV_In.z+Value_Shift,0.0,1.0));\r}\rvoid Remap_Range_B264(\rfloat In_Min,\rfloat In_Max,\rfloat Out_Min,\rfloat Out_Max,\rfloat In,\rout float Out)\r{\rOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\r}\rvoid To_HSV_B225(\rvec4 Color,\rout float Hue,\rout float Saturation,\rout float Value,\rout float Alpha,\rout vec3 HSV)\r{\rvec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);\rvec4 p=Color.g<Color.b ? vec4(Color.bg,K.wz) : vec4(Color.gb,K.xy);\rvec4 q=Color.r<p.x ? vec4(p.xyw,Color.r) : vec4(Color.r,p.yzx);\rfloat d=q.x-min(q.w,q.y);\rfloat e=1.0e-10;\rHue=abs(q.z+(q.w-q.y)/(6.0*d+e));\rSaturation=d/(q.x+e);\rValue=q.x;\rAlpha=Color.a;\rHSV=vec3(Hue,Saturation,Value);\r}\rvoid Code_B260(\rfloat X,\rout float Result)\r{\rResult=(acos(X)/3.14159-0.5)*2.0;\r}\rvoid Rim_Light_B282(\rvec3 Front,\rvec3 Normal,\rvec3 Incident,\rfloat Rim_Intensity,\rsampler2D Texture,\rout vec4 Result)\r{\rvec3 R=reflect(Incident,Normal);\rfloat RdotF=dot(R,Front);\rfloat RdotL=sqrt(1.0-RdotF*RdotF);\rvec2 UV=vec2(R.y*0.5+0.5,0.5);\rvec4 Color=texture(Texture,UV);\rResult=Color;\r}\rvoid main()\r{\rvec4 Blob_Color_Q180;\r#if BLOB_ENABLE\nBlob_Fragment_B180(_Blob_Texture_,vExtra2,vExtra3,Blob_Color_Q180);\r#else\nBlob_Color_Q180=vec4(0,0,0,0);\r#endif\nvec3 Incident_Q189=normalize(vPosition-cameraPosition);\rvec3 Normalized_Q188=normalize(vNormal);\rvec3 Normalized_Q221=normalize(vTangent);\rvec4 Color_Q233;\r#if DECAL_ENABLE\nColor_Q233=texture(_Decal_,vUV);\r#else\nColor_Q233=vec4(0,0,0,0);\r#endif\nfloat X_Q240;\rfloat Y_Q240;\rfloat Z_Q240;\rfloat W_Q240;\rX_Q240=vExtra1.x;\rY_Q240=vExtra1.y;\rZ_Q240=vExtra1.z;\rW_Q240=vExtra1.w;\rvec4 Linear_Q193;\rLinear_Q193.rgb=clamp(_Sky_Color_.rgb*_Sky_Color_.rgb,0.0,1.0);\rLinear_Q193.a=_Sky_Color_.a;\rvec4 Linear_Q194;\rLinear_Q194.rgb=clamp(_Horizon_Color_.rgb*_Horizon_Color_.rgb,0.0,1.0);\rLinear_Q194.a=_Horizon_Color_.a;\rvec4 Linear_Q195;\rLinear_Q195.rgb=clamp(_Ground_Color_.rgb*_Ground_Color_.rgb,0.0,1.0);\rLinear_Q195.a=_Ground_Color_.a;\rvec3 Left_Index_Q214;\rvec3 Right_Index_Q214;\rvec3 Left_Index_Middle_Q214;\rvec3 Right_Index_Middle_Q214;\rFinger_Positions_B214(_Left_Index_Pos_,_Right_Index_Pos_,_Left_Index_Middle_Pos_,_Right_Index_Middle_Pos_,Left_Index_Q214,Right_Index_Q214,Left_Index_Middle_Q214,Right_Index_Middle_Q214);\rvec4 Linear_Q196;\rLinear_Q196.rgb=clamp(_Albedo_.rgb*_Albedo_.rgb,0.0,1.0);\rLinear_Q196.a=_Albedo_.a;\rvec3 Normalized_Q257=normalize(vBinormal);\rvec3 Incident_Q220=normalize(vPosition-cameraPosition);\rvec3 New_Normal_Q229;\rBulge_B229(_Bulge_Enabled_,Normalized_Q188,Normalized_Q221,_Bulge_Height_,vColor,_Bulge_Radius_,vBinormal,New_Normal_Q229);\rfloat Result_Q227;\rSSS_B227(vBinormal,New_Normal_Q229,Incident_Q189,Result_Q227);\rvec4 Result_Q241;\rScale_Color_B241(Color_Q233,X_Q240,Result_Q241);\rfloat Transmit_Q272;\rfloat Reflect_Q272;\rFast_Fresnel_B272(_Front_Reflect_,_Edge_Reflect_,_Power_,New_Normal_Q229,Incident_Q189,Transmit_Q272,Reflect_Q272);\rfloat Product_Q275=Y_Q240*Y_Q240;\rvec3 NearP_Q215;\rvec3 NearQ_Q215;\rfloat Distance_Q215;\rMin_Segment_Distance_B215(Left_Index_Q214,Left_Index_Middle_Q214,vPosition,cameraPosition,NearP_Q215,NearQ_Q215,Distance_Q215);\rvec3 NearP_Q213;\rvec3 NearQ_Q213;\rfloat Distance_Q213;\rMin_Segment_Distance_B215(Right_Index_Q214,Right_Index_Middle_Q214,vPosition,cameraPosition,NearP_Q213,NearQ_Q213,Distance_Q213);\rvec3 Reflected_Q197=reflect(Incident_Q189,New_Normal_Q229);\rvec4 Product_Q253=Linear_Q196*vec4(1,1,1,1);\rvec4 Result_Q282;\rRim_Light_B282(Normalized_Q257,Normalized_Q188,Incident_Q220,_Rim_Intensity_,_Rim_Texture_,Result_Q282);\rfloat Dot_Q222=dot(Incident_Q220, Normalized_Q221);\rfloat MaxAB_Q273=max(Reflect_Q272,Product_Q275);\rfloat NotInShadow_Q217;\r#if OCCLUSION_ENABLED\nFingerOcclusion_B217(_Width_,Distance_Q215,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q215,_Clip_Fade_,NotInShadow_Q217);\r#else\nNotInShadow_Q217=1.0;\r#endif\nfloat NotInShadow_Q218;\r#if OCCLUSION_ENABLED\nFingerOcclusion_B218(_Width_,Distance_Q213,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q213,_Clip_Fade_,NotInShadow_Q218);\r#else\nNotInShadow_Q218=1.0;\r#endif\nvec4 Reflected_Color_Q201;\rvec4 Indirect_Diffuse_Q201;\r#if ENV_ENABLE\nMapped_Environment_B201(_Reflection_Map_,_Indirect_Environment_,Reflected_Q197,Reflected_Color_Q201,Indirect_Diffuse_Q201);\r#else\nReflected_Color_Q201=vec4(0,0,0,1);\rIndirect_Diffuse_Q201=vec4(0,0,0,1);\r#endif\nvec4 Reflected_Color_Q200;\rvec4 Indirect_Color_Q200;\r#if SKY_ENABLED\nSky_Environment_B200(New_Normal_Q229,Reflected_Q197,Linear_Q193,Linear_Q194,Linear_Q195,_Horizon_Power_,Reflected_Color_Q200,Indirect_Color_Q200);\r#else\nReflected_Color_Q200=vec4(0,0,0,1);\rIndirect_Color_Q200=vec4(0,0,0,1);\r#endif\nfloat Hue_Q225;\rfloat Saturation_Q225;\rfloat Value_Q225;\rfloat Alpha_Q225;\rvec3 HSV_Q225;\rTo_HSV_B225(Product_Q253,Hue_Q225,Saturation_Q225,Value_Q225,Alpha_Q225,HSV_Q225);\rfloat Hue_Q277;\rfloat Saturation_Q277;\rfloat Value_Q277;\rfloat Alpha_Q277;\rvec3 HSV_Q277;\rTo_HSV_B225(Result_Q282,Hue_Q277,Saturation_Q277,Value_Q277,Alpha_Q277,HSV_Q277);\rfloat Result_Q260;\rCode_B260(Dot_Q222,Result_Q260);\rfloat AbsA_Q226=abs(Result_Q260);\rfloat MinAB_Q208=min(NotInShadow_Q217,NotInShadow_Q218);\rvec4 Sum_Q198=Reflected_Color_Q201+Reflected_Color_Q200;\rvec4 Sum_Q199=Indirect_Diffuse_Q201+Indirect_Color_Q200;\rvec3 HSV_Out_Q276;\rVaryHSV_B258(HSV_Q277,_Rim_Hue_Shift_,_Rim_Saturation_Shift_,_Rim_Value_Shift_,HSV_Out_Q276);\rfloat Out_Q264;\rRemap_Range_B264(-1.0,1.0,0.0,1.0,Result_Q260,Out_Q264);\rfloat Product_Q256;\rProduct_Q256=AbsA_Q226*_Hue_Shift_;\rfloat X_Q278;\rfloat Y_Q278;\rfloat Z_Q278;\rTo_XYZ_B224(HSV_Out_Q276,X_Q278,Y_Q278,Z_Q278);\rvec2 Vec2_Q262=vec2(Out_Q264,0.5);\rvec3 HSV_Out_Q258;\rVaryHSV_B258(HSV_Q225,Product_Q256,_Saturation_Shift_,_Value_Shift_,HSV_Out_Q258);\rvec4 Color_Q279;\rFrom_HSV_B223(X_Q278,Y_Q278,Z_Q278,0.0,Color_Q279);\rvec4 Color_Q261;\r#if IRIDESCENCE_ENABLED\nColor_Q261=texture(_Iridescence_Texture_,Vec2_Q262);\r#else\nColor_Q261=vec4(0,0,0,0);\r#endif\nfloat X_Q224;\rfloat Y_Q224;\rfloat Z_Q224;\rTo_XYZ_B224(HSV_Out_Q258,X_Q224,Y_Q224,Z_Q224);\rvec4 Result_Q281=_Rim_Intensity_*Color_Q279;\rvec4 Result_Q263=_Iridescence_Intensity_*Color_Q261;\rvec4 Color_Q223;\rFrom_HSV_B223(X_Q224,Y_Q224,Z_Q224,0.0,Color_Q223);\rvec4 Result_Q234=Result_Q241+(1.0-Result_Q241.a)*Color_Q223;\rvec4 Result_Q271;\rFragment_Main_B271(_Sun_Intensity_,_Sun_Theta_,_Sun_Phi_,New_Normal_Q229,Result_Q234,MaxAB_Q273,_Shininess_,Incident_Q189,_Horizon_Color_,_Sky_Color_,_Ground_Color_,_Indirect_Diffuse_,_Specular_,_Horizon_Power_,_Reflection_,Sum_Q198,Sum_Q199,_Sharpness_,Result_Q227,_Subsurface_,vec4(0,0,0,0),Result_Q281,Result_Q263,Result_Q271);\rvec4 Result_Q209;\rScale_RGB_B209(Result_Q271,MinAB_Q208,Result_Q209);\rvec4 sRGB_Q192;\rFastLinearTosRGB_B192(Result_Q209,sRGB_Q192);\rvec4 Result_Q181=Blob_Color_Q180+(1.0-Blob_Color_Q180.a)*sRGB_Q192;\rvec4 Result_Q190=Result_Q181; Result_Q190.a=1.0;\rvec4 Out_Color=Result_Q190;\rfloat Clip_Threshold=0.001;\rbool To_sRGB=false;\rgl_FragColor=Out_Color;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const mrdlSliderThumbPixelShader = { name, shader };\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"mrdlSliderThumbVertexShader\";\nconst shader = `uniform mat4 world;\runiform mat4 viewProjection;\runiform vec3 cameraPosition;\rattribute vec3 position;\rattribute vec3 normal;\rattribute vec2 uv;\r#ifdef TANGENT\nattribute vec3 tangent;\r#else\nconst vec3 tangent=vec3(0.);\r#endif\nuniform float _Radius_;\runiform float _Bevel_Front_;\runiform float _Bevel_Front_Stretch_;\runiform float _Bevel_Back_;\runiform float _Bevel_Back_Stretch_;\runiform float _Radius_Top_Left_;\runiform float _Radius_Top_Right_;\runiform float _Radius_Bottom_Left_;\runiform float _Radius_Bottom_Right_;\runiform bool _Bulge_Enabled_;\runiform float _Bulge_Height_;\runiform float _Bulge_Radius_;\runiform float _Sun_Intensity_;\runiform float _Sun_Theta_;\runiform float _Sun_Phi_;\runiform float _Indirect_Diffuse_;\runiform vec4 _Albedo_;\runiform float _Specular_;\runiform float _Shininess_;\runiform float _Sharpness_;\runiform float _Subsurface_;\runiform vec4 _Left_Color_;\runiform vec4 _Right_Color_;\runiform float _Reflection_;\runiform float _Front_Reflect_;\runiform float _Edge_Reflect_;\runiform float _Power_;\runiform vec4 _Sky_Color_;\runiform vec4 _Horizon_Color_;\runiform vec4 _Ground_Color_;\runiform float _Horizon_Power_;\runiform sampler2D _Reflection_Map_;\runiform sampler2D _Indirect_Environment_;\runiform float _Width_;\runiform float _Fuzz_;\runiform float _Min_Fuzz_;\runiform float _Clip_Fade_;\runiform float _Hue_Shift_;\runiform float _Saturation_Shift_;\runiform float _Value_Shift_;\runiform vec3 _Blob_Position_;\runiform float _Blob_Intensity_;\runiform float _Blob_Near_Size_;\runiform float _Blob_Far_Size_;\runiform float _Blob_Near_Distance_;\runiform float _Blob_Far_Distance_;\runiform float _Blob_Fade_Length_;\runiform float _Blob_Pulse_;\runiform float _Blob_Fade_;\runiform sampler2D _Blob_Texture_;\runiform vec3 _Blob_Position_2_;\runiform float _Blob_Near_Size_2_;\runiform float _Blob_Pulse_2_;\runiform float _Blob_Fade_2_;\runiform vec3 _Left_Index_Pos_;\runiform vec3 _Right_Index_Pos_;\runiform vec3 _Left_Index_Middle_Pos_;\runiform vec3 _Right_Index_Middle_Pos_;\runiform sampler2D _Decal_;\runiform vec2 _Decal_Scale_XY_;\runiform bool _Decal_Front_Only_;\runiform float _Rim_Intensity_;\runiform sampler2D _Rim_Texture_;\runiform float _Rim_Hue_Shift_;\runiform float _Rim_Saturation_Shift_;\runiform float _Rim_Value_Shift_;\runiform float _Iridescence_Intensity_;\runiform sampler2D _Iridescence_Texture_;\runiform bool Use_Global_Left_Index;\runiform bool Use_Global_Right_Index;\runiform vec4 Global_Left_Index_Tip_Position;\runiform vec4 Global_Right_Index_Tip_Position;\runiform vec4 Global_Left_Thumb_Tip_Position;\runiform vec4 Global_Right_Thumb_Tip_Position;\runiform float Global_Left_Index_Tip_Proximity;\runiform float Global_Right_Index_Tip_Proximity;\rvarying vec3 vPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvarying vec3 vTangent;\rvarying vec3 vBinormal;\rvarying vec4 vColor;\rvarying vec4 vExtra1;\rvarying vec4 vExtra2;\rvarying vec4 vExtra3;\rvoid Object_To_World_Pos_B162(\rvec3 Pos_Object,\rout vec3 Pos_World)\r{\rPos_World=(world*vec4(Pos_Object,1.0)).xyz;\r}\rvoid Object_To_World_Normal_B182(\rvec3 Nrm_Object,\rout vec3 Nrm_World)\r{\rNrm_World=(vec4(Nrm_Object,0.0)).xyz;\r}\rvoid Blob_Vertex_B173(\rvec3 Position,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rvec3 Blob_Position,\rfloat Intensity,\rfloat Blob_Near_Size,\rfloat Blob_Far_Size,\rfloat Blob_Near_Distance,\rfloat Blob_Far_Distance,\rfloat Blob_Fade_Length,\rfloat Blob_Pulse,\rfloat Blob_Fade,\rout vec4 Blob_Info)\r{\rvec3 blob= (Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Blob_Position);\rvec3 delta=blob-Position;\rfloat dist=dot(Normal,delta);\rfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\rfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\rfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\rvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\rfloat Fade=fadeValue*Intensity*Blob_Fade;\rfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\rBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\r}\rvoid Blob_Vertex_B174(\rvec3 Position,\rvec3 Normal,\rvec3 Tangent,\rvec3 Bitangent,\rvec3 Blob_Position,\rfloat Intensity,\rfloat Blob_Near_Size,\rfloat Blob_Far_Size,\rfloat Blob_Near_Distance,\rfloat Blob_Far_Distance,\rfloat Blob_Fade_Length,\rfloat Blob_Pulse,\rfloat Blob_Fade,\rout vec4 Blob_Info)\r{\rvec3 blob= (Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Blob_Position);\rvec3 delta=blob-Position;\rfloat dist=dot(Normal,delta);\rfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\rfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\rfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\rvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\rfloat Fade=fadeValue*Intensity*Blob_Fade;\rfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\rBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\r}\rvoid Move_Verts_B280(\rfloat Anisotropy,\rvec3 P,\rfloat Radius,\rfloat Bevel,\rvec3 Normal_Object,\rfloat ScaleZ,\rfloat Stretch,\rout vec3 New_P,\rout vec2 New_UV,\rout float Radial_Gradient,\rout vec3 Radial_Dir,\rout vec3 New_Normal)\r{\rvec2 UV=P.xy*2.0+0.5;\rvec2 center=clamp(UV,0.0,1.0);\rvec2 delta=UV-center;\rfloat deltad=(length(delta)*2.0);\rfloat f=(Bevel+(Radius-Bevel)*Stretch)/Radius;\rfloat innerd=clamp(deltad*2.0,0.0,1.0);\rfloat outerd=clamp(deltad*2.0-1.0,0.0,1.0);\rfloat bevelAngle=outerd*3.14159*0.5;\rfloat sinb=sin(bevelAngle);\rfloat cosb=cos(bevelAngle);\rfloat beveld=(1.0-f)*innerd+f*sinb;\rfloat br=outerd;\rvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\rfloat dir=P.z<0.0001 ? 1.0 : -1.0;\rNew_UV=center+r2*((0.5-center)+normalize(delta+vec2(0.0,0.000001))*beveld*0.5);\rNew_P=vec3(New_UV-0.5,P.z+dir*(1.0-cosb)*Bevel*ScaleZ);\rRadial_Gradient=clamp((deltad-0.5)*2.0,0.0,1.0);\rRadial_Dir=vec3(delta*r2,0.0);\rvec3 beveledNormal=cosb*Normal_Object+sinb*vec3(delta.x,delta.y,0.0);\rNew_Normal=Normal_Object.z==0.0 ? Normal_Object : beveledNormal;\r}\rvoid Object_To_World_Dir_B210(\rvec3 Dir_Object,\rout vec3 Normal_World,\rout vec3 Normal_World_N,\rout float Normal_Length)\r{\rNormal_World=(world*vec4(Dir_Object,0.0)).xyz;\rNormal_Length=length(Normal_World);\rNormal_World_N=Normal_World/Normal_Length;\r}\rvoid To_XYZ_B228(\rvec3 Vec3,\rout float X,\rout float Y,\rout float Z)\r{\rX=Vec3.x;\rY=Vec3.y;\rZ=Vec3.z;\r}\rvoid Conditional_Float_B243(\rbool Which,\rfloat If_True,\rfloat If_False,\rout float Result)\r{\rResult=Which ? If_True : If_False;\r}\rvoid Object_To_World_Dir_B178(\rvec3 Dir_Object,\rout vec3 Binormal_World,\rout vec3 Binormal_World_N,\rout float Binormal_Length)\r{\rBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\rBinormal_Length=length(Binormal_World);\rBinormal_World_N=Binormal_World/Binormal_Length;\r}\rvoid Pick_Radius_B219(\rfloat Radius,\rfloat Radius_Top_Left,\rfloat Radius_Top_Right,\rfloat Radius_Bottom_Left,\rfloat Radius_Bottom_Right,\rvec3 Position,\rout float Result)\r{\rbool whichY=Position.y>0.0;\rResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\rResult*=Radius;\r}\rvoid Conditional_Float_B186(\rbool Which,\rfloat If_True,\rfloat If_False,\rout float Result)\r{\rResult=Which ? If_True : If_False;\r}\rvoid Greater_Than_B187(\rfloat Left,\rfloat Right,\rout bool Not_Greater_Than,\rout bool Greater_Than)\r{\rGreater_Than=Left>Right;\rNot_Greater_Than=!Greater_Than;\r}\rvoid Remap_Range_B255(\rfloat In_Min,\rfloat In_Max,\rfloat Out_Min,\rfloat Out_Max,\rfloat In,\rout float Out)\r{\rOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\r}\rvoid main()\r{\rvec2 XY_Q235;\rXY_Q235=(uv-vec2(0.5,0.5))*_Decal_Scale_XY_+vec2(0.5,0.5);\rvec3 Tangent_World_Q177;\rvec3 Tangent_World_N_Q177;\rfloat Tangent_Length_Q177;\rTangent_World_Q177=(world*vec4(vec3(1,0,0),0.0)).xyz;\rTangent_Length_Q177=length(Tangent_World_Q177);\rTangent_World_N_Q177=Tangent_World_Q177/Tangent_Length_Q177;\rvec3 Normal_World_Q210;\rvec3 Normal_World_N_Q210;\rfloat Normal_Length_Q210;\rObject_To_World_Dir_B210(vec3(0,0,1),Normal_World_Q210,Normal_World_N_Q210,Normal_Length_Q210);\rfloat X_Q228;\rfloat Y_Q228;\rfloat Z_Q228;\rTo_XYZ_B228(position,X_Q228,Y_Q228,Z_Q228);\rvec3 Nrm_World_Q176;\rNrm_World_Q176=normalize((world*vec4(normal,0.0)).xyz);\rvec3 Binormal_World_Q178;\rvec3 Binormal_World_N_Q178;\rfloat Binormal_Length_Q178;\rObject_To_World_Dir_B178(vec3(0,1,0),Binormal_World_Q178,Binormal_World_N_Q178,Binormal_Length_Q178);\rfloat Anisotropy_Q179=Tangent_Length_Q177/Binormal_Length_Q178;\rfloat Result_Q219;\rPick_Radius_B219(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q219);\rfloat Anisotropy_Q203=Binormal_Length_Q178/Normal_Length_Q210;\rbool Not_Greater_Than_Q187;\rbool Greater_Than_Q187;\rGreater_Than_B187(Z_Q228,0.0,Not_Greater_Than_Q187,Greater_Than_Q187);\rvec4 Linear_Q251;\rLinear_Q251.rgb=clamp(_Left_Color_.rgb*_Left_Color_.rgb,0.0,1.0);\rLinear_Q251.a=_Left_Color_.a;\rvec4 Linear_Q252;\rLinear_Q252.rgb=clamp(_Right_Color_.rgb*_Right_Color_.rgb,0.0,1.0);\rLinear_Q252.a=_Right_Color_.a;\rvec3 Difference_Q211=vec3(0,0,0)-Normal_World_N_Q210;\rvec4 Out_Color_Q184=vec4(X_Q228,Y_Q228,Z_Q228,1);\rfloat Result_Q186;\rConditional_Float_B186(Greater_Than_Q187,_Bevel_Back_,_Bevel_Front_,Result_Q186);\rfloat Result_Q244;\rConditional_Float_B186(Greater_Than_Q187,_Bevel_Back_Stretch_,_Bevel_Front_Stretch_,Result_Q244);\rvec3 New_P_Q280;\rvec2 New_UV_Q280;\rfloat Radial_Gradient_Q280;\rvec3 Radial_Dir_Q280;\rvec3 New_Normal_Q280;\rMove_Verts_B280(Anisotropy_Q179,position,Result_Q219,Result_Q186,normal,Anisotropy_Q203,Result_Q244,New_P_Q280,New_UV_Q280,Radial_Gradient_Q280,Radial_Dir_Q280,New_Normal_Q280);\rfloat X_Q248;\rfloat Y_Q248;\rX_Q248=New_UV_Q280.x;\rY_Q248=New_UV_Q280.y;\rvec3 Pos_World_Q162;\rObject_To_World_Pos_B162(New_P_Q280,Pos_World_Q162);\rvec3 Nrm_World_Q182;\rObject_To_World_Normal_B182(New_Normal_Q280,Nrm_World_Q182);\rvec4 Blob_Info_Q173;\r#if BLOB_ENABLE\nBlob_Vertex_B173(Pos_World_Q162,Nrm_World_Q176,Tangent_World_N_Q177,Binormal_World_N_Q178,_Blob_Position_,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q173);\r#else\nBlob_Info_Q173=vec4(0,0,0,0);\r#endif\nvec4 Blob_Info_Q174;\r#if BLOB_ENABLE_2\nBlob_Vertex_B174(Pos_World_Q162,Nrm_World_Q176,Tangent_World_N_Q177,Binormal_World_N_Q178,_Blob_Position_2_,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q174);\r#else\nBlob_Info_Q174=vec4(0,0,0,0);\r#endif\nfloat Out_Q255;\rRemap_Range_B255(0.0,1.0,0.0,1.0,X_Q248,Out_Q255);\rfloat X_Q236;\rfloat Y_Q236;\rfloat Z_Q236;\rTo_XYZ_B228(Nrm_World_Q182,X_Q236,Y_Q236,Z_Q236);\rvec4 Color_At_T_Q247=mix(Linear_Q251,Linear_Q252,Out_Q255);\rfloat Minus_F_Q237=-Z_Q236;\rfloat R_Q249;\rfloat G_Q249;\rfloat B_Q249;\rfloat A_Q249;\rR_Q249=Color_At_T_Q247.r; G_Q249=Color_At_T_Q247.g; B_Q249=Color_At_T_Q247.b; A_Q249=Color_At_T_Q247.a;\rfloat ClampF_Q238=clamp(0.0,Minus_F_Q237,1.0);\rfloat Result_Q243;\rConditional_Float_B243(_Decal_Front_Only_,ClampF_Q238,1.0,Result_Q243);\rvec4 Vec4_Q239=vec4(Result_Q243,Radial_Gradient_Q280,G_Q249,B_Q249);\rvec3 Position=Pos_World_Q162;\rvec3 Normal=Nrm_World_Q182;\rvec2 UV=XY_Q235;\rvec3 Tangent=Tangent_World_N_Q177;\rvec3 Binormal=Difference_Q211;\rvec4 Color=Out_Color_Q184;\rvec4 Extra1=Vec4_Q239;\rvec4 Extra2=Blob_Info_Q173;\rvec4 Extra3=Blob_Info_Q174;\rgl_Position=viewProjection*vec4(Position,1);\rvPosition=Position;\rvNormal=Normal;\rvUV=UV;\rvTangent=Tangent;\rvBinormal=Binormal;\rvColor=Color;\rvExtra1=Extra1;\rvExtra2=Extra2;\rvExtra3=Extra3;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const mrdlSliderThumbVertexShader = { name, shader };\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport { SerializationHelper, serialize } from \"core/Misc/decorators\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Vector2, Vector3, Vector4 } from \"core/Maths/math.vector\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { Color4 } from \"core/Maths/math.color\";\r\nimport { EffectFallbacks } from \"core/Materials/effectFallbacks\";\r\nimport { Constants } from \"core/Engines/constants\";\r\n\r\nimport \"./shaders/mrdlSliderThumb.fragment\";\r\nimport \"./shaders/mrdlSliderThumb.vertex\";\r\n\r\n/** @internal */\r\nclass MRDLSliderThumbMaterialDefines extends MaterialDefines {\r\n    /*\r\n        \"SKY_ENABLED\", \"BLOB_ENABLE_2\", \"IRIDESCENCE_ENABLED\"\r\n    */\r\n    public SKY_ENABLED = true;\r\n    public BLOB_ENABLE_2 = true;\r\n    public IRIDESCENCE_ENABLED = true;\r\n\r\n    constructor() {\r\n        super();\r\n        this._needNormals = true;\r\n        this._needUVs = true;\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\n/**\r\n * Class used to render Slider Thumb material with MRDL\r\n */\r\nexport class MRDLSliderThumbMaterial extends PushMaterial {\r\n    /**\r\n     * URL pointing to the texture used to define the coloring for the Iridescent Map effect.\r\n     */\r\n    public static BLUE_GRADIENT_TEXTURE_URL = \"https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-blue-gradient.png\";\r\n    private _blueGradientTexture: Texture;\r\n    private _decalTexture: Texture;\r\n    private _reflectionMapTexture: Texture;\r\n    private _indirectEnvTexture: Texture;\r\n\r\n    /**\r\n     * Gets or sets the corner Radius on the slider thumb.\r\n     */\r\n    @serialize()\r\n    public radius = 0.157;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Front on the slider thumb.\r\n     */\r\n    @serialize()\r\n    public bevelFront = 0.065;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Front Stretch on the slider thumb.\r\n     */\r\n    @serialize()\r\n    public bevelFrontStretch = 0.077;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Back on the slider thumb.\r\n     */\r\n    @serialize()\r\n    public bevelBack = 0.031;\r\n\r\n    /**\r\n     * Gets or sets the Bevel Back Stretch on the slider thumb.\r\n     */\r\n    @serialize()\r\n    public bevelBackStretch = 0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusTopLeft = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusTopRight = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusBottomLeft = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusBottomRight = 1.0;\r\n\r\n    /**\r\n     * Gets or sets whether Bulge is enabled.\r\n     * Default is false.\r\n     */\r\n    @serialize()\r\n    public bulgeEnabled = false;\r\n\r\n    /**\r\n     * Gets or sets the Bulge Height.\r\n     */\r\n    @serialize()\r\n    public bulgeHeight = -0.323;\r\n\r\n    /**\r\n     * Gets or sets the Bulge Radius.\r\n     */\r\n    @serialize()\r\n    public bulgeRadius = 0.73;\r\n\r\n    /**\r\n     * Gets or sets the Sun Intensity.\r\n     */\r\n    @serialize()\r\n    public sunIntensity = 2;\r\n\r\n    /**\r\n     * Gets or sets the Sun Theta.\r\n     */\r\n    @serialize()\r\n    public sunTheta = 0.937;\r\n\r\n    /**\r\n     * Gets or sets the Sun Phi.\r\n     */\r\n    @serialize()\r\n    public sunPhi = 0.555;\r\n\r\n    /**\r\n     * Gets or sets the Indirect Diffuse.\r\n     */\r\n    @serialize()\r\n    public indirectDiffuse = 1;\r\n\r\n    /**\r\n     * Gets or sets the base albedo.\r\n     */\r\n    @serialize()\r\n    public albedo = new Color4(0.0117647, 0.505882, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the Specular value.\r\n     */\r\n    @serialize()\r\n    public specular = 0;\r\n\r\n    /**\r\n     * Gets or sets the Shininess value.\r\n     */\r\n    @serialize()\r\n    public shininess = 10;\r\n\r\n    /**\r\n     * Gets or sets the Sharpness value.\r\n     */\r\n    @serialize()\r\n    public sharpness = 0;\r\n\r\n    /**\r\n     * Gets or sets the Subsurface value.\r\n     */\r\n    @serialize()\r\n    public subsurface = 0.31;\r\n\r\n    /**\r\n     * Gets or sets the left gradient color.\r\n     */\r\n    @serialize()\r\n    public leftGradientColor = new Color4(0.0117647, 0.505882, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the right gradient color.\r\n     */\r\n    @serialize()\r\n    public rightGradientColor = new Color4(0.0117647, 0.505882, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the reflection value.\r\n     */\r\n    @serialize()\r\n    public reflection = 0.749;\r\n\r\n    /**\r\n     * Gets or sets the front reflect value.\r\n     */\r\n    @serialize()\r\n    public frontReflect = 0;\r\n\r\n    /**\r\n     * Gets or sets the edge reflect value.\r\n     */\r\n    @serialize()\r\n    public edgeReflect = 0.09;\r\n\r\n    /**\r\n     * Gets or sets the power value.\r\n     */\r\n    @serialize()\r\n    public power = 8.1;\r\n\r\n    /**\r\n     * Gets or sets the sky color.\r\n     */\r\n    @serialize()\r\n    public skyColor = new Color4(0.0117647, 0.960784, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the horizon color.\r\n     */\r\n    @serialize()\r\n    public horizonColor = new Color4(0.0117647, 0.333333, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the ground color.\r\n     */\r\n    @serialize()\r\n    public groundColor = new Color4(0, 0.254902, 0.996078, 1);\r\n\r\n    /**\r\n     * Gets or sets the horizon power value.\r\n     */\r\n    @serialize()\r\n    public horizonPower = 1;\r\n\r\n    /**\r\n     * Gets or sets the finger occlusion width value.\r\n     */\r\n    @serialize()\r\n    public width = 0.02;\r\n\r\n    /**\r\n     * Gets or sets the finger occlusion fuzz value.\r\n     */\r\n    @serialize()\r\n    public fuzz = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the minimum finger occlusion fuzz value.\r\n     */\r\n    @serialize()\r\n    public minFuzz = 0.001;\r\n\r\n    /**\r\n     * Gets or sets the finger occlusion clip fade value.\r\n     */\r\n    @serialize()\r\n    public clipFade = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the hue shift value.\r\n     */\r\n    @serialize()\r\n    public hueShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the saturation shift value.\r\n     */\r\n    @serialize()\r\n    public saturationShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the value shift.\r\n     */\r\n    @serialize()\r\n    public valueShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the position of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobPosition = new Vector3(0, 0, 0.1);\r\n\r\n    /**\r\n     * Gets or sets the intensity of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobIntensity = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the near size of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobNearSize = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the far size of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobFarSize = 0.03;\r\n\r\n    /**\r\n     * Gets or sets the distance considered \"near\" to the mesh, which controls the size of the hover glow effect (see blobNearSize).\r\n     */\r\n    @serialize()\r\n    public blobNearDistance = 0;\r\n\r\n    /**\r\n     * Gets or sets the distance considered \"far\" from the mesh, which controls the size of the hover glow effect (see blobFarSize).\r\n     */\r\n    @serialize()\r\n    public blobFarDistance = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the length of the hover glow effect fade.\r\n     */\r\n    @serialize()\r\n    public blobFadeLength = 0.576;\r\n\r\n    /**\r\n     * Gets or sets the progress of the hover glow effect selection animation corresponding to the left pointer (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public blobPulse = 0;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the hover glow effect corresponding to the left pointer (0.0 - 1.0). Default is 0.\r\n     */\r\n    @serialize()\r\n    public blobFade = 1;\r\n\r\n    /**\r\n     * Gets or sets the position of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobPosition2 = new Vector3(0.2, 0, 0.1);\r\n\r\n    /**\r\n     * Gets or sets the size of the hover glow effect when the right pointer is considered \"near\" to the mesh (see blobNearDistance).\r\n     */\r\n    @serialize()\r\n    public blobNearSize2 = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the progress of the hover glow effect selection animation corresponding to the right pointer (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public blobPulse2 = 0;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the hover glow effect corresponding to the right pointer (0.0 - 1.0). Default is 1.\r\n     */\r\n    @serialize()\r\n    public blobFade2 = 1;\r\n\r\n    /**\r\n     * Gets or sets the texture of the hover glow effect.\r\n     */\r\n    @serialize()\r\n    public blobTexture = new Texture(\"\", this.getScene());\r\n\r\n    /**\r\n     * Gets or sets the finger position for left index.\r\n     */\r\n    @serialize()\r\n    public leftIndexPosition = new Vector3(0, 0, 1);\r\n\r\n    /**\r\n     * Gets or sets the finger position for right index.\r\n     */\r\n    @serialize()\r\n    public rightIndexPosition = new Vector3(-1, -1, -1);\r\n\r\n    /**\r\n     * Gets or sets the finger position for left index middle position.\r\n     */\r\n    @serialize()\r\n    public leftIndexMiddlePosition = new Vector3(0, 0, 0);\r\n\r\n    /**\r\n     * Gets or sets the finger position for right index middle position.\r\n     */\r\n    @serialize()\r\n    public rightIndexMiddlePosition = new Vector3(0, 0, 0);\r\n\r\n    /**\r\n     * Gets or sets the Decal Scale for XY.\r\n     */\r\n    @serialize()\r\n    public decalScaleXY = new Vector2(1.5, 1.5);\r\n\r\n    /**\r\n     * Gets or sets decalFrontOnly\r\n     * Default is true\r\n     */\r\n    @serialize()\r\n    public decalFrontOnly = true;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light intensity.\r\n     */\r\n    @serialize()\r\n    public rimIntensity = 0.287;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light hue shift value.\r\n     */\r\n    @serialize()\r\n    public rimHueShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light saturation shift value.\r\n     */\r\n    @serialize()\r\n    public rimSaturationShift = 0;\r\n\r\n    /**\r\n     * Gets or sets the Rim Light value shift.\r\n     */\r\n    @serialize()\r\n    public rimValueShift = -1;\r\n\r\n    /**\r\n     * Gets or sets the intensity of the iridescence effect.\r\n     */\r\n    @serialize()\r\n    public iridescenceIntensity = 0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public useGlobalLeftIndex = 1.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public useGlobalRightIndex = 1.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftIndexTipProximity = 0.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalRightIndexTipProximity = 0.0;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftIndexTipPosition = new Vector4(0.5, 0.0, -0.55, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globaRightIndexTipPosition = new Vector4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftThumbTipPosition = new Vector4(0.5, 0.0, -0.55, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalRightThumbTipPosition = new Vector4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalLeftIndexMiddlePosition = new Vector4(0.5, 0.0, -0.55, 1.0);\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public globalRightIndexMiddlePosition = new Vector4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    constructor(name: string, scene?: Scene) {\r\n        super(name, scene);\r\n        this.alphaMode = Constants.ALPHA_DISABLE;\r\n        this.backFaceCulling = false;\r\n        this._blueGradientTexture = new Texture(MRDLSliderThumbMaterial.BLUE_GRADIENT_TEXTURE_URL, scene, true, false, Texture.NEAREST_SAMPLINGMODE);\r\n        this._decalTexture = new Texture(\"\", this.getScene());\r\n        this._reflectionMapTexture = new Texture(\"\", this.getScene());\r\n        this._indirectEnvTexture = new Texture(\"\", this.getScene());\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    // Methods\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new MRDLSliderThumbMaterialDefines();\r\n        }\r\n\r\n        const defines = <MRDLSliderThumbMaterialDefines>subMesh.materialDefines;\r\n        const scene = this.getScene();\r\n\r\n        if (this._isReadyForSubMesh(subMesh)) {\r\n            return true;\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n\r\n        // Attribs\r\n        MaterialHelper.PrepareDefinesForAttributes(mesh, defines, false, false);\r\n\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n\r\n            scene.resetCachedMaterial();\r\n\r\n            // Fallbacks\r\n            const fallbacks = new EffectFallbacks();\r\n            if (defines.FOG) {\r\n                fallbacks.addFallback(1, \"FOG\");\r\n            }\r\n\r\n            MaterialHelper.HandleFallbacksForShadows(defines, fallbacks);\r\n\r\n            defines.IMAGEPROCESSINGPOSTPROCESS = scene.imageProcessingConfiguration.applyByPostProcess;\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n\r\n            if (defines.NORMAL) {\r\n                attribs.push(VertexBuffer.NormalKind);\r\n            }\r\n\r\n            if (defines.UV1) {\r\n                attribs.push(VertexBuffer.UVKind);\r\n            }\r\n\r\n            if (defines.UV2) {\r\n                attribs.push(VertexBuffer.UV2Kind);\r\n            }\r\n\r\n            if (defines.VERTEXCOLOR) {\r\n                attribs.push(VertexBuffer.ColorKind);\r\n            }\r\n\r\n            if (defines.TANGENT) {\r\n                attribs.push(VertexBuffer.TangentKind);\r\n            }\r\n\r\n            MaterialHelper.PrepareAttributesForInstances(attribs, defines);\r\n\r\n            // Legacy browser patch\r\n            const shaderName = \"mrdlSliderThumb\";\r\n            const join = defines.toString();\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"viewProjection\",\r\n                \"cameraPosition\",\r\n                \"_Radius_\",\r\n                \"_Bevel_Front_\",\r\n                \"_Bevel_Front_Stretch_\",\r\n                \"_Bevel_Back_\",\r\n                \"_Bevel_Back_Stretch_\",\r\n                \"_Radius_Top_Left_\",\r\n                \"_Radius_Top_Right_\",\r\n                \"_Radius_Bottom_Left_\",\r\n                \"_Radius_Bottom_Right_\",\r\n                \"_Bulge_Enabled_\",\r\n                \"_Bulge_Height_\",\r\n                \"_Bulge_Radius_\",\r\n                \"_Sun_Intensity_\",\r\n                \"_Sun_Theta_\",\r\n                \"_Sun_Phi_\",\r\n                \"_Indirect_Diffuse_\",\r\n                \"_Albedo_\",\r\n                \"_Specular_\",\r\n                \"_Shininess_\",\r\n                \"_Sharpness_\",\r\n                \"_Subsurface_\",\r\n                \"_Left_Color_\",\r\n                \"_Right_Color_\",\r\n                \"_Reflection_\",\r\n                \"_Front_Reflect_\",\r\n                \"_Edge_Reflect_\",\r\n                \"_Power_\",\r\n                \"_Sky_Color_\",\r\n                \"_Horizon_Color_\",\r\n                \"_Ground_Color_\",\r\n                \"_Horizon_Power_\",\r\n                \"_Reflection_Map_\",\r\n                \"_Indirect_Environment_\",\r\n                \"_Width_\",\r\n                \"_Fuzz_\",\r\n                \"_Min_Fuzz_\",\r\n                \"_Clip_Fade_\",\r\n                \"_Hue_Shift_\",\r\n                \"_Saturation_Shift_\",\r\n                \"_Value_Shift_\",\r\n                \"_Blob_Position_\",\r\n                \"_Blob_Intensity_\",\r\n                \"_Blob_Near_Size_\",\r\n                \"_Blob_Far_Size_\",\r\n                \"_Blob_Near_Distance_\",\r\n                \"_Blob_Far_Distance_\",\r\n                \"_Blob_Fade_Length_\",\r\n                \"_Blob_Pulse_\",\r\n                \"_Blob_Fade_\",\r\n                \"_Blob_Texture_\",\r\n                \"_Blob_Position_2_\",\r\n                \"_Blob_Near_Size_2_\",\r\n                \"_Blob_Pulse_2_\",\r\n                \"_Blob_Fade_2_\",\r\n                \"_Left_Index_Pos_\",\r\n                \"_Right_Index_Pos_\",\r\n                \"_Left_Index_Middle_Pos_\",\r\n                \"_Right_Index_Middle_Pos_\",\r\n                \"_Decal_\",\r\n                \"_Decal_Scale_XY_\",\r\n                \"_Decal_Front_Only_\",\r\n                \"_Rim_Intensity_\",\r\n                \"_Rim_Texture_\",\r\n                \"_Rim_Hue_Shift_\",\r\n                \"_Rim_Saturation_Shift_\",\r\n                \"_Rim_Value_Shift_\",\r\n                \"_Iridescence_Intensity_\",\r\n                \"_Iridescence_Texture_\",\r\n                \"Use_Global_Left_Index\",\r\n                \"Use_Global_Right_Index\",\r\n                \"Global_Left_Index_Tip_Position\",\r\n                \"Global_Right_Index_Tip_Position\",\r\n                \"Global_Left_Thumb_Tip_Position\",\r\n                \"Global_Right_Thumb_Tip_Position\",\r\n                \"Global_Left_Index_Middle_Position;\",\r\n                \"Global_Right_Index_Middle_Position\",\r\n                \"Global_Left_Index_Tip_Proximity\",\r\n                \"Global_Right_Index_Tip_Proximity\",\r\n            ];\r\n            const samplers: string[] = [\"_Rim_Texture_\", \"_Iridescence_Texture_\"];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: fallbacks,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines\r\n            );\r\n        }\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const defines = <MRDLSliderThumbMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", this.getScene().getTransformMatrix());\r\n        this._activeEffect.setVector3(\"cameraPosition\", this.getScene().activeCamera!.position);\r\n\r\n        // \"Round Rect\"\r\n        this._activeEffect.setFloat(\"_Radius_\", this.radius);\r\n        this._activeEffect.setFloat(\"_Bevel_Front_\", this.bevelFront);\r\n        this._activeEffect.setFloat(\"_Bevel_Front_Stretch_\", this.bevelFrontStretch);\r\n        this._activeEffect.setFloat(\"_Bevel_Back_\", this.bevelBack);\r\n        this._activeEffect.setFloat(\"_Bevel_Back_Stretch_\", this.bevelBackStretch);\r\n\r\n        // \"Radii Multipliers\"\r\n        this._activeEffect.setFloat(\"_Radius_Top_Left_\", this.radiusTopLeft);\r\n        this._activeEffect.setFloat(\"_Radius_Top_Right_\", this.radiusTopRight);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Left_\", this.radiusBottomLeft);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Right_\", this.radiusBottomRight);\r\n\r\n        // \"Bulge\"\r\n        this._activeEffect.setFloat(\"_Bulge_Enabled_\", this.bulgeEnabled ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Bulge_Height_\", this.bulgeHeight);\r\n        this._activeEffect.setFloat(\"_Bulge_Radius_\", this.bulgeRadius);\r\n\r\n        // \"Sun\"\r\n        this._activeEffect.setFloat(\"_Sun_Intensity_\", this.sunIntensity);\r\n        this._activeEffect.setFloat(\"_Sun_Theta_\", this.sunTheta);\r\n        this._activeEffect.setFloat(\"_Sun_Phi_\", this.sunPhi);\r\n        this._activeEffect.setFloat(\"_Indirect_Diffuse_\", this.indirectDiffuse);\r\n\r\n        // \"Diffuse And Specular\"\r\n        this._activeEffect.setDirectColor4(\"_Albedo_\", this.albedo);\r\n        this._activeEffect.setFloat(\"_Specular_\", this.specular);\r\n        this._activeEffect.setFloat(\"_Shininess_\", this.shininess);\r\n        this._activeEffect.setFloat(\"_Sharpness_\", this.sharpness);\r\n        this._activeEffect.setFloat(\"_Subsurface_\", this.subsurface);\r\n\r\n        // \"Gradient\"\r\n        this._activeEffect.setDirectColor4(\"_Left_Color_\", this.leftGradientColor);\r\n        this._activeEffect.setDirectColor4(\"_Right_Color_\", this.rightGradientColor);\r\n\r\n        // \"Reflection\"\r\n        this._activeEffect.setFloat(\"_Reflection_\", this.reflection);\r\n        this._activeEffect.setFloat(\"_Front_Reflect_\", this.frontReflect);\r\n        this._activeEffect.setFloat(\"_Edge_Reflect_\", this.edgeReflect);\r\n        this._activeEffect.setFloat(\"_Power_\", this.power);\r\n\r\n        // \"Sky Environment\"\r\n        //define SKY_ENABLED true;\r\n        this._activeEffect.setDirectColor4(\"_Sky_Color_\", this.skyColor);\r\n        this._activeEffect.setDirectColor4(\"_Horizon_Color_\", this.horizonColor);\r\n        this._activeEffect.setDirectColor4(\"_Ground_Color_\", this.groundColor);\r\n        this._activeEffect.setFloat(\"_Horizon_Power_\", this.horizonPower);\r\n\r\n        // \"Mapped Environment\"\r\n        //define ENV_ENABLE false;\r\n        this._activeEffect.setTexture(\"_Reflection_Map_\", this._reflectionMapTexture);\r\n        this._activeEffect.setTexture(\"_Indirect_Environment_\", this._indirectEnvTexture);\r\n\r\n        // \"FingerOcclusion\"\r\n        //define OCCLUSION_ENABLED false;\r\n        this._activeEffect.setFloat(\"_Width_\", this.width);\r\n        this._activeEffect.setFloat(\"_Fuzz_\", this.fuzz);\r\n        this._activeEffect.setFloat(\"_Min_Fuzz_\", this.minFuzz);\r\n        this._activeEffect.setFloat(\"_Clip_Fade_\", this.clipFade);\r\n\r\n        // \"View Based Color Shift\"\r\n        this._activeEffect.setFloat(\"_Hue_Shift_\", this.hueShift);\r\n        this._activeEffect.setFloat(\"_Saturation_Shift_\", this.saturationShift);\r\n        this._activeEffect.setFloat(\"_Value_Shift_\", this.valueShift);\r\n\r\n        // \"Blob\"\r\n        //define BLOB_ENABLE false;\r\n        this._activeEffect.setVector3(\"_Blob_Position_\", this.blobPosition);\r\n        this._activeEffect.setFloat(\"_Blob_Intensity_\", this.blobIntensity);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_\", this.blobNearSize);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Size_\", this.blobFarSize);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Distance_\", this.blobNearDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Distance_\", this.blobFarDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_Length_\", this.blobFadeLength);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_\", this.blobPulse);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_\", this.blobFade);\r\n\r\n        // \"Blob Texture\"\r\n        this._activeEffect.setTexture(\"_Blob_Texture_\", this.blobTexture);\r\n\r\n        // \"Blob 2\"\r\n        //define BLOB_ENABLE_2 true;\r\n        this._activeEffect.setVector3(\"_Blob_Position_2_\", this.blobPosition2);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_2_\", this.blobNearSize2);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_2_\", this.blobPulse2);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_2_\", this.blobFade2);\r\n\r\n        // \"Finger Positions\"\r\n        this._activeEffect.setVector3(\"_Left_Index_Pos_\", this.leftIndexPosition);\r\n        this._activeEffect.setVector3(\"_Right_Index_Pos_\", this.rightIndexPosition);\r\n        this._activeEffect.setVector3(\"_Left_Index_Middle_Pos_\", this.leftIndexMiddlePosition);\r\n        this._activeEffect.setVector3(\"_Right_Index_Middle_Pos_\", this.rightIndexMiddlePosition);\r\n\r\n        // \"Decal Texture\"\r\n        //define DECAL_ENABLE false;\r\n        this._activeEffect.setTexture(\"_Decal_\", this._decalTexture);\r\n        this._activeEffect.setVector2(\"_Decal_Scale_XY_\", this.decalScaleXY);\r\n        this._activeEffect.setFloat(\"_Decal_Front_Only_\", this.decalFrontOnly ? 1.0 : 0.0);\r\n\r\n        // \"Rim Light\"\r\n        this._activeEffect.setFloat(\"_Rim_Intensity_\", this.rimIntensity);\r\n        this._activeEffect.setTexture(\"_Rim_Texture_\", this._blueGradientTexture);\r\n        this._activeEffect.setFloat(\"_Rim_Hue_Shift_\", this.rimHueShift);\r\n        this._activeEffect.setFloat(\"_Rim_Saturation_Shift_\", this.rimSaturationShift);\r\n        this._activeEffect.setFloat(\"_Rim_Value_Shift_\", this.rimValueShift);\r\n\r\n        // \"Iridescence\"\r\n        //define IRIDESCENCE_ENABLED true;\r\n        this._activeEffect.setFloat(\"_Iridescence_Intensity_\", this.iridescenceIntensity);\r\n        this._activeEffect.setTexture(\"_Iridescence_Texture_\", this._blueGradientTexture);\r\n\r\n        // Global inputs\r\n        this._activeEffect.setFloat(\"Use_Global_Left_Index\", this.useGlobalLeftIndex);\r\n        this._activeEffect.setFloat(\"Use_Global_Right_Index\", this.useGlobalRightIndex);\r\n\r\n        this._activeEffect.setVector4(\"Global_Left_Index_Tip_Position\", this.globalLeftIndexTipPosition);\r\n        this._activeEffect.setVector4(\"Global_Right_Index_Tip_Position\", this.globaRightIndexTipPosition);\r\n\r\n        this._activeEffect.setVector4(\"Global_Left_Thumb_Tip_Position\", this.globalLeftThumbTipPosition);\r\n        this._activeEffect.setVector4(\"Global_Right_Thumb_Tip_Position\", this.globalRightThumbTipPosition);\r\n\r\n        this._activeEffect.setVector4(\"Global_Left_Index_Middle_Position\", this.globalLeftIndexMiddlePosition);\r\n        this._activeEffect.setVector4(\"Global_Right_Index_Middle_Position\", this.globalRightIndexMiddlePosition);\r\n\r\n        this._activeEffect.setFloat(\"Global_Left_Index_Tip_Proximity\", this.globalLeftIndexTipProximity);\r\n        this._activeEffect.setFloat(\"Global_Right_Index_Tip_Proximity\", this.globalRightIndexTipProximity);\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    /**\r\n     * Get the list of animatables in the material.\r\n     * @returns the list of animatables object used in the material\r\n     */\r\n    public getAnimatables(): IAnimatable[] {\r\n        return [];\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n        this._reflectionMapTexture.dispose();\r\n        this._indirectEnvTexture.dispose();\r\n        this._blueGradientTexture.dispose();\r\n        this._decalTexture.dispose();\r\n    }\r\n\r\n    public clone(name: string): MRDLSliderThumbMaterial {\r\n        return SerializationHelper.Clone(() => new MRDLSliderThumbMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.customType = \"BABYLON.MRDLSliderThumbMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"MRDLSliderThumbMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): MRDLSliderThumbMaterial {\r\n        return SerializationHelper.Parse(() => new MRDLSliderThumbMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.MRDLSliderThumbMaterial\", MRDLSliderThumbMaterial);\r\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport { SerializationHelper, serialize } from \"core/Misc/decorators\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport { Vector4 } from \"core/Maths/math.vector\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { Color4 } from \"core/Maths/math.color\";\r\nimport { EffectFallbacks } from \"core/Materials/effectFallbacks\";\r\nimport { Constants } from \"core/Engines/constants\";\r\n\r\nimport \"./shaders/mrdlBackplate.fragment\";\r\nimport \"./shaders/mrdlBackplate.vertex\";\r\n\r\n/** @internal */\r\nclass MRDLBackplateMaterialDefines extends MaterialDefines {\r\n    /*\r\n        \"IRIDESCENCE_ENABLE\", \"SMOOTH_EDGES\"\r\n    */\r\n    public IRIDESCENCE_ENABLE = true;\r\n    public SMOOTH_EDGES = true;\r\n\r\n    constructor() {\r\n        super();\r\n        this._needNormals = true;\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\n/**\r\n * Class used to render backplate material with MRDL\r\n */\r\nexport class MRDLBackplateMaterial extends PushMaterial {\r\n    /**\r\n     * URL pointing to the texture used to define the coloring for the Iridescent Map effect.\r\n     */\r\n    public static IRIDESCENT_MAP_TEXTURE_URL = \"https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-backplate-iridescence.png\";\r\n    private _iridescentMapTexture: Texture;\r\n\r\n    /**\r\n     * Gets or sets the corner radius on the backplate. If this value is changed, update the lineWidth to match.\r\n     */\r\n    @serialize()\r\n    public radius = 0.3;\r\n\r\n    /**\r\n     * Gets or sets the line width of the backplate.\r\n     */\r\n    @serialize()\r\n    public lineWidth = 0.003;\r\n\r\n    /**\r\n     * Gets or sets whether to use absolute sizes when calculating effects on the backplate.\r\n     * Since desktop and VR/AR have different relative sizes, it's usually best to keep this false.\r\n     */\r\n    @serialize()\r\n    public absoluteSizes = false;\r\n\r\n    /** @internal */\r\n    public _filterWidth = 1;\r\n\r\n    /**\r\n     * Gets or sets the base color of the backplate.\r\n     */\r\n    @serialize()\r\n    public baseColor = new Color4(0, 0, 0, 1);\r\n\r\n    /**\r\n     * Gets or sets the line color of the backplate.\r\n     */\r\n    @serialize()\r\n    public lineColor = new Color4(0.2, 0.262745, 0.4, 1);\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusTopLeft = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusTopRight = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusBottomLeft = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the top left Radii Multiplier.\r\n     */\r\n    @serialize()\r\n    public radiusBottomRight = 1.0;\r\n\r\n    /** @internal */\r\n    public _rate = 0;\r\n\r\n    /**\r\n     * Gets or sets the color of the highlights on the backplate line.\r\n     */\r\n    @serialize()\r\n    public highlightColor = new Color4(0.239216, 0.435294, 0.827451, 1);\r\n\r\n    /**\r\n     * Gets or sets the width of the highlights on the backplate line.\r\n     */\r\n    @serialize()\r\n    public highlightWidth = 0;\r\n\r\n    /** @internal */\r\n    public _highlightTransform = new Vector4(1, 1, 0, 0);\r\n\r\n    /** @internal */\r\n    public _highlight = 1;\r\n\r\n    /**\r\n     * Gets or sets the intensity of the iridescence effect.\r\n     */\r\n    @serialize()\r\n    public iridescenceIntensity = 0.45;\r\n\r\n    /**\r\n     * Gets or sets the intensity of the iridescence effect on the backplate edges.\r\n     */\r\n    @serialize()\r\n    public iridescenceEdgeIntensity = 1;\r\n\r\n    /**\r\n     * Gets or sets the Tint of the iridescence effect on the backplate.\r\n     */\r\n    @serialize()\r\n    public iridescenceTint = new Color4(1, 1, 1, 1);\r\n\r\n    /** @internal */\r\n    public _angle = -45;\r\n\r\n    /**\r\n     * Gets or sets the opacity of the backplate (0.0 - 1.0).\r\n     */\r\n    @serialize()\r\n    public fadeOut = 1;\r\n\r\n    /** @internal */\r\n    public _reflected = true;\r\n\r\n    /** @internal */\r\n    public _frequency = 1;\r\n\r\n    /** @internal */\r\n    public _verticalOffset = 0;\r\n\r\n    /**\r\n     * Gets or sets the gradient color effect on the backplate.\r\n     */\r\n    @serialize()\r\n    public gradientColor = new Color4(0.74902, 0.74902, 0.74902, 1);\r\n\r\n    /**\r\n     * Gets or sets the top left gradient color effect on the backplate.\r\n     */\r\n    @serialize()\r\n    public topLeftGradientColor = new Color4(0.00784314, 0.294118, 0.580392, 1);\r\n\r\n    /**\r\n     * Gets or sets the top right gradient color effect on the backplate.\r\n     */\r\n    @serialize()\r\n    public topRightGradientColor = new Color4(0.305882, 0, 1, 1);\r\n\r\n    /**\r\n     * Gets or sets the bottom left gradient color effect on the backplate.\r\n     */\r\n    @serialize()\r\n    public bottomLeftGradientColor = new Color4(0.133333, 0.258824, 0.992157, 1);\r\n\r\n    /**\r\n     * Gets or sets the bottom right gradient color effect on the backplate.\r\n     */\r\n    @serialize()\r\n    public bottomRightGradientColor = new Color4(0.176471, 0.176471, 0.619608, 1);\r\n\r\n    /**\r\n     * Gets or sets the edge width of the backplate.\r\n     */\r\n    @serialize()\r\n    public edgeWidth = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the edge width of the backplate.\r\n     */\r\n    @serialize()\r\n    public edgePower = 1;\r\n\r\n    /**\r\n     * Gets or sets the edge width of the backplate.\r\n     */\r\n    @serialize()\r\n    public edgeLineGradientBlend = 0.5;\r\n\r\n    constructor(name: string, scene?: Scene) {\r\n        super(name, scene);\r\n        this.alphaMode = Constants.ALPHA_DISABLE;\r\n        this.backFaceCulling = false;\r\n\r\n        this._iridescentMapTexture = new Texture(MRDLBackplateMaterial.IRIDESCENT_MAP_TEXTURE_URL, this.getScene(), true, false, Texture.NEAREST_SAMPLINGMODE);\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    // Methods\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new MRDLBackplateMaterialDefines();\r\n        }\r\n\r\n        const defines = <MRDLBackplateMaterialDefines>subMesh.materialDefines;\r\n        const scene = this.getScene();\r\n\r\n        if (this._isReadyForSubMesh(subMesh)) {\r\n            return true;\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n\r\n        // Attribs\r\n        MaterialHelper.PrepareDefinesForAttributes(mesh, defines, false, false);\r\n\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n\r\n            scene.resetCachedMaterial();\r\n\r\n            // Fallbacks\r\n            const fallbacks = new EffectFallbacks();\r\n            if (defines.FOG) {\r\n                fallbacks.addFallback(1, \"FOG\");\r\n            }\r\n\r\n            MaterialHelper.HandleFallbacksForShadows(defines, fallbacks);\r\n\r\n            defines.IMAGEPROCESSINGPOSTPROCESS = scene.imageProcessingConfiguration.applyByPostProcess;\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n\r\n            if (defines.NORMAL) {\r\n                attribs.push(VertexBuffer.NormalKind);\r\n            }\r\n\r\n            if (defines.UV1) {\r\n                attribs.push(VertexBuffer.UVKind);\r\n            }\r\n\r\n            if (defines.UV2) {\r\n                attribs.push(VertexBuffer.UV2Kind);\r\n            }\r\n\r\n            if (defines.VERTEXCOLOR) {\r\n                attribs.push(VertexBuffer.ColorKind);\r\n            }\r\n\r\n            if (defines.TANGENT) {\r\n                attribs.push(VertexBuffer.TangentKind);\r\n            }\r\n\r\n            MaterialHelper.PrepareAttributesForInstances(attribs, defines);\r\n\r\n            // Legacy browser patch\r\n            const shaderName = \"mrdlBackplate\";\r\n            const join = defines.toString();\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"viewProjection\",\r\n                \"cameraPosition\",\r\n                \"_Radius_\",\r\n                \"_Line_Width_\",\r\n                \"_Absolute_Sizes_\",\r\n                \"_Filter_Width_\",\r\n                \"_Base_Color_\",\r\n                \"_Line_Color_\",\r\n                \"_Radius_Top_Left_\",\r\n                \"_Radius_Top_Right_\",\r\n                \"_Radius_Bottom_Left_\",\r\n                \"_Radius_Bottom_Right_\",\r\n                \"_Rate_\",\r\n                \"_Highlight_Color_\",\r\n                \"_Highlight_Width_\",\r\n                \"_Highlight_Transform_\",\r\n                \"_Highlight_\",\r\n                \"_Iridescence_Intensity_\",\r\n                \"_Iridescence_Edge_Intensity_\",\r\n                \"_Iridescence_Tint_\",\r\n                \"_Iridescent_Map_\",\r\n                \"_Angle_\",\r\n                \"_Reflected_\",\r\n                \"_Frequency_\",\r\n                \"_Vertical_Offset_\",\r\n                \"_Gradient_Color_\",\r\n                \"_Top_Left_\",\r\n                \"_Top_Right_\",\r\n                \"_Bottom_Left_\",\r\n                \"_Bottom_Right_\",\r\n                \"_Edge_Width_\",\r\n                \"_Edge_Power_\",\r\n                \"_Line_Gradient_Blend_\",\r\n                \"_Fade_Out_\",\r\n            ];\r\n            const samplers: string[] = [\"_Iridescent_Map_\"];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: fallbacks,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines\r\n            );\r\n        }\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const defines = <MRDLBackplateMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", this.getScene().getTransformMatrix());\r\n        this._activeEffect.setVector3(\"cameraPosition\", this.getScene().activeCamera!.position);\r\n\r\n        // \"Round Rect\"\r\n        this._activeEffect.setFloat(\"_Radius_\", this.radius);\r\n        this._activeEffect.setFloat(\"_Line_Width_\", this.lineWidth);\r\n        this._activeEffect.setFloat(\"_Absolute_Sizes_\", this.absoluteSizes ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Filter_Width_\", this._filterWidth);\r\n        this._activeEffect.setDirectColor4(\"_Base_Color_\", this.baseColor);\r\n        this._activeEffect.setDirectColor4(\"_Line_Color_\", this.lineColor);\r\n\r\n        // \"Radii Multipliers\"\r\n        this._activeEffect.setFloat(\"_Radius_Top_Left_\", this.radiusTopLeft);\r\n        this._activeEffect.setFloat(\"_Radius_Top_Right_\", this.radiusTopRight);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Left_\", this.radiusBottomLeft);\r\n        this._activeEffect.setFloat(\"_Radius_Bottom_Right_\", this.radiusBottomRight);\r\n\r\n        // \"Line Highlight\"\r\n        this._activeEffect.setFloat(\"_Rate_\", this._rate);\r\n        this._activeEffect.setDirectColor4(\"_Highlight_Color_\", this.highlightColor);\r\n        this._activeEffect.setFloat(\"_Highlight_Width_\", this.highlightWidth);\r\n        this._activeEffect.setVector4(\"_Highlight_Transform_\", this._highlightTransform);\r\n        this._activeEffect.setFloat(\"_Highlight_\", this._highlight);\r\n\r\n        // \"Iridescence\"\r\n        //define IRIDESCENCE_ENABLE true;\r\n        this._activeEffect.setFloat(\"_Iridescence_Intensity_\", this.iridescenceIntensity);\r\n        this._activeEffect.setFloat(\"_Iridescence_Edge_Intensity_\", this.iridescenceEdgeIntensity);\r\n        this._activeEffect.setDirectColor4(\"_Iridescence_Tint_\", this.iridescenceTint);\r\n        this._activeEffect.setTexture(\"_Iridescent_Map_\", this._iridescentMapTexture);\r\n        this._activeEffect.setFloat(\"_Angle_\", this._angle);\r\n        this._activeEffect.setFloat(\"_Reflected_\", this._reflected ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Frequency_\", this._frequency);\r\n        this._activeEffect.setFloat(\"_Vertical_Offset_\", this._verticalOffset);\r\n\r\n        // \"Gradient\"\r\n        this._activeEffect.setDirectColor4(\"_Gradient_Color_\", this.gradientColor);\r\n        this._activeEffect.setDirectColor4(\"_Top_Left_\", this.topLeftGradientColor);\r\n        this._activeEffect.setDirectColor4(\"_Top_Right_\", this.topRightGradientColor);\r\n        this._activeEffect.setDirectColor4(\"_Bottom_Left_\", this.bottomLeftGradientColor);\r\n        this._activeEffect.setDirectColor4(\"_Bottom_Right_\", this.bottomRightGradientColor);\r\n        //define EDGE_ONLY false;\r\n        this._activeEffect.setFloat(\"_Edge_Width_\", this.edgeWidth);\r\n        this._activeEffect.setFloat(\"_Edge_Power_\", this.edgePower);\r\n        this._activeEffect.setFloat(\"_Line_Gradient_Blend_\", this.edgeLineGradientBlend);\r\n\r\n        // \"Fade\"\r\n        this._activeEffect.setFloat(\"_Fade_Out_\", this.fadeOut);\r\n\r\n        // \"Antialiasing\"\r\n        //define SMOOTH_EDGES true;\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    /**\r\n     * Get the list of animatables in the material.\r\n     * @returns the list of animatables object used in the material\r\n     */\r\n    public getAnimatables(): IAnimatable[] {\r\n        return [];\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n    }\r\n\r\n    public clone(name: string): MRDLBackplateMaterial {\r\n        return SerializationHelper.Clone(() => new MRDLBackplateMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.customType = \"BABYLON.MRDLBackplateMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"MRDLBackplateMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): MRDLBackplateMaterial {\r\n        return SerializationHelper.Parse(() => new MRDLBackplateMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.MRDLBackplateMaterial\", MRDLBackplateMaterial);\r\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { Scene } from \"core/scene\";\r\nimport { Control3D } from \"./control3D\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport { PointerDragBehavior } from \"core/Behaviors/Meshes/pointerDragBehavior\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { SceneLoader } from \"core/Loading/sceneLoader\";\r\nimport { MRDLSliderBarMaterial } from \"../materials/mrdl/mrdlSliderBarMaterial\";\r\nimport { MRDLSliderThumbMaterial } from \"../materials/mrdl/mrdlSliderThumbMaterial\";\r\nimport { MRDLBackplateMaterial } from \"../materials/mrdl/mrdlBackplateMaterial\";\r\n\r\nconst SLIDER_MIN: number = 0;\r\nconst SLIDER_MAX: number = 100;\r\nconst SLIDER_VAL: number = 50;\r\nconst SLIDER_STEP: number = 0;\r\nconst SLIDER_SCALING: number = 1.0;\r\nconst SLIDER_MARGIN: number = 0.2;\r\n\r\n/**\r\n * Class used to create a slider in 3D\r\n */\r\nexport class Slider3D extends Control3D {\r\n    /**\r\n     * Base Url for the models.\r\n     */\r\n    public static MODEL_BASE_URL: string = \"https://assets.babylonjs.com/meshes/MRTK/\";\r\n\r\n    /**\r\n     * File name for the 8x4 model.\r\n     */\r\n    public static MODEL_FILENAME: string = \"mrtk-fluent-backplate.glb\";\r\n\r\n    private _sliderBackplate: AbstractMesh;\r\n    private _sliderBackplateMaterial: MRDLBackplateMaterial;\r\n    private _sliderBarMaterial: MRDLSliderBarMaterial;\r\n    private _sliderThumbMaterial: MRDLSliderThumbMaterial;\r\n    private _sliderThumb: AbstractMesh;\r\n    private _sliderBar: AbstractMesh;\r\n    private _sliderBackplateVisible: boolean;\r\n\r\n    private _minimum: number;\r\n    private _maximum: number;\r\n    private _value: number;\r\n    private _step: number;\r\n\r\n    private _draggedPosition: number;\r\n\r\n    /** Observable raised when the sldier value changes */\r\n    public onValueChangedObservable = new Observable<number>();\r\n\r\n    /**\r\n     * Creates a new slider\r\n     * @param name defines the control name\r\n     * @param sliderBackplateVisible defines if the control has a backplate, default is false\r\n     */\r\n    constructor(name?: string, sliderBackplateVisible?: boolean) {\r\n        super(name);\r\n        this._sliderBackplateVisible = sliderBackplateVisible || false;\r\n\r\n        this._minimum = SLIDER_MIN;\r\n        this._maximum = SLIDER_MAX;\r\n        this._step = SLIDER_STEP;\r\n        this._value = SLIDER_VAL;\r\n    }\r\n\r\n    /**\r\n     * Gets the mesh used to render this control\r\n     */\r\n    public get mesh(): Nullable<AbstractMesh> {\r\n        if (this.node) {\r\n            return this._sliderThumb;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /** Gets or sets minimum value */\r\n    public get minimum(): number {\r\n        return this._minimum;\r\n    }\r\n\r\n    public set minimum(value: number) {\r\n        if (this._minimum === value) {\r\n            return;\r\n        }\r\n\r\n        this._minimum = Math.max(value, SLIDER_MIN);\r\n        this._value = Math.max(Math.min(this._value, this._maximum), this._minimum);\r\n    }\r\n\r\n    /** Gets or sets maximum value */\r\n    public get maximum(): number {\r\n        return this._maximum;\r\n    }\r\n\r\n    public set maximum(value: number) {\r\n        if (this._maximum === value) {\r\n            return;\r\n        }\r\n\r\n        this._maximum = Math.max(value, this._minimum);\r\n        this._value = Math.max(Math.min(this._value, this._maximum), this._minimum);\r\n    }\r\n\r\n    /** Gets or sets step value */\r\n    public get step(): number {\r\n        return this._step;\r\n    }\r\n\r\n    public set step(value: number) {\r\n        if (this._step === value) {\r\n            return;\r\n        }\r\n\r\n        this._step = Math.max(Math.min(value, this._maximum - this._minimum), SLIDER_STEP);\r\n    }\r\n\r\n    /** Gets or sets current value */\r\n    public get value(): number {\r\n        return this._value;\r\n    }\r\n\r\n    public set value(value: number) {\r\n        if (this._value === value) {\r\n            return;\r\n        }\r\n\r\n        this._value = Math.max(Math.min(value, this._maximum), this._minimum);\r\n        if (this._sliderThumb) {\r\n            this._sliderThumb.position.x = this._convertToPosition(this.value);\r\n        }\r\n        this.onValueChangedObservable.notifyObservers(this._value);\r\n    }\r\n\r\n    protected get start(): number {\r\n        if (!this.node) {\r\n            return -SLIDER_SCALING / 2;\r\n        }\r\n\r\n        return this._sliderBar.position.x - this._sliderBar.scaling.x / 2;\r\n    }\r\n\r\n    protected get end(): number {\r\n        if (!this.node) {\r\n            return SLIDER_SCALING / 2;\r\n        }\r\n\r\n        return this._sliderBar.position.x + this._sliderBar.scaling.x / 2;\r\n    }\r\n\r\n    /**\r\n     * Gets the slider bar material used by this control\r\n     */\r\n    public get sliderBarMaterial(): MRDLSliderBarMaterial {\r\n        return this._sliderBarMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the slider thumb material used by this control\r\n     */\r\n    public get sliderThumbMaterial(): MRDLSliderThumbMaterial {\r\n        return this._sliderThumbMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the slider backplate material used by this control\r\n     */\r\n    public get sliderBackplateMaterial(): MRDLBackplateMaterial {\r\n        return this._sliderBackplateMaterial;\r\n    }\r\n\r\n    /** Sets a boolean indicating if the control is visible */\r\n    public set isVisible(value: boolean) {\r\n        if (this._isVisible === value) {\r\n            return;\r\n        }\r\n\r\n        this._isVisible = value;\r\n\r\n        this.node?.setEnabled(value);\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        const sliderBackplate = CreateBox(\r\n            `${this.name}_sliderbackplate`,\r\n            {\r\n                width: 1.0,\r\n                height: 1.0,\r\n                depth: 1.0,\r\n            },\r\n            scene\r\n        );\r\n        sliderBackplate.isPickable = false;\r\n        sliderBackplate.visibility = 0;\r\n        sliderBackplate.scaling = new Vector3(1, 0.5, 0.8);\r\n\r\n        SceneLoader.ImportMeshAsync(undefined, Slider3D.MODEL_BASE_URL, Slider3D.MODEL_FILENAME, scene).then((result) => {\r\n            // make all meshes not pickable. Required meshes' pickable state will be set later.\r\n            result.meshes.forEach((m) => {\r\n                m.isPickable = false;\r\n            });\r\n            const sliderBackplateModel = result.meshes[1];\r\n            const sliderBarModel = result.meshes[1].clone(`${this.name}_sliderbar`, sliderBackplate);\r\n            const sliderThumbModel = result.meshes[1].clone(`${this.name}_sliderthumb`, sliderBackplate);\r\n            sliderBackplateModel.visibility = 0;\r\n\r\n            if (this._sliderBackplateVisible) {\r\n                sliderBackplateModel.visibility = 1;\r\n                sliderBackplateModel.name = `${this.name}_sliderbackplate`;\r\n                sliderBackplateModel.scaling.x = 1;\r\n                sliderBackplateModel.scaling.z = 0.2;\r\n                sliderBackplateModel.parent = sliderBackplate;\r\n                if (this._sliderBackplateMaterial) {\r\n                    sliderBackplateModel.material = this._sliderBackplateMaterial;\r\n                }\r\n                this._sliderBackplate = sliderBackplateModel;\r\n            }\r\n\r\n            if (sliderBarModel) {\r\n                sliderBarModel.parent = sliderBackplate;\r\n                sliderBarModel.position.z = -0.1;\r\n                sliderBarModel.scaling = new Vector3(SLIDER_SCALING - SLIDER_MARGIN, 0.04, 0.3);\r\n                if (this._sliderBarMaterial) {\r\n                    sliderBarModel.material = this._sliderBarMaterial;\r\n                }\r\n                this._sliderBar = sliderBarModel;\r\n            }\r\n\r\n            if (sliderThumbModel) {\r\n                sliderThumbModel.parent = sliderBackplate;\r\n                sliderThumbModel.isPickable = true;\r\n                sliderThumbModel.position.z = -0.115;\r\n                sliderThumbModel.scaling = new Vector3(0.025, 0.3, 0.6);\r\n                sliderThumbModel.position.x = this._convertToPosition(this.value);\r\n                sliderThumbModel.addBehavior(this._createBehavior());\r\n                if (this._sliderThumbMaterial) {\r\n                    sliderThumbModel.material = this._sliderThumbMaterial;\r\n                }\r\n                this._sliderThumb = sliderThumbModel;\r\n            }\r\n\r\n            this._injectGUI3DReservedDataStore(sliderBackplate).control = this;\r\n            sliderBackplate.getChildMeshes().forEach((mesh) => {\r\n                this._injectGUI3DReservedDataStore(mesh).control = this;\r\n            });\r\n        });\r\n\r\n        this._affectMaterial(sliderBackplate);\r\n        return sliderBackplate;\r\n    }\r\n\r\n    protected _affectMaterial(mesh: AbstractMesh) {\r\n        this._sliderBackplateMaterial = this._sliderBackplateMaterial ?? new MRDLBackplateMaterial(`${this.name}_sliderbackplate_material`, mesh.getScene());\r\n        this._sliderBarMaterial = this._sliderBarMaterial ?? new MRDLSliderBarMaterial(`${this.name}_sliderbar_material`, mesh.getScene());\r\n        this._sliderThumbMaterial = this._sliderThumbMaterial ?? new MRDLSliderThumbMaterial(`${this.name}_sliderthumb_material`, mesh.getScene());\r\n    }\r\n\r\n    private _createBehavior(): PointerDragBehavior {\r\n        const pointerDragBehavior = new PointerDragBehavior({ dragAxis: Vector3.Right() });\r\n        pointerDragBehavior.moveAttached = false;\r\n\r\n        pointerDragBehavior.onDragStartObservable.add(() => {\r\n            this._draggedPosition = this._sliderThumb.position.x;\r\n        });\r\n\r\n        pointerDragBehavior.onDragObservable.add((event) => {\r\n            this._draggedPosition += event.dragDistance / this.scaling.x;\r\n            this.value = this._convertToValue(this._draggedPosition);\r\n        });\r\n\r\n        return pointerDragBehavior;\r\n    }\r\n\r\n    private _convertToPosition(value: number): number {\r\n        const position = ((value - this.minimum) / (this.maximum - this.minimum)) * (this.end - this.start) + this.start;\r\n        return Math.min(Math.max(position, this.start), this.end);\r\n    }\r\n\r\n    private _convertToValue(position: number): number {\r\n        let value = ((position - this.start) / (this.end - this.start)) * (this.maximum - this.minimum);\r\n        value = this.step ? Math.round(value / this.step) * this.step : value;\r\n\r\n        return Math.max(Math.min(this.minimum + value, this._maximum), this._minimum);\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose();\r\n        this._sliderBar?.dispose();\r\n        this._sliderThumb?.dispose();\r\n        this._sliderBarMaterial?.dispose();\r\n        this._sliderThumbMaterial?.dispose();\r\n        this._sliderBackplate?.dispose();\r\n        this._sliderBackplateMaterial?.dispose();\r\n    }\r\n}\r\n","import { Tools } from \"core/Misc/tools\";\r\nimport { Matrix, TmpVectors, Vector3 } from \"core/Maths/math.vector\";\r\nimport type { float } from \"core/types\";\r\n\r\nimport { VolumeBasedPanel } from \"./volumeBasedPanel\";\r\nimport type { Control3D } from \"./control3D\";\r\nimport { Container3D } from \"./container3D\";\r\nimport { Axis, Space } from \"core/Maths/math.axis\";\r\n\r\n/**\r\n * Class used to create a container panel deployed on the surface of a sphere\r\n */\r\nexport class SpherePanel extends VolumeBasedPanel {\r\n    private _radius = 5.0;\r\n\r\n    /**\r\n     * Gets or sets the radius of the sphere where to project controls (5 by default)\r\n     */\r\n    public get radius(): float {\r\n        return this._radius;\r\n    }\r\n\r\n    public set radius(value: float) {\r\n        if (this._radius === value) {\r\n            return;\r\n        }\r\n\r\n        this._radius = value;\r\n\r\n        Tools.SetImmediate(() => {\r\n            this._arrangeChildren();\r\n        });\r\n    }\r\n\r\n    protected _mapGridNode(control: Control3D, nodePosition: Vector3) {\r\n        const mesh = control.mesh;\r\n\r\n        if (!mesh) {\r\n            return;\r\n        }\r\n\r\n        const newPos = this._sphericalMapping(nodePosition);\r\n        control.position = newPos;\r\n\r\n        switch (this.orientation) {\r\n            case Container3D.FACEORIGIN_ORIENTATION:\r\n                mesh.lookAt(new Vector3(2 * newPos.x, 2 * newPos.y, 2 * newPos.z));\r\n                break;\r\n            case Container3D.FACEORIGINREVERSED_ORIENTATION:\r\n                mesh.lookAt(new Vector3(-newPos.x, -newPos.y, -newPos.z));\r\n                break;\r\n            case Container3D.FACEFORWARD_ORIENTATION:\r\n                break;\r\n            case Container3D.FACEFORWARDREVERSED_ORIENTATION:\r\n                mesh.rotate(Axis.Y, Math.PI, Space.LOCAL);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private _sphericalMapping(source: Vector3) {\r\n        const newPos = new Vector3(0, 0, this._radius);\r\n\r\n        const xAngle = source.y / this._radius;\r\n        const yAngle = -(source.x / this._radius);\r\n\r\n        Matrix.RotationYawPitchRollToRef(yAngle, xAngle, 0, TmpVectors.Matrix[0]);\r\n\r\n        return Vector3.TransformNormal(newPos, TmpVectors.Matrix[0]);\r\n    }\r\n}\r\n","import { Tools } from \"core/Misc/tools\";\r\nimport { Matrix, TmpVectors, Vector3 } from \"core/Maths/math.vector\";\r\n\r\nimport { Container3D } from \"./container3D\";\r\n\r\n/**\r\n * Class used to create a stack panel in 3D on XY plane\r\n */\r\nexport class StackPanel3D extends Container3D {\r\n    private _isVertical = false;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating if the stack panel is vertical or horizontal (horizontal by default)\r\n     */\r\n    public get isVertical(): boolean {\r\n        return this._isVertical;\r\n    }\r\n\r\n    public set isVertical(value: boolean) {\r\n        if (this._isVertical === value) {\r\n            return;\r\n        }\r\n\r\n        this._isVertical = value;\r\n\r\n        Tools.SetImmediate(() => {\r\n            this._arrangeChildren();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the distance between elements\r\n     */\r\n    public margin = 0.1;\r\n\r\n    /**\r\n     * Creates new StackPanel\r\n     * @param isVertical\r\n     */\r\n    public constructor(isVertical = false) {\r\n        super();\r\n\r\n        this._isVertical = isVertical;\r\n    }\r\n\r\n    protected _arrangeChildren() {\r\n        let width = 0;\r\n        let height = 0;\r\n        let controlCount = 0;\r\n        const extendSizes = [];\r\n\r\n        const currentInverseWorld = Matrix.Invert(this.node!.computeWorldMatrix(true));\r\n\r\n        // Measure\r\n        for (const child of this._children) {\r\n            if (!child.mesh) {\r\n                continue;\r\n            }\r\n\r\n            controlCount++;\r\n            child.mesh.computeWorldMatrix(true);\r\n            child.mesh.getWorldMatrix().multiplyToRef(currentInverseWorld, TmpVectors.Matrix[0]);\r\n\r\n            const boundingBox = child.mesh.getBoundingInfo().boundingBox;\r\n            const extendSize = Vector3.TransformNormal(boundingBox.extendSize, TmpVectors.Matrix[0]);\r\n            extendSizes.push(extendSize);\r\n\r\n            if (this._isVertical) {\r\n                height += extendSize.y;\r\n            } else {\r\n                width += extendSize.x;\r\n            }\r\n        }\r\n\r\n        if (this._isVertical) {\r\n            height += ((controlCount - 1) * this.margin) / 2;\r\n        } else {\r\n            width += ((controlCount - 1) * this.margin) / 2;\r\n        }\r\n\r\n        // Arrange\r\n        let offset: number;\r\n        if (this._isVertical) {\r\n            offset = -height;\r\n        } else {\r\n            offset = -width;\r\n        }\r\n\r\n        let index = 0;\r\n        for (const child of this._children) {\r\n            if (!child.mesh) {\r\n                continue;\r\n            }\r\n            controlCount--;\r\n            const extendSize = extendSizes[index++];\r\n\r\n            if (this._isVertical) {\r\n                child.position.y = offset + extendSize.y;\r\n                child.position.x = 0;\r\n                offset += extendSize.y * 2;\r\n            } else {\r\n                child.position.x = offset + extendSize.x;\r\n                child.position.y = 0;\r\n                offset += extendSize.x * 2;\r\n            }\r\n\r\n            offset += controlCount > 0 ? this.margin : 0;\r\n        }\r\n    }\r\n}\r\n","import type { TransformNode } from \"core/Meshes/transformNode\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\n\r\nimport { TouchButton3D } from \"./touchButton3D\";\r\n\r\n/**\r\n * Class used to create an interactable object. It's a touchable 3D button using a mesh coming from the current scene\r\n * @since 5.0.0\r\n */\r\nexport class TouchMeshButton3D extends TouchButton3D {\r\n    /** @internal */\r\n    protected _currentMesh: Mesh;\r\n\r\n    /**\r\n     * Creates a new 3D button based on a mesh\r\n     * @param mesh mesh to become a 3D button. By default this is also the mesh for near interaction collision checking\r\n     * @param name defines the control name\r\n     */\r\n    constructor(mesh: Mesh, name?: string) {\r\n        super(name, mesh);\r\n\r\n        this._currentMesh = mesh;\r\n\r\n        /**\r\n         * Provides a default behavior on hover/out & up/down\r\n         * Override those function to create your own desired behavior specific to your mesh\r\n         */\r\n        this.pointerEnterAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(1.1);\r\n        };\r\n\r\n        this.pointerOutAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(1.0 / 1.1);\r\n        };\r\n\r\n        this.pointerDownAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(0.95);\r\n        };\r\n\r\n        this.pointerUpAnimation = () => {\r\n            if (!this.mesh) {\r\n                return;\r\n            }\r\n            this.mesh.scaling.scaleInPlace(1.0 / 0.95);\r\n        };\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"TouchMeshButton3D\";\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(): TransformNode {\r\n        this._currentMesh.getChildMeshes().forEach((mesh) => {\r\n            this._injectGUI3DReservedDataStore(mesh).control = this;\r\n        });\r\n\r\n        return this._currentMesh;\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    protected _affectMaterial(mesh: AbstractMesh) {}\r\n}\r\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"mrdlBackglowPixelShader\";\nconst shader = `uniform vec3 cameraPosition;\rvarying vec3 vNormal;\rvarying vec2 vUV;\runiform float _Bevel_Radius_;\runiform float _Line_Width_;\runiform bool _Absolute_Sizes_;\runiform float _Tuning_Motion_;\runiform float _Motion_;\runiform float _Max_Intensity_;\runiform float _Intensity_Fade_In_Exponent_;\runiform float _Outer_Fuzz_Start_;\runiform float _Outer_Fuzz_End_;\runiform vec4 _Color_;\runiform vec4 _Inner_Color_;\runiform float _Blend_Exponent_;\runiform float _Falloff_;\runiform float _Bias_;\rfloat BiasFunc(float b,float v) {\rreturn pow(v,log(clamp(b,0.001,0.999))/log(0.5));\r}\rvoid Fuzzy_Round_Rect_B33(\rfloat Size_X,\rfloat Size_Y,\rfloat Radius_X,\rfloat Radius_Y,\rfloat Line_Width,\rvec2 UV,\rfloat Outer_Fuzz,\rfloat Max_Outer_Fuzz,\rout float Rect_Distance,\rout float Inner_Distance)\r{\rvec2 halfSize=vec2(Size_X,Size_Y)*0.5;\rvec2 r=max(min(vec2(Radius_X,Radius_Y),halfSize),vec2(0.001,0.001));\rfloat radius=min(r.x,r.y)-Max_Outer_Fuzz;\rvec2 v=abs(UV);\rvec2 nearestp=min(v,halfSize-r);\rfloat d=distance(nearestp,v);\rInner_Distance=clamp(1.0-(radius-d)/Line_Width,0.0,1.0);\rRect_Distance=clamp(1.0-(d-radius)/Outer_Fuzz,0.0,1.0)*Inner_Distance;\r}\rvoid main()\r{\rfloat X_Q42;\rfloat Y_Q42;\rX_Q42=vNormal.x;\rY_Q42=vNormal.y;\rfloat MaxAB_Q24=max(_Tuning_Motion_,_Motion_);\rfloat Sqrt_F_Q27=sqrt(MaxAB_Q24);\rfloat Power_Q43=pow(MaxAB_Q24,_Intensity_Fade_In_Exponent_);\rfloat Value_At_T_Q26=mix(_Outer_Fuzz_Start_,_Outer_Fuzz_End_,Sqrt_F_Q27);\rfloat Product_Q23=_Max_Intensity_*Power_Q43;\rfloat Rect_Distance_Q33;\rfloat Inner_Distance_Q33;\rFuzzy_Round_Rect_B33(X_Q42,Y_Q42,_Bevel_Radius_,_Bevel_Radius_,_Line_Width_,vUV,Value_At_T_Q26,_Outer_Fuzz_Start_,Rect_Distance_Q33,Inner_Distance_Q33);\rfloat Power_Q44=pow(Inner_Distance_Q33,_Blend_Exponent_);\rfloat Result_Q45=pow(BiasFunc(_Bias_,Rect_Distance_Q33),_Falloff_);\rvec4 Color_At_T_Q25=mix(_Inner_Color_,_Color_,Power_Q44);\rfloat Product_Q22=Result_Q45*Product_Q23;\rvec4 Result_Q28=Product_Q22*Color_At_T_Q25;\rvec4 Out_Color=Result_Q28;\rfloat Clip_Threshold=0.0;\rgl_FragColor=Out_Color;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const mrdlBackglowPixelShader = { name, shader };\n","// Do not edit.\nimport { ShaderStore } from \"core/Engines/shaderStore\";\n\nconst name = \"mrdlBackglowVertexShader\";\nconst shader = `uniform mat4 world;\runiform mat4 viewProjection;\runiform vec3 cameraPosition;\rattribute vec3 position;\rattribute vec3 normal;\rattribute vec2 uv;\rattribute vec3 tangent;\runiform float _Bevel_Radius_;\runiform float _Line_Width_;\runiform bool _Absolute_Sizes_;\runiform float _Tuning_Motion_;\runiform float _Motion_;\runiform float _Max_Intensity_;\runiform float _Intensity_Fade_In_Exponent_;\runiform float _Outer_Fuzz_Start_;\runiform float _Outer_Fuzz_End_;\runiform vec4 _Color_;\runiform vec4 _Inner_Color_;\runiform float _Blend_Exponent_;\runiform float _Falloff_;\runiform float _Bias_;\rvarying vec3 vNormal;\rvarying vec2 vUV;\rvoid main()\r{\rvec3 Dir_World_Q41=(world*vec4(tangent,0.0)).xyz;\rvec3 Dir_World_Q40=(world*vec4((cross(normal,tangent)),0.0)).xyz;\rfloat MaxAB_Q24=max(_Tuning_Motion_,_Motion_);\rfloat Length_Q16=length(Dir_World_Q41);\rfloat Length_Q17=length(Dir_World_Q40);\rbool Greater_Than_Q37=MaxAB_Q24>0.0;\rvec3 Sizes_Q35;\rvec2 XY_Q35;\rSizes_Q35=(_Absolute_Sizes_ ? vec3(Length_Q16,Length_Q17,0) : vec3(Length_Q16/Length_Q17,1,0));\rXY_Q35=(uv-vec2(0.5,0.5))*Sizes_Q35.xy;\rvec3 Result_Q38=Greater_Than_Q37 ? position : vec3(0,0,0);\rvec3 Pos_World_Q39=(world*vec4(Result_Q38,1.0)).xyz;\rvec3 Position=Pos_World_Q39;\rvec3 Normal=Sizes_Q35;\rvec2 UV=XY_Q35;\rvec3 Tangent=vec3(0,0,0);\rvec3 Binormal=vec3(0,0,0);\rvec4 Color=vec4(1,1,1,1);\rgl_Position=viewProjection*vec4(Position,1);\rvNormal=Normal;\rvUV=UV;\r}`;\n// Sideeffect\nShaderStore.ShadersStore[name] = shader;\n/** @internal */\nexport const mrdlBackglowVertexShader = { name, shader };\n","import type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Scene } from \"core/scene\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\n\r\nimport { Color4 } from \"core/Maths/math.color\";\r\nimport { Constants } from \"core/Engines/constants\";\r\nimport { EffectFallbacks } from \"core/Materials/effectFallbacks\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { SerializationHelper, serialize } from \"core/Misc/decorators\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\n\r\nimport \"./shaders/mrdlBackglow.fragment\";\r\nimport \"./shaders/mrdlBackglow.vertex\";\r\n\r\n/** @hidden */\r\nclass MRDLBackglowMaterialDefines extends MaterialDefines {\r\n    constructor() {\r\n        super();\r\n        this._needNormals = true;\r\n        this._needUVs = true;\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\nexport class MRDLBackglowMaterial extends PushMaterial {\r\n    /**\r\n     * Gets or sets the bevel radius on the backglow. If this value is changed, update the lineWidth to match.\r\n     */\r\n    @serialize()\r\n    public bevelRadius = 0.16;\r\n\r\n    /**\r\n     * Gets or sets the line width of the backglow.\r\n     */\r\n    @serialize()\r\n    public lineWidth = 0.16;\r\n\r\n    /**\r\n     * Gets or sets whether to use absolute sizes when calculating effects on the backglow.\r\n     * Since desktop and VR/AR have different relative sizes, it's usually best to keep this false.\r\n     */\r\n    @serialize()\r\n    public absoluteSizes = false;\r\n\r\n    /**\r\n     * Gets or sets the tuning motion of the backglow.\r\n     */\r\n    @serialize()\r\n    public tuningMotion = 0.0;\r\n\r\n    /**\r\n     * Gets or sets the motion of the backglow.\r\n     */\r\n    @serialize()\r\n    public motion = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the maximum intensity of the backglow.\r\n     */\r\n    @serialize()\r\n    public maxIntensity = 0.7;\r\n\r\n    /**\r\n     * Gets or sets the fade-in exponent of the intensity of the backglow.\r\n     */\r\n    @serialize()\r\n    public intensityFadeInExponent = 2.0;\r\n\r\n    /**\r\n     * Gets or sets the start of the outer fuzz effect on the backglow.\r\n     */\r\n    @serialize()\r\n    public outerFuzzStart = 0.04;\r\n\r\n    /**\r\n     * Gets or sets the end of the outer fuzz effect on the backglow.\r\n     */\r\n    @serialize()\r\n    public outerFuzzEnd = 0.04;\r\n\r\n    /**\r\n     * Gets or sets the color of the backglow.\r\n     */\r\n    @serialize()\r\n    public color: Color4 = new Color4(0.682353, 0.698039, 1, 1);\r\n\r\n    /**\r\n     * Gets or sets the inner color of the backglow.\r\n     */\r\n    @serialize()\r\n    public innerColor: Color4 = new Color4(0.356863, 0.392157, 0.796078, 1);\r\n\r\n    /**\r\n     * Gets or sets the blend exponent of the backglow.\r\n     */\r\n    @serialize()\r\n    public blendExponent = 1.5;\r\n\r\n    /**\r\n     * Gets or sets the falloff of the backglow.\r\n     */\r\n    @serialize()\r\n    public falloff = 2.0;\r\n\r\n    /**\r\n     * Gets or sets the bias of the backglow.\r\n     */\r\n    @serialize()\r\n    public bias = 0.5;\r\n\r\n    constructor(name: string, scene: Scene) {\r\n        super(name, scene);\r\n        this.alphaMode = Constants.ALPHA_ADD;\r\n        this.disableDepthWrite = true;\r\n        this.backFaceCulling = false;\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    // Methods\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new MRDLBackglowMaterialDefines();\r\n        }\r\n\r\n        const defines = <MRDLBackglowMaterialDefines>subMesh.materialDefines;\r\n        const scene = this.getScene();\r\n\r\n        if (this._isReadyForSubMesh(subMesh)) {\r\n            return true;\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n\r\n        // Attribs\r\n        MaterialHelper.PrepareDefinesForAttributes(mesh, defines, false, false);\r\n\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n\r\n            scene.resetCachedMaterial();\r\n\r\n            // Fallbacks\r\n            const fallbacks = new EffectFallbacks();\r\n            if (defines.FOG) {\r\n                fallbacks.addFallback(1, \"FOG\");\r\n            }\r\n\r\n            MaterialHelper.HandleFallbacksForShadows(defines, fallbacks);\r\n\r\n            defines.IMAGEPROCESSINGPOSTPROCESS = scene.imageProcessingConfiguration.applyByPostProcess;\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n\r\n            if (defines.NORMAL) {\r\n                attribs.push(VertexBuffer.NormalKind);\r\n            }\r\n\r\n            if (defines.UV1) {\r\n                attribs.push(VertexBuffer.UVKind);\r\n            }\r\n\r\n            if (defines.UV2) {\r\n                attribs.push(VertexBuffer.UV2Kind);\r\n            }\r\n\r\n            if (defines.VERTEXCOLOR) {\r\n                attribs.push(VertexBuffer.ColorKind);\r\n            }\r\n\r\n            if (defines.TANGENT) {\r\n                attribs.push(VertexBuffer.TangentKind);\r\n            }\r\n\r\n            MaterialHelper.PrepareAttributesForInstances(attribs, defines);\r\n\r\n            // Legacy browser patch\r\n            const shaderName = \"mrdlBackglow\";\r\n            const join = defines.toString();\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"worldView\",\r\n                \"worldViewProjection\",\r\n                \"view\",\r\n                \"projection\",\r\n                \"viewProjection\",\r\n                \"cameraPosition\",\r\n                \"_Bevel_Radius_\",\r\n                \"_Line_Width_\",\r\n                \"_Absolute_Sizes_\",\r\n                \"_Tuning_Motion_\",\r\n                \"_Motion_\",\r\n                \"_Max_Intensity_\",\r\n                \"_Intensity_Fade_In_Exponent_\",\r\n                \"_Outer_Fuzz_Start_\",\r\n                \"_Outer_Fuzz_End_\",\r\n                \"_Color_\",\r\n                \"_Inner_Color_\",\r\n                \"_Blend_Exponent_\",\r\n                \"_Falloff_\",\r\n                \"_Bias_\",\r\n            ];\r\n            const samplers: string[] = [];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: fallbacks,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines\r\n            );\r\n        }\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const scene = this.getScene();\r\n\r\n        const defines = <MRDLBackglowMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", scene.getTransformMatrix());\r\n        this._activeEffect.setVector3(\"cameraPosition\", scene.activeCamera!.position);\r\n\r\n        // \"Rounded Rectangle\"\r\n        this._activeEffect.setFloat(\"_Bevel_Radius_\", this.bevelRadius);\r\n        this._activeEffect.setFloat(\"_Line_Width_\", this.lineWidth);\r\n        this._activeEffect.setFloat(\"_Absolute_Sizes_\", this.absoluteSizes ? 1.0 : 0.0);\r\n\r\n        // \"Animation\"\r\n        this._activeEffect.setFloat(\"_Tuning_Motion_\", this.tuningMotion);\r\n        this._activeEffect.setFloat(\"_Motion_\", this.motion);\r\n        this._activeEffect.setFloat(\"_Max_Intensity_\", this.maxIntensity);\r\n        this._activeEffect.setFloat(\"_Intensity_Fade_In_Exponent_\", this.intensityFadeInExponent);\r\n        this._activeEffect.setFloat(\"_Outer_Fuzz_Start_\", this.outerFuzzStart);\r\n        this._activeEffect.setFloat(\"_Outer_Fuzz_End_\", this.outerFuzzEnd);\r\n\r\n        // \"Color\"\r\n        this._activeEffect.setDirectColor4(\"_Color_\", this.color);\r\n        this._activeEffect.setDirectColor4(\"_Inner_Color_\", this.innerColor);\r\n        this._activeEffect.setFloat(\"_Blend_Exponent_\", this.blendExponent);\r\n\r\n        // \"Inner Transition\"\r\n        this._activeEffect.setFloat(\"_Falloff_\", this.falloff);\r\n        this._activeEffect.setFloat(\"_Bias_\", this.bias);\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    /**\r\n     * Get the list of animatables in the material.\r\n     * @returns the list of animatables object used in the material\r\n     */\r\n    public getAnimatables(): IAnimatable[] {\r\n        return [];\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n    }\r\n\r\n    public clone(name: string): MRDLBackglowMaterial {\r\n        return SerializationHelper.Clone(() => new MRDLBackglowMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): unknown {\r\n        const serializationObject = SerializationHelper.Serialize(this);\r\n        serializationObject.customType = \"BABYLON.MRDLBackglowMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"MRDLBackglowMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): MRDLBackglowMaterial {\r\n        return SerializationHelper.Parse(() => new MRDLBackglowMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.MRDLBackglowMaterial\", MRDLBackglowMaterial);\r\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { BaseTexture } from \"core/Materials/Textures/baseTexture\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { IEffectCreationOptions } from \"core/Materials/effect\";\r\nimport type { Matrix } from \"core/Maths/math.vector\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Scene } from \"core/scene\";\r\nimport type { SubMesh } from \"core/Meshes/subMesh\";\r\n\r\nimport { Color4 } from \"core/Maths/math.color\";\r\nimport { Constants } from \"core/Engines/constants\";\r\nimport { EffectFallbacks } from \"core/Materials/effectFallbacks\";\r\nimport { MaterialDefines } from \"core/Materials/materialDefines\";\r\nimport { MaterialHelper } from \"core/Materials/materialHelper\";\r\nimport { PushMaterial } from \"core/Materials/pushMaterial\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { SerializationHelper, serialize } from \"core/Misc/decorators\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport { VertexBuffer } from \"core/Buffers/buffer\";\r\nimport { Texture } from \"core/Materials/Textures/texture\";\r\n\r\nimport \"./shaders/mrdlFrontplate.fragment\";\r\nimport \"./shaders/mrdlFrontplate.vertex\";\r\n\r\n/** @hidden */\r\nclass MRDLFrontplateMaterialDefines extends MaterialDefines {\r\n    /**\r\n     * Sets default value for \"SMOOTH_EDGES\"\r\n     */\r\n    public SMOOTH_EDGES = true;\r\n\r\n    constructor() {\r\n        super();\r\n        this._needNormals = true;\r\n        this._needUVs = true;\r\n        this.rebuild();\r\n    }\r\n}\r\n\r\nexport class MRDLFrontplateMaterial extends PushMaterial {\r\n    /**\r\n     * Gets or sets the corner radius on the frontplate. If this value is changed, update the lineWidth to match.\r\n     */\r\n    @serialize()\r\n    public radius = 0.12;\r\n\r\n    /**\r\n     * Gets or sets the line width of the frontplate.\r\n     */\r\n    @serialize()\r\n    public lineWidth = 0.01;\r\n\r\n    /**\r\n     * Gets or sets whether the scale is relative to the frontplate height.\r\n     */\r\n    @serialize()\r\n    public relativeToHeight = false;\r\n\r\n    /** @hidden */\r\n    public _filterWidth = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the edge color of the frontplate.\r\n     */\r\n    @serialize()\r\n    public edgeColor: Color4 = new Color4(0.53, 0.53, 0.53, 1);\r\n\r\n    /**\r\n     * Gets or sets whether to enable blob effects on the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobEnable = true;\r\n\r\n    /**\r\n     * Gets or sets the blob position on the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobPosition: Vector3 = new Vector3(100, 100, 100);\r\n\r\n    /**\r\n     * Gets or sets the blob intensity of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobIntensity = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the blob near size of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobNearSize = 0.032;\r\n\r\n    /**\r\n     * Gets or sets the blob far size of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobFarSize = 0.048;\r\n\r\n    /**\r\n     * Gets or sets the blob near distance of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobNearDistance = 0.008;\r\n\r\n    /**\r\n     * Gets or sets the blob far distance of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobFarDistance = 0.064;\r\n\r\n    /**\r\n     * Gets or sets the blob fade length of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobFadeLength = 0.04;\r\n\r\n    /**\r\n     * Gets or sets the blob inner fade of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobInnerFade = 0.01;\r\n\r\n    /**\r\n     * Gets or sets the blob pulse of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobPulse = 0.0;\r\n\r\n    /**\r\n     * Gets or sets the blob fade effect on the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobFade = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the maximum size of the blob pulse on the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobPulseMaxSize = 0.05;\r\n\r\n    /**\r\n     * Gets or sets whether to enable extra blob effects of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobEnable2 = true;\r\n\r\n    /**\r\n     * Gets or sets blob2 position of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobPosition2: Vector3 = new Vector3(10, 10.1, -0.6);\r\n\r\n    /**\r\n     * Gets or sets the blob2 near size of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobNearSize2 = 0.008;\r\n\r\n    /**\r\n     * Gets or sets the blob2 inner fade of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobInnerFade2 = 0.1;\r\n\r\n    /**\r\n     * Gets or sets the blob2 pulse of the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobPulse2 = 0.0;\r\n\r\n    /**\r\n     * Gets or sets the blob2 fade effect on the frontplate.\r\n     */\r\n    @serialize()\r\n    public blobFade2 = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the gaze intensity of the frontplate.\r\n     */\r\n    @serialize()\r\n    public gazeIntensity = 0.8;\r\n\r\n    /**\r\n     * Gets or sets the gaze focus of the frontplate.\r\n     */\r\n    @serialize()\r\n    public gazeFocus = 0.0;\r\n\r\n    /**\r\n     * Gets or sets the selection fuzz of the frontplate.\r\n     */\r\n    @serialize()\r\n    public selectionFuzz = 0.5;\r\n\r\n    /**\r\n     * Gets or sets the fade intensity of the frontplate.\r\n     */\r\n    @serialize()\r\n    public selected = 1.0;\r\n\r\n    /**\r\n     * Gets or sets the selection fade intensity of the frontplate.\r\n     */\r\n    @serialize()\r\n    public selectionFade = 0.2;\r\n\r\n    /**\r\n     * Gets or sets the selection fade size of the frontplate.\r\n     */\r\n    @serialize()\r\n    public selectionFadeSize = 0.0;\r\n\r\n    /**\r\n     * Gets or sets the selected distance of the frontplate.\r\n     */\r\n    @serialize()\r\n    public selectedDistance = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the selected fade length of the frontplate.\r\n     */\r\n    @serialize()\r\n    public selectedFadeLength = 0.08;\r\n\r\n    /**\r\n     * Gets or sets the proximity maximum intensity of the frontplate.\r\n     */\r\n    @serialize()\r\n    public proximityMaxIntensity = 0.45;\r\n\r\n    /**\r\n     * Gets or sets the proximity far distance of the frontplate.\r\n     */\r\n    @serialize()\r\n    public proximityFarDistance = 0.16;\r\n\r\n    /**\r\n     * Gets or sets the proximity near radius of the frontplate.\r\n     */\r\n    @serialize()\r\n    public proximityNearRadius = 0.016;\r\n\r\n    /**\r\n     * Gets or sets the proximity anisotropy of the frontplate.\r\n     */\r\n    @serialize()\r\n    public proximityAnisotropy = 1.0;\r\n\r\n    /**\r\n     * Gets or sets whether to use global left index on the frontplate.\r\n     */\r\n    @serialize()\r\n    public useGlobalLeftIndex = true;\r\n\r\n    /**\r\n     * Gets or sets  whether to use global right index of the frontplate.\r\n     */\r\n    @serialize()\r\n    public useGlobalRightIndex = true;\r\n\r\n    /**\r\n     * URL pointing to the texture used to define the coloring for the BLOB.\r\n     */\r\n    public static BLOB_TEXTURE_URL = \"\";\r\n\r\n    /**\r\n     * Gets or sets the opacity of the frontplate (0.0 - 1.0).\r\n     */\r\n    public fadeOut = 1.0;\r\n\r\n    private _blobTexture: Texture;\r\n\r\n    constructor(name: string, scene: Scene) {\r\n        super(name, scene);\r\n        this.alphaMode = Constants.ALPHA_ADD;\r\n        this.disableDepthWrite = true;\r\n        this.backFaceCulling = false;\r\n        this._blobTexture = new Texture(MRDLFrontplateMaterial.BLOB_TEXTURE_URL, scene, true, false, Texture.NEAREST_SAMPLINGMODE);\r\n    }\r\n\r\n    public needAlphaBlending(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public needAlphaTesting(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public getAlphaTestTexture(): Nullable<BaseTexture> {\r\n        return null;\r\n    }\r\n\r\n    // Methods\r\n    public isReadyForSubMesh(mesh: AbstractMesh, subMesh: SubMesh): boolean {\r\n        if (this.isFrozen) {\r\n            if (subMesh.effect && subMesh.effect._wasPreviouslyReady) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (!subMesh.materialDefines) {\r\n            subMesh.materialDefines = new MRDLFrontplateMaterialDefines();\r\n        }\r\n\r\n        const defines = <MRDLFrontplateMaterialDefines>subMesh.materialDefines;\r\n        const scene = this.getScene();\r\n\r\n        if (this._isReadyForSubMesh(subMesh)) {\r\n            return true;\r\n        }\r\n\r\n        const engine = scene.getEngine();\r\n\r\n        // Attribs\r\n        MaterialHelper.PrepareDefinesForAttributes(mesh, defines, false, false);\r\n\r\n        // Get correct effect\r\n        if (defines.isDirty) {\r\n            defines.markAsProcessed();\r\n\r\n            scene.resetCachedMaterial();\r\n\r\n            // Fallbacks\r\n            const fallbacks = new EffectFallbacks();\r\n            if (defines.FOG) {\r\n                fallbacks.addFallback(1, \"FOG\");\r\n            }\r\n\r\n            MaterialHelper.HandleFallbacksForShadows(defines, fallbacks);\r\n\r\n            defines.IMAGEPROCESSINGPOSTPROCESS = scene.imageProcessingConfiguration.applyByPostProcess;\r\n\r\n            //Attributes\r\n            const attribs = [VertexBuffer.PositionKind];\r\n\r\n            if (defines.NORMAL) {\r\n                attribs.push(VertexBuffer.NormalKind);\r\n            }\r\n\r\n            if (defines.UV1) {\r\n                attribs.push(VertexBuffer.UVKind);\r\n            }\r\n\r\n            if (defines.UV2) {\r\n                attribs.push(VertexBuffer.UV2Kind);\r\n            }\r\n\r\n            if (defines.VERTEXCOLOR) {\r\n                attribs.push(VertexBuffer.ColorKind);\r\n            }\r\n\r\n            if (defines.TANGENT) {\r\n                attribs.push(VertexBuffer.TangentKind);\r\n            }\r\n\r\n            MaterialHelper.PrepareAttributesForInstances(attribs, defines);\r\n\r\n            // Legacy browser patch\r\n            const shaderName = \"mrdlFrontplate\";\r\n            const join = defines.toString();\r\n\r\n            const uniforms = [\r\n                \"world\",\r\n                \"worldView\",\r\n                \"worldViewProjection\",\r\n                \"view\",\r\n                \"projection\",\r\n                \"viewProjection\",\r\n                \"cameraPosition\",\r\n                \"_Radius_\",\r\n                \"_Line_Width_\",\r\n                \"_Relative_To_Height_\",\r\n                \"_Filter_Width_\",\r\n                \"_Edge_Color_\",\r\n                \"_Fade_Out_\",\r\n                \"_Smooth_Edges_\",\r\n                \"_Blob_Enable_\",\r\n                \"_Blob_Position_\",\r\n                \"_Blob_Intensity_\",\r\n                \"_Blob_Near_Size_\",\r\n                \"_Blob_Far_Size_\",\r\n                \"_Blob_Near_Distance_\",\r\n                \"_Blob_Far_Distance_\",\r\n                \"_Blob_Fade_Length_\",\r\n                \"_Blob_Inner_Fade_\",\r\n                \"_Blob_Pulse_\",\r\n                \"_Blob_Fade_\",\r\n                \"_Blob_Pulse_Max_Size_\",\r\n                \"_Blob_Enable_2_\",\r\n                \"_Blob_Position_2_\",\r\n                \"_Blob_Near_Size_2_\",\r\n                \"_Blob_Inner_Fade_2_\",\r\n                \"_Blob_Pulse_2_\",\r\n                \"_Blob_Fade_2_\",\r\n                \"_Gaze_Intensity_\",\r\n                \"_Gaze_Focus_\",\r\n                \"_Blob_Texture_\",\r\n                \"_Selection_Fuzz_\",\r\n                \"_Selected_\",\r\n                \"_Selection_Fade_\",\r\n                \"_Selection_Fade_Size_\",\r\n                \"_Selected_Distance_\",\r\n                \"_Selected_Fade_Length_\",\r\n                \"_Proximity_Max_Intensity_\",\r\n                \"_Proximity_Far_Distance_\",\r\n                \"_Proximity_Near_Radius_\",\r\n                \"_Proximity_Anisotropy_\",\r\n                \"Global_Left_Index_Tip_Position\",\r\n                \"Global_Right_Index_Tip_Position\",\r\n                \"_Use_Global_Left_Index_\",\r\n                \"_Use_Global_Right_Index_\",\r\n            ];\r\n            const samplers: string[] = [];\r\n            const uniformBuffers = new Array<string>();\r\n\r\n            MaterialHelper.PrepareUniformsAndSamplersList(<IEffectCreationOptions>{\r\n                uniformsNames: uniforms,\r\n                uniformBuffersNames: uniformBuffers,\r\n                samplers: samplers,\r\n                defines: defines,\r\n                maxSimultaneousLights: 4,\r\n            });\r\n\r\n            subMesh.setEffect(\r\n                scene.getEngine().createEffect(\r\n                    shaderName,\r\n                    <IEffectCreationOptions>{\r\n                        attributes: attribs,\r\n                        uniformsNames: uniforms,\r\n                        uniformBuffersNames: uniformBuffers,\r\n                        samplers: samplers,\r\n                        defines: join,\r\n                        fallbacks: fallbacks,\r\n                        onCompiled: this.onCompiled,\r\n                        onError: this.onError,\r\n                        indexParameters: { maxSimultaneousLights: 4 },\r\n                    },\r\n                    engine\r\n                ),\r\n                defines\r\n            );\r\n        }\r\n        if (!subMesh.effect || !subMesh.effect.isReady()) {\r\n            return false;\r\n        }\r\n\r\n        defines._renderId = scene.getRenderId();\r\n        subMesh.effect._wasPreviouslyReady = true;\r\n\r\n        return true;\r\n    }\r\n\r\n    public bindForSubMesh(world: Matrix, mesh: Mesh, subMesh: SubMesh): void {\r\n        const scene = this.getScene();\r\n\r\n        const defines = <MRDLFrontplateMaterialDefines>subMesh.materialDefines;\r\n        if (!defines) {\r\n            return;\r\n        }\r\n\r\n        const effect = subMesh.effect;\r\n        if (!effect) {\r\n            return;\r\n        }\r\n\r\n        this._activeEffect = effect;\r\n\r\n        // Matrices\r\n        this.bindOnlyWorldMatrix(world);\r\n        this._activeEffect.setMatrix(\"viewProjection\", scene.getTransformMatrix());\r\n        this._activeEffect.setVector3(\"cameraPosition\", scene.activeCamera!.position);\r\n\r\n        // \"Round Rect\"\r\n        this._activeEffect.setFloat(\"_Radius_\", this.radius);\r\n        this._activeEffect.setFloat(\"_Line_Width_\", this.lineWidth);\r\n        this._activeEffect.setFloat(\"_Relative_To_Height_\", this.relativeToHeight ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Filter_Width_\", this._filterWidth);\r\n        this._activeEffect.setDirectColor4(\"_Edge_Color_\", this.edgeColor);\r\n\r\n        // \"Fade\"\r\n        this._activeEffect.setFloat(\"_Fade_Out_\", this.fadeOut);\r\n\r\n        // \"Blob\"\r\n        this._activeEffect.setFloat(\"_Blob_Enable_\", this.blobEnable ? 1.0 : 0.0);\r\n        this._activeEffect.setVector3(\"_Blob_Position_\", this.blobPosition);\r\n        this._activeEffect.setFloat(\"_Blob_Intensity_\", this.blobIntensity);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_\", this.blobNearSize);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Size_\", this.blobFarSize);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Distance_\", this.blobNearDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Far_Distance_\", this.blobFarDistance);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_Length_\", this.blobFadeLength);\r\n        this._activeEffect.setFloat(\"_Blob_Inner_Fade_\", this.blobInnerFade);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_\", this.blobPulse);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_\", this.blobFade);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_Max_Size_\", this.blobPulseMaxSize);\r\n\r\n        // \"Blob 2\"\r\n        this._activeEffect.setFloat(\"_Blob_Enable_2_\", this.blobEnable2 ? 1.0 : 0.0);\r\n        this._activeEffect.setVector3(\"_Blob_Position_2_\", this.blobPosition2);\r\n        this._activeEffect.setFloat(\"_Blob_Near_Size_2_\", this.blobNearSize2);\r\n        this._activeEffect.setFloat(\"_Blob_Inner_Fade_2_\", this.blobInnerFade2);\r\n        this._activeEffect.setFloat(\"_Blob_Pulse_2_\", this.blobPulse2);\r\n        this._activeEffect.setFloat(\"_Blob_Fade_2_\", this.blobFade2);\r\n\r\n        // \"Gaze\"\r\n        this._activeEffect.setFloat(\"_Gaze_Intensity_\", this.gazeIntensity);\r\n        this._activeEffect.setFloat(\"_Gaze_Focus_\", this.gazeFocus);\r\n\r\n        // \"Blob Texture\"\r\n        this._activeEffect.setTexture(\"_Blob_Texture_\", this._blobTexture);\r\n\r\n        // \"Selection\"\r\n        this._activeEffect.setFloat(\"_Selection_Fuzz_\", this.selectionFuzz);\r\n        this._activeEffect.setFloat(\"_Selected_\", this.selected);\r\n        this._activeEffect.setFloat(\"_Selection_Fade_\", this.selectionFade);\r\n        this._activeEffect.setFloat(\"_Selection_Fade_Size_\", this.selectionFadeSize);\r\n        this._activeEffect.setFloat(\"_Selected_Distance_\", this.selectedDistance);\r\n        this._activeEffect.setFloat(\"_Selected_Fade_Length_\", this.selectedFadeLength);\r\n\r\n        // \"Proximity\"\r\n        this._activeEffect.setFloat(\"_Proximity_Max_Intensity_\", this.proximityMaxIntensity);\r\n        this._activeEffect.setFloat(\"_Proximity_Far_Distance_\", this.proximityFarDistance);\r\n        this._activeEffect.setFloat(\"_Proximity_Near_Radius_\", this.proximityNearRadius);\r\n        this._activeEffect.setFloat(\"_Proximity_Anisotropy_\", this.proximityAnisotropy);\r\n\r\n        // \"Global\"\r\n        this._activeEffect.setFloat(\"_Use_Global_Left_Index_\", this.useGlobalLeftIndex ? 1.0 : 0.0);\r\n        this._activeEffect.setFloat(\"_Use_Global_Right_Index_\", this.useGlobalRightIndex ? 1.0 : 0.0);\r\n\r\n        // \"Antialiasing\"\r\n        //define SMOOTH_EDGES true;\r\n\r\n        this._afterBind(mesh, this._activeEffect);\r\n    }\r\n\r\n    /**\r\n     * Get the list of animatables in the material.\r\n     * @returns the list of animatables object used in the material\r\n     */\r\n    public getAnimatables(): IAnimatable[] {\r\n        return [];\r\n    }\r\n\r\n    public dispose(forceDisposeEffect?: boolean): void {\r\n        super.dispose(forceDisposeEffect);\r\n    }\r\n\r\n    public clone(name: string): MRDLFrontplateMaterial {\r\n        return SerializationHelper.Clone(() => new MRDLFrontplateMaterial(name, this.getScene()), this);\r\n    }\r\n\r\n    public serialize(): unknown {\r\n        const serializationObject = SerializationHelper.Serialize(this);\r\n        serializationObject.customType = \"BABYLON.MRDLFrontplateMaterial\";\r\n        return serializationObject;\r\n    }\r\n\r\n    public getClassName(): string {\r\n        return \"MRDLFrontplateMaterial\";\r\n    }\r\n\r\n    // Statics\r\n    public static Parse(source: any, scene: Scene, rootUrl: string): MRDLFrontplateMaterial {\r\n        return SerializationHelper.Parse(() => new MRDLFrontplateMaterial(source.name, scene), source, scene, rootUrl);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.GUI.MRDLFrontplateMaterial\", MRDLFrontplateMaterial);\r\n","import type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport type { Control3D } from \"../control3D\";\r\nimport type { Mesh } from \"core/Meshes/mesh\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport type { Scene } from \"core/scene\";\r\nimport type { Vector3WithInfo } from \"../../vector3WithInfo\";\r\n\r\nimport { AdvancedDynamicTexture } from \"../../../2D/advancedDynamicTexture\";\r\nimport { Animation } from \"core/Animations/animation\";\r\nimport { AnimationGroup } from \"core/Animations/animationGroup\";\r\nimport { Color3, Color4 } from \"core/Maths/math.color\";\r\nimport { Control } from \"../../../2D/controls/control\";\r\nimport { CreatePlane } from \"core/Meshes/Builders/planeBuilder\";\r\nimport { CreateBox } from \"core/Meshes/Builders/boxBuilder\";\r\nimport { DomManagement } from \"core/Misc/domManagement\";\r\nimport { FadeInOutBehavior } from \"core/Behaviors/Meshes/fadeInOutBehavior\";\r\nimport { Grid } from \"../../../2D/controls/grid\";\r\nimport { Image } from \"../../../2D/controls/image\";\r\nimport { MRDLBackglowMaterial } from \"../../materials/mrdl/mrdlBackglowMaterial\";\r\nimport { MRDLBackplateMaterial } from \"../../materials/mrdl/mrdlBackplateMaterial\";\r\nimport { MRDLFrontplateMaterial } from \"../../materials/mrdl/mrdlFrontplateMaterial\";\r\nimport { MRDLInnerquadMaterial } from \"../../materials/mrdl/mrdlInnerquadMaterial\";\r\nimport { Rectangle } from \"../../../2D/controls/rectangle\";\r\nimport { SceneLoader } from \"core/Loading/sceneLoader\";\r\nimport { StackPanel } from \"../../../2D/controls/stackPanel\";\r\nimport { StandardMaterial } from \"core/Materials/standardMaterial\";\r\nimport { TextBlock } from \"../../../2D/controls/textBlock\";\r\nimport { TouchButton3D } from \"../touchButton3D\";\r\nimport { TransformNode } from \"core/Meshes/transformNode\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\n\r\n/**\r\n * Class used to create the mrtkv3 button\r\n */\r\nexport class TouchHolographicButton extends TouchButton3D {\r\n    /**\r\n     * Base Url for the frontplate model.\r\n     */\r\n    public static MRTK_ASSET_BASE_URL = \"https://assets.babylonjs.com/meshes/MRTK/\";\r\n\r\n    /**\r\n     * File name for the frontplate model.\r\n     */\r\n    public static FRONTPLATE_MODEL_FILENAME = \"mrtk-fluent-frontplate.glb\";\r\n\r\n    /**\r\n     * File name for the backplate model.\r\n     */\r\n    public static BACKPLATE_MODEL_FILENAME = \"mrtk-fluent-backplate.glb\";\r\n\r\n    /**\r\n     * File name for the backglow model.\r\n     */\r\n    public static BACKGLOW_MODEL_FILENAME = \"mrtk-fluent-button.glb\";\r\n\r\n    /**\r\n     * File name for the innerquad model.\r\n     */\r\n    public static INNERQUAD_MODEL_FILENAME = \"SlateProximity.glb\";\r\n\r\n    /**\r\n     * Gets or sets the horizontal scaling for the button.\r\n     */\r\n    public width = 1;\r\n\r\n    /**\r\n     * Gets or sets the vertical scaling for the button.\r\n     */\r\n    public height = 1;\r\n\r\n    /**\r\n     * Gets or sets the bevel radius for the button.\r\n     */\r\n    public radius = 0.14;\r\n\r\n    /**\r\n     * Gets or sets the font size of the button text in pixels.\r\n     * This is only adjustable for a button with width to height ratio greater than 1.\r\n     */\r\n    public textSizeInPixels = 18;\r\n\r\n    /**\r\n     * Gets or sets the size of the button image in pixels.\r\n     * This is only adjustable for a button with width to height ratio greater than 1.\r\n     */\r\n    public imageSizeInPixels = 40;\r\n\r\n    /**\r\n     * Gets or sets the color of the button plate.\r\n     */\r\n    public plateMaterialColor = new Color3(0.4, 0.4, 0.4);\r\n\r\n    // Shared variables for meshes\r\n    /**\r\n     * Gets or sets the depth of the button's front plate.\r\n     * This variable determines the z scaling and z position for some of the button's meshes.\r\n     */\r\n    public frontPlateDepth = 0.2;\r\n\r\n    /**\r\n     * Gets or sets the depth of the button's back plate.\r\n     * This variable determines the z scaling and z position for some of the button's meshes.\r\n     */\r\n    public backPlateDepth = 0.04;\r\n\r\n    /**\r\n     * Gets or sets the offset value for button's back glow.\r\n     * This variable determines the x, y scaling of the button's meshes.\r\n     */\r\n    public backGlowOffset = 0.1;\r\n\r\n    /**\r\n     * Gets or sets the value that determines the z scaling and z position for the innerQuad and BackGlow meshes.\r\n     */\r\n    public flatPlaneDepth = 0.001;\r\n\r\n    /**\r\n     * Gets or sets the radius for FrontMaterial and innerQuadMaterial.\r\n     */\r\n    public innerQuadRadius = this.radius - 0.04;\r\n\r\n    /**\r\n     * Gets or sets the color for innerQuadMaterial.\r\n     */\r\n    public innerQuadColor = new Color4(0, 0, 0, 0);\r\n\r\n    /**\r\n     * Gets or sets the color for innerQuadMaterial for when it is toggled.\r\n     */\r\n    public innerQuadToggledColor = new Color4(0.5197843, 0.6485234, 0.9607843, 0.6);\r\n\r\n    /**\r\n     * Gets or sets the color for innerQuadMaterial for when it is hovered.\r\n     */\r\n    public innerQuadHoverColor = new Color4(1, 1, 1, 0.05);\r\n\r\n    /**\r\n     * Gets or sets the color for innerQuadMaterial for when it is toggled and hovered.\r\n     */\r\n    public innerQuadToggledHoverColor = new Color4(0.5197843, 0.6485234, 0.9607843, 1);\r\n\r\n    // Meshes\r\n    private _backPlate: AbstractMesh;\r\n    private _textPlate: Mesh;\r\n    private _frontPlate: AbstractMesh;\r\n    private _backGlow: AbstractMesh;\r\n    private _innerQuad: AbstractMesh;\r\n    private _collisionPlate: AbstractMesh;\r\n    private _frontPlateCollisionMesh: AbstractMesh;\r\n    private _isBackplateVisible = true;\r\n\r\n    // Content\r\n    private _text: string;\r\n    private _subtext: string;\r\n    private _imageUrl: string;\r\n\r\n    // Materials\r\n    private _shareMaterials = true;\r\n    private _frontMaterial: MRDLFrontplateMaterial;\r\n    private _backMaterial: MRDLBackplateMaterial;\r\n    private _backGlowMaterial: MRDLBackglowMaterial;\r\n    private _innerQuadMaterial: MRDLInnerquadMaterial;\r\n    private _plateMaterial: StandardMaterial;\r\n\r\n    // Events\r\n    private _pickedPointObserver: Nullable<Observer<Nullable<Vector3>>>;\r\n    private _pointerClickObserver: Nullable<Observer<Vector3WithInfo>>;\r\n    private _pointerEnterObserver: Nullable<Observer<Control3D>>;\r\n    private _pointerOutObserver: Nullable<Observer<Control3D>>;\r\n    private _toggleObserver: Nullable<Observer<boolean>>;\r\n\r\n    // Tooltip\r\n    private _tooltipFade: Nullable<FadeInOutBehavior>;\r\n    private _tooltipTextBlock: Nullable<TextBlock>;\r\n    private _tooltipTexture: Nullable<AdvancedDynamicTexture>;\r\n    private _tooltipMesh: Nullable<Mesh>;\r\n    private _tooltipHoverObserver: Nullable<Observer<Control3D>>;\r\n    private _tooltipOutObserver: Nullable<Observer<Control3D>>;\r\n\r\n    private _disposeTooltip() {\r\n        this._tooltipFade = null;\r\n        if (this._tooltipTextBlock) {\r\n            this._tooltipTextBlock.dispose();\r\n        }\r\n        if (this._tooltipTexture) {\r\n            this._tooltipTexture.dispose();\r\n        }\r\n        if (this._tooltipMesh) {\r\n            this._tooltipMesh.dispose();\r\n        }\r\n        this.onPointerEnterObservable.remove(this._tooltipHoverObserver);\r\n        this.onPointerOutObservable.remove(this._tooltipOutObserver);\r\n    }\r\n\r\n    /**\r\n     * Rendering ground id of all the mesh in the button\r\n     */\r\n    public set renderingGroupId(id: number) {\r\n        this._backPlate.renderingGroupId = id;\r\n        this._textPlate.renderingGroupId = id;\r\n        this._frontPlate.renderingGroupId = id;\r\n        this._backGlow.renderingGroupId = id;\r\n        this._innerQuad.renderingGroupId = id;\r\n\r\n        if (this._tooltipMesh) {\r\n            this._tooltipMesh.renderingGroupId = id;\r\n        }\r\n    }\r\n    public get renderingGroupId(): number {\r\n        return this._backPlate.renderingGroupId;\r\n    }\r\n\r\n    /**\r\n     * Gets the mesh used to render this control\r\n     */\r\n    public get mesh(): Nullable<AbstractMesh> {\r\n        return this._backPlate as AbstractMesh;\r\n    }\r\n\r\n    /**\r\n     * Text to be displayed on the tooltip shown when hovering on the button. When set to null tooltip is disabled. (Default: null)\r\n     * Set this property after adding the button to the GUI3DManager\r\n     */\r\n    public set tooltipText(text: Nullable<string>) {\r\n        if (!text) {\r\n            this._disposeTooltip();\r\n            return;\r\n        }\r\n        if (!this._tooltipFade) {\r\n            const rightHandedScene = this._backPlate._scene.useRightHandedSystem;\r\n            // Create tooltip with mesh and text\r\n            this._tooltipMesh = CreatePlane(\"\", { size: 1 }, this._backPlate._scene);\r\n            this._tooltipMesh.position = Vector3.Down().scale(0.7).add(Vector3.Forward(rightHandedScene).scale(-0.15));\r\n            this._tooltipMesh.isPickable = false;\r\n            this._tooltipMesh.parent = this._frontPlateCollisionMesh;\r\n\r\n            // Create text texture for the tooltip\r\n            this._tooltipTexture = AdvancedDynamicTexture.CreateForMesh(this._tooltipMesh);\r\n            const tooltipBackground = new Rectangle();\r\n            tooltipBackground.height = 0.25;\r\n            tooltipBackground.width = 0.8;\r\n            tooltipBackground.cornerRadius = 25;\r\n            tooltipBackground.color = \"#ffffff\";\r\n            tooltipBackground.thickness = 20;\r\n            tooltipBackground.background = \"#060668\";\r\n            this._tooltipTexture.addControl(tooltipBackground);\r\n\r\n            this._tooltipTextBlock = new TextBlock();\r\n            this._tooltipTextBlock.color = \"white\";\r\n            this._tooltipTextBlock.fontSize = 100;\r\n            this._tooltipTexture.addControl(this._tooltipTextBlock);\r\n\r\n            // Add hover action to tooltip\r\n            this._tooltipFade = new FadeInOutBehavior();\r\n            this._tooltipFade.delay = 500;\r\n            this._tooltipMesh.addBehavior(this._tooltipFade);\r\n            this._tooltipHoverObserver = this.onPointerEnterObservable.add(() => {\r\n                if (this._tooltipFade) {\r\n                    this._tooltipFade.fadeIn(true);\r\n                }\r\n            });\r\n            this._tooltipOutObserver = this.onPointerOutObservable.add(() => {\r\n                if (this._tooltipFade) {\r\n                    this._tooltipFade.fadeIn(false);\r\n                }\r\n            });\r\n        }\r\n        if (this._tooltipTextBlock) {\r\n            this._tooltipTextBlock.text = text;\r\n        }\r\n    }\r\n\r\n    public get tooltipText() {\r\n        return this._tooltipTextBlock?.text || null;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets text for the button\r\n     */\r\n    public get text(): string {\r\n        return this._text;\r\n    }\r\n\r\n    public set text(value: string) {\r\n        if (this._text === value) {\r\n            return;\r\n        }\r\n\r\n        this._text = value;\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets subtext for a button with larger width\r\n     */\r\n    public get subtext(): string {\r\n        return this._subtext;\r\n    }\r\n\r\n    public set subtext(value: string) {\r\n        if (this._subtext === value) {\r\n            return;\r\n        }\r\n\r\n        this._subtext = value;\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the image url for the button\r\n     */\r\n    public get imageUrl(): string {\r\n        return this._imageUrl;\r\n    }\r\n\r\n    public set imageUrl(value: string) {\r\n        if (this._imageUrl === value) {\r\n            return;\r\n        }\r\n\r\n        this._imageUrl = value;\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Gets the back material used by this button\r\n     */\r\n    public get backMaterial(): MRDLBackplateMaterial {\r\n        return this._backMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the front material used by this button\r\n     */\r\n    public get frontMaterial(): MRDLFrontplateMaterial {\r\n        return this._frontMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the back glow material used by this button\r\n     */\r\n    public get backGlowMaterial(): MRDLBackglowMaterial {\r\n        return this._backGlowMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the inner quad material used by this button\r\n     */\r\n    public get innerQuadMaterial(): MRDLInnerquadMaterial {\r\n        return this._innerQuadMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets the plate material used by this button\r\n     */\r\n    public get plateMaterial(): StandardMaterial {\r\n        return this._plateMaterial;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this button shares its material with other V3 Buttons\r\n     */\r\n    public get shareMaterials(): boolean {\r\n        return this._shareMaterials;\r\n    }\r\n\r\n    /**\r\n     * Sets whether the backplate is visible or hidden. Hiding the backplate is not recommended without some sort of replacement\r\n     */\r\n    public set isBackplateVisible(isVisible: boolean) {\r\n        if (this.mesh && this._backMaterial) {\r\n            if (isVisible && !this._isBackplateVisible) {\r\n                this._backPlate.visibility = 1;\r\n            } else if (!isVisible && this._isBackplateVisible) {\r\n                this._backPlate.visibility = 0;\r\n            }\r\n        }\r\n\r\n        this._isBackplateVisible = isVisible;\r\n    }\r\n\r\n    /**\r\n     * Creates a new button\r\n     * @param name defines the control name\r\n     * @param shareMaterials\r\n     */\r\n    constructor(name?: string, shareMaterials = true) {\r\n        super(name);\r\n\r\n        this._shareMaterials = shareMaterials;\r\n\r\n        this.pointerEnterAnimation = () => {\r\n            if (this._frontPlate && this._textPlate && !this.isToggleButton) {\r\n                this._performEnterExitAnimation(1);\r\n            }\r\n\r\n            if (this.isToggleButton && this._innerQuadMaterial) {\r\n                if (this.isToggled) {\r\n                    this._innerQuadMaterial.color = this.innerQuadToggledHoverColor;\r\n                } else {\r\n                    this._innerQuadMaterial.color = this.innerQuadHoverColor;\r\n                }\r\n            }\r\n        };\r\n\r\n        this.pointerOutAnimation = () => {\r\n            if (this._frontPlate && this._textPlate && !this.isToggleButton) {\r\n                this._performEnterExitAnimation(-0.8);\r\n            }\r\n\r\n            if (this.isToggleButton && this._innerQuadMaterial) {\r\n                this._onToggle(this.isToggled);\r\n            }\r\n        };\r\n\r\n        this.pointerDownAnimation = () => {\r\n            // Do nothing\r\n        };\r\n\r\n        this.pointerUpAnimation = () => {\r\n            // Do nothing\r\n        };\r\n\r\n        this._pointerClickObserver = this.onPointerClickObservable.add(() => {\r\n            if (this._frontPlate && this._backGlow && !this.isActiveNearInteraction) {\r\n                this._performClickAnimation();\r\n            }\r\n\r\n            if (this.isToggleButton && this._innerQuadMaterial) {\r\n                this._onToggle(this.isToggled);\r\n            }\r\n        });\r\n\r\n        this._pointerEnterObserver = this.onPointerEnterObservable.add(() => {\r\n            this.pointerEnterAnimation();\r\n        });\r\n\r\n        this._pointerOutObserver = this.onPointerOutObservable.add(() => {\r\n            this.pointerOutAnimation();\r\n        });\r\n\r\n        this._toggleObserver = this.onToggleObservable.add((isToggled) => {\r\n            if (isToggled) {\r\n                this._innerQuadMaterial.color = this.innerQuadToggledColor;\r\n            } else {\r\n                this._innerQuadMaterial.color = this.innerQuadColor;\r\n            }\r\n        });\r\n    }\r\n\r\n    protected _getTypeName(): string {\r\n        return \"TouchHolographicButton\";\r\n    }\r\n\r\n    private _rebuildContent(): void {\r\n        let content: Control;\r\n\r\n        if (this._getAspectRatio() <= 1) {\r\n            // align text and image vertically\r\n            content = this._alignContentVertically();\r\n        } else {\r\n            // align text and image horizontally\r\n            content = this._alignContentHorizontally();\r\n        }\r\n\r\n        this.content = content;\r\n    }\r\n\r\n    private _getAspectRatio() {\r\n        return this.width / this.height;\r\n    }\r\n\r\n    private _alignContentVertically() {\r\n        const panel = new StackPanel();\r\n        panel.isVertical = true;\r\n\r\n        if (DomManagement.IsDocumentAvailable() && !!document.createElement) {\r\n            if (this._imageUrl) {\r\n                const image = new Image();\r\n                image.source = this._imageUrl;\r\n                image.heightInPixels = 180;\r\n                image.widthInPixels = 100;\r\n                image.paddingTopInPixels = 40;\r\n                image.paddingBottomInPixels = 40;\r\n                panel.addControl(image);\r\n            }\r\n        }\r\n\r\n        if (this._text) {\r\n            const text = new TextBlock();\r\n            text.text = this._text;\r\n            text.color = \"white\";\r\n            text.heightInPixels = 30;\r\n            text.fontSize = 24;\r\n            panel.addControl(text);\r\n        }\r\n\r\n        return panel;\r\n    }\r\n\r\n    private _alignContentHorizontally() {\r\n        let totalPanelWidthInPixels = 240;\r\n        const padding = 15;\r\n\r\n        const contentContainer = new Rectangle();\r\n        contentContainer.widthInPixels = totalPanelWidthInPixels;\r\n        contentContainer.heightInPixels = totalPanelWidthInPixels;\r\n        contentContainer.color = \"transparent\";\r\n        contentContainer.setPaddingInPixels(padding, padding, padding, padding);\r\n        totalPanelWidthInPixels -= padding * 2;\r\n\r\n        const panel = new StackPanel();\r\n        panel.isVertical = false;\r\n        panel.scaleY = this._getAspectRatio();\r\n\r\n        if (DomManagement.IsDocumentAvailable() && !!document.createElement) {\r\n            if (this._imageUrl) {\r\n                const imageContainer = new Rectangle(`${this.name}_image`);\r\n                imageContainer.widthInPixels = this.imageSizeInPixels;\r\n                imageContainer.heightInPixels = this.imageSizeInPixels;\r\n                imageContainer.color = \"transparent\";\r\n                totalPanelWidthInPixels -= this.imageSizeInPixels;\r\n\r\n                const image = new Image();\r\n                image.source = this._imageUrl;\r\n\r\n                imageContainer.addControl(image);\r\n                panel.addControl(imageContainer);\r\n            }\r\n        }\r\n\r\n        if (this._text) {\r\n            const text = new TextBlock(`${this.name}_text`);\r\n            text.text = this._text;\r\n            text.color = \"white\";\r\n            text.fontSize = this.textSizeInPixels;\r\n            text.widthInPixels = totalPanelWidthInPixels;\r\n\r\n            if (this._imageUrl) {\r\n                text.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n                text.paddingLeftInPixels = padding;\r\n            }\r\n\r\n            if (this._subtext) {\r\n                const textContainer = new Grid();\r\n                textContainer.addColumnDefinition(1);\r\n                textContainer.addRowDefinition(0.5);\r\n                textContainer.addRowDefinition(0.5);\r\n                textContainer.widthInPixels = totalPanelWidthInPixels;\r\n                textContainer.heightInPixels = 45;\r\n\r\n                const subtext = new TextBlock(`${this.name}_subtext`);\r\n                subtext.text = this._subtext;\r\n                subtext.color = \"#EEEEEEAB\";\r\n                subtext.fontSize = this.textSizeInPixels * 0.75;\r\n                subtext.fontWeight = \"600\";\r\n\r\n                if (this._imageUrl) {\r\n                    subtext.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n                    subtext.paddingLeftInPixels = padding;\r\n                }\r\n\r\n                textContainer.addControl(text, 0);\r\n                textContainer.addControl(subtext, 1);\r\n                panel.addControl(textContainer);\r\n            } else {\r\n                panel.addControl(text);\r\n            }\r\n        }\r\n\r\n        contentContainer.addControl(panel);\r\n        return contentContainer;\r\n    }\r\n\r\n    // Mesh association\r\n    protected _createNode(scene: Scene): TransformNode {\r\n        this.name = this.name ?? \"TouchHolographicButton\";\r\n\r\n        const backPlateMesh = this._createBackPlate(scene);\r\n        const collisionMesh = this._createFrontPlate(scene);\r\n        const innerQuadMesh = this._createInnerQuad(scene);\r\n        const backGlowMesh = this._createBackGlow(scene);\r\n\r\n        this._frontPlateCollisionMesh = collisionMesh;\r\n        this._textPlate = <Mesh>super._createNode(scene);\r\n        this._textPlate.name = `${this.name}_textPlate`;\r\n        this._textPlate.isPickable = false;\r\n        this._textPlate.scaling.x = this.width;\r\n        this._textPlate.parent = collisionMesh;\r\n\r\n        this._backPlate = backPlateMesh;\r\n        this._backPlate.position = Vector3.Forward(scene.useRightHandedSystem).scale(this.backPlateDepth / 2);\r\n        this._backPlate.isPickable = false;\r\n\r\n        this._backPlate.addChild(collisionMesh);\r\n        this._backPlate.addChild(innerQuadMesh);\r\n\r\n        if (backGlowMesh) {\r\n            this._backPlate.addChild(backGlowMesh);\r\n        }\r\n\r\n        const tn = new TransformNode(`${this.name}_root`, scene);\r\n        this._backPlate.setParent(tn);\r\n\r\n        this.collisionMesh = collisionMesh;\r\n        this.collidableFrontDirection = this._backPlate.forward.negate(); // Mesh is facing the wrong way\r\n\r\n        return tn;\r\n    }\r\n\r\n    private _createBackPlate(scene: Scene) {\r\n        const backPlateMesh = CreateBox(`${this.name}_backPlate`, {}, scene);\r\n        backPlateMesh.isPickable = false;\r\n        backPlateMesh.visibility = 0;\r\n        backPlateMesh.scaling.z = 0.2;\r\n\r\n        SceneLoader.ImportMeshAsync(undefined, TouchHolographicButton.MRTK_ASSET_BASE_URL, TouchHolographicButton.BACKPLATE_MODEL_FILENAME, scene).then((result) => {\r\n            const backPlateModel = result.meshes[1];\r\n            backPlateModel.visibility = 0;\r\n\r\n            if (this._isBackplateVisible) {\r\n                backPlateModel.visibility = 1;\r\n                backPlateModel.name = `${this.name}_backPlate`;\r\n                backPlateModel.isPickable = false;\r\n                backPlateModel.scaling.x = this.width;\r\n                backPlateModel.scaling.y = this.height;\r\n                backPlateModel.parent = backPlateMesh;\r\n            }\r\n\r\n            if (this._backMaterial) {\r\n                backPlateModel.material = this._backMaterial;\r\n            }\r\n\r\n            this._backPlate = backPlateModel;\r\n        });\r\n\r\n        return backPlateMesh;\r\n    }\r\n\r\n    private _createFrontPlate(scene: Scene) {\r\n        const collisionMesh = CreateBox(\r\n            `${this.name}_frontPlate`,\r\n            {\r\n                width: this.width,\r\n                height: this.height,\r\n                depth: this.frontPlateDepth,\r\n            },\r\n            scene\r\n        );\r\n        collisionMesh.isPickable = true;\r\n        collisionMesh.isNearPickable = true;\r\n        collisionMesh.visibility = 0;\r\n        collisionMesh.position = Vector3.Forward(scene.useRightHandedSystem).scale((this.backPlateDepth - this.frontPlateDepth) / 2);\r\n\r\n        SceneLoader.ImportMeshAsync(undefined, TouchHolographicButton.MRTK_ASSET_BASE_URL, TouchHolographicButton.FRONTPLATE_MODEL_FILENAME, scene).then((result) => {\r\n            const collisionPlate = CreateBox(\r\n                `${this.name}_collisionPlate`,\r\n                {\r\n                    width: this.width,\r\n                    height: this.height,\r\n                },\r\n                scene\r\n            );\r\n            collisionPlate.isPickable = false;\r\n            collisionPlate.scaling.z = this.frontPlateDepth;\r\n            collisionPlate.visibility = 0;\r\n            collisionPlate.parent = collisionMesh;\r\n            this._collisionPlate = collisionPlate;\r\n\r\n            const frontPlateModel = result.meshes[1];\r\n            frontPlateModel.name = `${this.name}_frontPlate`;\r\n            frontPlateModel.isPickable = false;\r\n            frontPlateModel.scaling.x = this.width - this.backGlowOffset;\r\n            frontPlateModel.scaling.y = this.height - this.backGlowOffset;\r\n            frontPlateModel.position = Vector3.Forward(scene.useRightHandedSystem).scale(-0.5);\r\n            frontPlateModel.parent = collisionPlate;\r\n\r\n            if (this.isToggleButton) {\r\n                frontPlateModel.visibility = 0;\r\n            }\r\n\r\n            if (this._frontMaterial) {\r\n                frontPlateModel.material = this._frontMaterial;\r\n            }\r\n\r\n            this._textPlate.scaling.x = 1;\r\n            this._textPlate.parent = frontPlateModel;\r\n            this._frontPlate = frontPlateModel;\r\n        });\r\n\r\n        return collisionMesh;\r\n    }\r\n\r\n    private _createInnerQuad(scene: Scene) {\r\n        const innerQuadMesh = CreateBox(`${this.name}_innerQuad`, {}, scene);\r\n        innerQuadMesh.isPickable = false;\r\n        innerQuadMesh.visibility = 0;\r\n        innerQuadMesh.scaling.z = this.flatPlaneDepth;\r\n        innerQuadMesh.position.z += this.backPlateDepth / 2 - this.flatPlaneDepth;\r\n\r\n        SceneLoader.ImportMeshAsync(undefined, TouchHolographicButton.MRTK_ASSET_BASE_URL, TouchHolographicButton.INNERQUAD_MODEL_FILENAME, scene).then((result) => {\r\n            const innerQuadModel = result.meshes[1];\r\n            innerQuadModel.name = `${this.name}_innerQuad`;\r\n            innerQuadModel.isPickable = false;\r\n            innerQuadModel.scaling.x = this.width - this.backGlowOffset;\r\n            innerQuadModel.scaling.y = this.height - this.backGlowOffset;\r\n            innerQuadModel.parent = innerQuadMesh;\r\n\r\n            if (this._innerQuadMaterial) {\r\n                innerQuadModel.material = this._innerQuadMaterial;\r\n            }\r\n\r\n            this._innerQuad = innerQuadModel;\r\n        });\r\n\r\n        return innerQuadMesh;\r\n    }\r\n\r\n    private _createBackGlow(scene: Scene) {\r\n        if (this.isToggleButton) {\r\n            return;\r\n        }\r\n\r\n        const backGlowMesh = CreateBox(`${this.name}_backGlow`, {}, scene);\r\n        backGlowMesh.isPickable = false;\r\n        backGlowMesh.visibility = 0;\r\n        backGlowMesh.scaling.z = this.flatPlaneDepth;\r\n        backGlowMesh.position.z += this.backPlateDepth / 2 - this.flatPlaneDepth * 2;\r\n\r\n        SceneLoader.ImportMeshAsync(undefined, TouchHolographicButton.MRTK_ASSET_BASE_URL, TouchHolographicButton.BACKGLOW_MODEL_FILENAME, scene).then((result) => {\r\n            const backGlowModel = result.meshes[1];\r\n            backGlowModel.name = `${this.name}_backGlow`;\r\n            backGlowModel.isPickable = false;\r\n            backGlowModel.scaling.x = this.width - this.backGlowOffset;\r\n            backGlowModel.scaling.y = this.height - this.backGlowOffset;\r\n            backGlowModel.parent = backGlowMesh;\r\n\r\n            if (this._backGlowMaterial) {\r\n                backGlowModel.material = this._backGlowMaterial;\r\n            }\r\n\r\n            this._backGlow = backGlowModel;\r\n        });\r\n\r\n        return backGlowMesh;\r\n    }\r\n\r\n    protected _applyFacade(facadeTexture: AdvancedDynamicTexture) {\r\n        this._plateMaterial.emissiveTexture = facadeTexture;\r\n        this._plateMaterial.opacityTexture = facadeTexture;\r\n        this._plateMaterial.diffuseColor = this.plateMaterialColor;\r\n    }\r\n\r\n    private _performClickAnimation() {\r\n        const frameRate = 60;\r\n        const animationGroup = new AnimationGroup(\"Click Animation Group\");\r\n\r\n        const animations = [\r\n            {\r\n                name: \"backGlowMotion\",\r\n                mesh: this._backGlow,\r\n                property: \"material.motion\",\r\n                keys: [\r\n                    {\r\n                        frame: 0,\r\n                        values: [0, 0, 0],\r\n                    },\r\n                    {\r\n                        frame: 20,\r\n                        values: [1, 0.0144, 0.0144],\r\n                    },\r\n                    {\r\n                        frame: 40,\r\n                        values: [0.0027713229489760476, 0, 0],\r\n                    },\r\n                    {\r\n                        frame: 45,\r\n                        values: [0.0027713229489760476],\r\n                    },\r\n                ],\r\n            },\r\n            {\r\n                name: \"_collisionPlateZSlide\",\r\n                mesh: this._collisionPlate,\r\n                property: \"position.z\",\r\n                keys: [\r\n                    {\r\n                        frame: 0,\r\n                        values: [0.0, 0.0, 0.0],\r\n                    },\r\n                    {\r\n                        frame: 20,\r\n                        values: [Vector3.Forward(this._collisionPlate._scene.useRightHandedSystem).scale(this.frontPlateDepth / 2).z, 0.0, 0.0],\r\n                    },\r\n                    {\r\n                        frame: 40,\r\n                        values: [0.0, 0.005403332496794331],\r\n                    },\r\n                    {\r\n                        frame: 45,\r\n                        values: [0.0],\r\n                    },\r\n                ],\r\n            },\r\n            {\r\n                name: \"_collisionPlateZScale\",\r\n                mesh: this._collisionPlate,\r\n                property: \"scaling.z\",\r\n                keys: [\r\n                    {\r\n                        frame: 0,\r\n                        values: [this.frontPlateDepth, 0.0, 0.0],\r\n                    },\r\n                    {\r\n                        frame: 20,\r\n                        values: [this.backPlateDepth, 0.0, 0.0],\r\n                    },\r\n                    {\r\n                        frame: 40,\r\n                        values: [this.frontPlateDepth, 0.0054],\r\n                    },\r\n                    {\r\n                        frame: 45,\r\n                        values: [this.frontPlateDepth],\r\n                    },\r\n                ],\r\n            },\r\n        ];\r\n\r\n        for (const animation of animations) {\r\n            const anim = new Animation(animation.name, animation.property, frameRate, Animation.ANIMATIONTYPE_FLOAT, Animation.ANIMATIONLOOPMODE_CYCLE);\r\n            const animkeyFrames = [];\r\n\r\n            for (const key of animation.keys) {\r\n                animkeyFrames.push({\r\n                    frame: key.frame,\r\n                    value: key.values[0],\r\n                    inTangent: key.values[1],\r\n                    outTangent: key.values[2],\r\n                    interpolation: key.values[3],\r\n                });\r\n            }\r\n\r\n            anim.setKeys(animkeyFrames);\r\n\r\n            if (!animation.mesh) {\r\n                continue;\r\n            }\r\n\r\n            animationGroup.addTargetedAnimation(anim, animation.mesh);\r\n        }\r\n\r\n        animationGroup.normalize(0, 45);\r\n        animationGroup.speedRatio = 1;\r\n\r\n        animationGroup.play();\r\n    }\r\n\r\n    private _performEnterExitAnimation(speedRatio: number) {\r\n        const frameRate = 60;\r\n        const animationGroup = new AnimationGroup(\"Enter Exit Animation Group\");\r\n\r\n        const animations = [\r\n            {\r\n                name: \"frontPlateFadeOut\",\r\n                mesh: this._frontPlate,\r\n                property: \"material.fadeOut\",\r\n                keys: [\r\n                    {\r\n                        frame: 0,\r\n                        values: [0, 0, 0.025045314830017686, 0],\r\n                    },\r\n                    {\r\n                        frame: 40,\r\n                        values: [1.00205599570012, 0.025045314830017686, 0, 0],\r\n                    },\r\n                ],\r\n            },\r\n            {\r\n                name: \"textPlateZSlide\",\r\n                mesh: this._textPlate,\r\n                property: \"position.z\",\r\n                keys: [\r\n                    {\r\n                        frame: 0,\r\n                        values: [0, 0.0, 0.0],\r\n                    },\r\n                    {\r\n                        frame: 40,\r\n                        values: [Vector3.Forward(this._textPlate._scene.useRightHandedSystem).scale(-0.15).z, 0.0, 0.0],\r\n                    },\r\n                ],\r\n            },\r\n        ];\r\n\r\n        for (const animation of animations) {\r\n            const anim = new Animation(animation.name, animation.property, frameRate, Animation.ANIMATIONTYPE_FLOAT, Animation.ANIMATIONLOOPMODE_CYCLE);\r\n            const animkeyFrames = [];\r\n\r\n            for (const key of animation.keys) {\r\n                animkeyFrames.push({\r\n                    frame: key.frame,\r\n                    value: key.values[0],\r\n                    inTangent: key.values[1],\r\n                    outTangent: key.values[2],\r\n                    interpolation: key.values[3],\r\n                });\r\n            }\r\n\r\n            anim.setKeys(animkeyFrames);\r\n\r\n            if (!animation.mesh) {\r\n                continue;\r\n            }\r\n\r\n            animationGroup.addTargetedAnimation(anim, animation.mesh);\r\n        }\r\n\r\n        animationGroup.normalize(0, 45);\r\n        animationGroup.speedRatio = speedRatio;\r\n\r\n        animationGroup.play();\r\n    }\r\n\r\n    private _createBackMaterial(mesh: Mesh) {\r\n        this._backMaterial = this._backMaterial ?? new MRDLBackplateMaterial(this.name + \"backPlateMaterial\", mesh.getScene());\r\n        this._backMaterial.absoluteSizes = true;\r\n        this._backMaterial.radius = this.radius;\r\n        this._backMaterial.lineWidth = 0.02;\r\n    }\r\n\r\n    private _createFrontMaterial(mesh: Mesh) {\r\n        this._frontMaterial = this._frontMaterial ?? new MRDLFrontplateMaterial(this.name + \"Front Material\", mesh.getScene());\r\n        this.frontMaterial.radius = this.innerQuadRadius;\r\n        this.frontMaterial.fadeOut = 0.0;\r\n    }\r\n\r\n    private _createBackGlowMaterial(mesh: Mesh) {\r\n        const glowRadius = this.radius + 0.04;\r\n        this._backGlowMaterial = this._backGlowMaterial ?? new MRDLBackglowMaterial(this.name + \"Back Glow Material\", mesh.getScene());\r\n        this._backGlowMaterial.bevelRadius = glowRadius;\r\n        this._backGlowMaterial.lineWidth = glowRadius;\r\n        this._backGlowMaterial.motion = 0.0;\r\n    }\r\n\r\n    private _createInnerQuadMaterial(mesh: Mesh) {\r\n        this._innerQuadMaterial = this._innerQuadMaterial ?? new MRDLInnerquadMaterial(\"inner_quad\", mesh.getScene());\r\n        this._innerQuadMaterial.radius = this.innerQuadRadius;\r\n\r\n        if (this.isToggleButton) {\r\n            this._innerQuadMaterial.color = this.innerQuadColor;\r\n        }\r\n    }\r\n\r\n    private _createPlateMaterial(mesh: Mesh) {\r\n        this._plateMaterial = this._plateMaterial ?? new StandardMaterial(this.name + \"Plate Material\", mesh.getScene());\r\n        this._plateMaterial.specularColor = Color3.Black();\r\n    }\r\n\r\n    protected _onToggle(newState: boolean) {\r\n        super._onToggle(newState);\r\n    }\r\n\r\n    protected _affectMaterial(mesh: Mesh) {\r\n        if (this._shareMaterials) {\r\n            // Back\r\n            if (!this._host._touchSharedMaterials[\"mrdlBackplateMaterial\"]) {\r\n                this._createBackMaterial(mesh);\r\n                this._host._touchSharedMaterials[\"mrdlBackplateMaterial\"] = this._backMaterial;\r\n            } else {\r\n                this._backMaterial = this._host._touchSharedMaterials[\"mrdlBackplateMaterial\"] as MRDLBackplateMaterial;\r\n            }\r\n\r\n            // Front\r\n            if (!this._host._touchSharedMaterials[\"mrdlFrontplateMaterial\"]) {\r\n                this._createFrontMaterial(mesh);\r\n                this._host._touchSharedMaterials[\"mrdlFrontplateMaterial\"] = this._frontMaterial;\r\n            } else {\r\n                this._frontMaterial = this._host._touchSharedMaterials[\"mrdlFrontplateMaterial\"] as MRDLFrontplateMaterial;\r\n            }\r\n\r\n            // Back glow\r\n            if (!this._host._touchSharedMaterials[\"mrdlBackglowMaterial\"]) {\r\n                this._createBackGlowMaterial(mesh);\r\n                this._host._touchSharedMaterials[\"mrdlBackglowMaterial\"] = this._backGlowMaterial;\r\n            } else {\r\n                this._backGlowMaterial = this._host._touchSharedMaterials[\"mrdlBackglowMaterial\"] as MRDLBackglowMaterial;\r\n            }\r\n\r\n            // Inner quad\r\n            if (!this._host._touchSharedMaterials[\"mrdlInnerQuadMaterial\"]) {\r\n                this._createInnerQuadMaterial(mesh);\r\n                this._host._touchSharedMaterials[\"mrdlInnerQuadMaterial\"] = this._innerQuadMaterial;\r\n            } else {\r\n                this._innerQuadMaterial = this._host._touchSharedMaterials[\"mrdlInnerQuadMaterial\"] as MRDLInnerquadMaterial;\r\n            }\r\n        } else {\r\n            this._createBackMaterial(mesh);\r\n            this._createFrontMaterial(mesh);\r\n            this._createBackGlowMaterial(mesh);\r\n            this._createInnerQuadMaterial(mesh);\r\n        }\r\n\r\n        this._createPlateMaterial(mesh);\r\n        this._backPlate.material = this._backMaterial;\r\n        this._textPlate.material = this._plateMaterial;\r\n\r\n        if (!this._isBackplateVisible) {\r\n            this._backPlate.visibility = 0;\r\n        }\r\n\r\n        if (this._frontPlate) {\r\n            this._frontPlate.material = this._frontMaterial;\r\n        }\r\n\r\n        if (this._backGlow) {\r\n            this._backGlow.material = this._backGlowMaterial;\r\n        }\r\n\r\n        if (this._innerQuad) {\r\n            this._innerQuad.material = this._innerQuadMaterial;\r\n        }\r\n\r\n        this._rebuildContent();\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        super.dispose(); // will dispose main mesh ie. back plate\r\n\r\n        this._disposeTooltip();\r\n        this.onPointerClickObservable.remove(this._pointerClickObserver);\r\n        this.onPointerEnterObservable.remove(this._pointerEnterObserver);\r\n        this.onPointerOutObservable.remove(this._pointerOutObserver);\r\n        this.onToggleObservable.remove(this._toggleObserver);\r\n\r\n        if (!this.shareMaterials) {\r\n            this._backMaterial.dispose();\r\n            this._frontMaterial.dispose();\r\n            this._plateMaterial.dispose();\r\n            this._backGlowMaterial.dispose();\r\n            this._innerQuadMaterial.dispose();\r\n\r\n            if (this._pickedPointObserver) {\r\n                this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver);\r\n                this._pickedPointObserver = null;\r\n            }\r\n        }\r\n    }\r\n}\r\n","export * from \"./abstractButton3D\";\r\nexport * from \"./button3D\";\r\nexport * from \"./container3D\";\r\nexport * from \"./control3D\";\r\nexport * from \"./cylinderPanel\";\r\nexport * from \"./handMenu\";\r\nexport * from \"./holographicBackplate\";\r\nexport * from \"./holographicButton\";\r\nexport * from \"./holographicSlate\";\r\nexport * from \"./meshButton3D\";\r\nexport * from \"./nearMenu\";\r\nexport * from \"./planePanel\";\r\nexport * from \"./scatterPanel\";\r\nexport * from \"./slider3D\";\r\nexport * from \"./spherePanel\";\r\nexport * from \"./stackPanel3D\";\r\nexport * from \"./touchButton3D\";\r\nexport * from \"./touchMeshButton3D\";\r\nexport * from \"./touchHolographicButton\";\r\nexport * from \"./touchHolographicMenu\";\r\nexport * from \"./volumeBasedPanel\";\r\n\r\n// MRTK3 Controls\r\nexport { TouchHolographicButton as TouchHolographicButtonV3 } from \"./MRTK3/touchHolographicButton\";\r\n","export * from \"./fluentMaterial\";\r\n","export * from \"./fluentButtonMaterial\";\r\n","export * from \"./fluentBackplateMaterial\";\r\n","export * from \"./handleMaterial\";\r\n","export * from \"./mrdlSliderBarMaterial\";\r\nexport * from \"./mrdlSliderThumbMaterial\";\r\nexport * from \"./mrdlBackplateMaterial\";\r\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Observable } from \"core/Misc/observable\";\r\nimport { Vector3 } from \"core/Maths/math.vector\";\r\nimport type { PointerInfo } from \"core/Events/pointerEvents\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\nimport type { Material } from \"core/Materials/material\";\r\nimport { HemisphericLight } from \"core/Lights/hemisphericLight\";\r\nimport type { AbstractMesh } from \"core/Meshes/abstractMesh\";\r\nimport { UtilityLayerRenderer } from \"core/Rendering/utilityLayerRenderer\";\r\nimport { EngineStore } from \"core/Engines/engineStore\";\r\nimport type { IDisposable, Scene } from \"core/scene\";\r\n\r\nimport { Container3D } from \"./controls/container3D\";\r\nimport type { Control3D } from \"./controls/control3D\";\r\nimport type { IPointerEvent } from \"core/Events/deviceInputEvents\";\r\n\r\n/**\r\n * Class used to manage 3D user interface\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/gui/gui3D\r\n */\r\nexport class GUI3DManager implements IDisposable {\r\n    private _scene: Scene;\r\n    private _sceneDisposeObserver: Nullable<Observer<Scene>>;\r\n    private _utilityLayer: Nullable<UtilityLayerRenderer>;\r\n    private _rootContainer: Container3D;\r\n    private _pointerObserver: Nullable<Observer<PointerInfo>>;\r\n    private _pointerOutObserver: Nullable<Observer<number>>;\r\n    private _customControlScaling = 1.0;\r\n    /** @internal */\r\n    public _lastPickedControl: Control3D;\r\n    /** @internal */\r\n    public _lastControlOver: { [pointerId: number]: Control3D } = {};\r\n    /** @internal */\r\n    public _lastControlDown: { [pointerId: number]: Control3D } = {};\r\n\r\n    protected static MRTK_REALISTIC_SCALING: number = 0.032;\r\n\r\n    /**\r\n     * Observable raised when the point picked by the pointer events changed\r\n     */\r\n    public onPickedPointChangedObservable = new Observable<Nullable<Vector3>>();\r\n\r\n    /**\r\n     * Observable raised when a picking happens\r\n     */\r\n    public onPickingObservable = new Observable<Nullable<AbstractMesh>>();\r\n\r\n    // Shared resources\r\n    /** @internal */\r\n    public _sharedMaterials: { [key: string]: Material } = {};\r\n\r\n    /** @internal */\r\n    public _touchSharedMaterials: { [key: string]: Material } = {};\r\n\r\n    /** Gets the hosting scene */\r\n    public get scene(): Scene {\r\n        return this._scene;\r\n    }\r\n\r\n    /** Gets associated utility layer */\r\n    public get utilityLayer(): Nullable<UtilityLayerRenderer> {\r\n        return this._utilityLayer;\r\n    }\r\n\r\n    /** Gets the scaling for all UI elements owned by this manager */\r\n    public get controlScaling() {\r\n        return this._customControlScaling;\r\n    }\r\n\r\n    /** Sets the scaling adjustment for all UI elements owned by this manager */\r\n    public set controlScaling(newScale: number) {\r\n        if (this._customControlScaling !== newScale && newScale > 0) {\r\n            const scaleRatio = newScale / this._customControlScaling;\r\n            this._customControlScaling = newScale;\r\n\r\n            this._rootContainer.children.forEach((control: Control3D) => {\r\n                control.scaling.scaleInPlace(scaleRatio);\r\n\r\n                if (newScale !== 1) {\r\n                    control._isScaledByManager = true;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /** Gets if controls attached to this manager are realistically sized, based on the fact that 1 unit length is 1 meter */\r\n    public get useRealisticScaling() {\r\n        return this.controlScaling === GUI3DManager.MRTK_REALISTIC_SCALING;\r\n    }\r\n\r\n    /** Sets if controls attached to this manager are realistically sized, based on the fact that 1 unit length is 1 meter */\r\n    public set useRealisticScaling(newValue: boolean) {\r\n        this.controlScaling = newValue ? GUI3DManager.MRTK_REALISTIC_SCALING : 1;\r\n    }\r\n\r\n    /**\r\n     * Creates a new GUI3DManager\r\n     * @param scene\r\n     */\r\n    public constructor(scene?: Scene) {\r\n        this._scene = scene || EngineStore.LastCreatedScene!;\r\n        this._sceneDisposeObserver = this._scene.onDisposeObservable.add(() => {\r\n            this._sceneDisposeObserver = null;\r\n            this._utilityLayer = null;\r\n            this.dispose();\r\n        });\r\n\r\n        this._utilityLayer = UtilityLayerRenderer._CreateDefaultUtilityLayerFromScene(this._scene);\r\n        this._utilityLayer.onlyCheckPointerDownEvents = false;\r\n        this._utilityLayer.pickUtilitySceneFirst = false;\r\n        this._utilityLayer.mainSceneTrackerPredicate = (mesh: Nullable<AbstractMesh>) => {\r\n            return mesh && mesh.reservedDataStore?.GUI3D?.control?._node;\r\n        };\r\n\r\n        // Root\r\n        this._rootContainer = new Container3D(\"RootContainer\");\r\n        this._rootContainer._host = this;\r\n        const utilityLayerScene = this._utilityLayer.utilityLayerScene;\r\n\r\n        // Events\r\n        this._pointerOutObserver = this._utilityLayer.onPointerOutObservable.add((pointerId) => {\r\n            this._handlePointerOut(pointerId, true);\r\n        });\r\n\r\n        this._pointerObserver = utilityLayerScene.onPointerObservable.add((pi) => {\r\n            this._doPicking(pi);\r\n        });\r\n\r\n        // Scene\r\n        this._utilityLayer.utilityLayerScene.autoClear = false;\r\n        this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil = false;\r\n        new HemisphericLight(\"hemi\", Vector3.Up(), this._utilityLayer.utilityLayerScene);\r\n    }\r\n\r\n    private _handlePointerOut(pointerId: number, isPointerUp: boolean) {\r\n        const previousControlOver = this._lastControlOver[pointerId];\r\n        if (previousControlOver) {\r\n            previousControlOver._onPointerOut(previousControlOver);\r\n            delete this._lastControlOver[pointerId];\r\n        }\r\n\r\n        if (isPointerUp) {\r\n            if (this._lastControlDown[pointerId]) {\r\n                this._lastControlDown[pointerId].forcePointerUp();\r\n                delete this._lastControlDown[pointerId];\r\n            }\r\n        }\r\n\r\n        this.onPickedPointChangedObservable.notifyObservers(null);\r\n    }\r\n\r\n    private _doPicking(pi: PointerInfo): boolean {\r\n        if (!this._utilityLayer || !this._utilityLayer.shouldRender || !this._utilityLayer.utilityLayerScene.activeCamera) {\r\n            return false;\r\n        }\r\n\r\n        const pointerEvent = <IPointerEvent>pi.event;\r\n\r\n        const pointerId = pointerEvent.pointerId || 0;\r\n        const buttonIndex = pointerEvent.button;\r\n\r\n        const pickingInfo = pi.pickInfo;\r\n        if (pickingInfo) {\r\n            this.onPickingObservable.notifyObservers(pickingInfo.pickedMesh);\r\n        }\r\n\r\n        if (!pickingInfo || !pickingInfo.hit) {\r\n            this._handlePointerOut(pointerId, pi.type === PointerEventTypes.POINTERUP);\r\n            return false;\r\n        }\r\n\r\n        if (pickingInfo.pickedPoint) {\r\n            this.onPickedPointChangedObservable.notifyObservers(pickingInfo.pickedPoint);\r\n        }\r\n\r\n        const control = <Control3D>pickingInfo.pickedMesh!.reservedDataStore?.GUI3D?.control;\r\n        if (!!control && !control._processObservables(pi.type, pickingInfo.pickedPoint!, pickingInfo.originMesh?.position || null, pointerId, buttonIndex)) {\r\n            if (pi.type === PointerEventTypes.POINTERMOVE) {\r\n                if (this._lastControlOver[pointerId]) {\r\n                    this._lastControlOver[pointerId]._onPointerOut(this._lastControlOver[pointerId]);\r\n                }\r\n\r\n                delete this._lastControlOver[pointerId];\r\n            }\r\n        }\r\n\r\n        if (pi.type === PointerEventTypes.POINTERUP) {\r\n            if (this._lastControlDown[pointerEvent.pointerId]) {\r\n                this._lastControlDown[pointerEvent.pointerId].forcePointerUp();\r\n                delete this._lastControlDown[pointerEvent.pointerId];\r\n            }\r\n\r\n            if (pointerEvent.pointerType === \"touch\" || (pointerEvent.pointerType === \"xr\" && this._scene.getEngine().hostInformation.isMobile)) {\r\n                this._handlePointerOut(pointerId, false);\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Gets the root container\r\n     */\r\n    public get rootContainer(): Container3D {\r\n        return this._rootContainer;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if the given control is in the root child list\r\n     * @param control defines the control to check\r\n     * @returns true if the control is in the root child list\r\n     */\r\n    public containsControl(control: Control3D): boolean {\r\n        return this._rootContainer.containsControl(control);\r\n    }\r\n\r\n    /**\r\n     * Adds a control to the root child list\r\n     * @param control defines the control to add\r\n     * @returns the current manager\r\n     */\r\n    public addControl(control: Control3D): GUI3DManager {\r\n        this._rootContainer.addControl(control);\r\n        if (this._customControlScaling !== 1) {\r\n            control.scaling.scaleInPlace(this._customControlScaling);\r\n            control._isScaledByManager = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Removes a control from the root child list\r\n     * @param control defines the control to remove\r\n     * @returns the current container\r\n     */\r\n    public removeControl(control: Control3D): GUI3DManager {\r\n        this._rootContainer.removeControl(control);\r\n        if (control._isScaledByManager) {\r\n            control.scaling.scaleInPlace(1 / this._customControlScaling);\r\n            control._isScaledByManager = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Releases all associated resources\r\n     */\r\n    public dispose() {\r\n        this._rootContainer.dispose();\r\n\r\n        for (const materialName in this._sharedMaterials) {\r\n            if (!Object.prototype.hasOwnProperty.call(this._sharedMaterials, materialName)) {\r\n                continue;\r\n            }\r\n\r\n            this._sharedMaterials[materialName].dispose();\r\n        }\r\n\r\n        this._sharedMaterials = {};\r\n\r\n        for (const materialName in this._touchSharedMaterials) {\r\n            if (!Object.prototype.hasOwnProperty.call(this._touchSharedMaterials, materialName)) {\r\n                continue;\r\n            }\r\n\r\n            this._touchSharedMaterials[materialName].dispose();\r\n        }\r\n\r\n        this._touchSharedMaterials = {};\r\n\r\n        if (this._pointerOutObserver && this._utilityLayer) {\r\n            this._utilityLayer.onPointerOutObservable.remove(this._pointerOutObserver);\r\n            this._pointerOutObserver = null;\r\n        }\r\n\r\n        this.onPickedPointChangedObservable.clear();\r\n        this.onPickingObservable.clear();\r\n\r\n        const utilityLayerScene = this._utilityLayer ? this._utilityLayer.utilityLayerScene : null;\r\n\r\n        if (utilityLayerScene) {\r\n            if (this._pointerObserver) {\r\n                utilityLayerScene.onPointerObservable.remove(this._pointerObserver);\r\n                this._pointerObserver = null;\r\n            }\r\n        }\r\n        if (this._scene) {\r\n            if (this._sceneDisposeObserver) {\r\n                this._scene.onDisposeObservable.remove(this._sceneDisposeObserver);\r\n                this._sceneDisposeObserver = null;\r\n            }\r\n        }\r\n\r\n        if (this._utilityLayer) {\r\n            this._utilityLayer.dispose();\r\n        }\r\n    }\r\n}\r\n","/* eslint-disable import/no-internal-modules */\r\nexport * from \"./fluent/index\";\r\nexport * from \"./fluentButton/index\";\r\nexport * from \"./fluentBackplate/index\";\r\nexport * from \"./handle/index\";\r\nexport * from \"./mrdl/index\";\r\n"],"names":["root","factory","exports","module","require","define","amd","self","global","this","__WEBPACK_EXTERNAL_MODULE__520__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","Function","e","window","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","__decorate","decorators","target","desc","c","arguments","length","getOwnPropertyDescriptor","Reflect","decorate","i","create","ValueAndUnit","unit","UNITMODE_PIXEL","negativeValueAllowed","_value","_unit","ignoreAdaptiveScaling","onChangedObservable","Observable","_originalUnit","isPercentage","UNITMODE_PERCENTAGE","isPixel","internalValue","notifyObservers","getValueInPixel","host","refValue","getValue","updateInPlace","width","height","idealWidth","Math","ceil","getSize","idealHeight","useSmallestIdeal","innerWidth","innerHeight","toString","decimals","percentage","toFixed","pixels","fromString","source","match","_Regex","exec","sourceValue","parseFloat","sourceUnit","_UNITMODE_PERCENTAGE","_UNITMODE_PIXEL","tmpRect","Vector2","tmpRect2","tmpV1","tmpV2","Measure","left","top","copyFrom","other","copyFromFloats","static","a","b","result","min","right","max","bottom","addAndTransformToRef","transform","addX","addY","addWidth","addHeight","Number","MAX_VALUE","transformCoordinates","x","y","floor","transformToRef","isEqualsTo","Vector2WithInfo","buttonIndex","super","Matrix2D","constructor","m00","m01","m10","m11","m20","m21","m","Float32Array","fromValues","determinant","invertToRef","l0","l1","l2","l3","l4","l5","det","Epsilon","detDiv","det4","det5","multiplyToRef","r0","r1","r2","r3","r4","r5","angle","s","sin","cos","tx","ty","scaleX","scaleY","parentMatrix","TranslationToRef","_TempPreTranslationMatrix","ScalingToRef","_TempScalingMatrix","RotationToRef","_TempRotationMatrix","_TempPostTranslationMatrix","_TempCompose0","_TempCompose1","_TempCompose2","Identity","MathTools","precision","DefaultRoundingPrecision","round","Control","isReadOnly","_isReadOnly","transformedMeasure","_evaluatedMeasure","clipChildren","_clipChildren","clipContent","_clipContent","shadowOffsetX","_shadowOffsetX","_markAsDirty","shadowOffsetY","_shadowOffsetY","shadowBlur","_shadowBlur","_previousShadowBlur","shadowColor","_shadowColor","typeName","_getTypeName","getClassName","accessibilityTag","_accessibilityTag","onAccessibilityTagChangedObservable","_host","fontOffset","_fontOffset","offset","alpha","_alpha","_alphaSet","highlightLineWidth","_highlightLineWidth","isHighlighted","_isHighlighted","highlightColor","_highlightColor","_scaleX","_markMatrixAsDirty","_scaleY","rotation","_rotation","transformCenterY","_transformCenterY","transformCenterX","_transformCenterX","horizontalAlignment","_horizontalAlignment","verticalAlignment","_verticalAlignment","fixedRatio","_fixedRatio","fixedRatioMasterIsWidth","_fixedRatioMasterIsWidth","_width","widthInPixels","_cachedParentMeasure","isNaN","_height","heightInPixels","fontFamily","_fontFamily","_resetFontCache","fontStyle","_fontStyle","fontWeight","_fontWeight","style","_style","remove","_styleObserver","add","_isFontSizeInPercentage","_fontSize","fontSizeInPixels","fontSizeToUse","_tempParentMeasure","fontSize","color","_color","gradient","_gradient","zIndex","_zIndex","parent","_reOrderControl","notRenderable","_doNotRender","isVisible","_isVisible","onIsVisibleChangedObservable","isDirty","_isDirty","linkedMesh","_linkedMesh","descendantsOnlyPadding","_descendantsOnlyPadding","paddingLeft","_paddingLeft","paddingLeftInPixels","_paddingLeftInPixels","paddingRight","_paddingRight","paddingRightInPixels","_paddingRightInPixels","paddingTop","_paddingTop","paddingTopInPixels","_paddingTopInPixels","paddingBottom","_paddingBottom","paddingBottomInPixels","_paddingBottomInPixels","_left","leftInPixels","_top","topInPixels","linkOffsetX","_linkOffsetX","linkOffsetXInPixels","linkOffsetY","_linkOffsetY","linkOffsetYInPixels","centerX","_currentMeasure","centerY","isEnabled","_isEnabled","recursivelyFirePointerOut","control","pointer","_lastControlOver","_onPointerOut","children","forEach","disabledColor","_disabledColor","disabledColorItem","_disabledColorItem","name","Empty","_tempPaddingMeasure","HORIZONTAL_ALIGNMENT_CENTER","VERTICAL_ALIGNMENT_CENTER","_wasDirty","_prevCurrentMeasureTransformedIntoGlobalSpace","_transformMatrix","_invertTransformMatrix","_transformedPosition","Zero","_isMatrixDirty","_fontSet","_dummyVector2","_downCount","_enterCount","_downPointerIds","_evaluatedParentMeasure","_rebuildLayout","_customData","_isClipped","_automaticSize","metadata","isHitTestVisible","isPointerBlocker","isFocusInvisible","useBitmapCache","hoverCursor","onWheelObservable","onPointerMoveObservable","onPointerOutObservable","onPointerDownObservable","onPointerUpObservable","onPointerClickObservable","onPointerEnterObservable","onDirtyObservable","onBeforeDrawObservable","onAfterDrawObservable","onDisposeObservable","animations","_tmpMeasureA","getAscendantOfClass","className","markAsDirty","force","markAllAsDirty","_markAllAsDirty","isAscendant","container","getLocalCoordinates","globalCoordinates","getLocalCoordinatesToRef","getParentLocalCoordinates","moveToVector3","position","scene","_rootContainer","Tools","Error","HORIZONTAL_ALIGNMENT_LEFT","VERTICAL_ALIGNMENT_TOP","globalViewport","_getGlobalViewport","projectedPosition","Vector3","Project","Matrix","IdentityReadOnly","getTransformMatrix","_moveToProjectedPosition","z","getDescendantsToRef","results","directDescendantsOnly","predicate","getDescendants","Array","linkWithMesh","mesh","index","_linkedControls","indexOf","splice","push","setPadding","setPaddingInPixels","oldLeft","oldTop","parentMeasure","_processMeasures","getContext","newLeft","newTop","leftAndTopIgnoreAdaptiveScaling","abs","_offsetLeft","_offsetTop","_flagDescendantsAsMatrixDirty","_intersectsRect","rect","context","_transform","_computeAdditionnalOffsetX","_computeAdditionnalOffsetY","invalidateRect","useInvalidateRectOptimization","CombineToRef","leftShadowOffset","rightShadowOffset","topShadowOffset","bottomShadowOffset","offsetX","offsetY","_font","_prepareFont","_link","uniqueId","getScene","getUniqueId","translate","rotate","scale","_cachedOffsetX","_cachedOffsetY","ComposeToRef","_renderHighlight","save","strokeStyle","lineWidth","_renderHighlightSpecific","restore","strokeRect","_getColor","getCanvasGradient","_applyStates","font","fillStyle","AllowAlphaInheritance","globalAlpha","renderToIntermediateTexture","_layout","_numLayoutCalls","rebuildCount","Logger","_evaluateClippingState","_preMeasure","_measure","_computeAlignment","_additionalProcessing","hasObservers","parentWidth","parentHeight","HORIZONTAL_ALIGNMENT_RIGHT","VERTICAL_ALIGNMENT_BOTTOM","_clipForChildren","_clip","invalidatedRectangle","beginPath","_ClipMeasure","intersection","clip","_render","_numRenderCalls","_cacheData","putImageData","_draw","getImageData","contains","_shouldBlockPointer","_processPicking","pi","type","pointerId","deltaX","deltaY","_processObservables","_onPointerMove","coordinates","_onPointerEnter","canNotify","_onPointerDown","rootContainer","_capturedPointerIds","event","_onPointerUp","notifyClick","canNotifyClick","delete","_forcePointerUp","_onWheelScroll","_onCanvasBlur","PointerEventTypes","POINTERMOVE","previousControlOver","POINTERDOWN","_registerLastControlDown","_lastPickedControl","POINTERUP","_lastControlDown","POINTERWHEEL","_GetFontOffset","child","clone","serialization","serialize","cloned","Instantiate","parse","serializedObject","SerializationHelper","Parse","_parseFromContent","serializationObject","Serialize","AppendSerializedAnimations","animationIndex","parsedAnimation","internalClass","GetClass","autoAnimate","beginAnimation","autoAnimateFrom","autoAnimateTo","autoAnimateLoop","autoAnimateSpeed","dispose","clear","removeControl","_HORIZONTAL_ALIGNMENT_LEFT","_HORIZONTAL_ALIGNMENT_RIGHT","_HORIZONTAL_ALIGNMENT_CENTER","_VERTICAL_ALIGNMENT_TOP","_VERTICAL_ALIGNMENT_BOTTOM","_VERTICAL_ALIGNMENT_CENTER","_FontHeightSizes","engine","EngineStore","LastCreatedEngine","getFontOffset","controlType","arc","PI","closePath","isReady","AddHeader","RegisterClass","Container","_renderToIntermediateTexture","adaptHeightToChildren","_adaptHeightToChildren","adaptWidthToChildren","_adaptWidthToChildren","background","_background","backgroundGradient","_backgroundGradient","_children","_measureForChildren","_intermediateTexture","logLayoutCycleErrors","maxLayoutCycle","onControlAddedObservable","onControlRemovedObservable","_inverseTransformMatrix","_inverseMeasure","getChildByName","getChildByType","containsControl","addControl","clearControls","slice","_cleanControlAfterRemoval","wasAdded","_getBackgroundColor","_localDraw","fillRect","_beforeLayout","scaleTo","DynamicTexture","Texture","NEAREST_SAMPLINGMODE","Constants","TEXTUREFORMAT_RGBA","hasAlpha","computedWidth","computedHeight","_postMeasure","renderToIntermediateTextureThisDraw","contextToDrawTo","clearRect","drawImage","canvas","item","_changeCursor","childSerializationObject","childData","Rectangle","thickness","_thickness","cornerRadius","_cornerRadius","cornerRadiusX","cornerRadiusY","cornerRadiusZ","cornerRadiusW","_cachedRadius","_getRectangleFill","_drawRoundedRect","fill","stroke","moveTo","lineTo","TextWrapping","TextBlock","lines","_lines","resizeToFit","_resizeToFit","textWrapping","_textWrapping","text","_text","onTextChangedObservable","textHorizontalAlignment","_textHorizontalAlignment","textVerticalAlignment","_textVerticalAlignment","lineSpacing","_lineSpacing","outlineWidth","_outlineWidth","underline","_underline","lineThrough","_lineThrough","applyOutlineToUnderline","_applyOutlineToUnderline","outlineColor","_outlineColor","wordDivider","_wordDivider","forceResizeWidth","_forceResizeWidth","Clip","onLinesReadyObservable","_linesTemp","_breakLines","maxLineWidth","line","newWidth","newHeight","_drawText","textWidth","strokeText","fillText","_drawLine","xFrom","yFrom","xTo","yTo","currentStroke","_renderLines","lineJoin","miterLimit","refWidth","refHeight","split","Ellipsis","_line","_parseLineEllipsis","WordWrap","_parseLineWordWrap","WordWrapEllipsis","_parseLineWordWrapEllipsis","_parseLine","_getTextMetricsWidth","measureText","_getCharsToRemove","lineLength","diff","charWidth","removeChars","characters","from","join","textMetrics","actualBoundingBoxLeft","actualBoundingBoxRight","words","wordSplittingFunction","n","testLine","testWidth","_computeHeightForLinesOf","lastLine","currentLine","linesToRemove","pop","rootY","ascent","descent","lineCount","computeExpectedHeight","createCanvas","Image","isLoaded","_loaded","detectPointerOnOpaqueOnly","_detectPointerOnOpaqueOnly","sliceLeft","_sliceLeft","sliceRight","_sliceRight","sliceTop","_sliceTop","sliceBottom","_sliceBottom","sourceLeft","_sourceLeft","sourceTop","_sourceTop","sourceWidth","_sourceWidth","sourceHeight","_sourceHeight","imageWidth","_imageWidth","imageHeight","_imageHeight","populateNinePatchSlicesFromImage","_populateNinePatchSlicesFromImage","_extractNinePatchSliceDataFromImage","isSVG","_isSVG","svgAttributesComputationCompleted","_svgAttributesComputationCompleted","autoScale","_autoScale","synchronizeSizeWithContent","stretch","_stretch","_rotate90","preserveProperties","_domImage","getEngine","dataUrl","toDataURL","rotatedImage","_cellId","_cellWidth","_cellHeight","_handleRotationForSVGImage","_imageDataCache","data","srcImage","dstImage","_rotate90SourceProperties","onSVGAttributesComputedObservable","addOnce","srcLeft","srcTop","srcWidth","domImage","srcHeight","dstLeft","dstTop","dstWidth","dstHeight","mult","_workingCanvas","imageData","_onImageLoaded","onload","onImageLoadedObservable","_source","SourceImgCache","_removeCacheUsage","timesUsed","_svgCheck","has","cachedData","img","loaded","waitingForLoadCallback","bind","createCanvasImage","set","waitingCallback","SetCorsBehavior","SetReferrerPolicyBehavior","referrerPolicy","src","SVGSVGElement","search","lastIndexOf","svgsrc","elemid","svgExist","document","body","querySelector","svgDoc","contentDocument","documentElement","vb","getAttribute","docwidth","docheight","getElementById","_getSVGAttribs","addEventListener","svgImage","createElement","appendChild","svgobj","elem","vb_width","vb_height","elem_bbox","getBBox","elem_matrix_a","elem_matrix_d","elem_matrix_e","elem_matrix_f","mainMatrix","baseVal","consolidate","matrix","f","cellWidth","cellHeight","cellId","url","STRETCH_FILL","STRETCH_NONE","STRETCH_UNIFORM","STRETCH_NINE_PATCH","STRETCH_EXTEND","_prepareWorkingCanvasForOpaqueDetection","_drawImage","sx","sy","sw","sh","tw","th","rowCount","naturalWidth","column","row","hRatio","vRatio","ratio","_renderNinePatch","leftWidth","topHeight","bottomHeight","rightWidth","centerWidth","centerHeight","targetCenterWidth","targetCenterHeight","centerLeftOffset","centerTopOffset","rightOffset","bottomOffset","Map","Button","image","_image","textBlock","_textBlock","delegatePickingToChildren","alphaStore","pointerEnterAnimation","pointerOutAnimation","pointerDownAnimation","pointerUpAnimation","textBlockName","imageName","imageUrl","iconImage","StackPanel","isVertical","_isVertical","spacing","_spacing","_doNotTrackManualChanges","_manualWidth","_manualHeight","ignoreLayoutWarnings","stackWidth","stackHeight","childrenCount","Warn","panelWidthChanged","panelHeightChanged","previousHeight","previousWidth","manualWidth","manualHeight","Checkbox","checkSizeRatio","_checkSizeRatio","isChecked","_isChecked","onIsCheckedChangedObservable","actualWidth","actualHeight","offsetWidth","offsetHeight","title","onValueChanged","panel","checkbox","header","TextWrapper","_characters","txt","removePart","idxStart","idxEnd","insertTxt","newCharacters","charAt","idx","substr","temp","substring","to","isWord","rWord","InputText","maxWidth","_maxWidth","maxWidthInPixels","highligherOpacity","_highligherOpacity","onFocusSelectAll","_onFocusSelectAll","textHighlightColor","_textHighlightColor","margin","_margin","marginInPixels","autoStretchWidth","_autoStretchWidth","focusedBackground","_focusedBackground","focusedColor","_focusedColor","placeholderColor","_placeholderColor","placeholderText","_placeholderText","deadKey","_deadKey","flag","highlightedText","_highlightedText","addKey","_addKey","currentKey","_currentKey","_textWrapper","valueAsString","_textHasChanged","_isFocused","_blinkIsEven","_cursorOffset","_isTextHighlightOn","_startHighlightIndex","_endHighlightIndex","_cursorIndex","_isPointerDown","promptMessage","disableMobilePrompt","onBeforeKeyAddObservable","onFocusObservable","onBlurObservable","onTextHighlightObservable","onTextCopyObservable","onTextCutObservable","onTextPasteObservable","onKeyboardEventProcessedObservable","onBlur","_scrollLeft","clearTimeout","_blinkTimeout","unRegisterClipboardEvents","_onClipboardObserver","onClipboardObservable","_onPointerDblTapObserver","onPointerObservable","onFocus","_focusedBy","prompt","focusedControl","registerClipboardEvents","clipboardInfo","ClipboardEventTypes","COPY","_onCopyText","CUT","_onCutText","PASTE","_onPasteText","pointerInfo","POINTERDOUBLETAP","_processDblClick","_selectAllText","focus","moveFocusToControl","blur","keepsFocusWith","_connectedVirtualKeyboard","processKey","keyCode","evt","ctrlKey","metaKey","preventDefault","isTextHighlightOn","deletePosition","shiftKey","insertPosition","_updateValueFromCursorIndex","moveLeft","moveRight","_clickedCoordinate","processKeyboard","ev","clipboardData","setData","types","getData","clipTextLeft","_beforeRenderText","_textWidth","marginWidth","availableWidth","textLeft","absoluteCursorPosition","currentSize","previousDist","cursorOffsetText","cursorOffsetWidth","cursorLeft","setTimeout","highlightCursorOffsetWidth","highlightCursorLeft","_capturingControl","pointerType","textWrapper","Grid","_cells","columnCount","_columnDefinitions","_rowDefinitions","_childControls","cells","getRowDefinition","getColumnDefinition","addRowDefinition","_rowDefinitionObservers","addColumnDefinition","_columnDefinitionObservers","setRowDefinition","current","setColumnDefinition","getChildrenAt","cell","getChildCellInfo","_tag","_removeCell","childIndex","_offsetCell","previousKey","removeColumnDefinition","removeRowDefinition","goodContainer","_getGridDefinitions","definitionCallback","widths","heights","lefts","tops","globalWidthPercentage","availableHeight","globalHeightPercentage","rowDefinition","columnDefinition","parseInt","columns","rows","tags","cd","rd","columnValue","rowValue","cellInfo","rowNumber","columnNumber","ColorPicker","equals","toHSVToRef","_tmpColor","_h","_s","_v","_Epsilon","onValueChangedObservable","size","Color3","Red","_pointerStartedOnSquare","_pointerStartedOnWheel","_squareLeft","_squareTop","_squareSize","_lastPointerDownId","_pointerIsDown","_updateSquareProps","radius","squareSize","sqrt","_drawGradientSquare","hueValue","lgh","createLinearGradient","addColorStop","lgv","_drawCircle","_createColorWheelCanvas","maxDistSq","innerRadius","minDistSq","distSq","dist","ang","atan2","HSVtoRGBToRef","alphaRatio","alphaAmount","maxAlpha","minAlpha","lowerRadius","upperRadius","wheelThickness","_colorWheelCanvas","cx","cy","_updateValueFromPointer","_isPointOnSquare","_isPointOnWheel","dx","dy","advancedTexture","options","Promise","resolve","pickerWidth","pickerHeight","headerHeight","lastColor","swatchLimit","numSwatchesPerLine","drawerMaxRows","rawSwatchSize","gutterSize","colGutters","swatchSize","drawerMaxSize","containerSize","buttonColor","buttonBackgroundColor","buttonBackgroundHoverColor","buttonBackgroundClickColor","buttonDisabledColor","buttonDisabledBackgroundColor","luminanceLimitColor","FromHexString","luminanceLimit","iconColorDark","iconColorLight","buttonFontSize","butEdit","inputFieldLabels","inputTextBackgroundColor","inputTextColor","swatchNumber","swatchDrawer","butSave","lastVal","activeField","editSwatchMode","dialogContainer","savedColors","topRow","initialRows","gutterCount","pickerPanel","panelHead","pickerPanelRows","closeButton","CreateSimpleButton","headerColor3","closeIconColor","toHexString","closePicker","currentSwatch","dialogBody","dialogBodyCols","pickerGrid","picker","editSwatches","updateValues","pickerBodyRight","pickerBodyRightRows","pickerSwatchesButtons","pickerButtonsCol","pickerSwatches","pickeSwatchesRows","activeSwatches","labelWidth","labelHeight","labelTextSize","newText","newSwatch","swatchOutline","currentText","buttonGrid","buttonGridRows","buttonWidth","buttonHeight","butOK","butCancel","disableButton","setEditButtonVisibility","updateSwatches","pickerColorValues","currentColor","rgbValuesQuadrant","labelText","rValInt","updateInt","gValInt","bValInt","rValDec","updateFloat","gValDec","bValDec","hexValueQuadrant","hexVal","minusPound","inputField","pickedColor","field","channel","newValue","test","newSwatchRGB","createSwatch","icon","swatch","swatchColor","swatchLuminence","mode","thisButton","button","currentRows","thisRow","totalButtonsThisRow","buttonIterations","w","enableButton","disabled","val","newHexValue","checkHex","leadingZero","Ellipse","drawEllipse","FocusableButton","_unfocusedColor","displose","InputTextArea","autoStretchHeight","_autoStretchHeight","maxHeight","_maxHeight","maxHeightInPixels","_updateCursorPosition","_highlightCursorInfo","initialStartIndex","initialRelativeStartIndex","initialLineIndex","_cursorInfo","globalStartIndex","globalEndIndex","relativeEndIndex","relativeStartIndex","currentLineIndex","alternativeProcessKey","code","rightDelta","upperLine","tmpIndex","relativeIndex","currentWidth","_contextForBreakLines","upperWidth","lineEnding","upperLineRelativeIndex","underLine","underWidth","underLineRelativeIndex","flushedLine","map","char","longerString","reduce","acc","longerStringWidth","_availableWidth","totalHeight","_availableHeight","tmpLength","_computeScroll","_clipTextLeft","_clipTextTop","selectedHeight","textTop","_scrollTop","deltaIndex","cursorTop","_resetBlinking","startLineIndex","endLineIndex","highlightRootY","highlightRootX","begin","end","leftOffsetWidth","selectedText","hightlightWidth","_clickedCoordinateX","_clickedCoordinateY","movementX","movementY","globalIndex","lastClickedCoordinateY","relativeCoordinateY","relativeXPosition","_evt","dipose","InputPassword","pwdTextWrapper","Line","dash","_dash","connectedControl","_connectedControl","_connectedControlDirtyObserver","x1","_x1","y1","_y1","x2","_x2","y2","_y2","_lineWidth","_effectiveX2","_effectiveY2","setLineDash","MultiLinePoint","multiLine","_multiLine","_x","_y","_point","_control","_controlObserver","onPointUpdate","_mesh","_meshObserver","onAfterCameraRenderObservable","resetLinks","_translatePoint","getProjectedPositionWithZ","getBoundingInfo","boundingSphere","center","getWorldMatrix","xValue","_canvas","yValue","MultiLine","_points","getAt","items","point","AbstractMesh","reset","previousPoint","first","_minX","_minY","_maxX","_maxY","RadioButton","executeOnAllControls","group","childRadio","offseHeight","radio","BaseSlider","displayThumb","_displayThumb","step","_step","barOffset","_barOffset","barOffsetInPixels","thumbWidth","_thumbWidth","thumbWidthInPixels","minimum","_minimum","_maximum","maximum","isThumbClamped","_isThumbClamped","_effectiveBarOffset","_getThumbPosition","_backgroundBoxLength","_getThumbThickness","thumbThickness","_backgroundBoxThickness","_prepareRenderingData","_renderLeft","_renderTop","_renderWidth","_renderHeight","_effectiveThumbThickness","console","error","Slider","displayValueBar","_displayValueBar","borderColor","_borderColor","thumbColor","_thumbColor","isThumbCircle","_isThumbCircle","thumbPosition","SelectorGroup","_groupPanel","_selectors","_groupHeader","_addGroupHeader","groupPanel","selectors","label","groupHeading","_getSelector","selectorNb","removeSelector","CheckboxGroup","addCheckbox","func","checked","state","_selector","isHorizontal","controlFirst","buttonBackground","_setSelectorLabel","_setSelectorLabelColor","_setSelectorButtonColor","_setSelectorButtonBackground","RadioGroup","_selectNb","addRadio","nb","SliderGroup","addSlider","v","onValueChange","SelectionPanel","groups","_buttonColor","_buttonBackground","_headerColor","_barColor","_barHeight","_spacerHeight","_bars","_groups","_panel","_addSpacer","headerColor","_setHeaderColor","_setbuttonColor","j","labelColor","_labelColor","_setLabelColor","_setButtonBackground","barColor","_setBarColor","barHeight","_setBarHeight","spacerHeight","_setSpacerHeight","separator","bar","addGroup","removeGroup","groupNb","setHeaderName","relabel","removeFromGroupSelector","addToGroupCheckbox","addToGroupRadio","addToGroupSlider","onVal","_ScrollViewerWindow","freezeControls","_freezeControls","_restoreMeasures","textureSize","renderWidth","renderHeight","measure","_updateMeasures","_useBuckets","_makeBuckets","bucketWidth","_bucketWidth","bucketHeight","_bucketHeight","setBucketSizes","_buckets","_bucketLen","_dispatchInBuckets","_oldLeft","_oldTop","bStartX","_origLeft","origLeft","bEndX","bEndY","_origTop","origTop","bStartY","bucket","lstc","origLeftForChildren","origTopForChildren","_updateChildrenMeasures","_parentMeasure","_scrollChildren","_scrollChildrenWithBuckets","scrollLeft","scrollTop","parentClientWidth","parentClientHeight","ScrollBar","invertScrollDirection","_invertScrollDirection","invert","_tempMeasure","sign","_first","_originX","_originY","delta","ImageScrollBar","backgroundImage","_backgroundBaseImage","num90RotationInVerticalMode","_backgroundImage","rotatedValue","thumbImage","_thumbBaseImage","_thumbImage","thumbLength","_thumbLength","thumbHeight","_thumbHeight","barImageHeight","_barImageHeight","ScrollViewer","horizontalBar","_horizontalBar","verticalBar","_verticalBar","_window","forceHorizontalBar","_forceHorizontalBar","_grid","_barSize","forceVerticalBar","_forceVerticalBar","isImageBased","_pointerIsOver","_wheelPrecision","_horizontalBarImageHeight","_verticalBarImageHeight","_oldWindowContentsWidth","_oldWindowContentsHeight","_useImageBar","_horizontalBarSpace","_verticalBarSpace","_dragSpace","_addBar","barBackground","resetWindow","_buildClientSizes","idealRatio","_clientWidth","_clientHeight","_updateScroller","_setWindowPosition","wheelPrecision","scrollBackground","_barImage","hb","horizontalThumbImage","_horizontalBarImage","verticalThumbImage","_verticalBarImage","barSize","horizontalBarImageHeight","verticalBarImageHeight","_barBackground","barImage","_barBackgroundImage","horizontalBarImage","_horizontalBarBackgroundImage","verticalBarImage","_verticalBarBackgroundImage","windowContentsWidth","windowContentsHeight","_endLeft","_endTop","_attachWheel","barControl","barContainer","_onWheelObserver","ToggleButton","_group","isActive","_isActive","toActiveAnimation","toInactiveAnimation","onIsActiveChangedObservable","childToggle","pointerEnterActiveAnimation","pointerOutActiveAnimation","pointerDownActiveAnimation","pointerUpActiveAnimation","pointerEnterInactiveAnimation","pointerOutInactiveAnimation","pointerDownInactiveAnimation","pointerUpInactiveAnimation","KeyPropertySet","VirtualKeyboard","onKeyPressObservable","defaultButtonWidth","defaultButtonHeight","defaultButtonPaddingLeft","defaultButtonPaddingRight","defaultButtonPaddingTop","defaultButtonPaddingBottom","defaultButtonColor","defaultButtonBackground","shiftButtonColor","selectedShiftThickness","shiftState","_currentlyConnectedInputText","_connectedInputTexts","_onKeyPressObserver","_createKey","propertySet","addKeysRow","keys","propertySets","maxKey","properties","applyShiftState","rowContainer","button_tblock","toUpperCase","toLowerCase","connectedInputText","connect","input","some","onFocusObserver","onBlurObserver","disconnect","filtered","filter","_removeConnectedInputObservables","returnValue","stackPanel","DisplayGrid","displayMinorLines","_displayMinorLines","displayMajorLines","_displayMajorLines","minorLineTickness","_minorLineTickness","minorLineColor","_minorLineColor","majorLineTickness","_majorLineTickness","majorLineColor","_majorLineColor","majorLineFrequency","_majorLineFrequency","cellCountX","cellCountY","cellX","cellY","ImageBasedSlider","valueBarImage","_valueBarImage","BaseGradient","_colorStops","_gradientDirty","_addColorStopsToCanvasGradient","stop","_canvasGradient","_context","_createCanvasGradient","removeColorStop","colorStop","clearColorStops","colorStops","LinearGradient","x0","y0","_x0","_y0","RadialGradient","_r0","_r1","createRadialGradient","Style","AdvancedDynamicTexture","numLayoutCalls","numRenderCalls","renderScale","_renderScale","_onResize","_idealWidth","_idealHeight","_useSmallestIdeal","renderAtIdealSize","_renderAtIdealSize","rwidth","rheight","layer","_layerToDispose","getChildren","getControlsByType","getControlByName","_getControlByKey","find","_focusedControl","isForeground","isBackground","_clipboardData","generateMipMaps","samplingMode","invertY","onGuiReadyObservable","_isFullscreen","_fullscreenViewport","Viewport","_blockNextFocusCheck","_cursorChanged","_defaultMousePointerId","_rootChildrenHaveChanged","Set","onControlPickedObservable","onBeginLayoutObservable","onEndLayoutObservable","onBeginRenderObservable","onEndRenderObservable","premulAlpha","applyYInversionOnUpdate","checkPointerEveryFrame","_useInvalidateRectOptimization","_invalidatedRectangle","_clearMeasure","_onClipboardCopy","rawEvt","ClipboardInfo","_onClipboardCut","_onClipboardPaste","parseContent","parseSerializedObject","_texture","_rootElement","getInputElement","_renderObserver","onBeforeCameraRenderObservable","camera","_checkUpdate","_controlAddedObserver","_controlRemovedObserver","_preKeyboardObserver","onPreKeyboardObservable","info","KeyboardEventTypes","KEYDOWN","skipOnPointerObservable","_resizeObserver","onResizeObservable","invalidMinX","invalidMinY","invalidMaxX","invalidMaxY","maxX","maxY","createStyle","moveToNonOverlappedPosition","overlapGroup","deltaStep","repelFactor","controlsForGroup","isArray","descendants","control1","velocity","control2","_Overlaps","subtract","diffLength","normalize","overlapDeltaMultiplier","_prePointerObserver","onPrePointerObservable","_sceneRenderObserver","onBeforeRenderObservable","_pointerObserver","_canvasPointerOutObserver","onCanvasPointerOutObservable","_canvasBlurObserver","onCanvasBlurObservable","texture","getRenderWidth","getRenderHeight","globalViewPort","toGlobal","targetX","targetY","getProjectedPosition","worldMatrix","skipUpdate","layerMask","isDisposed","SetImmediate","ZeroReadOnly","update","AllowGPUOptimizations","skipRender","_checkGuiIsReady","activeCamera","cursor","_doPicking","cameraToUseForPointers","viewport","doNotHandleCursors","_manageFocus","_cleanControlAfterRemovalFromList","list","pick","_scene","_translateToPicking","tempViewport","pointerX","pointerY","originalCameraToUseForPointers","rigCameras","rigViewport","rigCamera","toGlobalToRef","transformedX","getHardwareScalingLevel","transformedY","attach","isPointerCaptured","_attachPickingToSceneRender","_attachToOnPointerOut","_attachToOnBlur","removeEventListener","_transformUvs","uv","textureMatrix","getTextureMatrix","isIdentityAs3x2","homogeneousTextureMatrix","TmpVectors","getRowToRef","Vector4","setRowFromFloats","TransformToRef","wrapU","WRAP_ADDRESSMODE","MIRROR_ADDRESSMODE","fX","trunc","wrapV","fY","attachToMesh","supportPointerMove","pickInfo","hit","pickedMesh","getTextureCoordinates","friendlyControls","canMoveFocus","otherHost","enablePointerMoveEvents","pickFunction","forcePicking","pointerEvent","entries","serializeContent","scaleToSize","newName","noMipmap","snippetId","appendToAdt","adt","CreateFullscreenUI","serialized","_LoadURLContentAsync","SnippetUrl","replace","parseFromSnippetAsync","ParseFromSnippetAsync","parseFromURLAsync","ParseFromFileAsync","snippet","reject","request","WebRequest","readyState","status","gui","payload","JSON","responseText","jsonPayload","encodedGui","TextDecoder","decode","DecodeBase64ToBinary","open","send","onlyAlphaTesting","materialSetupCallback","_CreateMaterial","RandomGUID","TRILINEAR_SAMPLINGMODE","internalClassType","material","backFaceCulling","diffuseColor","Black","specularColor","diffuseTexture","emissiveTexture","opacityTexture","foreground","sampling","BILINEAR_SAMPLINGMODE","adaptiveScaling","resultScene","Layer","newScale","guiIsReady","AdvancedDynamicTextureInstrumentation","renderTimeCounter","_renderTime","layoutTimeCounter","_layoutTime","captureRenderTime","_captureRenderTime","_onBeginRenderObserver","beginMonitoring","_onEndRenderObserver","endMonitoring","captureLayoutTime","_captureLayoutTime","_onBeginLayoutObserver","_onEndLayoutObserver","PerfCounter","XmlLoaderError","XmlLoader","parentClass","_nodes","_nodeTypes","element","attribute","_isLoaded","_objectAttributes","_parentClass","_getChainElement","attributeValue","_getClassAttribute","attributeName","_createGuiElement","node","linkParent","guiNode","nodeName","attributes","includes","startsWith","endsWith","getNamedItem","id","exception","_parseGrid","cellNode","totalColumnsNumber","nodeType","nodeValue","k","firstChild","_parseXml","nextSibling","_parseElement","_prepareSourceElement","variable","iterator","_parseElementsFromSource","dataSource","splittedSource","generated","setAttribute","_rootNode","getNodeById","getNodes","loadLayout","xmlFile","rootNode","onSuccess","onError","xhttp","XMLHttpRequest","responseXML","xmlDoc","onerror","async","Vector3WithInfo","Control3D","_node","scaling","_isScaledByManager","behaviors","_behaviors","addBehavior","behavior","init","isLoading","onDataLoadedObservable","removeBehavior","detach","getBehaviorByName","setEnabled","linkToTransformNode","_prepareNode","_createNode","_injectGUI3DReservedDataStore","isPickable","_affectMaterial","reservedDataStore","GUI3D","_isTouchButton3D","_generatePointerEventType","forcePointerUp","pickedPoint","originMeshPosition","_disposeNode","ContentDisplay3D","_contentResolution","_contentScaleRatio","content","_content","utilityLayer","_facadeTexture","utilityLayerScene","_setFacadeTextureScaling","_applyFacade","_contentScaleRatioY","contentResolution","_resetContent","_disposeFacadeTexture","facadeTexture","AbstractButton3D","TransformNode","Button3D","_options","depth","_currentMaterial","emissiveColor","scaleInPlace","faceUV","useRightHandedSystem","CreateBox","wrap","StandardMaterial","Container3D","blockLayout","_blockLayout","_arrangeChildren","updateLayout","UNSET_ORIENTATION","FACEORIGIN_ORIENTATION","FACEORIGINREVERSED_ORIENTATION","FACEFORWARD_ORIENTATION","FACEFORWARDREVERSED_ORIENTATION","VolumeBasedPanel","orientation","_orientation","_columns","_rowThenColum","_rows","controlCount","currentInverseWorld","Invert","computeWorldMatrix","boundingBox","getHierarchyBoundingVectors","extendSize","subtractToRef","TransformNormalToRef","startOffsetX","startOffsetY","nodeGrid","cellCounter","_mapGridNode","_finalProcessing","CylinderPanel","_radius","nodePosition","newPos","_cylindricalMapping","lookAt","Axis","Y","Space","LOCAL","yAngle","RotationYawPitchRollToRef","TransformNormal"],"sourceRoot":""}